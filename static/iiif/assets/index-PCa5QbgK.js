function Od(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const i in r)if(i!=="default"&&!(i in e)){const s=Object.getOwnPropertyDescriptor(r,i);s&&Object.defineProperty(e,i,s.get?s:{enumerable:!0,get:()=>r[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function Jo(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var e1={exports:{}},jd={},t1={exports:{}},ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var za=Symbol.for("react.element"),A2=Symbol.for("react.portal"),O2=Symbol.for("react.fragment"),j2=Symbol.for("react.strict_mode"),M2=Symbol.for("react.profiler"),L2=Symbol.for("react.provider"),N2=Symbol.for("react.context"),F2=Symbol.for("react.forward_ref"),z2=Symbol.for("react.suspense"),$2=Symbol.for("react.memo"),D2=Symbol.for("react.lazy"),w0=Symbol.iterator;function B2(e){return e===null||typeof e!="object"?null:(e=w0&&e[w0]||e["@@iterator"],typeof e=="function"?e:null)}var n1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},r1=Object.assign,i1={};function el(e,t,n){this.props=e,this.context=t,this.refs=i1,this.updater=n||n1}el.prototype.isReactComponent={};el.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};el.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function s1(){}s1.prototype=el.prototype;function dm(e,t,n){this.props=e,this.context=t,this.refs=i1,this.updater=n||n1}var fm=dm.prototype=new s1;fm.constructor=dm;r1(fm,el.prototype);fm.isPureReactComponent=!0;var S0=Array.isArray,o1=Object.prototype.hasOwnProperty,hm={current:null},l1={key:!0,ref:!0,__self:!0,__source:!0};function a1(e,t,n){var r,i={},s=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(s=""+t.key),t)o1.call(t,r)&&!l1.hasOwnProperty(r)&&(i[r]=t[r]);var u=arguments.length-2;if(u===1)i.children=n;else if(1<u){for(var d=Array(u),h=0;h<u;h++)d[h]=arguments[h+2];i.children=d}if(e&&e.defaultProps)for(r in u=e.defaultProps,u)i[r]===void 0&&(i[r]=u[r]);return{$$typeof:za,type:e,key:s,ref:o,props:i,_owner:hm.current}}function U2(e,t){return{$$typeof:za,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function pm(e){return typeof e=="object"&&e!==null&&e.$$typeof===za}function W2(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var k0=/\/+/g;function $h(e,t){return typeof e=="object"&&e!==null&&e.key!=null?W2(""+e.key):t.toString(36)}function Pc(e,t,n,r,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(s){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case za:case A2:o=!0}}if(o)return o=e,i=i(o),e=r===""?"."+$h(o,0):r,S0(i)?(n="",e!=null&&(n=e.replace(k0,"$&/")+"/"),Pc(i,t,n,"",function(h){return h})):i!=null&&(pm(i)&&(i=U2(i,n+(!i.key||o&&o.key===i.key?"":(""+i.key).replace(k0,"$&/")+"/")+e)),t.push(i)),1;if(o=0,r=r===""?".":r+":",S0(e))for(var u=0;u<e.length;u++){s=e[u];var d=r+$h(s,u);o+=Pc(s,t,n,d,i)}else if(d=B2(e),typeof d=="function")for(e=d.call(e),u=0;!(s=e.next()).done;)s=s.value,d=r+$h(s,u++),o+=Pc(s,t,n,d,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function Hu(e,t,n){if(e==null)return e;var r=[],i=0;return Pc(e,r,"","",function(s){return t.call(n,s,i++)}),r}function H2(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var gn={current:null},Ec={transition:null},V2={ReactCurrentDispatcher:gn,ReactCurrentBatchConfig:Ec,ReactCurrentOwner:hm};function u1(){throw Error("act(...) is not supported in production builds of React.")}ze.Children={map:Hu,forEach:function(e,t,n){Hu(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return Hu(e,function(){t++}),t},toArray:function(e){return Hu(e,function(t){return t})||[]},only:function(e){if(!pm(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};ze.Component=el;ze.Fragment=O2;ze.Profiler=M2;ze.PureComponent=dm;ze.StrictMode=j2;ze.Suspense=z2;ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=V2;ze.act=u1;ze.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=r1({},e.props),i=e.key,s=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,o=hm.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(d in t)o1.call(t,d)&&!l1.hasOwnProperty(d)&&(r[d]=t[d]===void 0&&u!==void 0?u[d]:t[d])}var d=arguments.length-2;if(d===1)r.children=n;else if(1<d){u=Array(d);for(var h=0;h<d;h++)u[h]=arguments[h+2];r.children=u}return{$$typeof:za,type:e.type,key:i,ref:s,props:r,_owner:o}};ze.createContext=function(e){return e={$$typeof:N2,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:L2,_context:e},e.Consumer=e};ze.createElement=a1;ze.createFactory=function(e){var t=a1.bind(null,e);return t.type=e,t};ze.createRef=function(){return{current:null}};ze.forwardRef=function(e){return{$$typeof:F2,render:e}};ze.isValidElement=pm;ze.lazy=function(e){return{$$typeof:D2,_payload:{_status:-1,_result:e},_init:H2}};ze.memo=function(e,t){return{$$typeof:$2,type:e,compare:t===void 0?null:t}};ze.startTransition=function(e){var t=Ec.transition;Ec.transition={};try{e()}finally{Ec.transition=t}};ze.unstable_act=u1;ze.useCallback=function(e,t){return gn.current.useCallback(e,t)};ze.useContext=function(e){return gn.current.useContext(e)};ze.useDebugValue=function(){};ze.useDeferredValue=function(e){return gn.current.useDeferredValue(e)};ze.useEffect=function(e,t){return gn.current.useEffect(e,t)};ze.useId=function(){return gn.current.useId()};ze.useImperativeHandle=function(e,t,n){return gn.current.useImperativeHandle(e,t,n)};ze.useInsertionEffect=function(e,t){return gn.current.useInsertionEffect(e,t)};ze.useLayoutEffect=function(e,t){return gn.current.useLayoutEffect(e,t)};ze.useMemo=function(e,t){return gn.current.useMemo(e,t)};ze.useReducer=function(e,t,n){return gn.current.useReducer(e,t,n)};ze.useRef=function(e){return gn.current.useRef(e)};ze.useState=function(e){return gn.current.useState(e)};ze.useSyncExternalStore=function(e,t,n){return gn.current.useSyncExternalStore(e,t,n)};ze.useTransition=function(){return gn.current.useTransition()};ze.version="18.3.1";t1.exports=ze;var b=t1.exports;const at=Jo(b),c1=Od({__proto__:null,default:at},[b]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var q2=b,Q2=Symbol.for("react.element"),Y2=Symbol.for("react.fragment"),X2=Object.prototype.hasOwnProperty,K2=q2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,G2={key:!0,ref:!0,__self:!0,__source:!0};function d1(e,t,n){var r,i={},s=null,o=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)X2.call(t,r)&&!G2.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:Q2,type:e,key:s,ref:o,props:i,_owner:K2.current}}jd.Fragment=Y2;jd.jsx=d1;jd.jsxs=d1;e1.exports=jd;var E=e1.exports;const f1="%[a-f0-9]{2}",P0=new RegExp("("+f1+")|([^%]+?)","gi"),E0=new RegExp("("+f1+")+","gi");function Np(e,t){try{return[decodeURIComponent(e.join(""))]}catch{}if(e.length===1)return e;t=t||1;const n=e.slice(0,t),r=e.slice(t);return Array.prototype.concat.call([],Np(n),Np(r))}function Z2(e){try{return decodeURIComponent(e)}catch{let t=e.match(P0)||[];for(let n=1;n<t.length;n++)e=Np(t,n).join(""),t=e.match(P0)||[];return e}}function J2(e){const t={"%FE%FF":"��","%FF%FE":"��"};let n=E0.exec(e);for(;n;){try{t[n[0]]=decodeURIComponent(n[0])}catch{const i=Z2(n[0]);i!==n[0]&&(t[n[0]]=i)}n=E0.exec(e)}t["%C2"]="�";const r=Object.keys(t);for(const i of r)e=e.replace(new RegExp(i,"g"),t[i]);return e}function eb(e){if(typeof e!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return decodeURIComponent(e)}catch{return J2(e)}}function tb(e,t){const n={};if(Array.isArray(t))for(const r of t){const i=Object.getOwnPropertyDescriptor(e,r);i!=null&&i.enumerable&&Object.defineProperty(n,r,i)}else for(const r of Reflect.ownKeys(e)){const i=Object.getOwnPropertyDescriptor(e,r);if(i.enumerable){const s=e[r];t(r,s,e)&&Object.defineProperty(n,r,i)}}return n}function h1(e,t){if(!(typeof e=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e===""||t==="")return[];const n=e.indexOf(t);return n===-1?[]:[e.slice(0,n),e.slice(n+t.length)]}const nb=e=>e==null,rb=e=>encodeURIComponent(e).replaceAll(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),Fp=Symbol("encodeFragmentIdentifier");function ib(e){switch(e.arrayFormat){case"index":return t=>(n,r)=>{const i=n.length;return r===void 0||e.skipNull&&r===null||e.skipEmptyString&&r===""?n:r===null?[...n,[Et(t,e),"[",i,"]"].join("")]:[...n,[Et(t,e),"[",Et(i,e),"]=",Et(r,e)].join("")]};case"bracket":return t=>(n,r)=>r===void 0||e.skipNull&&r===null||e.skipEmptyString&&r===""?n:r===null?[...n,[Et(t,e),"[]"].join("")]:[...n,[Et(t,e),"[]=",Et(r,e)].join("")];case"colon-list-separator":return t=>(n,r)=>r===void 0||e.skipNull&&r===null||e.skipEmptyString&&r===""?n:r===null?[...n,[Et(t,e),":list="].join("")]:[...n,[Et(t,e),":list=",Et(r,e)].join("")];case"comma":case"separator":case"bracket-separator":{const t=e.arrayFormat==="bracket-separator"?"[]=":"=";return n=>(r,i)=>i===void 0||e.skipNull&&i===null||e.skipEmptyString&&i===""?r:(i=i===null?"":i,r.length===0?[[Et(n,e),t,Et(i,e)].join("")]:[[r,Et(i,e)].join(e.arrayFormatSeparator)])}default:return t=>(n,r)=>r===void 0||e.skipNull&&r===null||e.skipEmptyString&&r===""?n:r===null?[...n,Et(t,e)]:[...n,[Et(t,e),"=",Et(r,e)].join("")]}}function sb(e){let t;switch(e.arrayFormat){case"index":return(n,r,i)=>{if(t=/\[(\d*)]$/.exec(n),n=n.replace(/\[\d*]$/,""),!t){i[n]=r;return}i[n]===void 0&&(i[n]={}),i[n][t[1]]=r};case"bracket":return(n,r,i)=>{if(t=/(\[])$/.exec(n),n=n.replace(/\[]$/,""),!t){i[n]=r;return}if(i[n]===void 0){i[n]=[r];return}i[n]=[...i[n],r]};case"colon-list-separator":return(n,r,i)=>{if(t=/(:list)$/.exec(n),n=n.replace(/:list$/,""),!t){i[n]=r;return}if(i[n]===void 0){i[n]=[r];return}i[n]=[...i[n],r]};case"comma":case"separator":return(n,r,i)=>{const o=typeof r=="string"&&r.includes(e.arrayFormatSeparator)?r.split(e.arrayFormatSeparator).map(u=>Os(u,e)):r===null?r:Os(r,e);i[n]=o};case"bracket-separator":return(n,r,i)=>{const s=/(\[])$/.test(n);if(n=n.replace(/\[]$/,""),!s){i[n]=r&&Os(r,e);return}const o=r===null?[]:Os(r,e).split(e.arrayFormatSeparator);if(i[n]===void 0){i[n]=o;return}i[n]=[...i[n],...o]};default:return(n,r,i)=>{if(i[n]===void 0){i[n]=r;return}i[n]=[...[i[n]].flat(),r]}}}function p1(e){if(typeof e!="string"||e.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function Et(e,t){return t.encode?t.strict?rb(e):encodeURIComponent(e):e}function Os(e,t){return t.decode?eb(e):e}function g1(e){return Array.isArray(e)?e.sort():typeof e=="object"?g1(Object.keys(e)).sort((t,n)=>Number(t)-Number(n)).map(t=>e[t]):e}function m1(e){const t=e.indexOf("#");return t!==-1&&(e=e.slice(0,t)),e}function ob(e){let t="";const n=e.indexOf("#");return n!==-1&&(t=e.slice(n)),t}function C0(e,t,n){return n==="string"&&typeof e=="string"?e:typeof n=="function"&&typeof e=="string"?n(e):n==="boolean"&&e===null?!0:n==="boolean"&&e!==null&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")?e.toLowerCase()==="true":n==="boolean"&&e!==null&&(e.toLowerCase()==="1"||e.toLowerCase()==="0")?e.toLowerCase()==="1":n==="string[]"&&t.arrayFormat!=="none"&&typeof e=="string"?[e]:n==="number[]"&&t.arrayFormat!=="none"&&!Number.isNaN(Number(e))&&typeof e=="string"&&e.trim()!==""?[Number(e)]:n==="number"&&!Number.isNaN(Number(e))&&typeof e=="string"&&e.trim()!==""?Number(e):t.parseBooleans&&e!==null&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")?e.toLowerCase()==="true":t.parseNumbers&&!Number.isNaN(Number(e))&&typeof e=="string"&&e.trim()!==""?Number(e):e}function gm(e){e=m1(e);const t=e.indexOf("?");return t===-1?"":e.slice(t+1)}function mm(e,t){t={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...t},p1(t.arrayFormatSeparator);const n=sb(t),r=Object.create(null);if(typeof e!="string"||(e=e.trim().replace(/^[?#&]/,""),!e))return r;for(const i of e.split("&")){if(i==="")continue;const s=t.decode?i.replaceAll("+"," "):i;let[o,u]=h1(s,"=");o===void 0&&(o=s),u=u===void 0?null:["comma","separator","bracket-separator"].includes(t.arrayFormat)?u:Os(u,t),n(Os(o,t),u,r)}for(const[i,s]of Object.entries(r))if(typeof s=="object"&&s!==null&&t.types[i]!=="string")for(const[o,u]of Object.entries(s)){const d=t.types[i],h=typeof d=="function"?d:d?d.replace("[]",""):void 0;s[o]=C0(u,t,h)}else typeof s=="object"&&s!==null&&t.types[i]==="string"?r[i]=Object.values(s).join(t.arrayFormatSeparator):r[i]=C0(s,t,t.types[i]);return t.sort===!1?r:(t.sort===!0?Object.keys(r).sort():Object.keys(r).sort(t.sort)).reduce((i,s)=>{const o=r[s];return i[s]=o&&typeof o=="object"&&!Array.isArray(o)?g1(o):o,i},Object.create(null))}function y1(e,t){if(!e)return"";t={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...t},p1(t.arrayFormatSeparator);const n=o=>t.skipNull&&nb(e[o])||t.skipEmptyString&&e[o]==="",r=ib(t),i={};for(const[o,u]of Object.entries(e))n(o)||(i[o]=u);const s=Object.keys(i);return t.sort!==!1&&s.sort(t.sort),s.map(o=>{let u=e[o];if(t.replacer&&(u=t.replacer(o,u),u===void 0)||u===void 0)return"";if(u===null)return Et(o,t);if(Array.isArray(u)){if(u.length===0&&t.arrayFormat==="bracket-separator")return Et(o,t)+"[]";let d=u;return t.replacer&&(d=u.map((h,c)=>t.replacer(`${o}[${c}]`,h)).filter(h=>h!==void 0)),d.reduce(r(o),[]).join("&")}return Et(o,t)+"="+Et(u,t)}).filter(o=>o.length>0).join("&")}function v1(e,t){var i;t={decode:!0,...t};let[n,r]=h1(e,"#");return n===void 0&&(n=e),{url:((i=n==null?void 0:n.split("?"))==null?void 0:i[0])??"",query:mm(gm(e),t),...t&&t.parseFragmentIdentifier&&r?{fragmentIdentifier:Os(r,t)}:{}}}function x1(e,t){t={encode:!0,strict:!0,[Fp]:!0,...t};const n=m1(e.url).split("?")[0]||"",r=gm(e.url),i={...mm(r,{sort:!1,...t}),...e.query};let s=y1(i,t);s&&(s=`?${s}`);let o=ob(e.url);if(typeof e.fragmentIdentifier=="string"){const u=new URL(n);u.hash=e.fragmentIdentifier,o=t[Fp]?u.hash:`#${e.fragmentIdentifier}`}return`${n}${s}${o}`}function w1(e,t,n){n={parseFragmentIdentifier:!0,[Fp]:!1,...n};const{url:r,query:i,fragmentIdentifier:s}=v1(e,n);return x1({url:r,query:tb(i,t),fragmentIdentifier:s},n)}function lb(e,t,n){const r=Array.isArray(t)?i=>!t.includes(i):(i,s)=>!t(i,s);return w1(e,r,n)}const T0=Object.freeze(Object.defineProperty({__proto__:null,exclude:lb,extract:gm,parse:mm,parseUrl:v1,pick:w1,stringify:y1,stringifyUrl:x1},Symbol.toStringTag,{value:"Module"}));var Qc={},S1={exports:{}},Dn={},k1={exports:{}},P1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(M,L){var W=M.length;M.push(L);e:for(;0<W;){var le=W-1>>>1,we=M[le];if(0<i(we,L))M[le]=L,M[W]=we,W=le;else break e}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var L=M[0],W=M.pop();if(W!==L){M[0]=W;e:for(var le=0,we=M.length,je=we>>>1;le<je;){var Re=2*(le+1)-1,be=M[Re],Ie=Re+1,Ke=M[Ie];if(0>i(be,W))Ie<we&&0>i(Ke,be)?(M[le]=Ke,M[Ie]=W,le=Ie):(M[le]=be,M[Re]=W,le=Re);else if(Ie<we&&0>i(Ke,W))M[le]=Ke,M[Ie]=W,le=Ie;else break e}}return L}function i(M,L){var W=M.sortIndex-L.sortIndex;return W!==0?W:M.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,u=o.now();e.unstable_now=function(){return o.now()-u}}var d=[],h=[],c=1,p=null,m=3,w=!1,y=!1,S=!1,C=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(M){for(var L=n(h);L!==null;){if(L.callback===null)r(h);else if(L.startTime<=M)r(h),L.sortIndex=L.expirationTime,t(d,L);else break;L=n(h)}}function _(M){if(S=!1,T(M),!y)if(n(d)!==null)y=!0,se(R);else{var L=n(h);L!==null&&ve(_,L.startTime-M)}}function R(M,L){y=!1,S&&(S=!1,x(z),z=-1),w=!0;var W=m;try{for(T(L),p=n(d);p!==null&&(!(p.expirationTime>L)||M&&!H());){var le=p.callback;if(typeof le=="function"){p.callback=null,m=p.priorityLevel;var we=le(p.expirationTime<=L);L=e.unstable_now(),typeof we=="function"?p.callback=we:p===n(d)&&r(d),T(L)}else r(d);p=n(d)}if(p!==null)var je=!0;else{var Re=n(h);Re!==null&&ve(_,Re.startTime-L),je=!1}return je}finally{p=null,m=W,w=!1}}var O=!1,F=null,z=-1,J=5,j=-1;function H(){return!(e.unstable_now()-j<J)}function V(){if(F!==null){var M=e.unstable_now();j=M;var L=!0;try{L=F(!0,M)}finally{L?ne():(O=!1,F=null)}}else O=!1}var ne;if(typeof k=="function")ne=function(){k(V)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,de=Y.port2;Y.port1.onmessage=V,ne=function(){de.postMessage(null)}}else ne=function(){C(V,0)};function se(M){F=M,O||(O=!0,ne())}function ve(M,L){z=C(function(){M(e.unstable_now())},L)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){y||w||(y=!0,se(R))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(M){switch(m){case 1:case 2:case 3:var L=3;break;default:L=m}var W=m;m=L;try{return M()}finally{m=W}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,L){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var W=m;m=M;try{return L()}finally{m=W}},e.unstable_scheduleCallback=function(M,L,W){var le=e.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?le+W:le):W=le,M){case 1:var we=-1;break;case 2:we=250;break;case 5:we=1073741823;break;case 4:we=1e4;break;default:we=5e3}return we=W+we,M={id:c++,callback:L,priorityLevel:M,startTime:W,expirationTime:we,sortIndex:-1},W>le?(M.sortIndex=W,t(h,M),n(d)===null&&M===n(h)&&(S?(x(z),z=-1):S=!0,ve(_,W-le))):(M.sortIndex=we,t(d,M),y||w||(y=!0,se(R))),M},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(M){var L=m;return function(){var W=m;m=L;try{return M.apply(this,arguments)}finally{m=W}}}})(P1);k1.exports=P1;var ab=k1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ub=b,$n=ab;function re(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var E1=new Set,pa={};function Xs(e,t){Wo(e,t),Wo(e+"Capture",t)}function Wo(e,t){for(pa[e]=t,e=0;e<t.length;e++)E1.add(t[e])}var ci=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),zp=Object.prototype.hasOwnProperty,cb=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,b0={},R0={};function db(e){return zp.call(R0,e)?!0:zp.call(b0,e)?!1:cb.test(e)?R0[e]=!0:(b0[e]=!0,!1)}function fb(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function hb(e,t,n,r){if(t===null||typeof t>"u"||fb(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function mn(e,t,n,r,i,s,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var Xt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Xt[e]=new mn(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Xt[t]=new mn(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Xt[e]=new mn(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Xt[e]=new mn(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Xt[e]=new mn(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Xt[e]=new mn(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Xt[e]=new mn(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Xt[e]=new mn(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Xt[e]=new mn(e,5,!1,e.toLowerCase(),null,!1,!1)});var ym=/[\-:]([a-z])/g;function vm(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(ym,vm);Xt[t]=new mn(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(ym,vm);Xt[t]=new mn(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(ym,vm);Xt[t]=new mn(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Xt[e]=new mn(e,1,!1,e.toLowerCase(),null,!1,!1)});Xt.xlinkHref=new mn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Xt[e]=new mn(e,1,!1,e.toLowerCase(),null,!0,!0)});function xm(e,t,n,r){var i=Xt.hasOwnProperty(t)?Xt[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(hb(t,n,i,r)&&(n=null),r||i===null?db(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var mi=ub.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vu=Symbol.for("react.element"),ko=Symbol.for("react.portal"),Po=Symbol.for("react.fragment"),wm=Symbol.for("react.strict_mode"),$p=Symbol.for("react.profiler"),C1=Symbol.for("react.provider"),T1=Symbol.for("react.context"),Sm=Symbol.for("react.forward_ref"),Dp=Symbol.for("react.suspense"),Bp=Symbol.for("react.suspense_list"),km=Symbol.for("react.memo"),Mi=Symbol.for("react.lazy"),b1=Symbol.for("react.offscreen"),I0=Symbol.iterator;function bl(e){return e===null||typeof e!="object"?null:(e=I0&&e[I0]||e["@@iterator"],typeof e=="function"?e:null)}var pt=Object.assign,Dh;function Ul(e){if(Dh===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Dh=t&&t[1]||""}return`
`+Dh+e}var Bh=!1;function Uh(e,t){if(!e||Bh)return"";Bh=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(h){var r=h}Reflect.construct(e,[],t)}else{try{t.call()}catch(h){r=h}e.call(t.prototype)}else{try{throw Error()}catch(h){r=h}e()}}catch(h){if(h&&r&&typeof h.stack=="string"){for(var i=h.stack.split(`
`),s=r.stack.split(`
`),o=i.length-1,u=s.length-1;1<=o&&0<=u&&i[o]!==s[u];)u--;for(;1<=o&&0<=u;o--,u--)if(i[o]!==s[u]){if(o!==1||u!==1)do if(o--,u--,0>u||i[o]!==s[u]){var d=`
`+i[o].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),d}while(1<=o&&0<=u);break}}}finally{Bh=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Ul(e):""}function pb(e){switch(e.tag){case 5:return Ul(e.type);case 16:return Ul("Lazy");case 13:return Ul("Suspense");case 19:return Ul("SuspenseList");case 0:case 2:case 15:return e=Uh(e.type,!1),e;case 11:return e=Uh(e.type.render,!1),e;case 1:return e=Uh(e.type,!0),e;default:return""}}function Up(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Po:return"Fragment";case ko:return"Portal";case $p:return"Profiler";case wm:return"StrictMode";case Dp:return"Suspense";case Bp:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case T1:return(e.displayName||"Context")+".Consumer";case C1:return(e._context.displayName||"Context")+".Provider";case Sm:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case km:return t=e.displayName||null,t!==null?t:Up(e.type)||"Memo";case Mi:t=e._payload,e=e._init;try{return Up(e(t))}catch{}}return null}function gb(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Up(t);case 8:return t===wm?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function es(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function R1(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function mb(e){var t=R1(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(o){r=""+o,s.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function qu(e){e._valueTracker||(e._valueTracker=mb(e))}function I1(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=R1(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Yc(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Wp(e,t){var n=t.checked;return pt({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function _0(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=es(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function _1(e,t){t=t.checked,t!=null&&xm(e,"checked",t,!1)}function Hp(e,t){_1(e,t);var n=es(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Vp(e,t.type,n):t.hasOwnProperty("defaultValue")&&Vp(e,t.type,es(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function A0(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Vp(e,t,n){(t!=="number"||Yc(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Wl=Array.isArray;function Mo(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+es(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function qp(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(re(91));return pt({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function O0(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(re(92));if(Wl(n)){if(1<n.length)throw Error(re(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:es(n)}}function A1(e,t){var n=es(t.value),r=es(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function j0(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function O1(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Qp(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?O1(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Qu,j1=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Qu=Qu||document.createElement("div"),Qu.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Qu.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function ga(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Xl={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},yb=["Webkit","ms","Moz","O"];Object.keys(Xl).forEach(function(e){yb.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Xl[t]=Xl[e]})});function M1(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Xl.hasOwnProperty(e)&&Xl[e]?(""+t).trim():t+"px"}function L1(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=M1(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var vb=pt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Yp(e,t){if(t){if(vb[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(re(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(re(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(re(61))}if(t.style!=null&&typeof t.style!="object")throw Error(re(62))}}function Xp(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Kp=null;function Pm(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Gp=null,Lo=null,No=null;function M0(e){if(e=Ba(e)){if(typeof Gp!="function")throw Error(re(280));var t=e.stateNode;t&&(t=zd(t),Gp(e.stateNode,e.type,t))}}function N1(e){Lo?No?No.push(e):No=[e]:Lo=e}function F1(){if(Lo){var e=Lo,t=No;if(No=Lo=null,M0(e),t)for(e=0;e<t.length;e++)M0(t[e])}}function z1(e,t){return e(t)}function $1(){}var Wh=!1;function D1(e,t,n){if(Wh)return e(t,n);Wh=!0;try{return z1(e,t,n)}finally{Wh=!1,(Lo!==null||No!==null)&&($1(),F1())}}function ma(e,t){var n=e.stateNode;if(n===null)return null;var r=zd(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(re(231,t,typeof n));return n}var Zp=!1;if(ci)try{var Rl={};Object.defineProperty(Rl,"passive",{get:function(){Zp=!0}}),window.addEventListener("test",Rl,Rl),window.removeEventListener("test",Rl,Rl)}catch{Zp=!1}function xb(e,t,n,r,i,s,o,u,d){var h=Array.prototype.slice.call(arguments,3);try{t.apply(n,h)}catch(c){this.onError(c)}}var Kl=!1,Xc=null,Kc=!1,Jp=null,wb={onError:function(e){Kl=!0,Xc=e}};function Sb(e,t,n,r,i,s,o,u,d){Kl=!1,Xc=null,xb.apply(wb,arguments)}function kb(e,t,n,r,i,s,o,u,d){if(Sb.apply(this,arguments),Kl){if(Kl){var h=Xc;Kl=!1,Xc=null}else throw Error(re(198));Kc||(Kc=!0,Jp=h)}}function Ks(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function B1(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function L0(e){if(Ks(e)!==e)throw Error(re(188))}function Pb(e){var t=e.alternate;if(!t){if(t=Ks(e),t===null)throw Error(re(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return L0(i),e;if(s===r)return L0(i),t;s=s.sibling}throw Error(re(188))}if(n.return!==r.return)n=i,r=s;else{for(var o=!1,u=i.child;u;){if(u===n){o=!0,n=i,r=s;break}if(u===r){o=!0,r=i,n=s;break}u=u.sibling}if(!o){for(u=s.child;u;){if(u===n){o=!0,n=s,r=i;break}if(u===r){o=!0,r=s,n=i;break}u=u.sibling}if(!o)throw Error(re(189))}}if(n.alternate!==r)throw Error(re(190))}if(n.tag!==3)throw Error(re(188));return n.stateNode.current===n?e:t}function U1(e){return e=Pb(e),e!==null?W1(e):null}function W1(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=W1(e);if(t!==null)return t;e=e.sibling}return null}var H1=$n.unstable_scheduleCallback,N0=$n.unstable_cancelCallback,Eb=$n.unstable_shouldYield,Cb=$n.unstable_requestPaint,St=$n.unstable_now,Tb=$n.unstable_getCurrentPriorityLevel,Em=$n.unstable_ImmediatePriority,V1=$n.unstable_UserBlockingPriority,Gc=$n.unstable_NormalPriority,bb=$n.unstable_LowPriority,q1=$n.unstable_IdlePriority,Md=null,Nr=null;function Rb(e){if(Nr&&typeof Nr.onCommitFiberRoot=="function")try{Nr.onCommitFiberRoot(Md,e,void 0,(e.current.flags&128)===128)}catch{}}var wr=Math.clz32?Math.clz32:Ab,Ib=Math.log,_b=Math.LN2;function Ab(e){return e>>>=0,e===0?32:31-(Ib(e)/_b|0)|0}var Yu=64,Xu=4194304;function Hl(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Zc(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=n&268435455;if(o!==0){var u=o&~i;u!==0?r=Hl(u):(s&=o,s!==0&&(r=Hl(s)))}else o=n&~i,o!==0?r=Hl(o):s!==0&&(r=Hl(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-wr(t),i=1<<n,r|=e[n],t&=~i;return r}function Ob(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jb(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-wr(s),u=1<<o,d=i[o];d===-1?(!(u&n)||u&r)&&(i[o]=Ob(u,t)):d<=t&&(e.expiredLanes|=u),s&=~u}}function eg(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function Q1(){var e=Yu;return Yu<<=1,!(Yu&4194240)&&(Yu=64),e}function Hh(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function $a(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-wr(t),e[t]=n}function Mb(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-wr(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}function Cm(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-wr(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var qe=0;function Y1(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var X1,Tm,K1,G1,Z1,tg=!1,Ku=[],Wi=null,Hi=null,Vi=null,ya=new Map,va=new Map,zi=[],Lb="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function F0(e,t){switch(e){case"focusin":case"focusout":Wi=null;break;case"dragenter":case"dragleave":Hi=null;break;case"mouseover":case"mouseout":Vi=null;break;case"pointerover":case"pointerout":ya.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":va.delete(t.pointerId)}}function Il(e,t,n,r,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},t!==null&&(t=Ba(t),t!==null&&Tm(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function Nb(e,t,n,r,i){switch(t){case"focusin":return Wi=Il(Wi,e,t,n,r,i),!0;case"dragenter":return Hi=Il(Hi,e,t,n,r,i),!0;case"mouseover":return Vi=Il(Vi,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return ya.set(s,Il(ya.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,va.set(s,Il(va.get(s)||null,e,t,n,r,i)),!0}return!1}function J1(e){var t=js(e.target);if(t!==null){var n=Ks(t);if(n!==null){if(t=n.tag,t===13){if(t=B1(n),t!==null){e.blockedOn=t,Z1(e.priority,function(){K1(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Cc(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=ng(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Kp=r,n.target.dispatchEvent(r),Kp=null}else return t=Ba(n),t!==null&&Tm(t),e.blockedOn=n,!1;t.shift()}return!0}function z0(e,t,n){Cc(e)&&n.delete(t)}function Fb(){tg=!1,Wi!==null&&Cc(Wi)&&(Wi=null),Hi!==null&&Cc(Hi)&&(Hi=null),Vi!==null&&Cc(Vi)&&(Vi=null),ya.forEach(z0),va.forEach(z0)}function _l(e,t){e.blockedOn===t&&(e.blockedOn=null,tg||(tg=!0,$n.unstable_scheduleCallback($n.unstable_NormalPriority,Fb)))}function xa(e){function t(i){return _l(i,e)}if(0<Ku.length){_l(Ku[0],e);for(var n=1;n<Ku.length;n++){var r=Ku[n];r.blockedOn===e&&(r.blockedOn=null)}}for(Wi!==null&&_l(Wi,e),Hi!==null&&_l(Hi,e),Vi!==null&&_l(Vi,e),ya.forEach(t),va.forEach(t),n=0;n<zi.length;n++)r=zi[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<zi.length&&(n=zi[0],n.blockedOn===null);)J1(n),n.blockedOn===null&&zi.shift()}var Fo=mi.ReactCurrentBatchConfig,Jc=!0;function zb(e,t,n,r){var i=qe,s=Fo.transition;Fo.transition=null;try{qe=1,bm(e,t,n,r)}finally{qe=i,Fo.transition=s}}function $b(e,t,n,r){var i=qe,s=Fo.transition;Fo.transition=null;try{qe=4,bm(e,t,n,r)}finally{qe=i,Fo.transition=s}}function bm(e,t,n,r){if(Jc){var i=ng(e,t,n,r);if(i===null)ep(e,t,r,ed,n),F0(e,r);else if(Nb(i,e,t,n,r))r.stopPropagation();else if(F0(e,r),t&4&&-1<Lb.indexOf(e)){for(;i!==null;){var s=Ba(i);if(s!==null&&X1(s),s=ng(e,t,n,r),s===null&&ep(e,t,r,ed,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else ep(e,t,r,null,n)}}var ed=null;function ng(e,t,n,r){if(ed=null,e=Pm(r),e=js(e),e!==null)if(t=Ks(e),t===null)e=null;else if(n=t.tag,n===13){if(e=B1(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return ed=e,null}function eS(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Tb()){case Em:return 1;case V1:return 4;case Gc:case bb:return 16;case q1:return 536870912;default:return 16}default:return 16}}var Di=null,Rm=null,Tc=null;function tS(){if(Tc)return Tc;var e,t=Rm,n=t.length,r,i="value"in Di?Di.value:Di.textContent,s=i.length;for(e=0;e<n&&t[e]===i[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===i[s-r];r++);return Tc=i.slice(e,1<r?1-r:void 0)}function bc(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Gu(){return!0}function $0(){return!1}function Bn(e){function t(n,r,i,s,o){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=o,this.currentTarget=null;for(var u in e)e.hasOwnProperty(u)&&(n=e[u],this[u]=n?n(s):s[u]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Gu:$0,this.isPropagationStopped=$0,this}return pt(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Gu)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Gu)},persist:function(){},isPersistent:Gu}),t}var tl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Im=Bn(tl),Da=pt({},tl,{view:0,detail:0}),Db=Bn(Da),Vh,qh,Al,Ld=pt({},Da,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_m,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Al&&(Al&&e.type==="mousemove"?(Vh=e.screenX-Al.screenX,qh=e.screenY-Al.screenY):qh=Vh=0,Al=e),Vh)},movementY:function(e){return"movementY"in e?e.movementY:qh}}),D0=Bn(Ld),Bb=pt({},Ld,{dataTransfer:0}),Ub=Bn(Bb),Wb=pt({},Da,{relatedTarget:0}),Qh=Bn(Wb),Hb=pt({},tl,{animationName:0,elapsedTime:0,pseudoElement:0}),Vb=Bn(Hb),qb=pt({},tl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Qb=Bn(qb),Yb=pt({},tl,{data:0}),B0=Bn(Yb),Xb={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Kb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Gb={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Zb(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=Gb[e])?!!t[e]:!1}function _m(){return Zb}var Jb=pt({},Da,{key:function(e){if(e.key){var t=Xb[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=bc(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?Kb[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_m,charCode:function(e){return e.type==="keypress"?bc(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?bc(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),eR=Bn(Jb),tR=pt({},Ld,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),U0=Bn(tR),nR=pt({},Da,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_m}),rR=Bn(nR),iR=pt({},tl,{propertyName:0,elapsedTime:0,pseudoElement:0}),sR=Bn(iR),oR=pt({},Ld,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),lR=Bn(oR),aR=[9,13,27,32],Am=ci&&"CompositionEvent"in window,Gl=null;ci&&"documentMode"in document&&(Gl=document.documentMode);var uR=ci&&"TextEvent"in window&&!Gl,nS=ci&&(!Am||Gl&&8<Gl&&11>=Gl),W0=" ",H0=!1;function rS(e,t){switch(e){case"keyup":return aR.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function iS(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Eo=!1;function cR(e,t){switch(e){case"compositionend":return iS(t);case"keypress":return t.which!==32?null:(H0=!0,W0);case"textInput":return e=t.data,e===W0&&H0?null:e;default:return null}}function dR(e,t){if(Eo)return e==="compositionend"||!Am&&rS(e,t)?(e=tS(),Tc=Rm=Di=null,Eo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return nS&&t.locale!=="ko"?null:t.data;default:return null}}var fR={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function V0(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!fR[e.type]:t==="textarea"}function sS(e,t,n,r){N1(r),t=td(t,"onChange"),0<t.length&&(n=new Im("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Zl=null,wa=null;function hR(e){mS(e,0)}function Nd(e){var t=bo(e);if(I1(t))return e}function pR(e,t){if(e==="change")return t}var oS=!1;if(ci){var Yh;if(ci){var Xh="oninput"in document;if(!Xh){var q0=document.createElement("div");q0.setAttribute("oninput","return;"),Xh=typeof q0.oninput=="function"}Yh=Xh}else Yh=!1;oS=Yh&&(!document.documentMode||9<document.documentMode)}function Q0(){Zl&&(Zl.detachEvent("onpropertychange",lS),wa=Zl=null)}function lS(e){if(e.propertyName==="value"&&Nd(wa)){var t=[];sS(t,wa,e,Pm(e)),D1(hR,t)}}function gR(e,t,n){e==="focusin"?(Q0(),Zl=t,wa=n,Zl.attachEvent("onpropertychange",lS)):e==="focusout"&&Q0()}function mR(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Nd(wa)}function yR(e,t){if(e==="click")return Nd(t)}function vR(e,t){if(e==="input"||e==="change")return Nd(t)}function xR(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var kr=typeof Object.is=="function"?Object.is:xR;function Sa(e,t){if(kr(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!zp.call(t,i)||!kr(e[i],t[i]))return!1}return!0}function Y0(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function X0(e,t){var n=Y0(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Y0(n)}}function aS(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?aS(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function uS(){for(var e=window,t=Yc();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Yc(e.document)}return t}function Om(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function wR(e){var t=uS(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&aS(n.ownerDocument.documentElement,n)){if(r!==null&&Om(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=X0(n,s);var o=X0(n,r);i&&o&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var SR=ci&&"documentMode"in document&&11>=document.documentMode,Co=null,rg=null,Jl=null,ig=!1;function K0(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ig||Co==null||Co!==Yc(r)||(r=Co,"selectionStart"in r&&Om(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Jl&&Sa(Jl,r)||(Jl=r,r=td(rg,"onSelect"),0<r.length&&(t=new Im("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Co)))}function Zu(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var To={animationend:Zu("Animation","AnimationEnd"),animationiteration:Zu("Animation","AnimationIteration"),animationstart:Zu("Animation","AnimationStart"),transitionend:Zu("Transition","TransitionEnd")},Kh={},cS={};ci&&(cS=document.createElement("div").style,"AnimationEvent"in window||(delete To.animationend.animation,delete To.animationiteration.animation,delete To.animationstart.animation),"TransitionEvent"in window||delete To.transitionend.transition);function Fd(e){if(Kh[e])return Kh[e];if(!To[e])return e;var t=To[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in cS)return Kh[e]=t[n];return e}var dS=Fd("animationend"),fS=Fd("animationiteration"),hS=Fd("animationstart"),pS=Fd("transitionend"),gS=new Map,G0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ss(e,t){gS.set(e,t),Xs(t,[e])}for(var Gh=0;Gh<G0.length;Gh++){var Zh=G0[Gh],kR=Zh.toLowerCase(),PR=Zh[0].toUpperCase()+Zh.slice(1);ss(kR,"on"+PR)}ss(dS,"onAnimationEnd");ss(fS,"onAnimationIteration");ss(hS,"onAnimationStart");ss("dblclick","onDoubleClick");ss("focusin","onFocus");ss("focusout","onBlur");ss(pS,"onTransitionEnd");Wo("onMouseEnter",["mouseout","mouseover"]);Wo("onMouseLeave",["mouseout","mouseover"]);Wo("onPointerEnter",["pointerout","pointerover"]);Wo("onPointerLeave",["pointerout","pointerover"]);Xs("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Xs("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Xs("onBeforeInput",["compositionend","keypress","textInput","paste"]);Xs("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Xs("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Xs("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ER=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vl));function Z0(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,kb(r,t,void 0,e),e.currentTarget=null}function mS(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var u=r[o],d=u.instance,h=u.currentTarget;if(u=u.listener,d!==s&&i.isPropagationStopped())break e;Z0(i,u,h),s=d}else for(o=0;o<r.length;o++){if(u=r[o],d=u.instance,h=u.currentTarget,u=u.listener,d!==s&&i.isPropagationStopped())break e;Z0(i,u,h),s=d}}}if(Kc)throw e=Jp,Kc=!1,Jp=null,e}function nt(e,t){var n=t[ug];n===void 0&&(n=t[ug]=new Set);var r=e+"__bubble";n.has(r)||(yS(t,e,2,!1),n.add(r))}function Jh(e,t,n){var r=0;t&&(r|=4),yS(n,e,r,t)}var Ju="_reactListening"+Math.random().toString(36).slice(2);function ka(e){if(!e[Ju]){e[Ju]=!0,E1.forEach(function(n){n!=="selectionchange"&&(ER.has(n)||Jh(n,!1,e),Jh(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Ju]||(t[Ju]=!0,Jh("selectionchange",!1,t))}}function yS(e,t,n,r){switch(eS(t)){case 1:var i=zb;break;case 4:i=$b;break;default:i=bm}n=i.bind(null,t,n,e),i=void 0,!Zp||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function ep(e,t,n,r,i){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var u=r.stateNode.containerInfo;if(u===i||u.nodeType===8&&u.parentNode===i)break;if(o===4)for(o=r.return;o!==null;){var d=o.tag;if((d===3||d===4)&&(d=o.stateNode.containerInfo,d===i||d.nodeType===8&&d.parentNode===i))return;o=o.return}for(;u!==null;){if(o=js(u),o===null)return;if(d=o.tag,d===5||d===6){r=s=o;continue e}u=u.parentNode}}r=r.return}D1(function(){var h=s,c=Pm(n),p=[];e:{var m=gS.get(e);if(m!==void 0){var w=Im,y=e;switch(e){case"keypress":if(bc(n)===0)break e;case"keydown":case"keyup":w=eR;break;case"focusin":y="focus",w=Qh;break;case"focusout":y="blur",w=Qh;break;case"beforeblur":case"afterblur":w=Qh;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":w=D0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":w=Ub;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":w=rR;break;case dS:case fS:case hS:w=Vb;break;case pS:w=sR;break;case"scroll":w=Db;break;case"wheel":w=lR;break;case"copy":case"cut":case"paste":w=Qb;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":w=U0}var S=(t&4)!==0,C=!S&&e==="scroll",x=S?m!==null?m+"Capture":null:m;S=[];for(var k=h,T;k!==null;){T=k;var _=T.stateNode;if(T.tag===5&&_!==null&&(T=_,x!==null&&(_=ma(k,x),_!=null&&S.push(Pa(k,_,T)))),C)break;k=k.return}0<S.length&&(m=new w(m,y,null,n,c),p.push({event:m,listeners:S}))}}if(!(t&7)){e:{if(m=e==="mouseover"||e==="pointerover",w=e==="mouseout"||e==="pointerout",m&&n!==Kp&&(y=n.relatedTarget||n.fromElement)&&(js(y)||y[di]))break e;if((w||m)&&(m=c.window===c?c:(m=c.ownerDocument)?m.defaultView||m.parentWindow:window,w?(y=n.relatedTarget||n.toElement,w=h,y=y?js(y):null,y!==null&&(C=Ks(y),y!==C||y.tag!==5&&y.tag!==6)&&(y=null)):(w=null,y=h),w!==y)){if(S=D0,_="onMouseLeave",x="onMouseEnter",k="mouse",(e==="pointerout"||e==="pointerover")&&(S=U0,_="onPointerLeave",x="onPointerEnter",k="pointer"),C=w==null?m:bo(w),T=y==null?m:bo(y),m=new S(_,k+"leave",w,n,c),m.target=C,m.relatedTarget=T,_=null,js(c)===h&&(S=new S(x,k+"enter",y,n,c),S.target=T,S.relatedTarget=C,_=S),C=_,w&&y)t:{for(S=w,x=y,k=0,T=S;T;T=go(T))k++;for(T=0,_=x;_;_=go(_))T++;for(;0<k-T;)S=go(S),k--;for(;0<T-k;)x=go(x),T--;for(;k--;){if(S===x||x!==null&&S===x.alternate)break t;S=go(S),x=go(x)}S=null}else S=null;w!==null&&J0(p,m,w,S,!1),y!==null&&C!==null&&J0(p,C,y,S,!0)}}e:{if(m=h?bo(h):window,w=m.nodeName&&m.nodeName.toLowerCase(),w==="select"||w==="input"&&m.type==="file")var R=pR;else if(V0(m))if(oS)R=vR;else{R=mR;var O=gR}else(w=m.nodeName)&&w.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(R=yR);if(R&&(R=R(e,h))){sS(p,R,n,c);break e}O&&O(e,m,h),e==="focusout"&&(O=m._wrapperState)&&O.controlled&&m.type==="number"&&Vp(m,"number",m.value)}switch(O=h?bo(h):window,e){case"focusin":(V0(O)||O.contentEditable==="true")&&(Co=O,rg=h,Jl=null);break;case"focusout":Jl=rg=Co=null;break;case"mousedown":ig=!0;break;case"contextmenu":case"mouseup":case"dragend":ig=!1,K0(p,n,c);break;case"selectionchange":if(SR)break;case"keydown":case"keyup":K0(p,n,c)}var F;if(Am)e:{switch(e){case"compositionstart":var z="onCompositionStart";break e;case"compositionend":z="onCompositionEnd";break e;case"compositionupdate":z="onCompositionUpdate";break e}z=void 0}else Eo?rS(e,n)&&(z="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(z="onCompositionStart");z&&(nS&&n.locale!=="ko"&&(Eo||z!=="onCompositionStart"?z==="onCompositionEnd"&&Eo&&(F=tS()):(Di=c,Rm="value"in Di?Di.value:Di.textContent,Eo=!0)),O=td(h,z),0<O.length&&(z=new B0(z,e,null,n,c),p.push({event:z,listeners:O}),F?z.data=F:(F=iS(n),F!==null&&(z.data=F)))),(F=uR?cR(e,n):dR(e,n))&&(h=td(h,"onBeforeInput"),0<h.length&&(c=new B0("onBeforeInput","beforeinput",null,n,c),p.push({event:c,listeners:h}),c.data=F))}mS(p,t)})}function Pa(e,t,n){return{instance:e,listener:t,currentTarget:n}}function td(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=ma(e,n),s!=null&&r.unshift(Pa(e,s,i)),s=ma(e,t),s!=null&&r.push(Pa(e,s,i))),e=e.return}return r}function go(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function J0(e,t,n,r,i){for(var s=t._reactName,o=[];n!==null&&n!==r;){var u=n,d=u.alternate,h=u.stateNode;if(d!==null&&d===r)break;u.tag===5&&h!==null&&(u=h,i?(d=ma(n,s),d!=null&&o.unshift(Pa(n,d,u))):i||(d=ma(n,s),d!=null&&o.push(Pa(n,d,u)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var CR=/\r\n?/g,TR=/\u0000|\uFFFD/g;function ex(e){return(typeof e=="string"?e:""+e).replace(CR,`
`).replace(TR,"")}function ec(e,t,n){if(t=ex(t),ex(e)!==t&&n)throw Error(re(425))}function nd(){}var sg=null,og=null;function lg(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var ag=typeof setTimeout=="function"?setTimeout:void 0,bR=typeof clearTimeout=="function"?clearTimeout:void 0,tx=typeof Promise=="function"?Promise:void 0,RR=typeof queueMicrotask=="function"?queueMicrotask:typeof tx<"u"?function(e){return tx.resolve(null).then(e).catch(IR)}:ag;function IR(e){setTimeout(function(){throw e})}function tp(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),xa(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);xa(t)}function qi(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function nx(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var nl=Math.random().toString(36).slice(2),Lr="__reactFiber$"+nl,Ea="__reactProps$"+nl,di="__reactContainer$"+nl,ug="__reactEvents$"+nl,_R="__reactListeners$"+nl,AR="__reactHandles$"+nl;function js(e){var t=e[Lr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[di]||n[Lr]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=nx(e);e!==null;){if(n=e[Lr])return n;e=nx(e)}return t}e=n,n=e.parentNode}return null}function Ba(e){return e=e[Lr]||e[di],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function bo(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(re(33))}function zd(e){return e[Ea]||null}var cg=[],Ro=-1;function os(e){return{current:e}}function it(e){0>Ro||(e.current=cg[Ro],cg[Ro]=null,Ro--)}function Ze(e,t){Ro++,cg[Ro]=e.current,e.current=t}var ts={},on=os(ts),bn=os(!1),Bs=ts;function Ho(e,t){var n=e.type.contextTypes;if(!n)return ts;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function Rn(e){return e=e.childContextTypes,e!=null}function rd(){it(bn),it(on)}function rx(e,t,n){if(on.current!==ts)throw Error(re(168));Ze(on,t),Ze(bn,n)}function vS(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(re(108,gb(e)||"Unknown",i));return pt({},n,r)}function id(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ts,Bs=on.current,Ze(on,e),Ze(bn,bn.current),!0}function ix(e,t,n){var r=e.stateNode;if(!r)throw Error(re(169));n?(e=vS(e,t,Bs),r.__reactInternalMemoizedMergedChildContext=e,it(bn),it(on),Ze(on,e)):it(bn),Ze(bn,n)}var ti=null,$d=!1,np=!1;function xS(e){ti===null?ti=[e]:ti.push(e)}function OR(e){$d=!0,xS(e)}function ls(){if(!np&&ti!==null){np=!0;var e=0,t=qe;try{var n=ti;for(qe=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}ti=null,$d=!1}catch(i){throw ti!==null&&(ti=ti.slice(e+1)),H1(Em,ls),i}finally{qe=t,np=!1}}return null}var Io=[],_o=0,sd=null,od=0,Gn=[],Zn=0,Us=null,ni=1,ri="";function Es(e,t){Io[_o++]=od,Io[_o++]=sd,sd=e,od=t}function wS(e,t,n){Gn[Zn++]=ni,Gn[Zn++]=ri,Gn[Zn++]=Us,Us=e;var r=ni;e=ri;var i=32-wr(r)-1;r&=~(1<<i),n+=1;var s=32-wr(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,ni=1<<32-wr(t)+i|n<<i|r,ri=s+e}else ni=1<<s|n<<i|r,ri=e}function jm(e){e.return!==null&&(Es(e,1),wS(e,1,0))}function Mm(e){for(;e===sd;)sd=Io[--_o],Io[_o]=null,od=Io[--_o],Io[_o]=null;for(;e===Us;)Us=Gn[--Zn],Gn[Zn]=null,ri=Gn[--Zn],Gn[Zn]=null,ni=Gn[--Zn],Gn[Zn]=null}var Fn=null,Nn=null,lt=!1,vr=null;function SS(e,t){var n=er(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function sx(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Fn=e,Nn=qi(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Fn=e,Nn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Us!==null?{id:ni,overflow:ri}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=er(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Fn=e,Nn=null,!0):!1;default:return!1}}function dg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function fg(e){if(lt){var t=Nn;if(t){var n=t;if(!sx(e,t)){if(dg(e))throw Error(re(418));t=qi(n.nextSibling);var r=Fn;t&&sx(e,t)?SS(r,n):(e.flags=e.flags&-4097|2,lt=!1,Fn=e)}}else{if(dg(e))throw Error(re(418));e.flags=e.flags&-4097|2,lt=!1,Fn=e}}}function ox(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Fn=e}function tc(e){if(e!==Fn)return!1;if(!lt)return ox(e),lt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!lg(e.type,e.memoizedProps)),t&&(t=Nn)){if(dg(e))throw kS(),Error(re(418));for(;t;)SS(e,t),t=qi(t.nextSibling)}if(ox(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(re(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Nn=qi(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Nn=null}}else Nn=Fn?qi(e.stateNode.nextSibling):null;return!0}function kS(){for(var e=Nn;e;)e=qi(e.nextSibling)}function Vo(){Nn=Fn=null,lt=!1}function Lm(e){vr===null?vr=[e]:vr.push(e)}var jR=mi.ReactCurrentBatchConfig;function Ol(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(re(309));var r=n.stateNode}if(!r)throw Error(re(147,e));var i=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(o){var u=i.refs;o===null?delete u[s]:u[s]=o},t._stringRef=s,t)}if(typeof e!="string")throw Error(re(284));if(!n._owner)throw Error(re(290,e))}return e}function nc(e,t){throw e=Object.prototype.toString.call(t),Error(re(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function lx(e){var t=e._init;return t(e._payload)}function PS(e){function t(x,k){if(e){var T=x.deletions;T===null?(x.deletions=[k],x.flags|=16):T.push(k)}}function n(x,k){if(!e)return null;for(;k!==null;)t(x,k),k=k.sibling;return null}function r(x,k){for(x=new Map;k!==null;)k.key!==null?x.set(k.key,k):x.set(k.index,k),k=k.sibling;return x}function i(x,k){return x=Ki(x,k),x.index=0,x.sibling=null,x}function s(x,k,T){return x.index=T,e?(T=x.alternate,T!==null?(T=T.index,T<k?(x.flags|=2,k):T):(x.flags|=2,k)):(x.flags|=1048576,k)}function o(x){return e&&x.alternate===null&&(x.flags|=2),x}function u(x,k,T,_){return k===null||k.tag!==6?(k=up(T,x.mode,_),k.return=x,k):(k=i(k,T),k.return=x,k)}function d(x,k,T,_){var R=T.type;return R===Po?c(x,k,T.props.children,_,T.key):k!==null&&(k.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===Mi&&lx(R)===k.type)?(_=i(k,T.props),_.ref=Ol(x,k,T),_.return=x,_):(_=Mc(T.type,T.key,T.props,null,x.mode,_),_.ref=Ol(x,k,T),_.return=x,_)}function h(x,k,T,_){return k===null||k.tag!==4||k.stateNode.containerInfo!==T.containerInfo||k.stateNode.implementation!==T.implementation?(k=cp(T,x.mode,_),k.return=x,k):(k=i(k,T.children||[]),k.return=x,k)}function c(x,k,T,_,R){return k===null||k.tag!==7?(k=zs(T,x.mode,_,R),k.return=x,k):(k=i(k,T),k.return=x,k)}function p(x,k,T){if(typeof k=="string"&&k!==""||typeof k=="number")return k=up(""+k,x.mode,T),k.return=x,k;if(typeof k=="object"&&k!==null){switch(k.$$typeof){case Vu:return T=Mc(k.type,k.key,k.props,null,x.mode,T),T.ref=Ol(x,null,k),T.return=x,T;case ko:return k=cp(k,x.mode,T),k.return=x,k;case Mi:var _=k._init;return p(x,_(k._payload),T)}if(Wl(k)||bl(k))return k=zs(k,x.mode,T,null),k.return=x,k;nc(x,k)}return null}function m(x,k,T,_){var R=k!==null?k.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return R!==null?null:u(x,k,""+T,_);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case Vu:return T.key===R?d(x,k,T,_):null;case ko:return T.key===R?h(x,k,T,_):null;case Mi:return R=T._init,m(x,k,R(T._payload),_)}if(Wl(T)||bl(T))return R!==null?null:c(x,k,T,_,null);nc(x,T)}return null}function w(x,k,T,_,R){if(typeof _=="string"&&_!==""||typeof _=="number")return x=x.get(T)||null,u(k,x,""+_,R);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Vu:return x=x.get(_.key===null?T:_.key)||null,d(k,x,_,R);case ko:return x=x.get(_.key===null?T:_.key)||null,h(k,x,_,R);case Mi:var O=_._init;return w(x,k,T,O(_._payload),R)}if(Wl(_)||bl(_))return x=x.get(T)||null,c(k,x,_,R,null);nc(k,_)}return null}function y(x,k,T,_){for(var R=null,O=null,F=k,z=k=0,J=null;F!==null&&z<T.length;z++){F.index>z?(J=F,F=null):J=F.sibling;var j=m(x,F,T[z],_);if(j===null){F===null&&(F=J);break}e&&F&&j.alternate===null&&t(x,F),k=s(j,k,z),O===null?R=j:O.sibling=j,O=j,F=J}if(z===T.length)return n(x,F),lt&&Es(x,z),R;if(F===null){for(;z<T.length;z++)F=p(x,T[z],_),F!==null&&(k=s(F,k,z),O===null?R=F:O.sibling=F,O=F);return lt&&Es(x,z),R}for(F=r(x,F);z<T.length;z++)J=w(F,x,z,T[z],_),J!==null&&(e&&J.alternate!==null&&F.delete(J.key===null?z:J.key),k=s(J,k,z),O===null?R=J:O.sibling=J,O=J);return e&&F.forEach(function(H){return t(x,H)}),lt&&Es(x,z),R}function S(x,k,T,_){var R=bl(T);if(typeof R!="function")throw Error(re(150));if(T=R.call(T),T==null)throw Error(re(151));for(var O=R=null,F=k,z=k=0,J=null,j=T.next();F!==null&&!j.done;z++,j=T.next()){F.index>z?(J=F,F=null):J=F.sibling;var H=m(x,F,j.value,_);if(H===null){F===null&&(F=J);break}e&&F&&H.alternate===null&&t(x,F),k=s(H,k,z),O===null?R=H:O.sibling=H,O=H,F=J}if(j.done)return n(x,F),lt&&Es(x,z),R;if(F===null){for(;!j.done;z++,j=T.next())j=p(x,j.value,_),j!==null&&(k=s(j,k,z),O===null?R=j:O.sibling=j,O=j);return lt&&Es(x,z),R}for(F=r(x,F);!j.done;z++,j=T.next())j=w(F,x,z,j.value,_),j!==null&&(e&&j.alternate!==null&&F.delete(j.key===null?z:j.key),k=s(j,k,z),O===null?R=j:O.sibling=j,O=j);return e&&F.forEach(function(V){return t(x,V)}),lt&&Es(x,z),R}function C(x,k,T,_){if(typeof T=="object"&&T!==null&&T.type===Po&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case Vu:e:{for(var R=T.key,O=k;O!==null;){if(O.key===R){if(R=T.type,R===Po){if(O.tag===7){n(x,O.sibling),k=i(O,T.props.children),k.return=x,x=k;break e}}else if(O.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===Mi&&lx(R)===O.type){n(x,O.sibling),k=i(O,T.props),k.ref=Ol(x,O,T),k.return=x,x=k;break e}n(x,O);break}else t(x,O);O=O.sibling}T.type===Po?(k=zs(T.props.children,x.mode,_,T.key),k.return=x,x=k):(_=Mc(T.type,T.key,T.props,null,x.mode,_),_.ref=Ol(x,k,T),_.return=x,x=_)}return o(x);case ko:e:{for(O=T.key;k!==null;){if(k.key===O)if(k.tag===4&&k.stateNode.containerInfo===T.containerInfo&&k.stateNode.implementation===T.implementation){n(x,k.sibling),k=i(k,T.children||[]),k.return=x,x=k;break e}else{n(x,k);break}else t(x,k);k=k.sibling}k=cp(T,x.mode,_),k.return=x,x=k}return o(x);case Mi:return O=T._init,C(x,k,O(T._payload),_)}if(Wl(T))return y(x,k,T,_);if(bl(T))return S(x,k,T,_);nc(x,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,k!==null&&k.tag===6?(n(x,k.sibling),k=i(k,T),k.return=x,x=k):(n(x,k),k=up(T,x.mode,_),k.return=x,x=k),o(x)):n(x,k)}return C}var qo=PS(!0),ES=PS(!1),ld=os(null),ad=null,Ao=null,Nm=null;function Fm(){Nm=Ao=ad=null}function zm(e){var t=ld.current;it(ld),e._currentValue=t}function hg(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function zo(e,t){ad=e,Nm=Ao=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Tn=!0),e.firstContext=null)}function rr(e){var t=e._currentValue;if(Nm!==e)if(e={context:e,memoizedValue:t,next:null},Ao===null){if(ad===null)throw Error(re(308));Ao=e,ad.dependencies={lanes:0,firstContext:e}}else Ao=Ao.next=e;return t}var Ms=null;function $m(e){Ms===null?Ms=[e]:Ms.push(e)}function CS(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,$m(t)):(n.next=i.next,i.next=n),t.interleaved=n,fi(e,r)}function fi(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var Li=!1;function Dm(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function TS(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function ii(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Qi(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ue&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,fi(e,n)}return i=r.interleaved,i===null?(t.next=t,$m(r)):(t.next=i.next,i.next=t),r.interleaved=t,fi(e,n)}function Rc(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Cm(e,n)}}function ax(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=o:s=s.next=o,n=n.next}while(n!==null);s===null?i=s=t:s=s.next=t}else i=s=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ud(e,t,n,r){var i=e.updateQueue;Li=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,u=i.shared.pending;if(u!==null){i.shared.pending=null;var d=u,h=d.next;d.next=null,o===null?s=h:o.next=h,o=d;var c=e.alternate;c!==null&&(c=c.updateQueue,u=c.lastBaseUpdate,u!==o&&(u===null?c.firstBaseUpdate=h:u.next=h,c.lastBaseUpdate=d))}if(s!==null){var p=i.baseState;o=0,c=h=d=null,u=s;do{var m=u.lane,w=u.eventTime;if((r&m)===m){c!==null&&(c=c.next={eventTime:w,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var y=e,S=u;switch(m=t,w=n,S.tag){case 1:if(y=S.payload,typeof y=="function"){p=y.call(w,p,m);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=S.payload,m=typeof y=="function"?y.call(w,p,m):y,m==null)break e;p=pt({},p,m);break e;case 2:Li=!0}}u.callback!==null&&u.lane!==0&&(e.flags|=64,m=i.effects,m===null?i.effects=[u]:m.push(u))}else w={eventTime:w,lane:m,tag:u.tag,payload:u.payload,callback:u.callback,next:null},c===null?(h=c=w,d=p):c=c.next=w,o|=m;if(u=u.next,u===null){if(u=i.shared.pending,u===null)break;m=u,u=m.next,m.next=null,i.lastBaseUpdate=m,i.shared.pending=null}}while(!0);if(c===null&&(d=p),i.baseState=d,i.firstBaseUpdate=h,i.lastBaseUpdate=c,t=i.shared.interleaved,t!==null){i=t;do o|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Hs|=o,e.lanes=o,e.memoizedState=p}}function ux(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(re(191,i));i.call(r)}}}var Ua={},Fr=os(Ua),Ca=os(Ua),Ta=os(Ua);function Ls(e){if(e===Ua)throw Error(re(174));return e}function Bm(e,t){switch(Ze(Ta,t),Ze(Ca,e),Ze(Fr,Ua),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Qp(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Qp(t,e)}it(Fr),Ze(Fr,t)}function Qo(){it(Fr),it(Ca),it(Ta)}function bS(e){Ls(Ta.current);var t=Ls(Fr.current),n=Qp(t,e.type);t!==n&&(Ze(Ca,e),Ze(Fr,n))}function Um(e){Ca.current===e&&(it(Fr),it(Ca))}var ft=os(0);function cd(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var rp=[];function Wm(){for(var e=0;e<rp.length;e++)rp[e]._workInProgressVersionPrimary=null;rp.length=0}var Ic=mi.ReactCurrentDispatcher,ip=mi.ReactCurrentBatchConfig,Ws=0,ht=null,Ot=null,Dt=null,dd=!1,ea=!1,ba=0,MR=0;function tn(){throw Error(re(321))}function Hm(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!kr(e[n],t[n]))return!1;return!0}function Vm(e,t,n,r,i,s){if(Ws=s,ht=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Ic.current=e===null||e.memoizedState===null?zR:$R,e=n(r,i),ea){s=0;do{if(ea=!1,ba=0,25<=s)throw Error(re(301));s+=1,Dt=Ot=null,t.updateQueue=null,Ic.current=DR,e=n(r,i)}while(ea)}if(Ic.current=fd,t=Ot!==null&&Ot.next!==null,Ws=0,Dt=Ot=ht=null,dd=!1,t)throw Error(re(300));return e}function qm(){var e=ba!==0;return ba=0,e}function Mr(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dt===null?ht.memoizedState=Dt=e:Dt=Dt.next=e,Dt}function ir(){if(Ot===null){var e=ht.alternate;e=e!==null?e.memoizedState:null}else e=Ot.next;var t=Dt===null?ht.memoizedState:Dt.next;if(t!==null)Dt=t,Ot=e;else{if(e===null)throw Error(re(310));Ot=e,e={memoizedState:Ot.memoizedState,baseState:Ot.baseState,baseQueue:Ot.baseQueue,queue:Ot.queue,next:null},Dt===null?ht.memoizedState=Dt=e:Dt=Dt.next=e}return Dt}function Ra(e,t){return typeof t=="function"?t(e):t}function sp(e){var t=ir(),n=t.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=e;var r=Ot,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var o=i.next;i.next=s.next,s.next=o}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var u=o=null,d=null,h=s;do{var c=h.lane;if((Ws&c)===c)d!==null&&(d=d.next={lane:0,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null}),r=h.hasEagerState?h.eagerState:e(r,h.action);else{var p={lane:c,action:h.action,hasEagerState:h.hasEagerState,eagerState:h.eagerState,next:null};d===null?(u=d=p,o=r):d=d.next=p,ht.lanes|=c,Hs|=c}h=h.next}while(h!==null&&h!==s);d===null?o=r:d.next=u,kr(r,t.memoizedState)||(Tn=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=d,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do s=i.lane,ht.lanes|=s,Hs|=s,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function op(e){var t=ir(),n=t.queue;if(n===null)throw Error(re(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(i!==null){n.pending=null;var o=i=i.next;do s=e(s,o.action),o=o.next;while(o!==i);kr(s,t.memoizedState)||(Tn=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function RS(){}function IS(e,t){var n=ht,r=ir(),i=t(),s=!kr(r.memoizedState,i);if(s&&(r.memoizedState=i,Tn=!0),r=r.queue,Qm(OS.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||Dt!==null&&Dt.memoizedState.tag&1){if(n.flags|=2048,Ia(9,AS.bind(null,n,r,i,t),void 0,null),Ut===null)throw Error(re(349));Ws&30||_S(n,t,i)}return i}function _S(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=ht.updateQueue,t===null?(t={lastEffect:null,stores:null},ht.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function AS(e,t,n,r){t.value=n,t.getSnapshot=r,jS(t)&&MS(e)}function OS(e,t,n){return n(function(){jS(t)&&MS(e)})}function jS(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!kr(e,n)}catch{return!0}}function MS(e){var t=fi(e,1);t!==null&&Sr(t,e,1,-1)}function cx(e){var t=Mr();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ra,lastRenderedState:e},t.queue=e,e=e.dispatch=FR.bind(null,ht,e),[t.memoizedState,e]}function Ia(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=ht.updateQueue,t===null?(t={lastEffect:null,stores:null},ht.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function LS(){return ir().memoizedState}function _c(e,t,n,r){var i=Mr();ht.flags|=e,i.memoizedState=Ia(1|t,n,void 0,r===void 0?null:r)}function Dd(e,t,n,r){var i=ir();r=r===void 0?null:r;var s=void 0;if(Ot!==null){var o=Ot.memoizedState;if(s=o.destroy,r!==null&&Hm(r,o.deps)){i.memoizedState=Ia(t,n,s,r);return}}ht.flags|=e,i.memoizedState=Ia(1|t,n,s,r)}function dx(e,t){return _c(8390656,8,e,t)}function Qm(e,t){return Dd(2048,8,e,t)}function NS(e,t){return Dd(4,2,e,t)}function FS(e,t){return Dd(4,4,e,t)}function zS(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function $S(e,t,n){return n=n!=null?n.concat([e]):null,Dd(4,4,zS.bind(null,t,e),n)}function Ym(){}function DS(e,t){var n=ir();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Hm(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function BS(e,t){var n=ir();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&Hm(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function US(e,t,n){return Ws&21?(kr(n,t)||(n=Q1(),ht.lanes|=n,Hs|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Tn=!0),e.memoizedState=n)}function LR(e,t){var n=qe;qe=n!==0&&4>n?n:4,e(!0);var r=ip.transition;ip.transition={};try{e(!1),t()}finally{qe=n,ip.transition=r}}function WS(){return ir().memoizedState}function NR(e,t,n){var r=Xi(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},HS(e))VS(t,n);else if(n=CS(e,t,n,r),n!==null){var i=pn();Sr(n,e,r,i),qS(n,t,r)}}function FR(e,t,n){var r=Xi(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(HS(e))VS(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var o=t.lastRenderedState,u=s(o,n);if(i.hasEagerState=!0,i.eagerState=u,kr(u,o)){var d=t.interleaved;d===null?(i.next=i,$m(t)):(i.next=d.next,d.next=i),t.interleaved=i;return}}catch{}finally{}n=CS(e,t,i,r),n!==null&&(i=pn(),Sr(n,e,r,i),qS(n,t,r))}}function HS(e){var t=e.alternate;return e===ht||t!==null&&t===ht}function VS(e,t){ea=dd=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function qS(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Cm(e,n)}}var fd={readContext:rr,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useInsertionEffect:tn,useLayoutEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useMutableSource:tn,useSyncExternalStore:tn,useId:tn,unstable_isNewReconciler:!1},zR={readContext:rr,useCallback:function(e,t){return Mr().memoizedState=[e,t===void 0?null:t],e},useContext:rr,useEffect:dx,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,_c(4194308,4,zS.bind(null,t,e),n)},useLayoutEffect:function(e,t){return _c(4194308,4,e,t)},useInsertionEffect:function(e,t){return _c(4,2,e,t)},useMemo:function(e,t){var n=Mr();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Mr();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=NR.bind(null,ht,e),[r.memoizedState,e]},useRef:function(e){var t=Mr();return e={current:e},t.memoizedState=e},useState:cx,useDebugValue:Ym,useDeferredValue:function(e){return Mr().memoizedState=e},useTransition:function(){var e=cx(!1),t=e[0];return e=LR.bind(null,e[1]),Mr().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=ht,i=Mr();if(lt){if(n===void 0)throw Error(re(407));n=n()}else{if(n=t(),Ut===null)throw Error(re(349));Ws&30||_S(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,dx(OS.bind(null,r,s,e),[e]),r.flags|=2048,Ia(9,AS.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=Mr(),t=Ut.identifierPrefix;if(lt){var n=ri,r=ni;n=(r&~(1<<32-wr(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=ba++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=MR++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},$R={readContext:rr,useCallback:DS,useContext:rr,useEffect:Qm,useImperativeHandle:$S,useInsertionEffect:NS,useLayoutEffect:FS,useMemo:BS,useReducer:sp,useRef:LS,useState:function(){return sp(Ra)},useDebugValue:Ym,useDeferredValue:function(e){var t=ir();return US(t,Ot.memoizedState,e)},useTransition:function(){var e=sp(Ra)[0],t=ir().memoizedState;return[e,t]},useMutableSource:RS,useSyncExternalStore:IS,useId:WS,unstable_isNewReconciler:!1},DR={readContext:rr,useCallback:DS,useContext:rr,useEffect:Qm,useImperativeHandle:$S,useInsertionEffect:NS,useLayoutEffect:FS,useMemo:BS,useReducer:op,useRef:LS,useState:function(){return op(Ra)},useDebugValue:Ym,useDeferredValue:function(e){var t=ir();return Ot===null?t.memoizedState=e:US(t,Ot.memoizedState,e)},useTransition:function(){var e=op(Ra)[0],t=ir().memoizedState;return[e,t]},useMutableSource:RS,useSyncExternalStore:IS,useId:WS,unstable_isNewReconciler:!1};function mr(e,t){if(e&&e.defaultProps){t=pt({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function pg(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:pt({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Bd={isMounted:function(e){return(e=e._reactInternals)?Ks(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=pn(),i=Xi(e),s=ii(r,i);s.payload=t,n!=null&&(s.callback=n),t=Qi(e,s,i),t!==null&&(Sr(t,e,i,r),Rc(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=pn(),i=Xi(e),s=ii(r,i);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=Qi(e,s,i),t!==null&&(Sr(t,e,i,r),Rc(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=pn(),r=Xi(e),i=ii(n,r);i.tag=2,t!=null&&(i.callback=t),t=Qi(e,i,r),t!==null&&(Sr(t,e,r,n),Rc(t,e,r))}};function fx(e,t,n,r,i,s,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,o):t.prototype&&t.prototype.isPureReactComponent?!Sa(n,r)||!Sa(i,s):!0}function QS(e,t,n){var r=!1,i=ts,s=t.contextType;return typeof s=="object"&&s!==null?s=rr(s):(i=Rn(t)?Bs:on.current,r=t.contextTypes,s=(r=r!=null)?Ho(e,i):ts),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Bd,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function hx(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Bd.enqueueReplaceState(t,t.state,null)}function gg(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},Dm(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=rr(s):(s=Rn(t)?Bs:on.current,i.context=Ho(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(pg(e,t,s,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Bd.enqueueReplaceState(i,i.state,null),ud(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function Yo(e,t){try{var n="",r=t;do n+=pb(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function lp(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function mg(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var BR=typeof WeakMap=="function"?WeakMap:Map;function YS(e,t,n){n=ii(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){pd||(pd=!0,Tg=r),mg(e,t)},n}function XS(e,t,n){n=ii(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){mg(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){mg(e,t),typeof r!="function"&&(Yi===null?Yi=new Set([this]):Yi.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function px(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new BR;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=tI.bind(null,e,t,n),t.then(e,e))}function gx(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function mx(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=ii(-1,1),t.tag=2,Qi(n,t,1))),n.lanes|=1),e)}var UR=mi.ReactCurrentOwner,Tn=!1;function fn(e,t,n,r){t.child=e===null?ES(t,null,n,r):qo(t,e.child,n,r)}function yx(e,t,n,r,i){n=n.render;var s=t.ref;return zo(t,i),r=Vm(e,t,n,r,s,i),n=qm(),e!==null&&!Tn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,hi(e,t,i)):(lt&&n&&jm(t),t.flags|=1,fn(e,t,r,i),t.child)}function vx(e,t,n,r,i){if(e===null){var s=n.type;return typeof s=="function"&&!ny(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,KS(e,t,s,r,i)):(e=Mc(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var o=s.memoizedProps;if(n=n.compare,n=n!==null?n:Sa,n(o,r)&&e.ref===t.ref)return hi(e,t,i)}return t.flags|=1,e=Ki(s,r),e.ref=t.ref,e.return=t,t.child=e}function KS(e,t,n,r,i){if(e!==null){var s=e.memoizedProps;if(Sa(s,r)&&e.ref===t.ref)if(Tn=!1,t.pendingProps=r=s,(e.lanes&i)!==0)e.flags&131072&&(Tn=!0);else return t.lanes=e.lanes,hi(e,t,i)}return yg(e,t,n,r,i)}function GS(e,t,n){var r=t.pendingProps,i=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ze(jo,Mn),Mn|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ze(jo,Mn),Mn|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Ze(jo,Mn),Mn|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,Ze(jo,Mn),Mn|=r;return fn(e,t,i,n),t.child}function ZS(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function yg(e,t,n,r,i){var s=Rn(n)?Bs:on.current;return s=Ho(t,s),zo(t,i),n=Vm(e,t,n,r,s,i),r=qm(),e!==null&&!Tn?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,hi(e,t,i)):(lt&&r&&jm(t),t.flags|=1,fn(e,t,n,i),t.child)}function xx(e,t,n,r,i){if(Rn(n)){var s=!0;id(t)}else s=!1;if(zo(t,i),t.stateNode===null)Ac(e,t),QS(t,n,r),gg(t,n,r,i),r=!0;else if(e===null){var o=t.stateNode,u=t.memoizedProps;o.props=u;var d=o.context,h=n.contextType;typeof h=="object"&&h!==null?h=rr(h):(h=Rn(n)?Bs:on.current,h=Ho(t,h));var c=n.getDerivedStateFromProps,p=typeof c=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==r||d!==h)&&hx(t,o,r,h),Li=!1;var m=t.memoizedState;o.state=m,ud(t,r,o,i),d=t.memoizedState,u!==r||m!==d||bn.current||Li?(typeof c=="function"&&(pg(t,n,c,r),d=t.memoizedState),(u=Li||fx(t,n,u,r,m,d,h))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=d),o.props=r,o.state=d,o.context=h,r=u):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,TS(e,t),u=t.memoizedProps,h=t.type===t.elementType?u:mr(t.type,u),o.props=h,p=t.pendingProps,m=o.context,d=n.contextType,typeof d=="object"&&d!==null?d=rr(d):(d=Rn(n)?Bs:on.current,d=Ho(t,d));var w=n.getDerivedStateFromProps;(c=typeof w=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(u!==p||m!==d)&&hx(t,o,r,d),Li=!1,m=t.memoizedState,o.state=m,ud(t,r,o,i);var y=t.memoizedState;u!==p||m!==y||bn.current||Li?(typeof w=="function"&&(pg(t,n,w,r),y=t.memoizedState),(h=Li||fx(t,n,h,r,m,y,d)||!1)?(c||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,y,d),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,y,d)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||u===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=y),o.props=r,o.state=y,o.context=d,r=h):(typeof o.componentDidUpdate!="function"||u===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||u===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),r=!1)}return vg(e,t,n,r,s,i)}function vg(e,t,n,r,i,s){ZS(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return i&&ix(t,n,!1),hi(e,t,s);r=t.stateNode,UR.current=t;var u=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=qo(t,e.child,null,s),t.child=qo(t,null,u,s)):fn(e,t,u,s),t.memoizedState=r.state,i&&ix(t,n,!0),t.child}function JS(e){var t=e.stateNode;t.pendingContext?rx(e,t.pendingContext,t.pendingContext!==t.context):t.context&&rx(e,t.context,!1),Bm(e,t.containerInfo)}function wx(e,t,n,r,i){return Vo(),Lm(i),t.flags|=256,fn(e,t,n,r),t.child}var xg={dehydrated:null,treeContext:null,retryLane:0};function wg(e){return{baseLanes:e,cachePool:null,transitions:null}}function ek(e,t,n){var r=t.pendingProps,i=ft.current,s=!1,o=(t.flags&128)!==0,u;if((u=o)||(u=e!==null&&e.memoizedState===null?!1:(i&2)!==0),u?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Ze(ft,i&1),e===null)return fg(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,s?(r=t.mode,s=t.child,o={mode:"hidden",children:o},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=o):s=Hd(o,r,0,null),e=zs(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=wg(n),t.memoizedState=xg,e):Xm(t,o));if(i=e.memoizedState,i!==null&&(u=i.dehydrated,u!==null))return WR(e,t,o,r,u,i,n);if(s){s=r.fallback,o=t.mode,i=e.child,u=i.sibling;var d={mode:"hidden",children:r.children};return!(o&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=d,t.deletions=null):(r=Ki(i,d),r.subtreeFlags=i.subtreeFlags&14680064),u!==null?s=Ki(u,s):(s=zs(s,o,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,o=e.child.memoizedState,o=o===null?wg(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},s.memoizedState=o,s.childLanes=e.childLanes&~n,t.memoizedState=xg,r}return s=e.child,e=s.sibling,r=Ki(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function Xm(e,t){return t=Hd({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function rc(e,t,n,r){return r!==null&&Lm(r),qo(t,e.child,null,n),e=Xm(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function WR(e,t,n,r,i,s,o){if(n)return t.flags&256?(t.flags&=-257,r=lp(Error(re(422))),rc(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=Hd({mode:"visible",children:r.children},i,0,null),s=zs(s,i,o,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&qo(t,e.child,null,o),t.child.memoizedState=wg(o),t.memoizedState=xg,s);if(!(t.mode&1))return rc(e,t,o,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var u=r.dgst;return r=u,s=Error(re(419)),r=lp(s,r,void 0),rc(e,t,o,r)}if(u=(o&e.childLanes)!==0,Tn||u){if(r=Ut,r!==null){switch(o&-o){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|o)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,fi(e,i),Sr(r,e,i,-1))}return ty(),r=lp(Error(re(421))),rc(e,t,o,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=nI.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Nn=qi(i.nextSibling),Fn=t,lt=!0,vr=null,e!==null&&(Gn[Zn++]=ni,Gn[Zn++]=ri,Gn[Zn++]=Us,ni=e.id,ri=e.overflow,Us=t),t=Xm(t,r.children),t.flags|=4096,t)}function Sx(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),hg(e.return,t,n)}function ap(e,t,n,r,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function tk(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(fn(e,t,r.children,n),r=ft.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Sx(e,n,t);else if(e.tag===19)Sx(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ze(ft,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&cd(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),ap(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&cd(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}ap(t,!0,n,null,s);break;case"together":ap(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ac(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function hi(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Hs|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(re(153));if(t.child!==null){for(e=t.child,n=Ki(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Ki(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function HR(e,t,n){switch(t.tag){case 3:JS(t),Vo();break;case 5:bS(t);break;case 1:Rn(t.type)&&id(t);break;case 4:Bm(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ze(ld,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Ze(ft,ft.current&1),t.flags|=128,null):n&t.child.childLanes?ek(e,t,n):(Ze(ft,ft.current&1),e=hi(e,t,n),e!==null?e.sibling:null);Ze(ft,ft.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return tk(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ze(ft,ft.current),r)break;return null;case 22:case 23:return t.lanes=0,GS(e,t,n)}return hi(e,t,n)}var nk,Sg,rk,ik;nk=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Sg=function(){};rk=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Ls(Fr.current);var s=null;switch(n){case"input":i=Wp(e,i),r=Wp(e,r),s=[];break;case"select":i=pt({},i,{value:void 0}),r=pt({},r,{value:void 0}),s=[];break;case"textarea":i=qp(e,i),r=qp(e,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=nd)}Yp(n,r);var o;n=null;for(h in i)if(!r.hasOwnProperty(h)&&i.hasOwnProperty(h)&&i[h]!=null)if(h==="style"){var u=i[h];for(o in u)u.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else h!=="dangerouslySetInnerHTML"&&h!=="children"&&h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&h!=="autoFocus"&&(pa.hasOwnProperty(h)?s||(s=[]):(s=s||[]).push(h,null));for(h in r){var d=r[h];if(u=i!=null?i[h]:void 0,r.hasOwnProperty(h)&&d!==u&&(d!=null||u!=null))if(h==="style")if(u){for(o in u)!u.hasOwnProperty(o)||d&&d.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in d)d.hasOwnProperty(o)&&u[o]!==d[o]&&(n||(n={}),n[o]=d[o])}else n||(s||(s=[]),s.push(h,n)),n=d;else h==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,u=u?u.__html:void 0,d!=null&&u!==d&&(s=s||[]).push(h,d)):h==="children"?typeof d!="string"&&typeof d!="number"||(s=s||[]).push(h,""+d):h!=="suppressContentEditableWarning"&&h!=="suppressHydrationWarning"&&(pa.hasOwnProperty(h)?(d!=null&&h==="onScroll"&&nt("scroll",e),s||u===d||(s=[])):(s=s||[]).push(h,d))}n&&(s=s||[]).push("style",n);var h=s;(t.updateQueue=h)&&(t.flags|=4)}};ik=function(e,t,n,r){n!==r&&(t.flags|=4)};function jl(e,t){if(!lt)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function nn(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function VR(e,t,n){var r=t.pendingProps;switch(Mm(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nn(t),null;case 1:return Rn(t.type)&&rd(),nn(t),null;case 3:return r=t.stateNode,Qo(),it(bn),it(on),Wm(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(tc(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,vr!==null&&(Ig(vr),vr=null))),Sg(e,t),nn(t),null;case 5:Um(t);var i=Ls(Ta.current);if(n=t.type,e!==null&&t.stateNode!=null)rk(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(re(166));return nn(t),null}if(e=Ls(Fr.current),tc(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[Lr]=t,r[Ea]=s,e=(t.mode&1)!==0,n){case"dialog":nt("cancel",r),nt("close",r);break;case"iframe":case"object":case"embed":nt("load",r);break;case"video":case"audio":for(i=0;i<Vl.length;i++)nt(Vl[i],r);break;case"source":nt("error",r);break;case"img":case"image":case"link":nt("error",r),nt("load",r);break;case"details":nt("toggle",r);break;case"input":_0(r,s),nt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},nt("invalid",r);break;case"textarea":O0(r,s),nt("invalid",r)}Yp(n,s),i=null;for(var o in s)if(s.hasOwnProperty(o)){var u=s[o];o==="children"?typeof u=="string"?r.textContent!==u&&(s.suppressHydrationWarning!==!0&&ec(r.textContent,u,e),i=["children",u]):typeof u=="number"&&r.textContent!==""+u&&(s.suppressHydrationWarning!==!0&&ec(r.textContent,u,e),i=["children",""+u]):pa.hasOwnProperty(o)&&u!=null&&o==="onScroll"&&nt("scroll",r)}switch(n){case"input":qu(r),A0(r,s,!0);break;case"textarea":qu(r),j0(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=nd)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=O1(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Lr]=t,e[Ea]=r,nk(e,t,!1,!1),t.stateNode=e;e:{switch(o=Xp(n,r),n){case"dialog":nt("cancel",e),nt("close",e),i=r;break;case"iframe":case"object":case"embed":nt("load",e),i=r;break;case"video":case"audio":for(i=0;i<Vl.length;i++)nt(Vl[i],e);i=r;break;case"source":nt("error",e),i=r;break;case"img":case"image":case"link":nt("error",e),nt("load",e),i=r;break;case"details":nt("toggle",e),i=r;break;case"input":_0(e,r),i=Wp(e,r),nt("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=pt({},r,{value:void 0}),nt("invalid",e);break;case"textarea":O0(e,r),i=qp(e,r),nt("invalid",e);break;default:i=r}Yp(n,i),u=i;for(s in u)if(u.hasOwnProperty(s)){var d=u[s];s==="style"?L1(e,d):s==="dangerouslySetInnerHTML"?(d=d?d.__html:void 0,d!=null&&j1(e,d)):s==="children"?typeof d=="string"?(n!=="textarea"||d!=="")&&ga(e,d):typeof d=="number"&&ga(e,""+d):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(pa.hasOwnProperty(s)?d!=null&&s==="onScroll"&&nt("scroll",e):d!=null&&xm(e,s,d,o))}switch(n){case"input":qu(e),A0(e,r,!1);break;case"textarea":qu(e),j0(e);break;case"option":r.value!=null&&e.setAttribute("value",""+es(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?Mo(e,!!r.multiple,s,!1):r.defaultValue!=null&&Mo(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=nd)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return nn(t),null;case 6:if(e&&t.stateNode!=null)ik(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(re(166));if(n=Ls(Ta.current),Ls(Fr.current),tc(t)){if(r=t.stateNode,n=t.memoizedProps,r[Lr]=t,(s=r.nodeValue!==n)&&(e=Fn,e!==null))switch(e.tag){case 3:ec(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&ec(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Lr]=t,t.stateNode=r}return nn(t),null;case 13:if(it(ft),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(lt&&Nn!==null&&t.mode&1&&!(t.flags&128))kS(),Vo(),t.flags|=98560,s=!1;else if(s=tc(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(re(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(re(317));s[Lr]=t}else Vo(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;nn(t),s=!1}else vr!==null&&(Ig(vr),vr=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||ft.current&1?jt===0&&(jt=3):ty())),t.updateQueue!==null&&(t.flags|=4),nn(t),null);case 4:return Qo(),Sg(e,t),e===null&&ka(t.stateNode.containerInfo),nn(t),null;case 10:return zm(t.type._context),nn(t),null;case 17:return Rn(t.type)&&rd(),nn(t),null;case 19:if(it(ft),s=t.memoizedState,s===null)return nn(t),null;if(r=(t.flags&128)!==0,o=s.rendering,o===null)if(r)jl(s,!1);else{if(jt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=cd(e),o!==null){for(t.flags|=128,jl(s,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,o=s.alternate,o===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=o.childLanes,s.lanes=o.lanes,s.child=o.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=o.memoizedProps,s.memoizedState=o.memoizedState,s.updateQueue=o.updateQueue,s.type=o.type,e=o.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ze(ft,ft.current&1|2),t.child}e=e.sibling}s.tail!==null&&St()>Xo&&(t.flags|=128,r=!0,jl(s,!1),t.lanes=4194304)}else{if(!r)if(e=cd(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),jl(s,!0),s.tail===null&&s.tailMode==="hidden"&&!o.alternate&&!lt)return nn(t),null}else 2*St()-s.renderingStartTime>Xo&&n!==1073741824&&(t.flags|=128,r=!0,jl(s,!1),t.lanes=4194304);s.isBackwards?(o.sibling=t.child,t.child=o):(n=s.last,n!==null?n.sibling=o:t.child=o,s.last=o)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=St(),t.sibling=null,n=ft.current,Ze(ft,r?n&1|2:n&1),t):(nn(t),null);case 22:case 23:return ey(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Mn&1073741824&&(nn(t),t.subtreeFlags&6&&(t.flags|=8192)):nn(t),null;case 24:return null;case 25:return null}throw Error(re(156,t.tag))}function qR(e,t){switch(Mm(t),t.tag){case 1:return Rn(t.type)&&rd(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Qo(),it(bn),it(on),Wm(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return Um(t),null;case 13:if(it(ft),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(re(340));Vo()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return it(ft),null;case 4:return Qo(),null;case 10:return zm(t.type._context),null;case 22:case 23:return ey(),null;case 24:return null;default:return null}}var ic=!1,sn=!1,QR=typeof WeakSet=="function"?WeakSet:Set,me=null;function Oo(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){vt(e,t,r)}else n.current=null}function kg(e,t,n){try{n()}catch(r){vt(e,t,r)}}var kx=!1;function YR(e,t){if(sg=Jc,e=uS(),Om(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var o=0,u=-1,d=-1,h=0,c=0,p=e,m=null;t:for(;;){for(var w;p!==n||i!==0&&p.nodeType!==3||(u=o+i),p!==s||r!==0&&p.nodeType!==3||(d=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(w=p.firstChild)!==null;)m=p,p=w;for(;;){if(p===e)break t;if(m===n&&++h===i&&(u=o),m===s&&++c===r&&(d=o),(w=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=w}n=u===-1||d===-1?null:{start:u,end:d}}else n=null}n=n||{start:0,end:0}}else n=null;for(og={focusedElem:e,selectionRange:n},Jc=!1,me=t;me!==null;)if(t=me,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,me=e;else for(;me!==null;){t=me;try{var y=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var S=y.memoizedProps,C=y.memoizedState,x=t.stateNode,k=x.getSnapshotBeforeUpdate(t.elementType===t.type?S:mr(t.type,S),C);x.__reactInternalSnapshotBeforeUpdate=k}break;case 3:var T=t.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(re(163))}}catch(_){vt(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,me=e;break}me=t.return}return y=kx,kx=!1,y}function ta(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&kg(t,n,s)}i=i.next}while(i!==r)}}function Ud(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function Pg(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function sk(e){var t=e.alternate;t!==null&&(e.alternate=null,sk(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Lr],delete t[Ea],delete t[ug],delete t[_R],delete t[AR])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ok(e){return e.tag===5||e.tag===3||e.tag===4}function Px(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||ok(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function Eg(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=nd));else if(r!==4&&(e=e.child,e!==null))for(Eg(e,t,n),e=e.sibling;e!==null;)Eg(e,t,n),e=e.sibling}function Cg(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(Cg(e,t,n),e=e.sibling;e!==null;)Cg(e,t,n),e=e.sibling}var Qt=null,yr=!1;function Ii(e,t,n){for(n=n.child;n!==null;)lk(e,t,n),n=n.sibling}function lk(e,t,n){if(Nr&&typeof Nr.onCommitFiberUnmount=="function")try{Nr.onCommitFiberUnmount(Md,n)}catch{}switch(n.tag){case 5:sn||Oo(n,t);case 6:var r=Qt,i=yr;Qt=null,Ii(e,t,n),Qt=r,yr=i,Qt!==null&&(yr?(e=Qt,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Qt.removeChild(n.stateNode));break;case 18:Qt!==null&&(yr?(e=Qt,n=n.stateNode,e.nodeType===8?tp(e.parentNode,n):e.nodeType===1&&tp(e,n),xa(e)):tp(Qt,n.stateNode));break;case 4:r=Qt,i=yr,Qt=n.stateNode.containerInfo,yr=!0,Ii(e,t,n),Qt=r,yr=i;break;case 0:case 11:case 14:case 15:if(!sn&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,o!==void 0&&(s&2||s&4)&&kg(n,t,o),i=i.next}while(i!==r)}Ii(e,t,n);break;case 1:if(!sn&&(Oo(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(u){vt(n,t,u)}Ii(e,t,n);break;case 21:Ii(e,t,n);break;case 22:n.mode&1?(sn=(r=sn)||n.memoizedState!==null,Ii(e,t,n),sn=r):Ii(e,t,n);break;default:Ii(e,t,n)}}function Ex(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new QR),t.forEach(function(r){var i=rI.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function pr(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,o=t,u=o;e:for(;u!==null;){switch(u.tag){case 5:Qt=u.stateNode,yr=!1;break e;case 3:Qt=u.stateNode.containerInfo,yr=!0;break e;case 4:Qt=u.stateNode.containerInfo,yr=!0;break e}u=u.return}if(Qt===null)throw Error(re(160));lk(s,o,i),Qt=null,yr=!1;var d=i.alternate;d!==null&&(d.return=null),i.return=null}catch(h){vt(i,t,h)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)ak(t,e),t=t.sibling}function ak(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(pr(t,e),jr(e),r&4){try{ta(3,e,e.return),Ud(3,e)}catch(S){vt(e,e.return,S)}try{ta(5,e,e.return)}catch(S){vt(e,e.return,S)}}break;case 1:pr(t,e),jr(e),r&512&&n!==null&&Oo(n,n.return);break;case 5:if(pr(t,e),jr(e),r&512&&n!==null&&Oo(n,n.return),e.flags&32){var i=e.stateNode;try{ga(i,"")}catch(S){vt(e,e.return,S)}}if(r&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,o=n!==null?n.memoizedProps:s,u=e.type,d=e.updateQueue;if(e.updateQueue=null,d!==null)try{u==="input"&&s.type==="radio"&&s.name!=null&&_1(i,s),Xp(u,o);var h=Xp(u,s);for(o=0;o<d.length;o+=2){var c=d[o],p=d[o+1];c==="style"?L1(i,p):c==="dangerouslySetInnerHTML"?j1(i,p):c==="children"?ga(i,p):xm(i,c,p,h)}switch(u){case"input":Hp(i,s);break;case"textarea":A1(i,s);break;case"select":var m=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var w=s.value;w!=null?Mo(i,!!s.multiple,w,!1):m!==!!s.multiple&&(s.defaultValue!=null?Mo(i,!!s.multiple,s.defaultValue,!0):Mo(i,!!s.multiple,s.multiple?[]:"",!1))}i[Ea]=s}catch(S){vt(e,e.return,S)}}break;case 6:if(pr(t,e),jr(e),r&4){if(e.stateNode===null)throw Error(re(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(S){vt(e,e.return,S)}}break;case 3:if(pr(t,e),jr(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{xa(t.containerInfo)}catch(S){vt(e,e.return,S)}break;case 4:pr(t,e),jr(e);break;case 13:pr(t,e),jr(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(Zm=St())),r&4&&Ex(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(sn=(h=sn)||c,pr(t,e),sn=h):pr(t,e),jr(e),r&8192){if(h=e.memoizedState!==null,(e.stateNode.isHidden=h)&&!c&&e.mode&1)for(me=e,c=e.child;c!==null;){for(p=me=c;me!==null;){switch(m=me,w=m.child,m.tag){case 0:case 11:case 14:case 15:ta(4,m,m.return);break;case 1:Oo(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){r=m,n=m.return;try{t=r,y.props=t.memoizedProps,y.state=t.memoizedState,y.componentWillUnmount()}catch(S){vt(r,n,S)}}break;case 5:Oo(m,m.return);break;case 22:if(m.memoizedState!==null){Tx(p);continue}}w!==null?(w.return=m,me=w):Tx(p)}c=c.sibling}e:for(c=null,p=e;;){if(p.tag===5){if(c===null){c=p;try{i=p.stateNode,h?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(u=p.stateNode,d=p.memoizedProps.style,o=d!=null&&d.hasOwnProperty("display")?d.display:null,u.style.display=M1("display",o))}catch(S){vt(e,e.return,S)}}}else if(p.tag===6){if(c===null)try{p.stateNode.nodeValue=h?"":p.memoizedProps}catch(S){vt(e,e.return,S)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===e)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===e)break e;for(;p.sibling===null;){if(p.return===null||p.return===e)break e;c===p&&(c=null),p=p.return}c===p&&(c=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:pr(t,e),jr(e),r&4&&Ex(e);break;case 21:break;default:pr(t,e),jr(e)}}function jr(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(ok(n)){var r=n;break e}n=n.return}throw Error(re(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(ga(i,""),r.flags&=-33);var s=Px(e);Cg(e,s,i);break;case 3:case 4:var o=r.stateNode.containerInfo,u=Px(e);Eg(e,u,o);break;default:throw Error(re(161))}}catch(d){vt(e,e.return,d)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function XR(e,t,n){me=e,uk(e)}function uk(e,t,n){for(var r=(e.mode&1)!==0;me!==null;){var i=me,s=i.child;if(i.tag===22&&r){var o=i.memoizedState!==null||ic;if(!o){var u=i.alternate,d=u!==null&&u.memoizedState!==null||sn;u=ic;var h=sn;if(ic=o,(sn=d)&&!h)for(me=i;me!==null;)o=me,d=o.child,o.tag===22&&o.memoizedState!==null?bx(i):d!==null?(d.return=o,me=d):bx(i);for(;s!==null;)me=s,uk(s),s=s.sibling;me=i,ic=u,sn=h}Cx(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,me=s):Cx(e)}}function Cx(e){for(;me!==null;){var t=me;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:sn||Ud(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!sn)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:mr(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&ux(t,s,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}ux(t,o,n)}break;case 5:var u=t.stateNode;if(n===null&&t.flags&4){n=u;var d=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":d.autoFocus&&n.focus();break;case"img":d.src&&(n.src=d.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var h=t.alternate;if(h!==null){var c=h.memoizedState;if(c!==null){var p=c.dehydrated;p!==null&&xa(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(re(163))}sn||t.flags&512&&Pg(t)}catch(m){vt(t,t.return,m)}}if(t===e){me=null;break}if(n=t.sibling,n!==null){n.return=t.return,me=n;break}me=t.return}}function Tx(e){for(;me!==null;){var t=me;if(t===e){me=null;break}var n=t.sibling;if(n!==null){n.return=t.return,me=n;break}me=t.return}}function bx(e){for(;me!==null;){var t=me;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Ud(4,t)}catch(d){vt(t,n,d)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(d){vt(t,i,d)}}var s=t.return;try{Pg(t)}catch(d){vt(t,s,d)}break;case 5:var o=t.return;try{Pg(t)}catch(d){vt(t,o,d)}}}catch(d){vt(t,t.return,d)}if(t===e){me=null;break}var u=t.sibling;if(u!==null){u.return=t.return,me=u;break}me=t.return}}var KR=Math.ceil,hd=mi.ReactCurrentDispatcher,Km=mi.ReactCurrentOwner,nr=mi.ReactCurrentBatchConfig,Ue=0,Ut=null,Tt=null,Yt=0,Mn=0,jo=os(0),jt=0,_a=null,Hs=0,Wd=0,Gm=0,na=null,Cn=null,Zm=0,Xo=1/0,ei=null,pd=!1,Tg=null,Yi=null,sc=!1,Bi=null,gd=0,ra=0,bg=null,Oc=-1,jc=0;function pn(){return Ue&6?St():Oc!==-1?Oc:Oc=St()}function Xi(e){return e.mode&1?Ue&2&&Yt!==0?Yt&-Yt:jR.transition!==null?(jc===0&&(jc=Q1()),jc):(e=qe,e!==0||(e=window.event,e=e===void 0?16:eS(e.type)),e):1}function Sr(e,t,n,r){if(50<ra)throw ra=0,bg=null,Error(re(185));$a(e,n,r),(!(Ue&2)||e!==Ut)&&(e===Ut&&(!(Ue&2)&&(Wd|=n),jt===4&&$i(e,Yt)),In(e,r),n===1&&Ue===0&&!(t.mode&1)&&(Xo=St()+500,$d&&ls()))}function In(e,t){var n=e.callbackNode;jb(e,t);var r=Zc(e,e===Ut?Yt:0);if(r===0)n!==null&&N0(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&N0(n),t===1)e.tag===0?OR(Rx.bind(null,e)):xS(Rx.bind(null,e)),RR(function(){!(Ue&6)&&ls()}),n=null;else{switch(Y1(r)){case 1:n=Em;break;case 4:n=V1;break;case 16:n=Gc;break;case 536870912:n=q1;break;default:n=Gc}n=yk(n,ck.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function ck(e,t){if(Oc=-1,jc=0,Ue&6)throw Error(re(327));var n=e.callbackNode;if($o()&&e.callbackNode!==n)return null;var r=Zc(e,e===Ut?Yt:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=md(e,r);else{t=r;var i=Ue;Ue|=2;var s=fk();(Ut!==e||Yt!==t)&&(ei=null,Xo=St()+500,Fs(e,t));do try{JR();break}catch(u){dk(e,u)}while(!0);Fm(),hd.current=s,Ue=i,Tt!==null?t=0:(Ut=null,Yt=0,t=jt)}if(t!==0){if(t===2&&(i=eg(e),i!==0&&(r=i,t=Rg(e,i))),t===1)throw n=_a,Fs(e,0),$i(e,r),In(e,St()),n;if(t===6)$i(e,r);else{if(i=e.current.alternate,!(r&30)&&!GR(i)&&(t=md(e,r),t===2&&(s=eg(e),s!==0&&(r=s,t=Rg(e,s))),t===1))throw n=_a,Fs(e,0),$i(e,r),In(e,St()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(re(345));case 2:Cs(e,Cn,ei);break;case 3:if($i(e,r),(r&130023424)===r&&(t=Zm+500-St(),10<t)){if(Zc(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){pn(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=ag(Cs.bind(null,e,Cn,ei),t);break}Cs(e,Cn,ei);break;case 4:if($i(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var o=31-wr(r);s=1<<o,o=t[o],o>i&&(i=o),r&=~s}if(r=i,r=St()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*KR(r/1960))-r,10<r){e.timeoutHandle=ag(Cs.bind(null,e,Cn,ei),r);break}Cs(e,Cn,ei);break;case 5:Cs(e,Cn,ei);break;default:throw Error(re(329))}}}return In(e,St()),e.callbackNode===n?ck.bind(null,e):null}function Rg(e,t){var n=na;return e.current.memoizedState.isDehydrated&&(Fs(e,t).flags|=256),e=md(e,t),e!==2&&(t=Cn,Cn=n,t!==null&&Ig(t)),e}function Ig(e){Cn===null?Cn=e:Cn.push.apply(Cn,e)}function GR(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!kr(s(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function $i(e,t){for(t&=~Gm,t&=~Wd,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-wr(t),r=1<<n;e[n]=-1,t&=~r}}function Rx(e){if(Ue&6)throw Error(re(327));$o();var t=Zc(e,0);if(!(t&1))return In(e,St()),null;var n=md(e,t);if(e.tag!==0&&n===2){var r=eg(e);r!==0&&(t=r,n=Rg(e,r))}if(n===1)throw n=_a,Fs(e,0),$i(e,t),In(e,St()),n;if(n===6)throw Error(re(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Cs(e,Cn,ei),In(e,St()),null}function Jm(e,t){var n=Ue;Ue|=1;try{return e(t)}finally{Ue=n,Ue===0&&(Xo=St()+500,$d&&ls())}}function Vs(e){Bi!==null&&Bi.tag===0&&!(Ue&6)&&$o();var t=Ue;Ue|=1;var n=nr.transition,r=qe;try{if(nr.transition=null,qe=1,e)return e()}finally{qe=r,nr.transition=n,Ue=t,!(Ue&6)&&ls()}}function ey(){Mn=jo.current,it(jo)}function Fs(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,bR(n)),Tt!==null)for(n=Tt.return;n!==null;){var r=n;switch(Mm(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&rd();break;case 3:Qo(),it(bn),it(on),Wm();break;case 5:Um(r);break;case 4:Qo();break;case 13:it(ft);break;case 19:it(ft);break;case 10:zm(r.type._context);break;case 22:case 23:ey()}n=n.return}if(Ut=e,Tt=e=Ki(e.current,null),Yt=Mn=t,jt=0,_a=null,Gm=Wd=Hs=0,Cn=na=null,Ms!==null){for(t=0;t<Ms.length;t++)if(n=Ms[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var o=s.next;s.next=i,r.next=o}n.pending=r}Ms=null}return e}function dk(e,t){do{var n=Tt;try{if(Fm(),Ic.current=fd,dd){for(var r=ht.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}dd=!1}if(Ws=0,Dt=Ot=ht=null,ea=!1,ba=0,Km.current=null,n===null||n.return===null){jt=1,_a=t,Tt=null;break}e:{var s=e,o=n.return,u=n,d=t;if(t=Yt,u.flags|=32768,d!==null&&typeof d=="object"&&typeof d.then=="function"){var h=d,c=u,p=c.tag;if(!(c.mode&1)&&(p===0||p===11||p===15)){var m=c.alternate;m?(c.updateQueue=m.updateQueue,c.memoizedState=m.memoizedState,c.lanes=m.lanes):(c.updateQueue=null,c.memoizedState=null)}var w=gx(o);if(w!==null){w.flags&=-257,mx(w,o,u,s,t),w.mode&1&&px(s,h,t),t=w,d=h;var y=t.updateQueue;if(y===null){var S=new Set;S.add(d),t.updateQueue=S}else y.add(d);break e}else{if(!(t&1)){px(s,h,t),ty();break e}d=Error(re(426))}}else if(lt&&u.mode&1){var C=gx(o);if(C!==null){!(C.flags&65536)&&(C.flags|=256),mx(C,o,u,s,t),Lm(Yo(d,u));break e}}s=d=Yo(d,u),jt!==4&&(jt=2),na===null?na=[s]:na.push(s),s=o;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=YS(s,d,t);ax(s,x);break e;case 1:u=d;var k=s.type,T=s.stateNode;if(!(s.flags&128)&&(typeof k.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Yi===null||!Yi.has(T)))){s.flags|=65536,t&=-t,s.lanes|=t;var _=XS(s,u,t);ax(s,_);break e}}s=s.return}while(s!==null)}pk(n)}catch(R){t=R,Tt===n&&n!==null&&(Tt=n=n.return);continue}break}while(!0)}function fk(){var e=hd.current;return hd.current=fd,e===null?fd:e}function ty(){(jt===0||jt===3||jt===2)&&(jt=4),Ut===null||!(Hs&268435455)&&!(Wd&268435455)||$i(Ut,Yt)}function md(e,t){var n=Ue;Ue|=2;var r=fk();(Ut!==e||Yt!==t)&&(ei=null,Fs(e,t));do try{ZR();break}catch(i){dk(e,i)}while(!0);if(Fm(),Ue=n,hd.current=r,Tt!==null)throw Error(re(261));return Ut=null,Yt=0,jt}function ZR(){for(;Tt!==null;)hk(Tt)}function JR(){for(;Tt!==null&&!Eb();)hk(Tt)}function hk(e){var t=mk(e.alternate,e,Mn);e.memoizedProps=e.pendingProps,t===null?pk(e):Tt=t,Km.current=null}function pk(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=qR(n,t),n!==null){n.flags&=32767,Tt=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{jt=6,Tt=null;return}}else if(n=VR(n,t,Mn),n!==null){Tt=n;return}if(t=t.sibling,t!==null){Tt=t;return}Tt=t=e}while(t!==null);jt===0&&(jt=5)}function Cs(e,t,n){var r=qe,i=nr.transition;try{nr.transition=null,qe=1,eI(e,t,n,r)}finally{nr.transition=i,qe=r}return null}function eI(e,t,n,r){do $o();while(Bi!==null);if(Ue&6)throw Error(re(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(re(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(Mb(e,s),e===Ut&&(Tt=Ut=null,Yt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||sc||(sc=!0,yk(Gc,function(){return $o(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=nr.transition,nr.transition=null;var o=qe;qe=1;var u=Ue;Ue|=4,Km.current=null,YR(e,n),ak(n,e),wR(og),Jc=!!sg,og=sg=null,e.current=n,XR(n),Cb(),Ue=u,qe=o,nr.transition=s}else e.current=n;if(sc&&(sc=!1,Bi=e,gd=i),s=e.pendingLanes,s===0&&(Yi=null),Rb(n.stateNode),In(e,St()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(pd)throw pd=!1,e=Tg,Tg=null,e;return gd&1&&e.tag!==0&&$o(),s=e.pendingLanes,s&1?e===bg?ra++:(ra=0,bg=e):ra=0,ls(),null}function $o(){if(Bi!==null){var e=Y1(gd),t=nr.transition,n=qe;try{if(nr.transition=null,qe=16>e?16:e,Bi===null)var r=!1;else{if(e=Bi,Bi=null,gd=0,Ue&6)throw Error(re(331));var i=Ue;for(Ue|=4,me=e.current;me!==null;){var s=me,o=s.child;if(me.flags&16){var u=s.deletions;if(u!==null){for(var d=0;d<u.length;d++){var h=u[d];for(me=h;me!==null;){var c=me;switch(c.tag){case 0:case 11:case 15:ta(8,c,s)}var p=c.child;if(p!==null)p.return=c,me=p;else for(;me!==null;){c=me;var m=c.sibling,w=c.return;if(sk(c),c===h){me=null;break}if(m!==null){m.return=w,me=m;break}me=w}}}var y=s.alternate;if(y!==null){var S=y.child;if(S!==null){y.child=null;do{var C=S.sibling;S.sibling=null,S=C}while(S!==null)}}me=s}}if(s.subtreeFlags&2064&&o!==null)o.return=s,me=o;else e:for(;me!==null;){if(s=me,s.flags&2048)switch(s.tag){case 0:case 11:case 15:ta(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,me=x;break e}me=s.return}}var k=e.current;for(me=k;me!==null;){o=me;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,me=T;else e:for(o=k;me!==null;){if(u=me,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Ud(9,u)}}catch(R){vt(u,u.return,R)}if(u===o){me=null;break e}var _=u.sibling;if(_!==null){_.return=u.return,me=_;break e}me=u.return}}if(Ue=i,ls(),Nr&&typeof Nr.onPostCommitFiberRoot=="function")try{Nr.onPostCommitFiberRoot(Md,e)}catch{}r=!0}return r}finally{qe=n,nr.transition=t}}return!1}function Ix(e,t,n){t=Yo(n,t),t=YS(e,t,1),e=Qi(e,t,1),t=pn(),e!==null&&($a(e,1,t),In(e,t))}function vt(e,t,n){if(e.tag===3)Ix(e,e,n);else for(;t!==null;){if(t.tag===3){Ix(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Yi===null||!Yi.has(r))){e=Yo(n,e),e=XS(t,e,1),t=Qi(t,e,1),e=pn(),t!==null&&($a(t,1,e),In(t,e));break}}t=t.return}}function tI(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=pn(),e.pingedLanes|=e.suspendedLanes&n,Ut===e&&(Yt&n)===n&&(jt===4||jt===3&&(Yt&130023424)===Yt&&500>St()-Zm?Fs(e,0):Gm|=n),In(e,t)}function gk(e,t){t===0&&(e.mode&1?(t=Xu,Xu<<=1,!(Xu&130023424)&&(Xu=4194304)):t=1);var n=pn();e=fi(e,t),e!==null&&($a(e,t,n),In(e,n))}function nI(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),gk(e,n)}function rI(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(re(314))}r!==null&&r.delete(t),gk(e,n)}var mk;mk=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||bn.current)Tn=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Tn=!1,HR(e,t,n);Tn=!!(e.flags&131072)}else Tn=!1,lt&&t.flags&1048576&&wS(t,od,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ac(e,t),e=t.pendingProps;var i=Ho(t,on.current);zo(t,n),i=Vm(null,t,r,e,i,n);var s=qm();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Rn(r)?(s=!0,id(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,Dm(t),i.updater=Bd,t.stateNode=i,i._reactInternals=t,gg(t,r,e,n),t=vg(null,t,r,!0,s,n)):(t.tag=0,lt&&s&&jm(t),fn(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ac(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=sI(r),e=mr(r,e),i){case 0:t=yg(null,t,r,e,n);break e;case 1:t=xx(null,t,r,e,n);break e;case 11:t=yx(null,t,r,e,n);break e;case 14:t=vx(null,t,r,mr(r.type,e),n);break e}throw Error(re(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:mr(r,i),yg(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:mr(r,i),xx(e,t,r,i,n);case 3:e:{if(JS(t),e===null)throw Error(re(387));r=t.pendingProps,s=t.memoizedState,i=s.element,TS(e,t),ud(t,r,null,n);var o=t.memoizedState;if(r=o.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=Yo(Error(re(423)),t),t=wx(e,t,r,n,i);break e}else if(r!==i){i=Yo(Error(re(424)),t),t=wx(e,t,r,n,i);break e}else for(Nn=qi(t.stateNode.containerInfo.firstChild),Fn=t,lt=!0,vr=null,n=ES(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Vo(),r===i){t=hi(e,t,n);break e}fn(e,t,r,n)}t=t.child}return t;case 5:return bS(t),e===null&&fg(t),r=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,o=i.children,lg(r,i)?o=null:s!==null&&lg(r,s)&&(t.flags|=32),ZS(e,t),fn(e,t,o,n),t.child;case 6:return e===null&&fg(t),null;case 13:return ek(e,t,n);case 4:return Bm(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=qo(t,null,r,n):fn(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:mr(r,i),yx(e,t,r,i,n);case 7:return fn(e,t,t.pendingProps,n),t.child;case 8:return fn(e,t,t.pendingProps.children,n),t.child;case 12:return fn(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value,Ze(ld,r._currentValue),r._currentValue=o,s!==null)if(kr(s.value,o)){if(s.children===i.children&&!bn.current){t=hi(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var u=s.dependencies;if(u!==null){o=s.child;for(var d=u.firstContext;d!==null;){if(d.context===r){if(s.tag===1){d=ii(-1,n&-n),d.tag=2;var h=s.updateQueue;if(h!==null){h=h.shared;var c=h.pending;c===null?d.next=d:(d.next=c.next,c.next=d),h.pending=d}}s.lanes|=n,d=s.alternate,d!==null&&(d.lanes|=n),hg(s.return,n,t),u.lanes|=n;break}d=d.next}}else if(s.tag===10)o=s.type===t.type?null:s.child;else if(s.tag===18){if(o=s.return,o===null)throw Error(re(341));o.lanes|=n,u=o.alternate,u!==null&&(u.lanes|=n),hg(o,n,t),o=s.sibling}else o=s.child;if(o!==null)o.return=s;else for(o=s;o!==null;){if(o===t){o=null;break}if(s=o.sibling,s!==null){s.return=o.return,o=s;break}o=o.return}s=o}fn(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,zo(t,n),i=rr(i),r=r(i),t.flags|=1,fn(e,t,r,n),t.child;case 14:return r=t.type,i=mr(r,t.pendingProps),i=mr(r.type,i),vx(e,t,r,i,n);case 15:return KS(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:mr(r,i),Ac(e,t),t.tag=1,Rn(r)?(e=!0,id(t)):e=!1,zo(t,n),QS(t,r,i),gg(t,r,i,n),vg(null,t,r,!0,e,n);case 19:return tk(e,t,n);case 22:return GS(e,t,n)}throw Error(re(156,t.tag))};function yk(e,t){return H1(e,t)}function iI(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function er(e,t,n,r){return new iI(e,t,n,r)}function ny(e){return e=e.prototype,!(!e||!e.isReactComponent)}function sI(e){if(typeof e=="function")return ny(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Sm)return 11;if(e===km)return 14}return 2}function Ki(e,t){var n=e.alternate;return n===null?(n=er(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Mc(e,t,n,r,i,s){var o=2;if(r=e,typeof e=="function")ny(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Po:return zs(n.children,i,s,t);case wm:o=8,i|=8;break;case $p:return e=er(12,n,t,i|2),e.elementType=$p,e.lanes=s,e;case Dp:return e=er(13,n,t,i),e.elementType=Dp,e.lanes=s,e;case Bp:return e=er(19,n,t,i),e.elementType=Bp,e.lanes=s,e;case b1:return Hd(n,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case C1:o=10;break e;case T1:o=9;break e;case Sm:o=11;break e;case km:o=14;break e;case Mi:o=16,r=null;break e}throw Error(re(130,e==null?e:typeof e,""))}return t=er(o,n,t,i),t.elementType=e,t.type=r,t.lanes=s,t}function zs(e,t,n,r){return e=er(7,e,r,t),e.lanes=n,e}function Hd(e,t,n,r){return e=er(22,e,r,t),e.elementType=b1,e.lanes=n,e.stateNode={isHidden:!1},e}function up(e,t,n){return e=er(6,e,null,t),e.lanes=n,e}function cp(e,t,n){return t=er(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function oI(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hh(0),this.expirationTimes=Hh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hh(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function ry(e,t,n,r,i,s,o,u,d){return e=new oI(e,t,n,u,d),t===1?(t=1,s===!0&&(t|=8)):t=0,s=er(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dm(s),e}function lI(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ko,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function vk(e){if(!e)return ts;e=e._reactInternals;e:{if(Ks(e)!==e||e.tag!==1)throw Error(re(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Rn(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(re(171))}if(e.tag===1){var n=e.type;if(Rn(n))return vS(e,n,t)}return t}function xk(e,t,n,r,i,s,o,u,d){return e=ry(n,r,!0,e,i,s,o,u,d),e.context=vk(null),n=e.current,r=pn(),i=Xi(n),s=ii(r,i),s.callback=t??null,Qi(n,s,i),e.current.lanes=i,$a(e,i,r),In(e,r),e}function Vd(e,t,n,r){var i=t.current,s=pn(),o=Xi(i);return n=vk(n),t.context===null?t.context=n:t.pendingContext=n,t=ii(s,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Qi(i,t,o),e!==null&&(Sr(e,i,o,s),Rc(e,i,o)),o}function yd(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function _x(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function iy(e,t){_x(e,t),(e=e.alternate)&&_x(e,t)}function aI(){return null}var wk=typeof reportError=="function"?reportError:function(e){console.error(e)};function sy(e){this._internalRoot=e}qd.prototype.render=sy.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(re(409));Vd(e,t,null,null)};qd.prototype.unmount=sy.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Vs(function(){Vd(null,e,null,null)}),t[di]=null}};function qd(e){this._internalRoot=e}qd.prototype.unstable_scheduleHydration=function(e){if(e){var t=G1();e={blockedOn:null,target:e,priority:t};for(var n=0;n<zi.length&&t!==0&&t<zi[n].priority;n++);zi.splice(n,0,e),n===0&&J1(e)}};function oy(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Qd(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function Ax(){}function uI(e,t,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var h=yd(o);s.call(h)}}var o=xk(t,r,e,0,null,!1,!1,"",Ax);return e._reactRootContainer=o,e[di]=o.current,ka(e.nodeType===8?e.parentNode:e),Vs(),o}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var u=r;r=function(){var h=yd(d);u.call(h)}}var d=ry(e,0,!1,null,null,!1,!1,"",Ax);return e._reactRootContainer=d,e[di]=d.current,ka(e.nodeType===8?e.parentNode:e),Vs(function(){Vd(t,d,n,r)}),d}function Yd(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if(typeof i=="function"){var u=i;i=function(){var d=yd(o);u.call(d)}}Vd(t,o,e,i)}else o=uI(n,t,e,i,r);return yd(o)}X1=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Hl(t.pendingLanes);n!==0&&(Cm(t,n|1),In(t,St()),!(Ue&6)&&(Xo=St()+500,ls()))}break;case 13:Vs(function(){var r=fi(e,1);if(r!==null){var i=pn();Sr(r,e,1,i)}}),iy(e,1)}};Tm=function(e){if(e.tag===13){var t=fi(e,134217728);if(t!==null){var n=pn();Sr(t,e,134217728,n)}iy(e,134217728)}};K1=function(e){if(e.tag===13){var t=Xi(e),n=fi(e,t);if(n!==null){var r=pn();Sr(n,e,t,r)}iy(e,t)}};G1=function(){return qe};Z1=function(e,t){var n=qe;try{return qe=e,t()}finally{qe=n}};Gp=function(e,t,n){switch(t){case"input":if(Hp(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=zd(r);if(!i)throw Error(re(90));I1(r),Hp(r,i)}}}break;case"textarea":A1(e,n);break;case"select":t=n.value,t!=null&&Mo(e,!!n.multiple,t,!1)}};z1=Jm;$1=Vs;var cI={usingClientEntryPoint:!1,Events:[Ba,bo,zd,N1,F1,Jm]},Ml={findFiberByHostInstance:js,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},dI={bundleType:Ml.bundleType,version:Ml.version,rendererPackageName:Ml.rendererPackageName,rendererConfig:Ml.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:mi.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=U1(e),e===null?null:e.stateNode},findFiberByHostInstance:Ml.findFiberByHostInstance||aI,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var oc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oc.isDisabled&&oc.supportsFiber)try{Md=oc.inject(dI),Nr=oc}catch{}}Dn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cI;Dn.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!oy(t))throw Error(re(200));return lI(e,t,null,n)};Dn.createRoot=function(e,t){if(!oy(e))throw Error(re(299));var n=!1,r="",i=wk;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=ry(e,1,!1,null,null,n,!1,r,i),e[di]=t.current,ka(e.nodeType===8?e.parentNode:e),new sy(t)};Dn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(re(188)):(e=Object.keys(e).join(","),Error(re(268,e)));return e=U1(t),e=e===null?null:e.stateNode,e};Dn.flushSync=function(e){return Vs(e)};Dn.hydrate=function(e,t,n){if(!Qd(t))throw Error(re(200));return Yd(null,e,t,!0,n)};Dn.hydrateRoot=function(e,t,n){if(!oy(e))throw Error(re(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",o=wk;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=xk(t,null,e,1,n??null,i,!1,s,o),e[di]=t.current,ka(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new qd(t)};Dn.render=function(e,t,n){if(!Qd(t))throw Error(re(200));return Yd(null,e,t,!1,n)};Dn.unmountComponentAtNode=function(e){if(!Qd(e))throw Error(re(40));return e._reactRootContainer?(Vs(function(){Yd(null,null,e,!1,function(){e._reactRootContainer=null,e[di]=null})}),!0):!1};Dn.unstable_batchedUpdates=Jm;Dn.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Qd(n))throw Error(re(200));if(e==null||e._reactInternals===void 0)throw Error(re(38));return Yd(e,t,n,!1,r)};Dn.version="18.3.1-next-f1338f8080-20240426";function Sk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Sk)}catch(e){console.error(e)}}Sk(),S1.exports=Dn;var Wa=S1.exports;const fI=Jo(Wa),hI=Od({__proto__:null,default:fI},[Wa]);var kk,ly,Ox=Wa;ly=Qc.createRoot=Ox.createRoot,kk=Qc.hydrateRoot=Ox.hydrateRoot;const pI=Od({__proto__:null,get createRoot(){return ly},default:Qc,get hydrateRoot(){return kk}},[Qc]),gI={collection:void 0,manifest:void 0,range:void 0,canvas:void 0,annotation:void 0,annotationPage:void 0},ay=at.createContext(gI),rl=()=>b.useContext(ay);function Xd({value:e,children:t}){const n=rl(),r=b.useMemo(()=>({...n,...e}),[e,n]);return E.jsx(ay.Provider,{value:r,children:t})}function Ko({canvas:e,children:t}){return E.jsx(Xd,{value:{canvas:e},children:t})}function Aa(e){"@babel/helpers - typeof";return Aa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Aa(e)}function mI(e,t){if(Aa(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Aa(r)!="object")return r;throw TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yI(e){var t=mI(e,"string");return Aa(t)=="symbol"?t:t+""}function rn(e,t,n){return(t=yI(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const vI={},jx=e=>{let t,n=new Set,r=(c,p)=>{let m=typeof c=="function"?c(t):c;if(!Object.is(m,t)){let w=t;t=p??(typeof m!="object"||!m)?m:Object.assign({},t,m),n.forEach(y=>y(t,w))}},i=()=>t,s=()=>h,o=c=>(n.add(c),()=>n.delete(c)),u=()=>{(vI?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()},d={setState:r,getState:i,getInitialState:s,subscribe:o,destroy:u},h=t=e(r,i,d);return d},Pk=e=>e?jx(e):jx;function Ek(e){return{all:e||(e=new Map),on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(i){i(n)}),(r=e.get("*"))&&r.slice().map(function(i){i(t,n)})}}}function Oa(e){"@babel/helpers - typeof";return Oa=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Oa(e)}function xI(e,t){if(Oa(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Oa(r)!="object")return r;throw TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wI(e){var t=xI(e,"string");return Oa(t)=="symbol"?t:t+""}function Ni(e,t,n){return(t=wI(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Jr(e){return Array.isArray(e)?e:e?[e]:[]}function Dr(e){for(let t in e)(e[t]===void 0||e[t]===null)&&delete e[t];return e}function si(e){return typeof e=="string"?!1:e&&!e.type&&"source"in e?(e.type="SpecificResource",!0):!!e&&e.type==="SpecificResource"}function lc(...e){return t=>e.reduce((n,r)=>r(n),t)}const Mx=["Collection","Manifest","Canvas","AnnotationPage","AnnotationCollection","Annotation","ContentResource","Range","Service","Selector","Agent"];function SI(e,t){if(e==null)throw Error("Null or undefined is not a valid entity.");if(Array.isArray(e))throw Error("Array is not a valid entity");if(typeof e!="object"){if(t)return t;throw Error(`${typeof e} is not a valid entity`)}if(typeof e.type=="string"){let n=Mx.indexOf(e.type);if(n!==-1)return Mx[n]}if(e.profile)return"Service";throw Error("Resource type is not known")}var kI=class Ck{constructor(t,n={}){Ni(this,"traversals",void 0),Ni(this,"options",void 0),Ni(this,"_traverseManifest",lc(this.traverseManifestItems.bind(this),this.traverseNavPlace.bind(this),this.traverseLinking.bind(this),this.traverseDescriptive.bind(this),this.traverseLinkedCanvases.bind(this),this.traverseManifestStructures.bind(this),this.traverseInlineAnnotationPages.bind(this))),Ni(this,"_traverseCanvas",lc(this.traverseCanvasItems.bind(this),this.traverseLinking.bind(this),this.traverseDescriptive.bind(this),this.traverseLinkedCanvases.bind(this),this.traverseInlineAnnotationPages.bind(this))),Ni(this,"_traverseAnnotationPage",lc(this.traverseAnnotationPageItems.bind(this),this.traverseLinking.bind(this),this.traverseDescriptive.bind(this))),Ni(this,"_traverseRange",lc(this.traverseRangeRanges.bind(this),this.traverseLinking.bind(this),this.traverseDescriptive.bind(this),this.traverseLinkedCanvases.bind(this))),this.traversals={collection:[],manifest:[],canvas:[],annotationCollection:[],annotationPage:[],annotation:[],contentResource:[],choice:[],range:[],service:[],agent:[],specificResource:[],geoJson:[],...t},this.options={allowUndefinedReturn:!1,...n}}static all(t){return new Ck({collection:[t],manifest:[t],canvas:[t],annotationCollection:[t],annotationPage:[t],annotation:[t],contentResource:[t],choice:[t],range:[t],service:[t],geoJson:[t],specificResource:[t],agent:[t]})}traverseDescriptive(t){return t.thumbnail&&(t.thumbnail=Jr(t.thumbnail).map(n=>this.traverseType(n,{parent:t},this.traversals.contentResource))),t.provider&&(t.provider=t.provider.map(n=>this.traverseAgent(n,t))),t}traverseLinking(t){return t.seeAlso&&(t.seeAlso=Jr(t.seeAlso).map(n=>this.traverseType(n,{parent:t},this.traversals.contentResource))),t.service&&(t.service=Jr(t.service).map(n=>this.traverseService(n))),t.services&&(t.services=Jr(t.services).map(n=>this.traverseService(n,t))),t.logo&&(t.logo=Jr(t.logo).map(n=>this.traverseType(n,{parent:t},this.traversals.contentResource))),t.homepage&&(t.homepage=Jr(t.homepage).map(n=>this.traverseType(n,{parent:t},this.traversals.contentResource))),t.partOf&&(t.partOf=t.partOf.map(n=>typeof n=="string"||!n.type?this.traverseType(n,{parent:t},this.traversals.contentResource):n.type==="Canvas"?this.traverseType(n,{parent:t},this.traversals.canvas):n.type==="AnnotationCollection"?this.traverseType(n,{parent:t},this.traversals.annotationCollection):n.type==="Collection"?this.traverseType(n,{parent:t},this.traversals.collection):this.traverseType(n,{parent:t},this.traversals.contentResource))),t.start&&(si(t.start)?t.start=this.traverseSpecificResource(t.start,"Canvas",t):t.start=this.traverseType(t.start,{parent:t},this.traversals.canvas)),t.rendering&&(t.rendering=t.rendering.map(n=>this.traverseType(n,{parent:t},this.traversals.contentResource))),t.supplementary&&(t.supplementary=t.supplementary.map(n=>this.traverseType(n,{parent:t},this.traversals.contentResource))),t}traverseCollectionItems(t){return t.items&&t.items.map(n=>n.type==="Collection"?this.traverseCollection(n):this.traverseManifest(n)),t}traverseCollection(t,n){return this.traverseType(this.traverseDescriptive(this.traverseNavPlace(this.traverseInlineAnnotationPages(this.traverseLinking(this.traverseLinkedCanvases(this.traverseCollectionItems(t)))))),{parent:n},this.traversals.collection)}traverseGeoJson(t,n){return this.traverseType(t,{parent:n},this.traversals.geoJson)}traverseNavPlace(t){return t.navPlace&&(t.navPlace=this.traverseGeoJson(t.navPlace,t)),t}traverseManifestItems(t){return t.items&&(t.items=t.items.map(n=>this.traverseCanvas(n))),t}traverseManifestStructures(t){return t.structures&&(t.structures=t.structures.map(n=>this.traverseRange(n))),t}traverseManifest(t,n){return this.traverseType(this._traverseManifest(t),{parent:n},this.traversals.manifest)}traverseCanvasItems(t){return t.items=(t.items||[]).map(n=>this.traverseAnnotationPage(n,t)),t}traverseInlineAnnotationPages(t){return typeof t=="string"||!t||t.annotations&&(t.annotations=t.annotations.map(n=>this.traverseAnnotationPage(n,t))),t}traverseCanvas(t,n){return this.traverseType(this._traverseCanvas(t),{parent:n},this.traversals.canvas)}traverseAnnotationPageItems(t){return t.items&&(t.items=t.items.map(n=>this.traverseAnnotation(n,t))),t}traverseAnnotationPage(t,n){return this.traverseType(this._traverseAnnotationPage(t),{parent:n},this.traversals.annotationPage)}traverseAnnotationBody(t){return Array.isArray(t.body)?t.body=t.body.map(n=>this.traverseContentResource(n,t)):t.body&&(t.body=this.traverseContentResource(t.body,t)),t}traverseLinkedCanvases(t){return t.placeholderCanvas&&(t.placeholderCanvas=this.traverseCanvas(t.placeholderCanvas)),t.accompanyingCanvas&&(t.accompanyingCanvas=this.traverseCanvas(t.accompanyingCanvas)),t}traverseAnnotation(t,n){return this.traverseType(this.traverseLinking(this.traverseAnnotationBody(this.traverseDescriptive(t))),{parent:n},this.traversals.annotation)}traverseContentResourceLinking(t){return typeof t=="string"||!t||t&&t.service&&(t.service=Jr(t.service||[]).map(n=>this.traverseService(n,t))),t}traverseContentResource(t,n){return t.type==="Choice"&&(t.items=t.items.map(r=>this.traverseContentResource(r,t))),si(t)?this.traverseSpecificResource(t,"ContentResource"):this.traverseType(this.traverseInlineAnnotationPages(this.traverseContentResourceLinking(t)),{parent:n},this.traversals.contentResource)}traverseSpecificResource(t,n,r){let i=t.source;return typeof t.source=="string"&&(i={id:t.source,type:n||"unknown"}),this.traverseType({...t,source:n==="Canvas"||i.type==="Canvas"?this.traverseType(i,{parent:r},this.traversals.canvas):n==="ContentResource"?this.traverseContentResource(i,{parent:r}):this.traverseUnknown(i,{parent:r,typeHint:n})},{parent:r},this.traversals.specificResource)}traverseRangeRanges(t){return t.items&&(t.items=t.items.map(n=>typeof n=="string"?this.traverseCanvas({id:n,type:"Canvas"},t):si(n)?this.traverseSpecificResource(n,"Canvas",t):n.type==="Manifest"?this.traverseManifest(n,t):this.traverseRange(n,t))),t}traverseRange(t,n){return this.traverseType(this._traverseRange(t),{parent:n},this.traversals.range)}traverseAgent(t,n){return this.traverseType(this.traverseDescriptive(this.traverseLinking(t)),{parent:n},this.traversals.agent)}traverseType(t,n,r){return r.reduce((i,s)=>{let o=s(i,n);return o===void 0&&!this.options.allowUndefinedReturn?i:o},t)}traverseService(t,n){let r=Object.assign({},t);return r&&r.service&&(r.service=Jr(r.service).map(i=>this.traverseService(i))),this.traverseType(r,{parent:n},this.traversals.service)}traverseUnknown(t,{parent:n,typeHint:r}={}){let i=SI(t,r);switch(i){case"Collection":return this.traverseCollection(t,n);case"Manifest":return this.traverseManifest(t,n);case"Canvas":return this.traverseCanvas(t,n);case"AnnotationPage":return this.traverseAnnotationPage(t,n);case"Annotation":return this.traverseAnnotation(t,n);case"ContentResource":return this.traverseContentResource(t,n);case"Range":return this.traverseRange(t,n);case"Service":return this.traverseService(t,n);case"Agent":return this.traverseAgent(t,n);default:throw Error(`Unknown or unsupported resource type of ${i}`)}}};const Tk="http://library.stanford.edu/iiif/image-api/compliance.html#level0",bk="http://library.stanford.edu/iiif/image-api/compliance.html#level1",Rk="http://library.stanford.edu/iiif/image-api/compliance.html#level2",Ik="http://library.stanford.edu/iiif/image-api/conformance.html#level0",_k="http://library.stanford.edu/iiif/image-api/conformance.html#level1",Ak="http://library.stanford.edu/iiif/image-api/conformance.html#level2",Ok="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",jk="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",Mk="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",Lk="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",Nk="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",Fk="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",zk="http://iiif.io/api/image/1/level0.json",$k="http://iiif.io/api/image/1/profiles/level0.json",Dk="http://iiif.io/api/image/1/level1.json",Bk="http://iiif.io/api/image/1/profiles/level1.json",Uk="http://iiif.io/api/image/1/level2.json",Wk="http://iiif.io/api/image/1/profiles/level2.json",Hk="http://iiif.io/api/image/2/level0.json",Vk="http://iiif.io/api/image/2/profiles/level0.json",qk="http://iiif.io/api/image/2/level1.json",Qk="http://iiif.io/api/image/2/profiles/level1.json",Yk="http://iiif.io/api/image/2/level2.json",Xk="http://iiif.io/api/image/2/profiles/level2.json",Kk="level0",Gk="level1",Zk="level2",Jk="http://iiif.io/api/image/2/level0",eP="http://iiif.io/api/image/2/level1",tP="http://iiif.io/api/image/2/level2",Kd=[tP,Rk,Ak,Mk,Fk,Uk,Wk,Yk,Xk,Zk],uy=[...Kd,eP,bk,_k,jk,Nk,Dk,Bk,qk,Qk,Gk],nP=[Jk,eP,tP,Tk,bk,Rk,Ik,_k,Ak,Ok,jk,Mk,Lk,Nk,Fk,zk,$k,Dk,Bk,Uk,Wk,Hk,Vk,qk,Qk,Yk,Xk,Kk,Gk,Zk],PI=nP,rP=[Jk,Tk,Ik,Ok,Lk,zk,$k,Hk,Vk,Kk],EI={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},CI={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},TI={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]},Lx=["sc:Collection","sc:Manifest","sc:Canvas","sc:AnnotationList","oa:Annotation","sc:Range","sc:Layer","sc:Sequence","oa:Choice","Service","ContentResource"];function bI(e){if(e==null)throw Error("Null or undefined is not a valid entity.");if(Array.isArray(e))throw Error("Array is not a valid entity");if(typeof e!="object")throw Error(`${typeof e} is not a valid entity`);if(typeof e["@type"]=="string"){let t=Lx.indexOf(e["@type"]);if(t!==-1)return Lx[t]}if(e.profile)return"Service";if(e.format||e["@type"])return"ContentResource";throw Error("Resource type is not known")}var RI=class iP{constructor(t,n={}){Ni(this,"traversals",void 0),Ni(this,"options",void 0),this.traversals={collection:[],manifest:[],canvas:[],annotationList:[],sequence:[],annotation:[],contentResource:[],choice:[],range:[],service:[],layer:[],...t},this.options={convertPropsToArray:!0,mergeMemberProperties:!0,allowUndefinedReturn:!1,...n}}static all(t){return new iP({collection:[t],manifest:[t],canvas:[t],annotationList:[t],sequence:[t],annotation:[t],contentResource:[t],choice:[t],range:[t],service:[t],layer:[t]})}traverseCollection(t){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(t))),this.traversals.collection)}traverseCollectionItems(t){if(this.options.mergeMemberProperties){let n=[...(t.manifests||[]).map(s=>typeof s=="string"?{"@id":s,"@type":"sc:Manifest"}:s),...(t.collections||[]).map(s=>typeof s=="string"?{"@id":s,"@type":"sc:Collection"}:s),...t.members||[]],r=[],i=n.filter(s=>r.includes(s["@id"])?!1:(r.push(s["@id"]),!0));delete t.collections,delete t.manifests,t.members=i}return t.manifests&&(t.manifests=t.manifests.map(n=>this.traverseManifest(typeof n=="string"?{"@id":n,"@type":"sc:Manifest"}:n))),t.collections&&(t.collections=t.collections.map(n=>this.traverseCollection(typeof n=="string"?{"@id":n,"@type":"sc:Collection"}:n))),t.members&&(t.members=t.members.map(n=>typeof n=="string"?n:n["@type"]==="sc:Collection"?this.traverseCollection(n):n["@type"]==="sc:Manifest"?this.traverseManifest(n):this.traverseUnknown(n))),t}traverseManifest(t){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(t))),this.traversals.manifest)}traverseManifestItems(t){return t.sequences&&(t.sequences=t.sequences.map(n=>this.traverseSequence(n))),t.structures&&(t.structures=t.structures.map(n=>this.traverseRange(n))),t}traverseSequence(t){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(t))),this.traversals.sequence)}traverseSequenceItems(t){return t.canvases&&(t.canvases=t.canvases.map(n=>this.traverseCanvas(n))),t}traverseCanvas(t){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(t))),this.traversals.canvas)}traverseCanvasItems(t){return t.images&&(t.images=t.images.map(n=>this.traverseAnnotation(n))),t.otherContent&&(t.otherContent=t.otherContent.map(n=>this.traverseAnnotationList(n))),t}traverseRange(t){return t["@type"]!=="sc:Range"&&(t["@type"]="sc:Range"),this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(t))),this.traversals.range)}traverseRangeItems(t){if(this.options.mergeMemberProperties){let n=[...(t.ranges||[]).map(r=>typeof r=="string"?{"@id":r,"@type":"sc:Range"}:r),...(t.canvases||[]).map(r=>typeof r=="string"?{"@id":r,"@type":"sc:Canvas"}:r),...t.members||[]];delete t.ranges,delete t.canvases,t.members=n.length?n.map(r=>this.traverseUnknown(r)):void 0}return t}traverseAnnotationList(t){let n=typeof t=="string"?{"@id":t,"@type":"sc:AnnotationList"}:t;return this.traverseType(this.traverseDescriptive(this.traverseAnnotationListItems(n)),this.traversals.annotationList)}traverseAnnotationListItems(t){return t.resources&&(t.resources=t.resources.map(n=>this.traverseAnnotation(n))),t}traverseAnnotation(t){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(t))),this.traversals.annotation)}traverseAnnotationItems(t){return t.resource&&(Array.isArray(t.resource)?t.resource=t.resource.map(n=>this.traverseContentResource(n)):t.resource=this.traverseContentResource(t.resource)),t.on,t}traverseLayer(t){return this.traverseType(this.traverseLinking(this.traverseLayerItems(t)),this.traversals.layer)}traverseLayerItems(t){return t.otherContent&&(t.otherContent=t.otherContent.map(n=>this.traverseAnnotationList(n))),t}traverseChoice(t){return this.traverseType(this.traverseChoiceItems(t),this.traversals.choice)}traverseChoiceItems(t){return t.default&&t.default!=="rdf:nil"&&(t.default=this.traverseContentResource(t.default)),t.item&&t.item!=="rdf:nil"&&(t.item=t.item.map(n=>this.traverseContentResource(n))),t}traverseService(t){return this.traverseType(this.traverseLinking(t),this.traversals.service)}traverseContentResource(t){return t["@type"]==="oa:Choice"?this.traverseChoice(t):this.traverseType(this.traverseDescriptive(this.traverseLinking(t)),this.traversals.contentResource)}traverseUnknown(t){if(!t["@type"]||typeof t=="string")return t;switch(bI(t)){case"sc:Collection":return this.traverseCollection(t);case"sc:Manifest":return this.traverseManifest(t);case"sc:Canvas":return this.traverseCanvas(t);case"sc:Sequence":return this.traverseSequence(t);case"sc:Range":return this.traverseRange(t);case"oa:Annotation":return this.traverseAnnotation(t);case"sc:AnnotationList":return this.traverseAnnotationList(t);case"sc:Layer":return this.traverseLayer(t);case"Service":return this.traverseService(t);case"oa:Choice":return this.traverseChoice(t);case"ContentResource":return this.traverseContentResource(t)}return t.profile?this.traverseService(t):t}traverseImageResource(t){let n=Array.isArray(t),r=Array.isArray(t)?t:[t],i=[];for(let s of r)typeof s=="string"?i.push(this.traverseContentResource({"@id":s,"@type":"dctypes:Image"})):i.push(this.traverseContentResource(s));return!n&&!this.options.convertPropsToArray?i[0]:i}traverseDescriptive(t){return t.thumbnail&&(t.thumbnail=this.traverseImageResource(t.thumbnail)),t.logo&&(t.logo=this.traverseImageResource(t.logo)),t}traverseOneOrMoreServices(t){let n=Array.isArray(t),r=Array.isArray(t)?t:[t],i=[];for(let s of r)i.push(this.traverseService(s));return!n&&!this.options.convertPropsToArray?i[0]:i}traverseLinking(t){return t.related&&(t.related=this.traverseOneOrManyType(t.related,this.traversals.contentResource)),t.rendering&&(t.rendering=this.traverseOneOrManyType(t.rendering,this.traversals.contentResource)),t.service&&(t.service=this.traverseOneOrMoreServices(t.service)),t.seeAlso&&(t.seeAlso=this.traverseOneOrManyType(t.seeAlso,this.traversals.contentResource)),t.within&&(typeof t.within=="string"||(t.within=this.traverseOneOrManyType(t.within,this.traversals.contentResource))),t.startCanvas&&(typeof t.startCanvas=="string"?t.startCanvas=this.traverseType({"@id":t.startCanvas,"@type":"sc:Canvas"},this.traversals.canvas):t.startCanvas&&this.traverseType(t.startCanvas,this.traversals.canvas)),t.contentLayer&&(typeof t.contentLayer=="string"?t.contentLayer=this.traverseLayer({"@id":t.contentLayer,"@type":"sc:Layer"}):t.contentLayer=this.traverseLayer(t.contentLayer)),t}traverseOneOrManyType(t,n){if(!Array.isArray(t))if(this.options.convertPropsToArray)t=[t];else return this.traverseType(t,n);return t.map(r=>this.traverseType(r,n))}traverseType(t,n){return n.reduce((r,i)=>{let s=i(r);return s===void 0&&!this.options.allowUndefinedReturn?r:s},t)}};const II=["http://iiif.io/api/image/2/level1","http://iiif.io/api/image/2/level2","http://library.stanford.edu/iiif/image-api/compliance.html#level1","http://library.stanford.edu/iiif/image-api/compliance.html#level2","http://library.stanford.edu/iiif/image-api/conformance.html#level1","http://library.stanford.edu/iiif/image-api/conformance.html#level2","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2","http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1","http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2","http://iiif.io/api/image/1/level1.json","http://iiif.io/api/image/1/profiles/level1.json","http://iiif.io/api/image/1/level2.json","http://iiif.io/api/image/1/profiles/level2.json","http://iiif.io/api/image/2/level1.json","http://iiif.io/api/image/2/profiles/level1.json","http://iiif.io/api/image/2/level2.json","http://iiif.io/api/image/2/profiles/level2.json","level1","level2"],_g={attributionLabel:"Attribution",providerId:"http://example.org/provider",providerName:""};function _I(e){if(typeof e=="string")return[e];if(!e)return[];let t=Array.isArray(e)?e:[e],n=[];for(let r of t){if(typeof r=="string"){n.push(r);continue}n.push({"@language":r["@language"]||r.language,"@value":r["@value"]||r.value})}return n}function Ns(e,t="none"){if(!e)return{none:[""]};let n=_I(e),r={};for(let i of n){if(typeof i=="string"){r[t]=r[t]?r[t]:[],r[t].push(i||"");continue}if(!i["@language"]){r[t]=r[t]?r[t]:[],r[t].push(i["@value"]||"");continue}let s=i["@language"];r[s]=r[s]?r[s]:[],r[s].push(i["@value"]||"")}return Object.keys(r).length===0?{none:[""]}:r}function sP(e){if(Array.isArray(e))return sP(e.find(t=>typeof t=="string"));if(Kd.indexOf(e)!==-1)return"level2";if(II.indexOf(e)!==-1)return"level1";if(PI.indexOf(e)!==-1)return"level0";if(typeof e=="string")return e}function AI(e){let t=Array.isArray(e)?e:[e];for(let n of t)switch(n){case"http://iiif.io/api/image/2/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2":return"ImageService2";case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":return"ImageService1";case"http://iiif.io/api/annex/openannotation/context.json":return"ImageApiSelector"}}function OI(e){switch(e){case"http://iiif.io/api/image/2/level0.json":case"http://iiif.io/api/image/2/level1.json":case"http://iiif.io/api/image/2/level2.json":return"ImageService2";case"http://iiif.io/api/auth/1/kiosk":case"http://iiif.io/api/auth/1/login":case"http://iiif.io/api/auth/1/clickthrough":case"http://iiif.io/api/auth/1/external":case"http://iiif.io/api/auth/0/kiosk":case"http://iiif.io/api/auth/0/login":case"http://iiif.io/api/auth/0/clickthrough":case"http://iiif.io/api/auth/0/external":return"AuthCookieService1";case"http://iiif.io/api/auth/1/token":case"http://iiif.io/api/auth/0/token":return"AuthTokenService1";case"http://iiif.io/api/auth/1/logout":case"http://iiif.io/api/auth/0/logout":return"AuthLogoutService1";case"http://iiif.io/api/search/1/search":case"http://iiif.io/api/search/0/search":return"SearchService1";case"http://iiif.io/api/search/1/autocomplete":case"http://iiif.io/api/search/0/autocomplete":return"AutoCompleteService1"}}function Nx(e){for(let t of["sc","oa","dcterms","dctypes","iiif"])if(e.startsWith(`${t}:`))return e.slice(t.length+1);return e}const jI=["Collection","Manifest","Annotation","AnnotationPage","Range","Service"];function cy(e){let t=e["@id"]||e.id,n=e["@type"]||e.type,r=e.profile||void 0,i=e["@context"]||void 0;if(r){let s=OI(r);if(s)return s}if(i){let s=AI(i);if(s)return s}if(n){if(Array.isArray(n)){if(n.indexOf("oa:CssStylesheet")!==-1)return"CssStylesheet";if(n.indexOf("cnt:ContentAsText")!==-1)return"TextualBody";n=n[0]}for(let s of["sc","oa","dcterms","dctypes","iiif"])if(n.startsWith(`${s}:`)){n=n.slice(s.length+1);break}switch(n){case"Layer":return"AnnotationCollection";case"AnnotationList":return"AnnotationPage";case"cnt:ContentAsText":return"TextualBody"}}if(n&&jI.indexOf(n)!==-1)return n;if(e.format){if(e.format.startsWith("image/"))return"Image";if(e.format.startsWith("text/")||e.format==="application/pdf")return"Text";if(e.format.startsWith("application/"))return"Dataset"}return t&&(t.endsWith(".jpg")||t.endsWith(".png")||t.endsWith(".jpeg"))?"Image":n||"unknown"}const MI=/http(s)?:\/\/(creativecommons.org|rightsstatements.org)[^"'\\<\n]+/gm;function LI(e){let t=e.match(MI);return t?t[0]:e}function NI(e,t="Rights/License",n="none"){let r=null,i=[],s=Array.isArray(e)?e:[e];for(let o of s){let u=o?LI(o):void 0;if(u&&(u.indexOf("creativecommons.org")!==-1||u.indexOf("rightsstatements.org")!==-1)){r=u.startsWith("https://")?`http://${u.slice(8)}`:u;continue}u&&i.push({label:{[n]:[t]},value:{[n]:[u]}})}return[r,i]}const FI=["http://iiif.io/api/presentation/2/context.json","http://iiif.io/api/image/2/context.json","http://iiif.io/api/image/1/context.json","http://library.stanford.edu/iiif/image-api/1.1/context.json","http://iiif.io/api/search/1/context.json","http://iiif.io/api/search/0/context.json","http://iiif.io/api/auth/1/context.json","http://iiif.io/api/auth/0/context.json","http://iiif.io/api/annex/openannotation/context.json"];function zI(e){if(e){let t=Array.isArray(e)?e:[e],n=[];for(let r of t)r==="http://iiif.io/api/presentation/2/context.json"&&n.push("http://iiif.io/api/presentation/3/context.json"),FI.indexOf(r)===-1&&n.push(r);if(t.length)return n.length===1?n[0]:n}}function $I(e){return e?e.map(t=>({label:Ns(t.label),value:Ns(t.value)})):[]}let Fx=0;function oP(e,t){let n=encodeURI(e.id||e["@id"]||"").trim();return n&&t?`${n}/${t}`:n||(Fx++,`http://example.org/${e["@type"]}${t?`/${t}`:""}/${Fx}`)}function yi(e){let t=[...e.behavior||[]];e.viewingHint&&t.push(e.viewingHint);let n;return Array.isArray(e.motivation)?n=e.motivation.map(Nx):e.motivation&&(n=Nx(e.motivation)),{"@context":e["@context"]?zI(e["@context"]):void 0,id:(e["@id"]||oP(e)).trim(),type:cy(e),behavior:t.length?t:void 0,height:e.height?e.height:void 0,width:e.width?e.width:void 0,motivation:n,viewingDirection:e.viewingDirection,profile:e.profile,format:e.format?e.format:void 0,duration:void 0,timeMode:void 0}}function vi(e){let[t,n]=NI(e.license),r=[...e.metadata?$I(e.metadata):[],...n];return{rights:t,metadata:r.length?r:void 0,label:e.label?Ns(e.label):void 0,requiredStatement:e.attribution?{label:Ns(_g.attributionLabel),value:Ns(e.attribution)}:void 0,navDate:e.navDate,summary:e.description?Ns(e.description):void 0,thumbnail:DI(e.thumbnail)}}function DI(e){return e&&(Array.isArray(e)?e:[e]).map(n=>typeof n=="string"?{id:n,type:"Image"}:(n.type==="unknown"&&(n.type="Image"),n))}function BI(e){if(!e.within)return;let t=Array.isArray(e.within)?e.within:[e.within],n=[];for(let r of t)if(typeof r=="string"){if(r)switch(e["@type"]){case"sc:Manifest":n.push({id:r,type:"Collection"});break}}else r["@id"]&&n.push({id:r["@id"],type:cy(r)});return n.length?n:void 0}function as(e){let t=e.related?Array.isArray(e.related)?e.related:[e.related]:[],n=e.contentLayer;return{provider:e.logo||t.length?[{id:_g.providerId,type:"Agent",homepage:t.length?[t[0]]:void 0,logo:e.logo?Array.isArray(e.logo)?e.logo:[e.logo]:void 0,label:Ns(_g.providerName)}]:void 0,partOf:BI(e),rendering:e.rendering,seeAlso:e.seeAlso,start:e.startCanvas,service:e.service?Jr(e.service):void 0,supplementary:n?[n]:void 0}}function UI(e){return{chars:e.chars,format:e.format?e.format:void 0,language:e.language}}function dp(e,t){return e?typeof e=="string"?{id:e,type:t}:typeof(e==null?void 0:e["@id"])=="string"?{id:e["@id"],type:t}:typeof e.id=="string"?{id:e.id,type:t}:null:null}function WI(e){let t={};if(e.first){let n=dp(e.first,"Collection");n&&(t.first=n)}if((e.total||e.total===0)&&(t.total=e.total),e.prev){let n=dp(e.prev,"Collection");n&&(t.prev=n)}if(e.next){let n=dp(e.next,"Collection");n&&(t.next=n)}return t}function HI(e){let t=[];for(let n of e){let r={...n};r.items&&r.items.length===0&&delete r.items,t.push(r)}return t}function VI(e){return Dr({...yi(e),...vi(e),...as(e),...WI(e),items:HI(e.members)})}function qI(e){let t=[],n=[],r,i;for(let o of e.sequences||[])o.canvases.length&&t.push(...o.canvases),o.behavior&&n.push(...o.behavior),o.viewingDirection&&(i=o.viewingDirection),o.startCanvas&&(r=o.startCanvas);let s=yi(e);return n.length&&(s.behavior?s.behavior.push(...n):s.behavior=n),Dr({...s,...vi(e),...as(e),viewingDirection:i,start:r,items:t,structures:QI(e.structures)})}function QI(e){if(!e)return e;let t=new Map;for(let r of e)t.set(r.id,r);let n=[];for(let r of e)if(r.items){let i=r.items.map(s=>typeof s=="string"?(n.push(s),t.get(s)||s):s&&s.id?(n.push(s.id),t.get(s.id)||s):s);r.items=i}return e.filter(r=>n.indexOf(r.id)===-1)}function YI(e){return Dr({...yi(e),...vi(e),...as(e),annotations:e.otherContent&&e.otherContent.length?e.otherContent:void 0,items:e.images&&e.images.length?[{id:oP(e,"annotation-page"),type:"AnnotationPage",items:e.images}]:void 0})}function XI(e){return Dr({...yi(e),...vi(e),...as(e),items:e.resources&&e.resources.length?e.resources:void 0})}function KI(e){return!e.canvases||e.canvases.length===0?{canvases:[],behavior:[]}:{canvases:e.canvases,behavior:e.viewingHint?[e.viewingHint]:[],viewingDirection:e.viewingDirection,startCanvas:e.startCanvas}}function GI(e){function t(n){if(Array.isArray(n)){if(n.length>1)return{type:"List",items:n.map(t)};n=n[0]}if(typeof n=="string")return encodeURI(n).trim();if("@type"in n){let r;if(typeof n.full=="string")r=n.full;else if(n.full["@type"]==="dctypes:Image")r={id:n.full["@id"],type:"Image"};else if(n.full["@type"]==="sc:Canvas")r={id:n.full["@id"],type:"Canvas"};else throw Error(`Unsupported source type on annotation: ${n.full["@type"]}`);return{type:"SpecificResource",source:r,selector:Ag(n.selector)}}else return encodeURI(n["@id"]).trim()}return Dr({...yi(e),...vi(e),...as(e),target:t(e.on),body:Array.isArray(e.resource)?e.resource.map(zx):zx(e.resource)})}function zx(e){return e.type==="Choice"?e:lP(e)}function lP(e){let t=e;return Dr({...yi(t),...vi(t),...as(t),...UI(t)})}function ZI(e){let t=[];return e.default&&e.default!=="rdf:nil"&&t.push(e.default),e.item&&e.item!=="rdf:nil"&&t.push(...e.item),Dr({...yi(e),...vi(e),items:t})}function JI(e){return Dr({...yi(e),...vi(e),...as(e),items:e.members})}function e_(e){let{"@id":t,"@type":n,"@context":r,profile:i,...s}=e,o={};return t&&(o["@id"]=t),o["@type"]=cy(e),o["@type"]==="unknown"&&(r&&r.length&&(o["@context"]=r),o["@type"]="Service"),i&&(o.profile=sP(i)),Dr({...o,...s})}function t_(e){return Dr({...yi(e),...vi(e),...as(e)})}const n_=new RI({collection:[VI],manifest:[qI],canvas:[YI],annotationList:[XI],sequence:[KI],annotation:[GI],contentResource:[lP],choice:[ZI],range:[JI],service:[e_],layer:[t_]});function r_(e){return e&&e["@context"]&&(e["@context"]==="http://iiif.io/api/presentation/2/context.json"||e["@context"].indexOf("http://iiif.io/api/presentation/2/context.json")!==-1||e["@context"]==="http://www.shared-canvas.org/ns/context.json")||e["@context"]==="http://iiif.io/api/image/2/context.json"||e["@id"]&&e["@type"]==="sc:Collection"||e["@id"]&&e["@type"]==="sc:Manifest"?(e["@context"]||(e["@context"]="http://iiif.io/api/presentation/2/context.json"),n_.traverseUnknown(e)):e}function Ag(e){if((Array.isArray(e["@type"])&&e["@type"].includes("oa:SvgSelector")||e["@type"]=="oa:SvgSelector")&&("chars"in e||"value"in e))return{type:"SvgSelector",value:"chars"in e?e.chars:e.value};if(e["@type"]==="oa:FragmentSelector")return{type:"FragmentSelector",value:e.value};if(e["@type"]==="oa:Choice")return[Ag(e.default),...(Array.isArray(e.item)?e.item:[e.item]).map(Ag)];if(e["@type"]=="iiif:ImageApiSelector")return{type:"ImageApiSelector",region:"region"in e?e.region:void 0,rotation:"rotation"in e?e.rotation:void 0};throw Error(`Unsupported selector type: ${e["@type"]}`)}function Gd(e,t){let n="unknown";if(!e)return;if(typeof e=="string")return{id:e,type:n};if(si(e))return Gd(e.source);let r=e.type||e["@type"],i=e.id||e["@id"];if(r&&r.indexOf(":")!==-1&&(r=r.split(":").pop()),i&&r)return{id:i,type:r}}const ia={},At="iiif-parser:hasPart",pi="iiif-parser:partOf",sa="iiif-parser:isExternal",xr="__$UNSET$__",aP="__$UNWRAP$__",Se=[];Object.freeze(Se),Object.freeze(ia);function i_(e){if(e===ia||Object.keys(e).length===0)return!0;for(let t in e)return!1;return!0}function dy(e,t){if(t&&t["@explicit"]){let n={},r=Object.keys(t);for(let i of r)i===pi||i==="@explicit"||(i_(t[i])?n[i]=e[i]:n[i]=t[i]);return n}return e}function uP(e,t,n){let r=Gd(t);if(!r)return[void 0,void 0];let i=e.requests[r.id],s=r.type||e.mapping[r.id];if(!s||i&&i.resourceUri&&(!e.entities[s]||!e.entities[s][i.resourceUri]))return[void 0,void 0];let o=e.entities[s][i?i.resourceUri:r.id];if(r.type&&!o)return uP(e,{id:r.id},n);if(o&&o[At]){let u=o[At].find(h=>n?h[pi]===n.id:h[pi]===o.id);return[dy(o,u),o]}return[o,o]}const s_={id:"https://iiif-parser/annotation-page",type:"AnnotationPage",behavior:Se,label:null,thumbnail:Se,summary:null,requiredStatement:null,metadata:Se,rights:null,provider:Se,items:Se,seeAlso:Se,homepage:Se,rendering:Se,service:Se},o_={id:"https://iiif-parser/empty-canvas",type:"Canvas",label:null,behavior:Se,thumbnail:Se,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:Se,rights:null,navDate:null,provider:Se,items:Se,annotations:Se,seeAlso:Se,homepage:Se,partOf:Se,rendering:Se,service:Se,duration:0,height:0,width:0},l_={id:"https://iiif-parser/empty-collection",type:"Collection",label:null,viewingDirection:"left-to-right",behavior:Se,thumbnail:Se,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:Se,rights:null,navDate:null,provider:Se,items:Se,annotations:Se,seeAlso:Se,homepage:Se,partOf:Se,rendering:Se,service:Se,services:Se},a_={id:"https://iiif-parser/empty-manifest",type:"Manifest",annotations:Se,behavior:Se,homepage:Se,items:Se,label:null,metadata:Se,navDate:null,provider:Se,partOf:Se,accompanyingCanvas:null,placeholderCanvas:null,rendering:Se,requiredStatement:null,rights:null,seeAlso:Se,service:Se,services:Se,start:null,structures:Se,summary:null,thumbnail:Se,viewingDirection:"left-to-right"},u_={id:"https://iiif-parser/empty-canvas",type:"Range",label:null,behavior:Se,thumbnail:Se,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:Se,rights:null,navDate:null,provider:Se,items:Se,annotations:Se,seeAlso:Se,homepage:Se,partOf:Se,rendering:Se,service:Se,start:null,supplementary:null,viewingDirection:"left-to-right"},c_={id:"https://iiif-parser/empty-agent",type:"Agent",label:{},logo:Se,seeAlso:Se,homepage:Se},d_={id:"https://iiif-parser/empty-service",type:"UnknownService"};function Lc(e,t={}){if(Array.isArray(e))return Lc(e[0]);if(typeof e=="string"){let[n,r]=e.split("#");return r?{type:"SpecificResource",source:{id:n,type:t.typeHint||"Unknown"},selector:{type:"FragmentSelector",value:r}}:{type:"SpecificResource",source:{id:n,type:t.typeMap&&t.typeMap[n]||t.typeHint||"Unknown"}}}if(e.type==="Choice"||e.type==="List"||e.type==="Composite"||e.type==="Independents")return Lc(e.items[0]);if(!e.type&&"source"in e&&(e.type="SpecificResource"),e.type==="SpecificResource"){e.source.type==="Canvas"&&e.source.partOf&&typeof e.source.partOf=="string"&&(e.source.partOf=[{id:e.source.partOf,type:"Manifest"}]);let n=typeof e.source=="string"?e.source:e.source.id;if(n!=null&&n.includes("#")){let r=Lc(n,t);r&&(e.selector=r.selector,e.source=r.source)}return e.selector?{...e,type:"SpecificResource",source:e.source,selector:e.selector}:{...e,type:"SpecificResource",source:e.source}}if(e.id){e.type==="Canvas"&&e.partOf&&typeof e.partOf=="string"&&(e.partOf=[{id:e.partOf,type:"Manifest"}]);let[n,r]=e.id.split("#");return r?{type:"SpecificResource",source:{...e,id:n},selector:{type:"FragmentSelector",value:r}}:{type:"SpecificResource",source:{...e,id:n}}}return{type:"SpecificResource",source:e}}function f_(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}function cP(e,t){if(typeof e=="string")return{id:e,type:t};if(!e.id)throw Error(`Invalid resource does not have an ID (${JSON.stringify(e)}, ${t})`);return e}function h_(e,t){return(n,r)=>{let i=e[n]?e[n]:{};return(s,o)=>{let u=cP(s,r||n);return u&&u.id&&n?(i[u.id]=i[u.id]?jg(i[u.id],u,{parent:o.parent,isTopLevel:t.id===u.id}):jg({id:u.id,type:u.type},u,{parent:o.parent,isTopLevel:t.id===u.id}),{id:u.id,type:n==="ContentResource"?n:u.type}):u}}}function Og(e,t,n){if(!t)return e;if(Array.isArray(e)){if(!Array.isArray(t))throw Error("Cannot merge array with non-array");let r=[...e];for(let i of t)if(i["@id"]&&!i.id&&(i.id=i["@id"]),i["@type"]&&!i.type&&(i.type=i["@type"]),i!=null)if(Array.isArray(i))r.push(i);else if(typeof i=="object"&&i.id&&i.type){let s=r.findIndex(o=>o.id===i.id&&o.type===i.type);s>=0&&(r[s]=Og(r[s],i))}else e.indexOf(i)===-1&&r.push(i);return r}else if(typeof e=="object"){if(Array.isArray(t)||typeof t!="object")throw Error("Cannot merge object with non-object");let r={...e},i=[],s=[],o=Object.keys(e).filter(h=>h!==At&&h!=="id"&&h!=="type"),u={},d={};for(let[h,c]of Object.entries(t)){if(h===At||h==="id"||h==="type")continue;let p=r[h];p===c?s.push(h):p===Se||!p?(i.push(h),r[h]=c):(p&&c&&(u[h]=p,d[h]=c),r[h]=Og(p,c),r[h]===u[h]&&(s.push(h),delete u[h]))}if(n&&(n.parent&&n.parent.id||n.isTopLevel)){let h=[],c={};if(n.parent?c[pi]=n.parent.id:n.isTopLevel&&(c[pi]=e.id),r[At]&&r[At].length){let p=!(r[At]||[]).find(w=>w["@explicit"]),m=i.length>0||s.length!==o.length;if(p&&m)for(let w of r[At]){let y={...w},S=Object.keys(u);if(y){y["@explicit"]=!0;for(let C of o)C!==At&&(y[C]=ia);for(let C of S)y[C]=u[C]}h.push(y)}else h.push(...r[At]);if(m){let w=Object.keys(d);c["@explicit"]=!0;for(let y of i)c[y]=ia;for(let y of s)c[y]=ia;for(let y of w)c[y]=d[y]}}c.id=r.id,c.type=r.type,h.push(c),r[At]=h}return r}else if(e)return e;return t}function jg(e,t,n){if(typeof e=="string")return e;if(t.id!==e.id||t.type!==e.type){if(t.type==="ImageService3")return t;if(e.type==="ImageService3")return e;throw Error(`Can only merge entities with identical identifiers and type! ${t.type}(${t.id}) => ${e.type}(${e.id})`)}return Og({...e},t,n)}function p_(e){return(t,n)=>r=>{let{id:i,type:s}=cP(r,n||t);if(i===void 0)throw Error("Found invalid entity without an ID.");return t==="ContentResource"||t==="Service"?e[i]=t:e[i]=s,r}}function g_(e){let t=Object.assign({},e);if(t["@id"]&&(t.id=t["@id"]),t["@type"]&&(t.type=t["@type"]),t.service){let n=[];t.service=Array.isArray(t.service)?t.service:[t.service];for(let r of t.service)n.push({id:r["@id"]||r.id,type:r["@type"]||r.type});t.service=n}return Object.assign({},d_,t)}function m_(e){return t=>{e.Service=e.Service?e.Service:{};let n=t.id||t["@id"],r=g_(t);return r&&r.id&&(e.Service[r.id]?e.Service[n]=jg(e.Service[n],r):e.Service[n]=r),t}}function y_(e){let t=JSON.stringify(e),n=5381,r=t.length;for(;r;)n=n*33^t.charCodeAt(--r);let i=n>>>0,s=i.toString(16);return s.length%2?"0"+s:s}function fp(e){return t=>typeof t=="string"?{id:t,type:e}:t.id?t.type?t:{type:e,...t}:{id:`vault://${y_(t)}`,type:e,...t}}function mo(e){return t=>({...e,...t})}function Ll(e){return Array.isArray(e)?e:[e]}function v_(e){return e.body&&(e.body=Ll(e.body)),e.seeAlso&&(e.seeAlso=Ll(e.seeAlso)),e.audience&&(e.audience=Ll(e.audience)),e.accessibility&&(e.accessibility=Ll(e.accessibility)),e.motivation&&(e.motivation=Ll(e.motivation)),e}function dP(e,{typeHint:t,partOfTypeHint:n}={}){if(typeof e=="string"&&(e={id:e,type:t||"unknown"}),si(e))return typeof e.source=="string"&&(e.source={id:e.source,type:t||"unknown"}),e.source.type==="Canvas"&&e.source.partOf&&typeof e.source.partOf=="string"&&(e.source.partOf=[{id:e.source.partOf,type:n||"Manifest"}]),e;let r;if((e.id||"").indexOf("#")!==-1){let[i,s]=(e.id||"").split("#");e.id=i,s&&(r={type:"FragmentSelector",value:s})}return{type:"SpecificResource",source:e,selector:r}}function x_(e){let t=Object.assign({},e);return e&&e.items&&(t.items=e.items.map(n=>typeof n=="string"||n.type==="Canvas"?dP(n):n)),t}function w_(e){let t=Object.assign({},e);return t.start?(t.start=dP(t.start,{typeHint:"Canvas"}),t):e}function S_(e){let t=Object.assign({},e);return t.target?(t.target=Lc(t.target,{typeHint:"Canvas"}),t):e}function k_(e){return e}function hp(e){return e.items===void 0&&(e[sa]=!0),e}function P_(e){let t=r_(e),n=f_(),r={},i=h_(n,t),s=p_(r),o=new kI({collection:[hp,mo(l_),s("Collection"),i("Collection")],manifest:[hp,mo(a_),w_,s("Manifest"),i("Manifest")],canvas:[mo(o_),s("Canvas"),i("Canvas")],annotationPage:[hp,fp("AnnotationPage"),mo(s_),s("AnnotationPage"),i("AnnotationPage")],annotation:[fp("Annotation"),v_,S_,s("Annotation"),i("Annotation")],contentResource:[fp("ContentResource"),s("ContentResource"),i("ContentResource")],range:[mo(u_),x_,s("Range","Canvas"),i("Range","Canvas")],agent:[mo(c_),s("Agent"),i("Agent")],specificResource:[k_],service:[m_(n)]}),u=o.traverseUnknown(t);return{entities:n,resource:u,mapping:r}}function E_(e){let t={};for(let[n,r]of e){if(n===aP&&r!==xr)return r;r!==xr&&r!=null&&(t[n]=r)}return t}function C_(e,t,n){if(!t.type||!t.id)throw Error("Unknown entity");if(!n[t.type])throw Error(`Serializer not found for ${t.type}`);function r(i,s,o=0){let u=n[i.type];if(!u)return xr;if(o>20)throw Error("Circular reference: "+i.id+" "+i.type);let[d,h]=uP(e,i.type?i:i.id,s)||(i.id&&i.type?i:null);if(!d)return xr;let c=u(d,e,{parent:s,isTopLevel:t.id===i.id,fullResource:h}),p=c.next();for(;!p.done;){let m=p.value,w=xr;if(m)if(Array.isArray(m)){let y=[];for(let S of m)y.push(r(S,i,o+1));w=y}else w=r(m,i,o+1);p=c.next(w)}return p.value===xr?xr:E_(p.value)}return r(t)}function oa(e,{allowSourceString:t=!0,allowString:n=!1,allowedStringType:r}={}){let i=s=>{if(t&&s&&s.source&&typeof s.source!="string"){let o=Object.keys(s.source);if(s.source.id&&s.source.type&&o.length===2)return{...s,source:s.source.id}}return s};if(e){if(e.source&&e.source.partOf)return i(e);let s=Object.keys(e);if(s.length===2&&e.type&&e.source||s.length===3&&e.type&&e.source&&s.indexOf("selector")!==-1&&!e.selector)return n&&(!r||r===e.source.type)?e.source.id:e.source.type==="ContentResource"?{type:"SpecificResource",source:e.source.id}:e.source;if(e.selector&&!Array.isArray(e.selector)&&typeof e.selector!="string"&&e.selector.type==="FragmentSelector"){let o=`${e.source.id}#${e.selector.value}`;return n?o:{id:o,type:e.source.type}}}return i(e)}function xo(e){if(!e)return;let t=Object.keys(e);if(t.length!==0){if(t.length===1){let n=t[0];if(!n)return"";let r=(e[n]||[]).join("");return n==="@none"||n==="none"||n==="en"?r:{"@language":n,"@value":r}}return t.map(n=>({"@language":n,"@value":(e[n]||[]).join("")}))}}function fP(e){return Array.isArray(e)?e.map(t=>fP(t)):typeof e=="string"?e:e.type&&e.type==="Canvas"?e.id:e}function Gi(e,t=!1){if(e)return e.length>1&&!t?e:e[0]||void 0}function T_(e){if(e){if(typeof e=="string")return{"@id":e};if("@id"in e){let t={...e};return delete t["@type"],t}return{"@context":"http://iiif.io/api/image/2/context.json","@id":e.id,profile:`http://iiif.io/api/image/2/profiles/${e.profile}.json`}}}function Ss(e,t){return[["@id",e.id],["@type",t],["format",e.format],["height",e.height],["width",e.width],["viewingDirection",e.viewingDirection==="left-to-right"?void 0:e.viewingDirection],["license",e.license?e.license:void 0]]}function*ks(e){let t=e.provider?yield e.provider[0]:void 0;return[["label",xo(e.label)],["metadata",e.metadata&&e.metadata.length?e.metadata.map(n=>({label:xo(n.label)||"",value:xo(n.value)||""})):void 0],["description",xo(e.summary)],["thumbnail",Gi(yield e.thumbnail)],["navDate",e.navDate],["logo",t?Gi(t.logo):void 0],["homepage",t?t.homepage:void 0],["attribution",e.requiredStatement?xo(e.requiredStatement.value):void 0]]}function*Nl(e){let t=e.start&&e.start.type&&e.start.type==="SpecificResource"?oa(e.start):e.start;return[["seeAlso",Gi(yield e.seeAlso)],["service",Gi((e.service||[]).map(T_))],["rendering",Gi(yield e.rendering)],["startCanvas",t?t.id:void 0]]}function b_(e){return e.type==="SpecificResource"}function R_(e){return e&&e.type==="FragmentSelector"}function I_(e){if(e&&b_(e)){let t=e.id,n=e.selector?Array.isArray(e.selector)?e.selector[0]:e.selector:void 0;return R_(n)&&(t+="#"+n.value),t}return e==null?void 0:e.id}const __={Manifest:function*(e,t,{isTopLevel:n}){return[...n?[["@context","http://iiif.io/api/presentation/2/context.json"]]:[],...Ss(e,"sc:Manifest"),...yield*ks(e),...yield*Nl(e),["sequences",[{"@id":`${e.id}/sequence0`,"@type":"sc:Sequence",canvases:yield e.items}]],["structures",yield e.structures]]},Canvas:function*(e){let t=yield e.items,n=t[0];return[...Ss(e,"sc:Canvas"),...yield*ks(e),...yield*Nl(e),["images",n?[n.resources]:void 0],["annotations",e.annotations&&e.annotations.length?Gi(yield e.annotations):void 0]]},AnnotationPage:function*(e){return[...Ss(e,"sc:AnnotationList"),...yield*ks(e),["resources",e.items&&e.items.length?Gi(yield e.items):void 0]]},Annotation:function*(e){return[["@id",e.id],["@type","oa:Annotation"],["motivation","sc:painting"],["on",fP(e.target)],["resource",Gi(yield e.body,!0)]]},ContentResource:function*(e){switch(e.type){case"Image":return[...Ss(e,"dctypes:Image"),...yield*ks(e),...yield*Nl(e)];case"Text":case"Dataset":default:return[...Ss(e,void 0),...yield*ks(e)]}},AnnotationCollection:function*(e){return[["@id",e.id],["@type","sc:Layer"],["label",xo(e.label)]]},Collection:function*(e){return[...Ss(e,"sc:Collection"),...yield*ks(e),...yield*Nl(e),["members",yield*e.items]]},Range:function*(e){let t=[],n=[];if(e.items)for(let r of e.items){let i=r.type==="SpecificResource"?r.source:r;if(i){let s=yield i;t.push({"@id":I_(r),"@type":i.type,label:s?s.label:void 0,within:e.id}),i.type==="Canvas"&&n.push(i.id)}}return[...Ss(e,"sc:Range"),...yield*ks(e),...yield*Nl(e),["canvases",n.length===t.length?n:void 0],["members",n.length===t.length?void 0:t]]}};function Ps(e){var t;return[["id",(t=e.id)!=null&&t.startsWith("vault://")?void 0:e.id],["type",e.type],["format",e.format],["profile",e.profile],["height",e.height||void 0],["width",e.width||void 0],["duration",e.duration||void 0],["viewingDirection",e.viewingDirection==="left-to-right"?void 0:e.viewingDirection],["behavior",e.behavior&&e.behavior.length?e.behavior:void 0],["timeMode",e.timeMode],["motivation",Array.isArray(e.motivation)?e.motivation[0]:e.motivation],[At,xr]]}function Ct(e){if(e===xr||!e||e.length===0)return;let t=e.filter(n=>n!==xr);if(t.length!==0)return t}function hP(e){if(e&&e.type&&e.type==="ImageService2"){let{id:t,type:n,profile:r,...i}=e,s=typeof r=="string"?r:Array.isArray(r)?r.find(o=>typeof o=="string"):"";return{"@id":t,"@type":n,profile:s?s.startsWith("http")?s:`http://iiif.io/api/image/2/${s}.json`:"http://iiif.io/api/image/2/level0.json",...i}}return e}function $x(e){if(Array.isArray(e)||(e=e?[e]:[]),!(!e||e.length===0))return e.map(hP)}function*_i(e){return[["label",e.label],["metadata",Ct(e.metadata)],["summary",e.summary],["requiredStatement",e.requiredStatement],["rights",Array.isArray(e.rights)?e.rights[0]||void 0:e.rights||void 0],["navDate",e.navDate],["language",e.language],["thumbnail",Ct(yield e.thumbnail)],["placeholderCanvas",yield e.placeholderCanvas],["accompanyingCanvas",yield e.accompanyingCanvas],["provider",Ct(yield e.provider)]]}function*Ai(e,t){let n=[];for(let r of e.partOf||[])r.type==="Manifest"&&t.type==="Manifest"||n.push(yield r);return[["seeAlso",Ct(yield e.seeAlso)],["service",Ct($x(e.service))],["services",Ct($x(e.services))],["rendering",Ct(yield e.rendering)],["supplementary",Ct(yield e.supplementary)],["homepage",Ct(yield e.homepage)],["logo",Ct(yield e.logo)],["partOf",Ct(n)],["start",e.start?oa(e.start):e.start]]}const A_={Manifest:function*(e,t,{isTopLevel:n}){if(!n)return[...Ps(e),...yield*_i(e),["navPlace",e.navPlace]];let r="http://iiif.io/api/presentation/3/context.json";return(e.navPlace||Dx(e))&&(r=["http://iiif.io/api/presentation/3/context.json","http://iiif.io/api/extension/navplace/context.json"]),[["@context",e["@context"]?e["@context"]:r],...Ps(e),...yield*_i(e),...yield*Ai(e),["items",yield e.items],["structures",Ct(yield e.structures)],["annotations",Ct(yield e.annotations)],["navPlace",e.navPlace]]},Canvas:function*(e,t,{parent:n}){return n&&n.type!=="Manifest"&&n.type!=="Canvas"?[["id",e.id]]:[...Ps(e),...yield*_i(e),...yield*Ai(e,n),["items",yield e.items],["annotations",Ct(yield e.annotations)],["navPlace",e.navPlace]]},Agent:function*(e){return[["id",e.id],["type","Agent"],["label",e.label],...yield*Ai(e)]},AnnotationPage:function*(e){var r;let t=Object.entries(e).map(([i,s])=>[i,Array.isArray(s)?Ct(s):s]).filter(([i,s])=>i!=="items"&&i!=="id"&&i!==At&&i!==pi&&i!==sa),n=yield e.items;return[["id",(r=e.id)!=null&&r.startsWith("vault://")?void 0:e.id],...t,...yield*Ai(e),["items",n.length||e[sa]===!1?n:xr]]},Service:function*(e){return[[aP,hP(e)]]},Annotation:function*(e){let t=Object.entries(e).map(([r,i])=>r==="motivation"?[r,Array.isArray(i)?i[0]:i]:r==="target"?[r,oa(i,{allowString:!0,allowSourceString:!0,allowedStringType:"Canvas"})]:[r,Array.isArray(i)?Ct(i):i]).filter(([r])=>r!=="body"&&r!==At&&r!==sa),n;if(Array.isArray(e.body)){let r=[];for(let i of e.body)if(i&&si(i)){let s={...i};i.source.type==="Canvas"?s.source=i.source:s.source=yield i.source,r.push(oa(s,{allowSourceString:!0}))}else r.push(yield i);n=r}else e.body&&si(e.body)?(n={...e.body},n.source=yield e.body.source):n=yield e.body;return[...t,...yield*_i(e),...yield*Ai(e),["body",n.length===1?n[0]:n]]},ContentResource:function*(e){return O_([...Ps(e),...yield*_i(e),...yield*Ai(e),["annotations",Ct(yield e.annotations)],["items",Ct(yield e.items)]],e)},AnnotationCollection:function*(e){return[["id",e.id],["type","AnnotationCollection"],["label",e.label]]},Collection:function*(e,t,{isTopLevel:n}){if(n){let r="http://iiif.io/api/presentation/3/context.json";return(e.navPlace||Dx(e))&&(r=["http://iiif.io/api/extension/navplace/context.json","http://iiif.io/api/presentation/3/context.json"]),[["@context",r],...Ps(e),...yield*_i(e),...yield*Ai(e),["items",Ct(yield e.items)],["navPlace",e.navPlace]]}return[...Ps(e),...yield*_i(e),["navPlace",e.navPlace]]},Range:function*(e){let t=[];for(let n of e.items)n.type==="Range"?t.push(yield n):n&&n.type==="SpecificResource"?t.push(oa(n)):t.push(n);return[...Ps(e),...yield*_i(e),...yield*Ai(e),["items",t],["annotations",Ct(yield e.annotations)],["navPlace",e.navPlace]]}};function O_(e,t){let n=Object.keys(t),r=e.map(([i])=>i);for(let i of n)i===At||i===sa||r.indexOf(i)===-1&&t[i]!==void 0&&e.push([i,t[i]]);return e}function Dx(e){if(!e.items||!Array.isArray(e.items))return!1;for(let t of e.items)if(t.navPlace)return!0;return!1}function j_(e,t){return si(e)?typeof e.source=="string"?{...e,source:t}:{...e,source:{...e.source||{},id:t}}:{...e,id:t}}const gt=function(e){return function(){let t={type:e,getType:()=>e,toString:()=>e};return(n,r)=>({...t,...n!==void 0&&{payload:n},...r!==void 0&&{meta:r}})}},pP="@iiif/IMPORT_ENTITIES",gP="@iiif/MODIFY_ENTITY_FIELD",mP="@iiif/REORDER_ENTITY_FIELD",yP="@iiif/MOVE_ENTITY",Mg="@iiif/MOVE_ENTITIES",vP="@iiif/ADD_REFERENCE",Lg="@iiif/UPDATE_REFERENCE",xP="@iiif/CHANGE_REFERENCE_IDENTIFIER",wP="@iiif/REMOVE_REFERENCE",SP="@iiif/ADD_METADATA",kP="@iiif/REMOVE_METADATA",Ng="@iiif/UPDATE_METADATA",PP="@iiif/REORDER_METADATA",EP=gt(pP)(),M_=gt(gP)(),L_=gt(mP)(),N_=gt(yP)(),F_=gt(Mg)(),z_=gt(vP)(),$_=gt(wP)(),D_=gt(Lg)(),B_=gt(xP)(),U_=gt(SP)(),W_=gt(Ng)(),H_=gt(kP)(),V_=gt(PP)(),Nc={importEntities:EP,modifyEntityField:M_,reorderEntityField:L_,addReference:z_,removeReference:$_,updateReference:D_,changeReferenceIdentifier:B_,addMetadata:U_,removeMetadata:H_,updateMetadata:W_,reorderMetadata:V_,moveEntity:N_,moveEntities:F_},CP="@iiif/ADD_MAPPING",TP="@iiif/ADD_MAPPINGS",q_=gt(CP)(),Q_=gt(TP)(),Fg="RESOURCE_ERROR",bP="RESOURCE_LOADING",zg="RESOURCE_READY",RP="@iiif/REQUEST_RESOURCE",IP="@iiif/REQUEST_ERROR",_P="@iiif/REQUEST_MISMATCH",AP="@iiif/REQUEST_COMPLETE",Y_="@iiif/REQUEST_OFFLINE_RESOURCE",X_=gt(RP)(),$g=gt(IP)(),K_=gt(_P)(),G_=gt(AP)(),fy="@iiif/BATCH",Z_="@iiif/BATCH_IMPORT",Dg=gt(fy)(),OP="@iiif/SET_META_VALUE",jP="@iiif/SET_META_VALUE_DYNAMIC",MP="@iiif/UNSET_META_VALUE",J_=gt(OP)(),eA=gt(jP)(),tA=gt(MP)(),Bx={setMetaValue:J_,setMetaValueDynamic:eA,unsetMetaValue:tA},nA=(e,t)=>{let{entities:n,resource:r,mapping:i}=P_(t);if(r.id===void 0)return[$g({id:e,message:"ID is not defined in resource."})];let s=[EP({entities:n}),Q_({mapping:i})];return r.id!==e&&(s.push(q_({id:e,type:r.type})),s.push(K_({requestId:e,actualId:r.id}))),s.push(G_({id:e})),s},Ux=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function rA(e,t){return!!(e===t||Ux(e)&&Ux(t))}function Wx(e,t){if(!Array.isArray(e)||!Array.isArray(t))return e===t;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(!rA(e[n],t[n]))return!1;return!0}function pp(e,t,n){let r=e.iiif.requests[t],i=e.iiif.mapping[t];if(!i||!e.iiif.entities[i][r.resourceUri])return;let s=e.iiif.entities[i][r.resourceUri];if(s&&s[At]){let o=s[At].find(u=>u[pi]===s.id);return dy(s,o)}return s}function iA(e){return e&&typeof e.then=="function"}function Hx(e,t,{waitTimeout:n=30}={}){return(r,i,s)=>{let o=e.getStore(),u=o.getState(),d=u.iiif.requests[r];if(d){if(d.loadingState===zg){let c=pp(u,r);if(c)return c}switch(d.loadingState){case Fg:break;case bP:return(async()=>{let c,p=!1;try{let m=await Promise.race([new Promise((w,y)=>{p||(c=o.subscribe(()=>{let S=o.getState();if(S.iiif.requests[r].loadingState===Fg){y();return}if(S.iiif.requests[r].loadingState===zg){let C=pp(S,r);C?w(C):y()}}))}),new Promise((w,y)=>setTimeout(()=>{p=!0,y()},n*60*1e3))]);if(c&&c(),m)return m}catch{c&&c()}})()}}e.dispatch(X_({id:r}));let h=c=>{if(!c)return;!c.id&&!c["@id"]&&(c["@type"]&&(c["@id"]=r),c.id=r);let p=nA(r,c);return e.dispatch(Dg({actions:p})),pp(o.getState(),r)};try{let c=t(r,i);return iA(c)?(async()=>{try{let p=await c;return s&&(p=s(p)),h(p)}catch(p){throw e.dispatch($g({id:r,message:p.toString()})),p}})():h(s?s(c):c)}catch(c){throw e.dispatch($g({id:r,message:c.toString()})),c}}}function LP(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}const gp={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1},sA=(e,t)=>(n,r,i)=>(i.dispatch=s=>(n(o=>e(o,s),!1,s),s),i.dispatchFromDevtools=!0,{dispatch:(...s)=>i.dispatch(...s),...t}),oA=sA,Bg=new Map,ac=e=>{let t=Bg.get(e);return t?Object.fromEntries(Object.entries(t.stores).map(([n,r])=>[n,r.getState()])):{}},lA=(e,t,n)=>{if(e===void 0)return{type:"untracked",connection:t.connect(n)};let r=Bg.get(n.name);if(r)return{type:"tracked",store:e,...r};let i={connection:t.connect(n),stores:{}};return Bg.set(n.name,i),{type:"tracked",store:e,...i}},aA=(e,t={})=>(n,r,i)=>{let{enabled:s,anonymousActionType:o,store:u,...d}=t,h;try{h=(s??(gp?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!h)return(gp?"production":void 0)!=="production"&&s&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),e(n,r,i);let{connection:c,...p}=lA(u,h,d),m=!0;i.setState=(S,C,x)=>{let k=n(S,C);if(!m)return k;let T=x===void 0?{type:o||"anonymous"}:typeof x=="string"?{type:x}:x;return u===void 0?(c==null||c.send(T,r()),k):(c==null||c.send({...T,type:`${u}/${T.type}`},{...ac(d.name),[u]:i.getState()}),k)};let w=(...S)=>{let C=m;m=!1,n(...S),m=C},y=e(i.setState,r,i);if(p.type==="untracked"?c==null||c.init(y):(p.stores[p.store]=i,c==null||c.init(Object.fromEntries(Object.entries(p.stores).map(([S,C])=>[S,S===p.store?y:C.getState()])))),i.dispatchFromDevtools&&typeof i.dispatch=="function"){let S=!1,C=i.dispatch;i.dispatch=(...x)=>{(gp?"production":void 0)!=="production"&&x[0].type==="__setState"&&!S&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),S=!0),C(...x)}}return c.subscribe(S=>{var C;switch(S.type){case"ACTION":if(typeof S.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return mp(S.payload,x=>{if(x.type==="__setState"){if(u===void 0){w(x.state);return}Object.keys(x.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);let k=x.state[u];if(k==null)return;JSON.stringify(i.getState())!==JSON.stringify(k)&&w(k);return}i.dispatchFromDevtools&&typeof i.dispatch=="function"&&i.dispatch(x)});case"DISPATCH":switch(S.payload.type){case"RESET":return w(y),u===void 0?c==null?void 0:c.init(i.getState()):c==null?void 0:c.init(ac(d.name));case"COMMIT":if(u===void 0){c==null||c.init(i.getState());return}return c==null?void 0:c.init(ac(d.name));case"ROLLBACK":return mp(S.state,x=>{if(u===void 0){w(x),c==null||c.init(i.getState());return}w(x[u]),c==null||c.init(ac(d.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return mp(S.state,x=>{if(u===void 0){w(x);return}JSON.stringify(i.getState())!==JSON.stringify(x[u])&&w(x[u])});case"IMPORT_STATE":{let{nextLiftedState:x}=S.payload,k=(C=x.computedStates.slice(-1)[0])==null?void 0:C.state;if(!k)return;w(u===void 0?k:k[u]),c==null||c.send(null,x);return}case"PAUSE_RECORDING":return m=!m}return}}),y},uA=aA,mp=(e,t)=>{let n;try{n=JSON.parse(e)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&t(n)},cA=e=>(t,n,r)=>{let i=r.subscribe;return r.subscribe=(o,u,d)=>{let h=o;if(u){let c=(d==null?void 0:d.equalityFn)||Object.is,p=o(r.getState());h=m=>{let w=o(m);if(!c(p,w)){let y=p;u(p=w,y)}},d!=null&&d.fireImmediately&&u(p,p)}return i(h)},e(t,n,r)},dA=cA,fA=(e={},t)=>{switch(t.type){case CP:return{...e,[t.payload.id]:t.payload.type};case TP:return{...e,...t.payload.mapping};default:return e}};function Fl(e,t,n,r){return!(!e[n]||!e[n][t]||!e[n][t][r]||!Array.isArray(e[n][t][r]))}function hA(e,t){let n={},r=[];for(let[i,s]of Object.entries(e||{})){r.push(i);let o=(t||{})[i];if(!o||o.length===0){n[i]=s;continue}n[i]=o}for(let[i,s]of Object.entries(t||{}))r.indexOf(i)===-1&&(n[i]=s);return n}function ke(e){return e.payload||{}}function pA(e,t,n){if(!e[t]||!Array.isArray(e[t]))return null;let r=n.index===void 0?e[t].findIndex(i=>{var s;return i?((s=Gd(i))==null?void 0:s.id)===n.id:!1}):n.index;return r===-1?null:{entity:e[t][r],index:r}}function Vx(e,t){var n;if(!(!(t!=null&&t.id)||!(t!=null&&t.type)))return(n=e[t.type])==null?void 0:n[t.id]}function uc(e,t){return e===void 0?t:e}const NP=(e=LP(),t)=>{var r,i;let n=(s,o)=>({...e,[ke(t).type]:{...e[ke(t).type],[ke(t).id]:{...s,...o}}});switch(t.type){case gP:{if(!e[ke(t).type]||!e[ke(t).type][ke(t).id])return e;let s=e[ke(t).type][ke(t).id];return typeof s=="string"?e:n(s,{[ke(t).key]:ke(t).value})}case mP:{if(!Fl(e,ke(t).id,ke(t).type,ke(t).key))return e;let s=e[ke(t).type][ke(t).id];if(typeof s=="string")return e;let o=Array.from(s[ke(t).key]),[u]=o.splice(ke(t).startIndex,1);return o.splice(ke(t).endIndex,0,u),n(s,{[ke(t).key]:o})}case Mg:{let s=ke(t).subjects,o=ke(t).from,u=ke(t).to||o,d=Vx(e,o),h=(u==null?void 0:u.key)||o.key;if(!Fl(e,o.id,o.type,o.key)||!Fl(e,u.id,u.type,u.key))return e;let c=[],p=[];if(s.type==="slice"){let T=s.startIndex,_=s.length;c=Array.from(d[o.key]),p=c.splice(T,_)}else{let T=Array.from(d[o.key]);for(let _ of s.items){let R=pA(d,o.key,_);R&&(p.push(R.entity),T[R.index]=null),c=T.filter(O=>O!==null)}}let m={...d,[o.key]:c},w={...e,[o.type]:{...e[o.type],[o.id]:m}},y=Vx(w,u);if(!y)return e;let S=(u==null?void 0:u.index)===void 0?y[h].length:u.index,C=Array.from(y[u.key]);C.splice(S,0,...p);let x={...y,[h]:C};return{...w,[u.type]:{...w[u.type],[u.id]:x}}}case yP:return NP(e,{type:Mg,payload:{subjects:{type:"list",items:[ke(t).subject]},from:ke(t).from,to:ke(t).to}});case xP:{let{id:s,index:o,key:u,newIdentifier:d,reference:h,type:c}=ke(t),p=e[c][s],m=Gd(h);if(!p||!p[u]||!m||o<0)return e;let w=p[u],y=w[o],S=(r=e[m.type])==null?void 0:r[m.id];if(!S||!y)return e;let C=j_(y,d),x=Array.from(w);x.splice(uc(o,x.length+1),1,C);let k=n(p,{[u]:x}),T={...S,id:d};T["iiif-parser:hasPart"]&&(T["iiif-parser:hasPart"]=T["iiif-parser:hasPart"].filter(R=>R["iiif-parser:partOf"]===s).map(R=>({...R,id:d})));let _={...k[m.type],[d]:T};return k[m.type]=_,k}case pP:{let s=Object.keys(ke(t).entities),o={...e};for(let u of s){let d=ke(t).entities[u],h={...e[u]||{}},c=!1,p=Object.keys(d||{})||[];if(d&&p){for(let m of p)c=!0,h[m]=e[u][m]?hA(e[u][m],d[m]):d[m];c&&(o[u]=h)}}return o}case vP:{if(!Fl(e,ke(t).id,ke(t).type,ke(t).key))return e;let s=e[ke(t).type][ke(t).id],o=Array.from(s[ke(t).key]);return o.splice(uc(ke(t).index,o.length+1),0,ke(t).reference),n(s,{[ke(t).key]:o})}case Lg:case wP:{if(!Fl(e,ke(t).id,ke(t).type,ke(t).key))return e;let s=e[ke(t).type][ke(t).id],o=Array.from(s[ke(t).key]),u=uc(ke(t).index,o.findIndex(d=>d&&d.id===ke(t).reference.id));return u===-1||((i=o[u])==null?void 0:i.id)!==ke(t).reference.id?e:(t.type===Lg?o.splice(u,1,ke(t).reference):o.splice(u,1),n(s,{[ke(t).key]:o}))}case SP:{let s=e[ke(t).type][ke(t).id];if(!s)return e;let o=Array.from(s.metadata||[]),u=ke(t);return o.splice(uc(t.payload.beforeIndex,o.length+1),0,{label:u.label,value:u.label}),n(s,{metadata:o})}case PP:{let s=e[ke(t).type][ke(t).id];if(typeof s=="string"||!s)return e;let o=Array.from(s.metadata||[]),[u]=o.splice(ke(t).startIndex,1);return o.splice(ke(t).endIndex,0,u),n(s,{metadata:o})}case Ng:case kP:{let s=e[ke(t).type][ke(t).id],o=Array.from(s.metadata||[]),u=ke(t).atIndex;return u===void 0||u===-1||!o[u]?e:(t.type===Ng?o.splice(u,1,{label:ke(t).label,value:ke(t).value}):o.splice(u,1),n(s,{metadata:o}))}default:return e}},gA=(e={},t)=>{switch(t.type){case RP:case Y_:return{...e,[t.payload.id]:{requestUri:t.payload.id,loadingState:bP,uriMismatch:!1,resourceUri:t.payload.id}};case _P:return{...e,[t.payload.requestId]:{...e[t.payload.requestId]||{},uriMismatch:!0,resourceUri:t.payload.actualId},[t.payload.actualId]:{requestUri:t.payload.requestId,loadingState:e[t.payload.requestId].loadingState,uriMismatch:!0,resourceUri:t.payload.actualId}};case IP:return{...e,[t.payload.id]:{...e[t.payload.id]||{},loadingState:Fg,error:t.payload.message}};case AP:return{...e,[t.payload.id]:{...e[t.payload.id]||{},loadingState:zg,error:void 0}}}return e},mA=(e={},t)=>{let{id:n,updateValue:r,value:i,meta:s,key:o}=t&&t.payload||{};switch(t.type){case OP:return{...e,[n]:{...e[n]||{},[s]:{...e[n]&&e[n][s]||{},[o]:i}}};case jP:return{...e,[n]:{...e[n]||{},[s]:{...e[n]&&e[n][s]||{},[o]:e[n]&&e[n][s]?r(e[n][s][o]):r(void 0)}}};case MP:return e[n]&&e[n][s]&&e[n][s][o]?{...e,[n]:{...e[n]||{},[s]:{...e[n]&&e[n][s]||{},[o]:void 0}}}:e;default:return e}};function FP(e={}){let t=Object.keys(e);return function(n={},r){let i=!1,s={};for(let o=0;o<t.length;o++){let u=t[o];s[u]=e[u](n[u],r),i||(i=s[u]!==n[u])}return i?s:n}}function yA(e){return(t,n)=>n&&n.type===fy?n.payload.actions.reduce(e,t):n&&n.type===Z_?{...t,iiif:{...t.iiif,...n.payload.state}}:e(t,n)}const vA=FP({mapping:fA,entities:NP,requests:gA,meta:mA});function xA(){return{iiif:{entities:LP(),meta:{},mapping:{},requests:{}}}}function wA(e={}){let{enableDevtools:t=!1,iiifStoreName:n="iiif",defaultState:r=xA(),customReducers:i={}}=e,s=yA(FP({[n]:vA,...i})),o=!!(typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__);return Pk(dA((o?uA:(d,h)=>d)(oA(s,r),{enabled:t})))}function dn(e,t,n,r=!0){t[Do]=t[Do]||[],t[Do].push(e);let i=new Map;Object.defineProperty(t,e,{enumerable:r,get(){if(t[bs][e]===void 0)return;let s=t[bs][e];if(!s)return s;let o=n.get(t[bs][e],{parent:this.id?{id:this.id,type:this.type}:void 0});return i.has(o)||(i.clear(),i.set(o,Rs(o,n))),i.get(o)},set(s){t[bs][e]!==s&&(this[Ts]?n.modifyEntityField({id:this.id,type:this.type},e,zP(s)):this[bs][e]=s)}})}const bs=Symbol.for("_refs_"),Ts=Symbol.for("_reactive_"),Do=Symbol.for("_defined_"),qx=Symbol.for("_parent_");function SA(e,t=!1,n){let r={id:"",type:"unknown",[Do]:[],[bs]:{},[qx]:null,[Ts]:null,is(i){return typeof i=="string"?this.id===i:i.id?i.id===this.id:!1},reactive(){if(!this[Ts])return this[Ts]=this.subscribe(()=>this.refresh(),!0),()=>{this.unreactive()}},refresh(){if(this.id){let i=this.unwrap();for(let s of Object.keys(i||{}))this[Do].includes(s)?this[bs][s]=i[s]:this[s]=i[s]}},unreactive(){this[Ts]&&(this[Ts](),this[Ts]=null)},unwrap(){if(!this.id)throw Error("Invalid object");let i=this[qx];return e.get(this.id,{parent:i?{id:i,type:"unknown"}:void 0})},toPresentation3(){return e.toPresentation3(this.unwrap())},toPresentation2(){return e.toPresentation2(this.unwrap())},valueOf(){return this.unwrap()},toJSON(){let i=this;return{...i,items:i.items,annotations:i.annotations,structures:i.structures,seeAlso:i.seeAlso,service:i.service,services:i.services,rendering:i.rendering,partOf:i.partOf,start:i.start,supplementary:i.supplementary,homepage:i.homepage,thumbnail:i.thumbnail,placeholderCanvas:i.placeholderCanvas,accompanyingCanvas:i.accompanyingCanvas,provider:i.provider}},subscribe(i,s=!0){return e.subscribe(()=>this.id?e.get(this.id):null,i,s)}};return dn("items",r,e),dn("annotations",r,e),dn("structures",r,e),dn("seeAlso",r,e),dn("rendering",r,e),dn("partOf",r,e),dn("start",r,e,!1),dn("supplementary",r,e),dn("homepage",r,e),dn("thumbnail",r,e),dn("placeholderCanvas",r,e,!1),dn("accompanyingCanvas",r,e,!1),dn("provider",r,e),dn("body",r,e),dn("logo",r,e),r}function kA(e){return!!e[Do]}function zP(e){return Array.isArray(e)?e.map(t=>zP(t)):!e||!e.type?e:{id:e.id,type:e.type}}function Rs(e,t,n=!1,r){if(Array.isArray(e))return e.map(u=>Rs(u,t,n));if(!e||!e.type||!e.id)return e;let i=SA(t,n),s=Object.create(i),o=Object.assign(s,e);return n&&o.reactive(),o}function Qx(e){switch(e){case"Image":case"Video":case"Sound":case"Dataset":case"Text":case"Composite":case"List":case"Independents":case"Audience":return"ContentResource";case"ImageService1":case"ImageService2":case"ImageService3":return"Service"}return e}var Ug=class{constructor(t,n){rn(this,"options",void 0),rn(this,"store",void 0),rn(this,"emitter",void 0),rn(this,"isBatching",!1),rn(this,"batchQueue",[]),rn(this,"remoteFetcher",void 0),rn(this,"staticFetcher",void 0),rn(this,"defaultFetcher",r=>fetch(r).then(i=>{if(i.status===200)return i.json();{let s=Error(`${i.status} ${i.statusText}`);throw s.name="HTTPError",s}})),this.options=Object.assign({reducers:{},customFetcher:this.defaultFetcher,enableDevtools:!0},t||{}),this.store=n||wA({customReducers:this.options.reducers,defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter=Ek(),this.remoteFetcher=Hx(this,this.options.customFetcher),this.staticFetcher=Hx(this,(r,i)=>i)}batch(t){this.isBatching=!0;try{t(this),this.isBatching=!1,this.dispatch(Dg({actions:this.batchQueue}))}catch(n){throw this.batchQueue=[],this.isBatching=!1,n}this.batchQueue=[]}async asyncBatch(t){this.isBatching=!0;try{await t(this),this.isBatching=!1,this.dispatch(Dg({actions:this.batchQueue}))}catch(n){throw this.batchQueue=[],this.isBatching=!1,n}this.batchQueue=[]}modifyEntityField(t,n,r){this.dispatch(Nc.modifyEntityField({id:t.id,type:t.type,key:n,value:r}))}dispatch(t){if(this.isBatching)this.batchQueue.push(t);else{if(t.type===fy){for(let i of t.payload.actions)this.emitter.emit(i.type,{action:i,state:this.store.getState()});this.store.dispatch(t);let r=this.getState();for(let i of t.payload.actions)this.emitter.emit(`after:${i.type}`,{action:i,state:r});return}this.emitter.emit(t.type,{action:t,state:this.store.getState()}),this.store.dispatch(t);let n=this.store.getState();this.emitter.emit(`after:${t.type}`,{action:t,state:n});return}}on(t,n){return this.emitter.on(t,n),()=>{this.emitter.off(t,n)}}serialize(t,n){return C_(this.getState().iiif,t,n)}toPresentation2(t){return this.serialize(t,__)}toPresentation3(t){return this.serialize(t,A_)}hydrate(t,n,r={}){return this.get(t,n,{...r,skipSelfReturn:!1})}get(t,n,r={}){typeof n!="string"&&(r=n||{},n=void 0);let{skipSelfReturn:i=!0}=r||{},s=r.parent?typeof r.parent=="string"?r.parent:r.parent.id:void 0;if(Array.isArray(t))return t.map(p=>this.get(p,r));let o=this.getState();if(si(t)&&!r.preserveSpecificResources&&(t=t.source),typeof t=="string"){let p=Qx(n||o.iiif.mapping[t]);if(!p)return i?null:{id:t,type:"unknown"};t={id:t,type:p}}if(t&&t.partOf&&!s&&!r.skipPartOfCheck){let p=Array.isArray(t.partOf)?t.partOf[0]:t.partOf;p&&(typeof p=="string"&&(s=p),typeof p.id=="string"&&(s=p.id))}let u=Qx(n||(t==null?void 0:t.type)),d=t==null?void 0:t.id,h=o.iiif.entities[u];if(!h){let p=o.iiif.requests[d];return p&&p.resourceUri!==d?this.get(p.resourceUri,r):i?null:t}let c=h[t.id];if(c&&c[At]){let p=c[At].find(m=>s?m[pi]===s:m[pi]===c.id);return dy(c,p)}return h[t.id]||(i?null:t)}select(t){return t(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}deep(t,n){if(t===void 0)return this.get(n,{skipSelfReturn:!1});if(typeof t=="function")try{let i=t(this.get(n,{skipSelfReturn:!1})),s=o=>this.deep(o,i);return s.size=Array.isArray(i)?i.length:1,s}catch{let i=s=>this.deep(s,void 0);return i.size=0,i}let r=i=>this.deep(i,t);return r.size=Array.isArray(t)?t.length:1,r}loadManifest(t,n,r){let i=typeof t=="string"?t:t.id;return this.load(i,n,r)}loadCollection(t,n,r){let i=typeof t=="string"?t:t.id;return this.load(i,n,r)}load(t,n,r){let i=typeof t=="string"?t:t.id;return n?Promise.resolve(this.staticFetcher(i,n,r)):Promise.resolve(this.remoteFetcher(i,{},r))}loadSync(t,n,r){let i=typeof t=="string"?t:t.id;return this.staticFetcher(i,n,r)}loadManifestSync(t,n,r){let i=typeof t=="string"?t:t.id;return this.loadSync(i,n,r)}loadCollectionSync(t,n,r){let i=typeof t=="string"?t:t.id;return this.loadSync(i,n,r)}areInputsEqual(t,n){return Wx(t,n)}subscribe(t,n,r){return r===void 0&&(n===void 0||n===!1||n===!0)&&(r=n,n=t,t=i=>i),this.store.subscribe(t,i=>n(i,this),{equalityFn:Wx,fireImmediately:!r})}async ensureLoaded(t){let n=typeof t=="string"?t:t.id;this.requestStatus(n)||await this.load(n)}requestStatus(t){return this.select(n=>n.iiif.requests[t])}getPaginationState(t){let n=typeof t=="string"?t:t.id;if(!n)return null;let r=this.getResourceMeta(n,"@vault/pagination");if(r!=null&&r.state)return r.state;let i=this.get(t);if(i.first){let s={currentPage:null,currentPageIndex:null,isFetching:!1,isFullyLoaded:!1,next:i.first,page:1,pages:[],previous:null,totalItems:i.total,currentLength:0};return this.setMetaValue([n,"@vault/pagination","state"],s),s}return null}async loadNextPage(t,n){var w;let r=typeof t=="string"?t:t.id;if(!r)return[null,null];let i=this.getPaginationState(t);if(!i||i.isFullyLoaded||!i.next)return[null,null];if(i.isFetching)return[i,null];let s=typeof i.next=="string"?i.next:i.next.id,o=i.currentPage,u={...i,isFetching:!0};this.setMetaValue([r,"@vault/pagination","state"],u);let d;try{d=await this.loadCollection(s,n,y=>{let{id:S,"@id":C,...x}=y||{};return C?{"@id":s,...x}:{id:s,...x}})}catch(y){let S={...i,isFetching:!1,error:y};return this.setMetaValue([r,"@vault/pagination","state"],S),[S,null]}if(!d){let y={...i,isFetching:!1,error:Error("Collection not found")};return this.setMetaValue([r,"@vault/pagination","state"],y),[y,null]}let h=this.get(r),c=[...h.items||[],...d.items||[]].map(y=>({id:y.id,type:y.type}));this.modifyEntityField({id:r,type:"Collection"},"items",c);let p=this.getPaginationState(t);if(!p)throw Error("Pagination state not found");let m={...p,isFetching:!1,error:null,currentPage:d.id,next:((w=d.next)==null?void 0:w.id)||null,currentPageIndex:p.pages.length,currentLength:c.length,pages:[...p.pages,{id:d.id,type:"Collection",startIndex:h.items.length,pageLength:d.items.length,order:typeof p.currentPageIndex=="number"?p.currentPageIndex+1:0}],isFullyLoaded:!d.next,previous:o,page:p.pages.length+1};return this.setMetaValue([r,"@vault/pagination","state"],m),[m,d]}getResourceMeta(t,n){let r=this.getState().iiif.meta[t];if(r)return n?r[n]:r}getObject(t,n,r={}){let{reactive:i,...s}=r;return Rs(this.get(t,n,s),this,i)}async loadObject(t,n){return Rs(await this.load(t,n),this)}async loadManifestObject(t,n){return Rs(await this.loadManifest(t,n),this)}async loadCollectionObject(t,n){return Rs(await this.loadCollection(t,n),this)}wrapObject(t){return Rs(this.get(t,{skipSelfReturn:!1}),this)}isWrapped(t){return kA(t)}setMetaValue([t,n,r],i){this.dispatch(typeof i=="function"?Bx.setMetaValueDynamic({id:t,meta:n,key:r,updateValue:i}):Bx.setMetaValue({id:t,meta:n,key:r,value:i}))}};function PA(){return typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}}function $P(e){let t=PA();try{let r=t.IIIF_VAULT;if(r)return r}catch{}let n=new Ug(e);try{t.IIIF_VAULT=n}catch{}return n}const Zd=at.createContext({vault:null,setVaultInstance:e=>{}});function hy({vault:e,vaultOptions:t,useGlobal:n,resources:r,children:i}){const[s,o]=b.useState(()=>e||(n?$P(t):t?new Ug(t):new Ug));return E.jsx(Zd.Provider,{value:{vault:s,setVaultInstance:o},children:E.jsx(Xd,{value:r||{},children:i})})}const yn=()=>{const{vault:e}=b.useContext(Zd);if(e===null)throw new Error("Vault not found. Ensure you have your provider set up correctly.");return e};function _n(e,t=[]){const n=yn(),[r,i]=b.useState(()=>e(n.getState(),n));return b.useEffect(()=>n.subscribe(s=>e(s,n),s=>{i(s)},!1),t),r}const Jd=at.createContext([]);function py(){const e=b.useContext(Jd);return _n(t=>e.map(n=>t.iiif.entities.Canvas[n]).filter(Boolean),[e])}function gy(e){const t=b.useContext(Zd);return e||(t&&t.vault?t.vault:$P())}function Br(e={},t=[]){const{id:n,selector:r}=e,i=rl();yn();const s=n||i.manifest,o=_n(u=>s?u.iiif.entities.Manifest[s]:void 0,[s]);return b.useMemo(()=>{if(o)return r?r(o):o},[o,r,...t])}function EA(e,{noCache:t=!1}={}){const n=typeof e=="string"?e:e.id,r=gy(),[i,s]=b.useState(n),[o,u]=b.useState(void 0),d=b.useMemo(()=>r.get(n,{skipSelfReturn:!0})||void 0,[n,r]),[h,c]=b.useState(d);return b.useEffect(()=>{(async()=>{try{const p=d&&!t?d:await r.load(n),m=p?p.id||p["@id"]:null;p&&i!==m&&s(m),c(p)}catch(p){u(p)}})()},[n,t]),{isLoaded:!!h,id:i,requestId:n,error:o,resource:h,cached:!!(h&&h===d)}}function CA(e,t){const{id:n,isLoaded:r,error:i,resource:s,requestId:o,cached:u}=EA(e,t);return{id:n,isLoaded:r,error:i,manifest:s,requestId:o,cached:u}}function TA({manifest:e,children:t}){return E.jsx(Xd,{value:{manifest:e},children:t})}function bA({range:e,children:t}){return E.jsx(Xd,{value:{range:e},children:t})}function DP(e,t){var r;const n=[];for(const i of t.items)if(i.type==="SpecificResource"&&((r=i.source)==null?void 0:r.type)==="Canvas"&&(i.source.id.indexOf("#")!==-1?n.push({id:i.source.id.split("#")[0],type:"Canvas"}):n.push(i.source)),i.type==="Range"&&n.push(...DP(e,e.get(i))),i.type==="SpecificResource"){const s=typeof i.source=="string"?i.source:i.source.id;n.push({id:s,type:"Canvas"})}return n}function RA(e,t,{disablePaging:n,skipNonPaged:r}={}){const i=t.behavior,s=i.includes("paged"),o=s?!1:i.includes("continuous"),u=s||o?!1:i.includes("individuals"),d=t.type==="Manifest"?t.items:DP(e,t);if(o)return[d,[d.map((y,S)=>S)]];if(u||!s||n)return[d,d.map((y,S)=>[S])];const h=[];let c=[];const p=()=>{c.length&&(h.push([...c]),c=[])};let m=0,w=!1;for(let y=0;y<d.length;y++){const S=e.get(d[y]);if(S.behavior.includes("non-paged")){y===m&&m++,r||(p(),h.push([y]),p());continue}if(y===m||S.behavior.includes("facing-pages")){c.length&&(w=!0),p(),h.push([y]),p();continue}if(c.push(y),w){p(),w=!1;continue}c.length>1&&p()}return c.length&&p(),[d,h]}function BP(e={},t=[]){const{id:n,selector:r}=e,i=rl(),s=n||i.range,o=_n(u=>s?u.iiif.entities.Range[s]:void 0,[s]);return b.useMemo(()=>{if(o)return r?r(o):o},[o,r,...t])}function IA({startCanvas:e,disablePaging:t}){var S;const n=yn(),r=Br(),i=BP(),[s,o]=b.useState(void 0),u=i||r;if(!u)throw new Error("Nothing selected");const[d,h]=b.useMemo(()=>RA(n,u,{disablePaging:t}),[n,u,t]),c=b.useRef(h);if(c.current!==h){const x=c.current[s][0],k=h.findIndex(T=>T.includes(x));c.current=h,o(k)}const p=b.useCallback(C=>{const x=h.findIndex(k=>k.includes(C));o(x===-1?0:x)},[d,h]),m=b.useCallback(C=>{const x=d.findIndex(k=>k.id===C);x!==-1?p(x):o(0)},[d,h]),w=b.useCallback(()=>{o(C=>C>=h.length-1?C:C+1)},[h]),y=b.useCallback(()=>{o(C=>C<=0?0:C-1)},[h]);return typeof s>"u"&&(e?m(e):o(0)),{visibleItems:((S=h[s])==null?void 0:S.map(C=>d[C].id))||[],cursor:s,items:d,sequence:h,hasPrevious:s>0,hasNext:s<h.length-1,setSequenceIndex:o,setCanvasIndex:p,setCanvasId:m,next:w,previous:y}}const _A={},Yx=e=>{let t;const n=new Set,r=(c,p)=>{const m=typeof c=="function"?c(t):c;if(!Object.is(m,t)){const w=t;t=p??(typeof m!="object"||m===null)?m:Object.assign({},t,m),n.forEach(y=>y(t,w))}},i=()=>t,d={setState:r,getState:i,getInitialState:()=>h,subscribe:c=>(n.add(c),()=>n.delete(c)),destroy:()=>{(_A?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},h=t=e(r,i,d);return d},us=e=>e?Yx(e):Yx;var UP={exports:{}},WP={},HP={exports:{}},VP={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Go=b;function AA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var OA=typeof Object.is=="function"?Object.is:AA,jA=Go.useState,MA=Go.useEffect,LA=Go.useLayoutEffect,NA=Go.useDebugValue;function FA(e,t){var n=t(),r=jA({inst:{value:n,getSnapshot:t}}),i=r[0].inst,s=r[1];return LA(function(){i.value=n,i.getSnapshot=t,yp(i)&&s({inst:i})},[e,n,t]),MA(function(){return yp(i)&&s({inst:i}),e(function(){yp(i)&&s({inst:i})})},[e]),NA(n),n}function yp(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!OA(e,n)}catch{return!0}}function zA(e,t){return t()}var $A=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?zA:FA;VP.useSyncExternalStore=Go.useSyncExternalStore!==void 0?Go.useSyncExternalStore:$A;HP.exports=VP;var DA=HP.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ef=b,BA=DA;function UA(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var WA=typeof Object.is=="function"?Object.is:UA,HA=BA.useSyncExternalStore,VA=ef.useRef,qA=ef.useEffect,QA=ef.useMemo,YA=ef.useDebugValue;WP.useSyncExternalStoreWithSelector=function(e,t,n,r,i){var s=VA(null);if(s.current===null){var o={hasValue:!1,value:null};s.current=o}else o=s.current;s=QA(function(){function d(w){if(!h){if(h=!0,c=w,w=r(w),i!==void 0&&o.hasValue){var y=o.value;if(i(y,w))return p=y}return p=w}if(y=p,WA(c,w))return y;var S=r(w);return i!==void 0&&i(y,S)?(c=w,y):(c=w,p=S)}var h=!1,c,p,m=n===void 0?null:n;return[function(){return d(t())},m===null?void 0:function(){return d(m())}]},[t,n,r,i]);var u=HA(e,s[0],s[1]);return qA(function(){o.hasValue=!0,o.value=u},[u]),YA(u),u};UP.exports=WP;var XA=UP.exports;const KA=Jo(XA),qP={},{useDebugValue:GA}=at,{useSyncExternalStoreWithSelector:ZA}=KA;let Xx=!1;const JA=e=>e;function Te(e,t=JA,n){(qP?"production":void 0)!=="production"&&n&&!Xx&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Xx=!0);const r=ZA(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return GA(r),r}const eO=e=>{(qP?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?us(e):e,n=(r,i)=>Te(t,r,i);return Object.assign(n,t),n},tO=e=>eO;function gr(e,t,n){const r=t.findIndex(o=>o.service.id===e);if(r===-1)return t;const i=[...t],s=n(i[r]);return s===i[r]?t:(i[r]=s,i)}const nO=()=>us((e,t)=>({currentAuth:-1,authItems:[],login:()=>{const n=t().authItems[t().currentAuth];if(!n||n.isPending||n.isLoggedIn)return;if(n.type!=="active")throw new Error("Cannot login to non-active service");const r=n.service.service.find(i=>i.type==="AuthAccessTokenService2");if(!r)throw new Error("Token service not found");e(()=>({authItems:gr(n.id,t().authItems,i=>({...i,isPending:!0}))})),Kx(n.service).then(()=>{vp(r).then(i=>{const s=i.expiresIn,o=Date.now()+s*1e3;e(()=>({authItems:gr(n.id,t().authItems,u=>({...u,isLoggedIn:!0,isPending:!1,session:{token:i.accessToken,expires:o}}))}))}).catch(i=>{e(()=>({authItems:gr(n.id,t().authItems,s=>({...s,isLoggedIn:!1,isPending:!1,error:i.message}))}))})})},logout:()=>{const n=t().authItems[t().currentAuth];if(!n||n.isPending||!n.isLoggedIn)return;if(n.type!=="active")throw new Error("Cannot logout of non-active service");const r=n.service.service.find(s=>s.type==="AuthLogoutService2");if(!r)return;const i=`${r.id}?origin=${QP()}`;window.open(i),e(()=>({authItems:gr(n.id,t().authItems,s=>({...s,isLoggedIn:!1,session:null,isPending:!1}))}))},nextAuth:()=>{const n=t().authItems.length,r=t().currentAuth+1;r>=n||e(()=>({currentAuth:r}))},previousAuth:()=>{const n=t().currentAuth-1;n<0||e(()=>({currentAuth:n}))},setAuth:n=>{n!==-1&&(n<0||n>=t().authItems.length)||e(()=>({currentAuth:n}))},addService:(n,r)=>{if(!n.service)return;const i=n.service.find(u=>u.type==="AuthAccessTokenService2"),s=n;if(t().authItems.find(u=>u.service.id===n.id)){e(()=>({authItems:gr(n.id,t().authItems,u=>({...u,instances:u.instances+1}))}));return}if(e(()=>({currentAuth:s.profile==="active"?0:t().currentAuth,authItems:[{id:n.id,type:n.profile,service:n,probeId:r,canAuthenticate:!0,instances:1,isPending:!1,isLoggedIn:!1,session:null},...t().authItems]})),n.profile==="external"){if(!i)throw new Error("Token service not found");vp(i).then(u=>{e(()=>({authItems:gr(n.id,t().authItems,d=>({...d,isLoggedIn:!0,isPending:!1,session:{token:u.accessToken,expires:u.expiresIn}}))}))}).catch(u=>{e(()=>({authItems:gr(n.id,t().authItems,d=>({...d,isLoggedIn:!1,isPending:!1,canAuthenticate:!1,error:u.message}))}))})}if(n.profile==="kiosk"){if(!i)throw new Error("Token service not found");e(()=>({authItems:gr(n.id,t().authItems,u=>({...u,isPending:!0}))})),Kx(s).then(()=>{vp(i).then(u=>{e(()=>({authItems:gr(n.id,t().authItems,d=>({...d,isLoggedIn:!0,isPending:!1,session:{token:u.accessToken,expires:u.expiresIn}}))}))}).catch(u=>{e(()=>({authItems:gr(n.id,t().authItems,d=>({...d,isLoggedIn:!1,isPending:!1,error:u.message}))}))})})}n.profile},removeService:(n,r)=>{const i=t().currentAuth===t().authItems.findIndex(o=>o.service.id===n.id);let s=t().currentAuth;if(i){const o=t().authItems.find(d=>d.service.id===n.id);o&&o.instances>1||(s=t().authItems.findIndex(h=>h.service.id!==n.id&&h.instances>0))}e(()=>({authItems:gr(n.id,t().authItems,o=>({...o,instances:o.instances-1})),currentAuth:s}))}})),rO=(e,t)=>us((n,r)=>({service:e,status:e?"unknown":"success",shouldRedirect:!1,redirectResource:null,shouldSubstitute:!1,substituteResource:null,error:null,errorHeading:null,errorNote:null,shouldDisplayResource:!1,token:t||null,async probe(){var o;if(!r().service)return;const i=(o=r().service)==null?void 0:o.id;if(!i){n({status:"error",error:"Service ID not found",errorHeading:{en:["Service ID not found"]}});return}n({status:"probing"});const s=r().token;try{const u=await fetch(i,{headers:s?{Authorization:`Bearer ${r().token}`,Accept:"application/json"}:{Accept:"application/json"}}).then(d=>d.json());if(u.status===200)n({status:"success",shouldDisplayResource:!0,error:null,errorHeading:null,errorNote:null,shouldSubstitute:!1,shouldRedirect:!1});else if(u.status<400&&u.status>=300){if(!u.location)throw new Error("Redirect location not found");n({status:"error",shouldDisplayResource:!1,shouldRedirect:!0,redirectResource:u.location||null})}else if(u.status===401)n({status:"error",shouldDisplayResource:!1,shouldRedirect:!1,shouldSubstitute:!!u.substitute,substituteResource:u.substitute||null,error:"Unauthorized",errorHeading:u.heading||{en:["Unauthorized"]},errorNote:u.note||null});else throw new Error("Unknown error")}catch(u){n({status:"error",error:u.message,errorHeading:{en:["Unknown error"]}})}},setToken(i){n({token:i})}}));function iO(e){const t=e.service||e.services||[],n={hasAuth:!1,services:{}};for(const r of t)if(r.type==="AuthProbeService2"){n.services.probe=r,n.hasAuth=!0;const i=r.service.filter(s=>s.type==="AuthAccessService2");i[0]&&(n.services.access=i[0])}return n}async function vp(e,{strict:t=!0}={}){return new Promise((n,r)=>{const i=Math.random().toString(36).substring(7),s=`${e.id}?messageId=${i}&origin=${window.location.origin}`,o=h=>{const c=h.data;if(c.messageId===i){if(t&&c.type!=="AuthAccessToken2"){u(),r("Invalid response, expected type=AuthAccessToken2");return}if(!c.accessToken){u(),r("Invalid response, expected accessToken");return}u(),n(c)}},u=()=>window.removeEventListener("message",o),d=document.createElement("iframe");d.src=s,d.style.display="none",document.body.appendChild(d),window.addEventListener("message",o)})}function QP(e){const t=window.location;return t.protocol+"//"+t.hostname+(t.port?":"+t.port:"")}async function Kx(e){const t=`${e.id}?origin=${QP()}`,n=window.open(t);if(!n)throw new Error("Failed to open window");return new Promise((r,i)=>{const s=setInterval(()=>{n.closed&&(clearInterval(s),r())},500)})}function sO(e){var s;const t=b.useMemo(()=>iO(e),[e]),n=hO((s=t.services.access)==null?void 0:s.id),r=b.useMemo(()=>rO(t.services.probe,n),[t.services.probe]),i=Te(r);return b.useEffect(()=>{i.status==="unknown"&&!n&&i.probe()},[t.services.probe,i.status]),b.useEffect(()=>{n&&(i.setToken(n),i.probe())},[n]),[e,i,t.hasAuth]}const Ha=b.createContext(null),oO=b.createContext(null);oO.displayName="CurrentAuth";const lO=b.createContext(null);lO.displayName="AuthActions";function aO({children:e}){const t=b.useMemo(()=>nO(),[]);return E.jsx(Ha.Provider,{value:t,children:e})}function uO(){return!!b.useContext(Ha)}function tf(){const e=b.useContext(Ha);if(!e)throw new Error("useAuthActions must be used within a AuthProvider");return e}function cO(){const e=tf();return Te(e,n=>({login:n.login,logout:n.logout,nextAuth:n.nextAuth,previousAuth:n.previousAuth,setAuth:n.setAuth,addService:n.addService,removeService:n.removeService}))}function dO(){const e=tf();return Te(e,t=>t)}function fO(e){const t=tf();return Te(t,r=>r.authItems.find(i=>i.service.id===e))}function hO(e){const t=tf();return Te(t,r=>{var i,s;return(s=(i=r.authItems.find(o=>o.id===e))==null?void 0:i.session)==null?void 0:s.token})}function pO(e){const t=cO(),n=fO(e.service.id);return b.useEffect(()=>(t==null||t.addService(e.service,e.probeId),()=>{t==null||t.removeService(e.service,e.probeId)}),[e.service]),n?(n.error||!n.isLoggedIn,e.children):null}function xp(){return null}function gO(e){const[t,n,r]=sO(e.resource);e.fallbackComponent;const i=e.loadingComponent||xp,s=e.errorComponent||xp,o=n.service;let u=null;if(!r||!o)return e.children(t);const d=o.service.filter(h=>h.type==="AuthAccessService2");n.status==="error"&&(u=E.jsx(s,{resource:e.resource,error:n.error||"",heading:n.errorHeading,note:n.errorNote,extra:e.extra})),(n.status==="unknown"||n.status==="probing")&&(u=E.jsx(i,{})),n.status==="success"&&(u=e.children(t));for(const h of d)u=E.jsx(pO,{service:h,probeId:o.id,children:u},h.id);return u}const YP=e=>e.id||e["@id"];function XP(e){return(Array.isArray(e.service)?e.service:[e.service]).find(n=>n.profile==="http://iiif.io/api/search/0/autocomplete"||n.profile==="http://iiif.io/api/search/1/autocomplete"||n.profile==="AutoCompleteService1")}const mO=e=>{const t=XP(e);if(!t)return null;const n=YP(t);let r=null;return us((i,s)=>({results:[],lastQuery:{},loading:!1,error:!1,errorMessage:"",ignored:[],async search(o,u={}){r&&!r.signal.aborted&&r.abort(),r=new AbortController;const d=new URLSearchParams;if(d.set("q",o),u.motivation&&d.set("motivation",u.motivation),u.date&&d.set("date",u.date),u.user&&d.set("user",u.user),(!o||o.length<3)&&!u.motivation&&!u.date&&!u.user){i({results:[],loading:!1,lastQuery:null});return}i({loading:!0,lastQuery:{q:o,motivation:u.motivation,date:u.date,user:u.user}}),fetch(`${n}?${d.toString()}`,{signal:r.signal,headers:{"Content-Type":"application/json",Accept:"application/json",...u.headers||{}}}).then(async h=>{if(!(r!=null&&r.signal.aborted))if(h.ok){const c=await h.json();i({loading:!1,ignored:c.ignored||[],results:c.terms,error:!1,errorMessage:""})}else i({results:[],error:!0,errorMessage:h.statusText})})}}))},yO=e=>{let t;typeof e=="string"?t={"@context":"http://iiif.io/api/search/1/context.json",profile:"http://iiif.io/api/search/1/search","@id":e,id:e,service:[]}:t=e;const n=t?YP(t):void 0;let r=null;return us((i,s)=>({service:t,resources:[],lastQuery:{},loading:!1,error:!1,highlight:null,hasSearch:!!t,hasAutocomplete:t?!!XP(t):!1,errorMessage:"",search(o,u={}){if(!n)throw new Error("No search service found.");r&&!r.signal.aborted&&r.abort(),r=new AbortController;const d=new URLSearchParams;o.q&&d.set("q",o.q),o.motivation&&d.set("motivation",o.motivation),o.date&&d.set("date",o.date),o.user&&d.set("user",o.user),i({loading:!0}),fetch(`${n}?${d.toString()}`,{signal:r.signal,headers:{"Content-Type":"application/json",Accept:"application/json",...u.headers||{}}}).then(async h=>{if(!(r!=null&&r.signal.aborted))if(h.ok){const c=await h.json();i({resources:c.resources,error:!1,errorMessage:""})}else i({resources:[],error:!0,errorMessage:h.statusText})})},clearSearch(){i({resources:[],error:!1,errorMessage:""})},highlightResult(o){const u=s().resources.find(d=>d["@id"]===o);i({highlight:u})},nextResult(){const o=s().resources,u=s().highlight;if(!u){i({highlight:o[0]||null});return}const d=o.findIndex(h=>h["@id"]===u["@id"]);if(d===-1){i({highlight:o[0]||null});return}i({highlight:o[d+1]||o[0]||null})},previousResult(){const o=s().resources,u=s().highlight;if(!u){i({highlight:o[o.length-1]||null});return}const d=o.findIndex(h=>h["@id"]===u["@id"]);if(d===-1){i({highlight:o[o.length-1]||null});return}if(d===0){i({highlight:o[o.length-1]||null});return}i({highlight:o[d-1]||o[o.length-1]||null})}}))};function vO(){const e=Br();return e?e.service.find(t=>t.profile==="SearchService1"||t.profile==="http://iiif.io/api/search/1/search"):void 0}const il=b.createContext(null);il.displayName="Search";function Va(){const e=b.useContext(il);if(!e)throw new Error("useSearch must be used within a SearchProvider");return Te(e)}function xO(){const e=Va(),t=b.useMemo(()=>{if(!e.service)throw new Error("No search service found. You can use useSearch().hasSearch to check for this.");return mO(e.service)},[e.service]);if(!t)throw new Error("No autocomplete service found. You can use useSearch().hasAutocomplete to check for this.");return Te(t)}function wO(e){const t=vO();return e.store?E.jsx(il.Provider,{value:e.store,children:e.children}):E.jsx(SO,{service:t,children:e.children})}function SO({service:e,children:t}){const n=b.useMemo(()=>yO(e),[e]);return E.jsx(il.Provider,{value:n,children:t})}const zl=()=>{},nf=b.createContext({setCurrentCanvasId:zl,setCurrentCanvasIndex:zl,nextCanvas:zl,previousCanvas:zl,items:[],sequence:[],setSequenceIndex:zl,currentSequenceIndex:0,hasNext:!1,hasPrevious:!1});function kO(e){const t=Br(),{cursor:n,visibleItems:r,next:i,sequence:s,items:o,setCanvasIndex:u,setCanvasId:d,previous:h,setSequenceIndex:c,hasNext:p,hasPrevious:m}=IA({startCanvas:e.startCanvas,disablePaging:e.pagingEnabled===!1}),w=b.useMemo(()=>({sequence:s,items:o,setCurrentCanvasId:d,nextCanvas:i,previousCanvas:h,totalCanvases:o.length,setCurrentCanvasIndex:u,setSequenceIndex:c,currentSequenceIndex:n,hasNext:p,hasPrevious:m}),[s,o,d,i,h,o,u,c,n]);return t?r.length===0?null:E.jsx(nf.Provider,{value:w,children:E.jsx(Jd.Provider,{value:r,children:E.jsx(Ko,{canvas:r[0],children:e.children})})}):(console.warn("The manifest passed to the provider is not a valid IIIF manifest."),E.jsx("div",{children:"Sorry, something went wrong."}))}function PO(e){const t=gy(e.vault),n=CA(e.manifest);if(!n)return console.warn("The manifest passed to the provider is not a valid IIIF manifest."),E.jsx("div",{children:"Sorry, something went wrong."});if(n.error)return E.jsx("div",{children:n.error.toString()});if(!n.isLoaded)return E.jsx("div",{children:"Loading..."});const r=E.jsx(kO,{...e,children:e.children});return E.jsx(hy,{vault:t,children:E.jsx(TA,{manifest:n.id,children:E.jsx(aO,{children:E.jsx(wO,{children:e.rangeId?E.jsx(bA,{range:e.rangeId,children:r}):r})})})})}function rf(){return b.useContext(nf)}const EO="modulepreload",CO=function(e){return"/"+e},Gx={},Zx=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),u=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));i=Promise.allSettled(n.map(d=>{if(d=CO(d),d in Gx)return;Gx[d]=!0;const h=d.endsWith(".css"),c=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${d}"]${c}`))return;const p=document.createElement("link");if(p.rel=h?"stylesheet":EO,h||(p.as="script"),p.crossOrigin="",p.href=d,u&&p.setAttribute("nonce",u),document.head.appendChild(p),h)return new Promise((m,w)=>{p.addEventListener("load",m),p.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${d}`)))})}))}function s(o){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=o,window.dispatchEvent(u),!u.defaultPrevented)throw o}return i.then(o=>{for(const u of o||[])u.status==="rejected"&&s(u.reason);return t().catch(s)})},ja=(e,t,n)=>{const r=e.length,i=n||Ee(r);for(let s=0;s<r;s++)i[s]=s%5===0?e[s+1]<t[3]&&e[s+3]>t[1]&&e[s+2]<t[4]&&e[s+4]>t[2]?1:0:e[s];return i};function Ee(e,t,n){return new Float32Array(e,t,n)}const TO=(e,t,n)=>{const r=e[1]<=t[3]&&e[3]>=t[1]&&e[2]<=t[4]&&e[4]>=t[2],i=n||Ee(5);return r?(i[0]=1,i[1]=Math.max(e[1],t[1]),i[2]=Math.max(e[2],t[2]),i[3]=Math.min(e[3],t[3]),i[4]=Math.min(e[4],t[4]),i):(i[0]=0,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i)},bO=e=>e.length/5,oi=(e,t,n)=>{const r=n||Ee(9);return r[0]=e[0]*t[0]+e[1]*t[3]+e[2]*t[6],r[1]=e[0]*t[1]+e[1]*t[4]+e[2]*t[7],r[2]=e[0]*t[2]+e[1]*t[5]+e[2]*t[8],r[3]=e[3]*t[0]+e[4]*t[3]+e[5]*t[6],r[4]=e[3]*t[1]+e[4]*t[4]+e[5]*t[7],r[5]=e[3]*t[2]+e[4]*t[5]+e[5]*t[8],r[6]=e[6]*t[0]+e[7]*t[3]+e[8]*t[6],r[7]=e[6]*t[1]+e[7]*t[4]+e[8]*t[7],r[8]=e[6]*t[2]+e[7]*t[5]+e[8]*t[8],r};class Be{constructor(t){this.index=0,this.length=t,this.points=Ee(this.length)}static grid(t=1,n=1){return new Be(5*t*n)}static point(t,n){const r=Ee(5);return r[0]=1,r[1]=t,r[2]=n,r[3]=t,r[4]=n,r}static positionPair(t){const n=Ee(5);return n[0]=1,n[1]=t.x1,n[2]=t.y1,n[3]=t.x2,n[4]=t.y2,n}static projection(t){return Be.singleBox(t.width,t.height,t.x,t.y)}static singleBox(t,n,r=0,i=0){const s=Ee(5);return s[0]=1,s[1]=r,s[2]=i,s[3]=t+r,s[4]=n+i,s}row(t){return t(this)}addPoints(t,n,r,i){return this.points[this.index]=1,this.points[1+this.index]=t,this.points[2+this.index]=n,this.points[3+this.index]=r,this.points[4+this.index]=i,this.index+=5,this}addBox(t,n,r,i){return this.addPoints(t,n,t+r,n+i),this}build(){return this.points}}const zr=(e,t)=>{const n=e.length;for(let r=0;r<n;r++)e[r]=r%5===0?t[6]*e[r+1]+t[7]*e[r+2]+t[8]*e[r]:r%5%2===1?t[0]*e[r]+t[1]*e[r+1]+t[2]:t[3]*e[r-1]+t[4]*e[r]+t[5];return e},ns=e=>{const t=Ee(9);return t[0]=e,t[4]=e,t[8]=1,t},hn=(e,t)=>{const n=Ee(9);return n[0]=1,n[2]=e,n[4]=1,n[5]=t,n[8]=1,n},Ma=(e,t,n)=>oi(hn((1-e)*t,(1-e)*n),ns(e)),li=(e,t,n)=>{const r=e.length,i=n&&n.length>=r?n.slice(0,r):Ee(r);for(let s=0;s<r;s++)i[s]=s%5===0?t[6]*e[s+1]+t[7]*e[s+2]+t[8]*e[s]:s%5%2===1?t[0]*e[s]+t[1]*e[s+1]+t[2]:t[3]*e[s-1]+t[4]*e[s]+t[5];return i},$l=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,RO=typeof AbortController=="function",vd=RO?AbortController:class{constructor(){this.signal=new KP}abort(t=new Error("This operation was aborted")){this.signal.reason=this.signal.reason||t,this.signal.aborted=!0,this.signal.dispatchEvent({type:"abort",target:this.signal})}},IO=typeof AbortSignal=="function",_O=typeof vd.AbortSignal=="function",KP=IO?AbortSignal:_O?vd.AbortController:class{constructor(){this.reason=void 0,this.aborted=!1,this._listeners=[]}dispatchEvent(t){t.type==="abort"&&(this.aborted=!0,this.onabort(t),this._listeners.forEach(n=>n(t),this))}onabort(){}addEventListener(t,n){t==="abort"&&this._listeners.push(n)}removeEventListener(t,n){t==="abort"&&(this._listeners=this._listeners.filter(r=>r!==n))}},my=new Set,wp=(e,t)=>{const n=`LRU_CACHE_OPTION_${e}`;sf(n)&&yy(n,`${e} option`,`options.${t}`,qs)},Sp=(e,t)=>{const n=`LRU_CACHE_METHOD_${e}`;if(sf(n)){const{prototype:r}=qs,{get:i}=Object.getOwnPropertyDescriptor(r,e);yy(n,`${e} method`,`cache.${t}()`,i)}},AO=(e,t)=>{const n=`LRU_CACHE_PROPERTY_${e}`;if(sf(n)){const{prototype:r}=qs,{get:i}=Object.getOwnPropertyDescriptor(r,e);yy(n,`${e} property`,`cache.${t}`,i)}},GP=(...e)=>{typeof process=="object"&&process&&typeof process.emitWarning=="function"?process.emitWarning(...e):console.error(...e)},sf=e=>!my.has(e),yy=(e,t,n,r)=>{my.add(e);const i=`The ${t} is deprecated. Please use ${n} instead.`;GP(i,"DeprecationWarning",e,r)},ji=e=>e&&e===Math.floor(e)&&e>0&&isFinite(e),ZP=e=>ji(e)?e<=Math.pow(2,8)?Uint8Array:e<=Math.pow(2,16)?Uint16Array:e<=Math.pow(2,32)?Uint32Array:e<=Number.MAX_SAFE_INTEGER?Fc:null:null;class Fc extends Array{constructor(t){super(t),this.fill(0)}}class OO{constructor(t){if(t===0)return[];const n=ZP(t);this.heap=new n(t),this.length=0}push(t){this.heap[this.length++]=t}pop(){return this.heap[--this.length]}}class qs{constructor(t={}){const{max:n=0,ttl:r,ttlResolution:i=1,ttlAutopurge:s,updateAgeOnGet:o,updateAgeOnHas:u,allowStale:d,dispose:h,disposeAfter:c,noDisposeOnSet:p,noUpdateTTL:m,maxSize:w=0,maxEntrySize:y=0,sizeCalculation:S,fetchMethod:C,fetchContext:x,noDeleteOnFetchRejection:k,noDeleteOnStaleGet:T,allowStaleOnFetchRejection:_,allowStaleOnFetchAbort:R,ignoreFetchAbort:O}=t,{length:F,maxAge:z,stale:J}=t instanceof qs?{}:t;if(n!==0&&!ji(n))throw new TypeError("max option must be a nonnegative integer");const j=n?ZP(n):Array;if(!j)throw new Error("invalid max value: "+n);if(this.max=n,this.maxSize=w,this.maxEntrySize=y||this.maxSize,this.sizeCalculation=S||F,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=C||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=x,!this.fetchMethod&&x!==void 0)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(n).fill(null),this.valList=new Array(n).fill(null),this.next=new j(n),this.prev=new j(n),this.head=0,this.tail=0,this.free=new OO(n),this.initialFill=1,this.size=0,typeof h=="function"&&(this.dispose=h),typeof c=="function"?(this.disposeAfter=c,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!p,this.noUpdateTTL=!!m,this.noDeleteOnFetchRejection=!!k,this.allowStaleOnFetchRejection=!!_,this.allowStaleOnFetchAbort=!!R,this.ignoreFetchAbort=!!O,this.maxEntrySize!==0){if(this.maxSize!==0&&!ji(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!ji(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!d||!!J,this.noDeleteOnStaleGet=!!T,this.updateAgeOnGet=!!o,this.updateAgeOnHas=!!u,this.ttlResolution=ji(i)||i===0?i:1,this.ttlAutopurge=!!s,this.ttl=r||z||0,this.ttl){if(!ji(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const H="LRU_CACHE_UNBOUNDED";sf(H)&&(my.add(H),GP("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",H,qs))}J&&wp("stale","allowStale"),z&&wp("maxAge","ttl"),F&&wp("length","sizeCalculation")}getRemainingTTL(t){return this.has(t,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new Fc(this.max),this.starts=new Fc(this.max),this.setItemTTL=(r,i,s=$l.now())=>{if(this.starts[r]=i!==0?s:0,this.ttls[r]=i,i!==0&&this.ttlAutopurge){const o=setTimeout(()=>{this.isStale(r)&&this.delete(this.keyList[r])},i+1);o.unref&&o.unref()}},this.updateItemAge=r=>{this.starts[r]=this.ttls[r]!==0?$l.now():0},this.statusTTL=(r,i)=>{r&&(r.ttl=this.ttls[i],r.start=this.starts[i],r.now=t||n(),r.remainingTTL=r.now+r.ttl-r.start)};let t=0;const n=()=>{const r=$l.now();if(this.ttlResolution>0){t=r;const i=setTimeout(()=>t=0,this.ttlResolution);i.unref&&i.unref()}return r};this.getRemainingTTL=r=>{const i=this.keyMap.get(r);return i===void 0?0:this.ttls[i]===0||this.starts[i]===0?1/0:this.starts[i]+this.ttls[i]-(t||n())},this.isStale=r=>this.ttls[r]!==0&&this.starts[r]!==0&&(t||n())-this.starts[r]>this.ttls[r]}updateItemAge(t){}statusTTL(t,n){}setItemTTL(t,n,r){}isStale(t){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new Fc(this.max),this.removeItemSize=t=>{this.calculatedSize-=this.sizes[t],this.sizes[t]=0},this.requireSize=(t,n,r,i)=>{if(this.isBackgroundFetch(n))return 0;if(!ji(r))if(i){if(typeof i!="function")throw new TypeError("sizeCalculation must be a function");if(r=i(n,t),!ji(r))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return r},this.addItemSize=(t,n,r)=>{if(this.sizes[t]=n,this.maxSize){const i=this.maxSize-this.sizes[t];for(;this.calculatedSize>i;)this.evict(!0)}this.calculatedSize+=this.sizes[t],r&&(r.entrySize=n,r.totalCalculatedSize=this.calculatedSize)}}removeItemSize(t){}addItemSize(t,n){}requireSize(t,n,r,i){if(r||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:t=this.allowStale}={}){if(this.size)for(let n=this.tail;!(!this.isValidIndex(n)||((t||!this.isStale(n))&&(yield n),n===this.head));)n=this.prev[n]}*rindexes({allowStale:t=this.allowStale}={}){if(this.size)for(let n=this.head;!(!this.isValidIndex(n)||((t||!this.isStale(n))&&(yield n),n===this.tail));)n=this.next[n]}isValidIndex(t){return t!==void 0&&this.keyMap.get(this.keyList[t])===t}*entries(){for(const t of this.indexes())this.valList[t]!==void 0&&this.keyList[t]!==void 0&&!this.isBackgroundFetch(this.valList[t])&&(yield[this.keyList[t],this.valList[t]])}*rentries(){for(const t of this.rindexes())this.valList[t]!==void 0&&this.keyList[t]!==void 0&&!this.isBackgroundFetch(this.valList[t])&&(yield[this.keyList[t],this.valList[t]])}*keys(){for(const t of this.indexes())this.keyList[t]!==void 0&&!this.isBackgroundFetch(this.valList[t])&&(yield this.keyList[t])}*rkeys(){for(const t of this.rindexes())this.keyList[t]!==void 0&&!this.isBackgroundFetch(this.valList[t])&&(yield this.keyList[t])}*values(){for(const t of this.indexes())this.valList[t]!==void 0&&!this.isBackgroundFetch(this.valList[t])&&(yield this.valList[t])}*rvalues(){for(const t of this.rindexes())this.valList[t]!==void 0&&!this.isBackgroundFetch(this.valList[t])&&(yield this.valList[t])}[Symbol.iterator](){return this.entries()}find(t,n){for(const r of this.indexes()){const i=this.valList[r],s=this.isBackgroundFetch(i)?i.__staleWhileFetching:i;if(s!==void 0&&t(s,this.keyList[r],this))return this.get(this.keyList[r],n)}}forEach(t,n=this){for(const r of this.indexes()){const i=this.valList[r],s=this.isBackgroundFetch(i)?i.__staleWhileFetching:i;s!==void 0&&t.call(n,s,this.keyList[r],this)}}rforEach(t,n=this){for(const r of this.rindexes()){const i=this.valList[r],s=this.isBackgroundFetch(i)?i.__staleWhileFetching:i;s!==void 0&&t.call(n,s,this.keyList[r],this)}}get prune(){return Sp("prune","purgeStale"),this.purgeStale}purgeStale(){let t=!1;for(const n of this.rindexes({allowStale:!0}))this.isStale(n)&&(this.delete(this.keyList[n]),t=!0);return t}dump(){const t=[];for(const n of this.indexes({allowStale:!0})){const r=this.keyList[n],i=this.valList[n],s=this.isBackgroundFetch(i)?i.__staleWhileFetching:i;if(s===void 0)continue;const o={value:s};if(this.ttls){o.ttl=this.ttls[n];const u=$l.now()-this.starts[n];o.start=Math.floor(Date.now()-u)}this.sizes&&(o.size=this.sizes[n]),t.unshift([r,o])}return t}load(t){this.clear();for(const[n,r]of t){if(r.start){const i=Date.now()-r.start;r.start=$l.now()-i}this.set(n,r.value,r)}}dispose(t,n,r){}set(t,n,{ttl:r=this.ttl,start:i,noDisposeOnSet:s=this.noDisposeOnSet,size:o=0,sizeCalculation:u=this.sizeCalculation,noUpdateTTL:d=this.noUpdateTTL,status:h}={}){if(o=this.requireSize(t,n,o,u),this.maxEntrySize&&o>this.maxEntrySize)return h&&(h.set="miss",h.maxEntrySizeExceeded=!0),this.delete(t),this;let c=this.size===0?void 0:this.keyMap.get(t);if(c===void 0)c=this.newIndex(),this.keyList[c]=t,this.valList[c]=n,this.keyMap.set(t,c),this.next[this.tail]=c,this.prev[c]=this.tail,this.tail=c,this.size++,this.addItemSize(c,o,h),h&&(h.set="add"),d=!1;else{this.moveToTail(c);const p=this.valList[c];if(n!==p){if(this.isBackgroundFetch(p)?p.__abortController.abort(new Error("replaced")):s||(this.dispose(p,t,"set"),this.disposeAfter&&this.disposed.push([p,t,"set"])),this.removeItemSize(c),this.valList[c]=n,this.addItemSize(c,o,h),h){h.set="replace";const m=p&&this.isBackgroundFetch(p)?p.__staleWhileFetching:p;m!==void 0&&(h.oldValue=m)}}else h&&(h.set="update")}if(r!==0&&this.ttl===0&&!this.ttls&&this.initializeTTLTracking(),d||this.setItemTTL(c,r,i),this.statusTTL(h,c),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max&&this.max!==0?this.evict(!1):this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){const t=this.valList[this.head];return this.evict(!0),t}}evict(t){const n=this.head,r=this.keyList[n],i=this.valList[n];return this.isBackgroundFetch(i)?i.__abortController.abort(new Error("evicted")):(this.dispose(i,r,"evict"),this.disposeAfter&&this.disposed.push([i,r,"evict"])),this.removeItemSize(n),t&&(this.keyList[n]=null,this.valList[n]=null,this.free.push(n)),this.head=this.next[n],this.keyMap.delete(r),this.size--,n}has(t,{updateAgeOnHas:n=this.updateAgeOnHas,status:r}={}){const i=this.keyMap.get(t);if(i!==void 0)if(this.isStale(i))r&&(r.has="stale",this.statusTTL(r,i));else return n&&this.updateItemAge(i),r&&(r.has="hit"),this.statusTTL(r,i),!0;else r&&(r.has="miss");return!1}peek(t,{allowStale:n=this.allowStale}={}){const r=this.keyMap.get(t);if(r!==void 0&&(n||!this.isStale(r))){const i=this.valList[r];return this.isBackgroundFetch(i)?i.__staleWhileFetching:i}}backgroundFetch(t,n,r,i){const s=n===void 0?void 0:this.valList[n];if(this.isBackgroundFetch(s))return s;const o=new vd;r.signal&&r.signal.addEventListener("abort",()=>o.abort(r.signal.reason));const u={signal:o.signal,options:r,context:i},d=(w,y=!1)=>{const{aborted:S}=o.signal,C=r.ignoreFetchAbort&&w!==void 0;return r.status&&(S&&!y?(r.status.fetchAborted=!0,r.status.fetchError=o.signal.reason,C&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),S&&!C&&!y?c(o.signal.reason):(this.valList[n]===m&&(w===void 0?m.__staleWhileFetching?this.valList[n]=m.__staleWhileFetching:this.delete(t):(r.status&&(r.status.fetchUpdated=!0),this.set(t,w,u.options))),w)},h=w=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=w),c(w)),c=w=>{const{aborted:y}=o.signal,S=y&&r.allowStaleOnFetchAbort,C=S||r.allowStaleOnFetchRejection,x=C||r.noDeleteOnFetchRejection;if(this.valList[n]===m&&(!x||m.__staleWhileFetching===void 0?this.delete(t):S||(this.valList[n]=m.__staleWhileFetching)),C)return r.status&&m.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),m.__staleWhileFetching;if(m.__returned===m)throw w},p=(w,y)=>{this.fetchMethod(t,s,u).then(S=>w(S),y),o.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(w(),r.allowStaleOnFetchAbort&&(w=S=>d(S,!0)))})};r.status&&(r.status.fetchDispatched=!0);const m=new Promise(p).then(d,h);return m.__abortController=o,m.__staleWhileFetching=s,m.__returned=null,n===void 0?(this.set(t,m,{...u.options,status:void 0}),n=this.keyMap.get(t)):this.valList[n]=m,m}isBackgroundFetch(t){return t&&typeof t=="object"&&typeof t.then=="function"&&Object.prototype.hasOwnProperty.call(t,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(t,"__returned")&&(t.__returned===t||t.__returned===null)}async fetch(t,{allowStale:n=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:o=this.noDisposeOnSet,size:u=0,sizeCalculation:d=this.sizeCalculation,noUpdateTTL:h=this.noUpdateTTL,noDeleteOnFetchRejection:c=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:p=this.allowStaleOnFetchRejection,ignoreFetchAbort:m=this.ignoreFetchAbort,allowStaleOnFetchAbort:w=this.allowStaleOnFetchAbort,fetchContext:y=this.fetchContext,forceRefresh:S=!1,status:C,signal:x}={}){if(!this.fetchMethod)return C&&(C.fetch="get"),this.get(t,{allowStale:n,updateAgeOnGet:r,noDeleteOnStaleGet:i,status:C});const k={allowStale:n,updateAgeOnGet:r,noDeleteOnStaleGet:i,ttl:s,noDisposeOnSet:o,size:u,sizeCalculation:d,noUpdateTTL:h,noDeleteOnFetchRejection:c,allowStaleOnFetchRejection:p,allowStaleOnFetchAbort:w,ignoreFetchAbort:m,status:C,signal:x};let T=this.keyMap.get(t);if(T===void 0){C&&(C.fetch="miss");const _=this.backgroundFetch(t,T,k,y);return _.__returned=_}else{const _=this.valList[T];if(this.isBackgroundFetch(_)){const J=n&&_.__staleWhileFetching!==void 0;return C&&(C.fetch="inflight",J&&(C.returnedStale=!0)),J?_.__staleWhileFetching:_.__returned=_}const R=this.isStale(T);if(!S&&!R)return C&&(C.fetch="hit"),this.moveToTail(T),r&&this.updateItemAge(T),this.statusTTL(C,T),_;const O=this.backgroundFetch(t,T,k,y),F=O.__staleWhileFetching!==void 0,z=F&&n;return C&&(C.fetch=F&&R?"stale":"refresh",z&&R&&(C.returnedStale=!0)),z?O.__staleWhileFetching:O.__returned=O}}get(t,{allowStale:n=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:i=this.noDeleteOnStaleGet,status:s}={}){const o=this.keyMap.get(t);if(o!==void 0){const u=this.valList[o],d=this.isBackgroundFetch(u);return this.statusTTL(s,o),this.isStale(o)?(s&&(s.get="stale"),d?(s&&(s.returnedStale=n&&u.__staleWhileFetching!==void 0),n?u.__staleWhileFetching:void 0):(i||this.delete(t),s&&(s.returnedStale=n),n?u:void 0)):(s&&(s.get="hit"),d?u.__staleWhileFetching:(this.moveToTail(o),r&&this.updateItemAge(o),u))}else s&&(s.get="miss")}connect(t,n){this.prev[n]=t,this.next[t]=n}moveToTail(t){t!==this.tail&&(t===this.head?this.head=this.next[t]:this.connect(this.prev[t],this.next[t]),this.connect(this.tail,t),this.tail=t)}get del(){return Sp("del","delete"),this.delete}delete(t){let n=!1;if(this.size!==0){const r=this.keyMap.get(t);if(r!==void 0)if(n=!0,this.size===1)this.clear();else{this.removeItemSize(r);const i=this.valList[r];this.isBackgroundFetch(i)?i.__abortController.abort(new Error("deleted")):(this.dispose(i,t,"delete"),this.disposeAfter&&this.disposed.push([i,t,"delete"])),this.keyMap.delete(t),this.keyList[r]=null,this.valList[r]=null,r===this.tail?this.tail=this.prev[r]:r===this.head?this.head=this.next[r]:(this.next[this.prev[r]]=this.next[r],this.prev[this.next[r]]=this.prev[r]),this.size--,this.free.push(r)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return n}clear(){for(const t of this.rindexes({allowStale:!0})){const n=this.valList[t];if(this.isBackgroundFetch(n))n.__abortController.abort(new Error("deleted"));else{const r=this.keyList[t];this.dispose(n,r,"delete"),this.disposeAfter&&this.disposed.push([n,r,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return Sp("reset","clear"),this.clear}get length(){return AO("length","size"),this.size}static get AbortController(){return vd}static get AbortSignal(){return KP}}var Jx=!1,Is,Wg,Hg,zc,$c,JP,Dc,Vg,qg,Qg,eE,Yg,Xg,tE,nE;function En(){if(!Jx){Jx=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),n=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(Yg=/\b(iPhone|iP[ao]d)/.exec(e),Xg=/\b(iP[ao]d)/.exec(e),Qg=/Android/i.exec(e),tE=/FBAN\/\w+;/i.exec(e),nE=/Mobile/i.exec(e),eE=!!/Win64/.exec(e),t){Is=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN,Is&&document&&document.documentMode&&(Is=document.documentMode);var r=/(?:Trident\/(\d+.\d+))/.exec(e);JP=r?parseFloat(r[1])+4:Is,Wg=t[2]?parseFloat(t[2]):NaN,Hg=t[3]?parseFloat(t[3]):NaN,zc=t[4]?parseFloat(t[4]):NaN,zc?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),$c=t&&t[1]?parseFloat(t[1]):NaN):$c=NaN}else Is=Wg=Hg=$c=zc=NaN;if(n){if(n[1]){var i=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);Dc=i?parseFloat(i[1].replace("_",".")):!0}else Dc=!1;Vg=!!n[2],qg=!!n[3]}else Dc=Vg=qg=!1}}var Kg={ie:function(){return En()||Is},ieCompatibilityMode:function(){return En()||JP>Is},ie64:function(){return Kg.ie()&&eE},firefox:function(){return En()||Wg},opera:function(){return En()||Hg},webkit:function(){return En()||zc},safari:function(){return Kg.webkit()},chrome:function(){return En()||$c},windows:function(){return En()||Vg},osx:function(){return En()||Dc},linux:function(){return En()||qg},iphone:function(){return En()||Yg},mobile:function(){return En()||Yg||Xg||Qg||nE},nativeApp:function(){return En()||tE},android:function(){return En()||Qg},ipad:function(){return En()||Xg}},jO=Kg,MO=!!(typeof window<"u"&&window.document&&window.document.createElement),LO={canUseDOM:MO},NO=LO,rE=NO,iE;rE.canUseDOM&&(iE=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);/**
 * Checks if an event is supported in the current execution environment.
 *
 * NOTE: This will not work correctly for non-generic events such as `change`,
 * `reset`, `load`, `error`, and `select`.
 *
 * Borrows from Modernizr.
 *
 * @param {string} eventNameSuffix Event name, e.g. "click".
 * @param {?boolean} capture Check if the capture phase is supported.
 * @return {boolean} True if the event is supported.
 * @internal
 * @license Modernizr 3.0.0pre (Custom Build) | MIT
 */function FO(e,t){if(!rE.canUseDOM||t&&!("addEventListener"in document))return!1;var n="on"+e,r=n in document;if(!r){var i=document.createElement("div");i.setAttribute(n,"return;"),r=typeof i[n]=="function"}return!r&&iE&&e==="wheel"&&(r=document.implementation.hasFeature("Events.wheel","3.0")),r}var zO=FO,$O=jO,DO=zO,ew=10,tw=40,nw=800;function sE(e){var t=0,n=0,r=0,i=0;return"detail"in e&&(n=e.detail),"wheelDelta"in e&&(n=-e.wheelDelta/120),"wheelDeltaY"in e&&(n=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=n,n=0),r=t*ew,i=n*ew,"deltaY"in e&&(i=e.deltaY),"deltaX"in e&&(r=e.deltaX),(r||i)&&e.deltaMode&&(e.deltaMode==1?(r*=tw,i*=tw):(r*=nw,i*=nw)),r&&!t&&(t=r<1?-1:1),i&&!n&&(n=i<1?-1:1),{spinX:t,spinY:n,pixelX:r,pixelY:i}}sE.getEventType=function(){return $O.firefox()?"DOMMouseScroll":DO("wheel")?"wheel":"mousewheel"};var BO=sE,UO=BO;const WO=Jo(UO);function rw(e,t){let n;return(...r)=>{window.clearTimeout(n),n=window.setTimeout(()=>e(...r),t)}}function oE({debounce:e,scroll:t,polyfill:n,offsetSize:r}={debounce:0,scroll:!1,offsetSize:!1}){const i=n||(typeof window>"u"?class{}:window.ResizeObserver);if(!i)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[s,o]=b.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),u=b.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:s,orientationHandler:null}),d=e?typeof e=="number"?e:e.scroll:null,h=e?typeof e=="number"?e:e.resize:null,c=b.useRef(!1);b.useEffect(()=>(c.current=!0,()=>void(c.current=!1)));const[p,m,w]=b.useMemo(()=>{const x=()=>{if(!u.current.element)return;const{left:k,top:T,width:_,height:R,bottom:O,right:F,x:z,y:J}=u.current.element.getBoundingClientRect(),j={left:k,top:T,width:_,height:R,bottom:O,right:F,x:z,y:J};u.current.element instanceof HTMLElement&&r&&(j.height=u.current.element.offsetHeight,j.width=u.current.element.offsetWidth),Object.freeze(j),c.current&&!QO(u.current.lastBounds,j)&&o(u.current.lastBounds=j)};return[x,h?rw(x,h):x,d?rw(x,d):x]},[o,r,d,h]);function y(){u.current.scrollContainers&&(u.current.scrollContainers.forEach(x=>x.removeEventListener("scroll",w,!0)),u.current.scrollContainers=null),u.current.resizeObserver&&(u.current.resizeObserver.disconnect(),u.current.resizeObserver=null),u.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",u.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",u.current.orientationHandler))}function S(){u.current.element&&(u.current.resizeObserver=new i(w),u.current.resizeObserver.observe(u.current.element),t&&u.current.scrollContainers&&u.current.scrollContainers.forEach(x=>x.addEventListener("scroll",w,{capture:!0,passive:!0})),u.current.orientationHandler=()=>{w()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",u.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",u.current.orientationHandler))}const C=x=>{!x||x===u.current.element||(y(),u.current.element=x,u.current.scrollContainers=lE(x),S())};return VO(w,!!t),HO(m),b.useEffect(()=>{y(),S()},[t,w,m]),b.useEffect(()=>y,[]),[C,s,p]}function HO(e){b.useEffect(()=>{const t=e;return window.addEventListener("resize",t),()=>void window.removeEventListener("resize",t)},[e])}function VO(e,t){b.useEffect(()=>{if(t){const n=e;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[e,t])}function lE(e){const t=[];if(!e||e===document.body)return t;const{overflow:n,overflowX:r,overflowY:i}=window.getComputedStyle(e);return[n,r,i].some(s=>s==="auto"||s==="scroll")&&t.push(e),[...t,...lE(e.parentElement)]}const qO=["x","y","top","bottom","left","right","width","height"],QO=(e,t)=>qO.every(n=>e[n]===t[n]);var aE={exports:{}},kp={exports:{}},Pp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var iw;function YO(){return iw||(iw=1,function(e){function t(M,L){var W=M.length;M.push(L);e:for(;0<W;){var le=W-1>>>1,we=M[le];if(0<i(we,L))M[le]=L,M[W]=we,W=le;else break e}}function n(M){return M.length===0?null:M[0]}function r(M){if(M.length===0)return null;var L=M[0],W=M.pop();if(W!==L){M[0]=W;e:for(var le=0,we=M.length,je=we>>>1;le<je;){var Re=2*(le+1)-1,be=M[Re],Ie=Re+1,Ke=M[Ie];if(0>i(be,W))Ie<we&&0>i(Ke,be)?(M[le]=Ke,M[Ie]=W,le=Ie):(M[le]=be,M[Re]=W,le=Re);else if(Ie<we&&0>i(Ke,W))M[le]=Ke,M[Ie]=W,le=Ie;else break e}}return L}function i(M,L){var W=M.sortIndex-L.sortIndex;return W!==0?W:M.id-L.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var o=Date,u=o.now();e.unstable_now=function(){return o.now()-u}}var d=[],h=[],c=1,p=null,m=3,w=!1,y=!1,S=!1,C=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(M){for(var L=n(h);L!==null;){if(L.callback===null)r(h);else if(L.startTime<=M)r(h),L.sortIndex=L.expirationTime,t(d,L);else break;L=n(h)}}function _(M){if(S=!1,T(M),!y)if(n(d)!==null)y=!0,se(R);else{var L=n(h);L!==null&&ve(_,L.startTime-M)}}function R(M,L){y=!1,S&&(S=!1,x(z),z=-1),w=!0;var W=m;try{for(T(L),p=n(d);p!==null&&(!(p.expirationTime>L)||M&&!H());){var le=p.callback;if(typeof le=="function"){p.callback=null,m=p.priorityLevel;var we=le(p.expirationTime<=L);L=e.unstable_now(),typeof we=="function"?p.callback=we:p===n(d)&&r(d),T(L)}else r(d);p=n(d)}if(p!==null)var je=!0;else{var Re=n(h);Re!==null&&ve(_,Re.startTime-L),je=!1}return je}finally{p=null,m=W,w=!1}}var O=!1,F=null,z=-1,J=5,j=-1;function H(){return!(e.unstable_now()-j<J)}function V(){if(F!==null){var M=e.unstable_now();j=M;var L=!0;try{L=F(!0,M)}finally{L?ne():(O=!1,F=null)}}else O=!1}var ne;if(typeof k=="function")ne=function(){k(V)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,de=Y.port2;Y.port1.onmessage=V,ne=function(){de.postMessage(null)}}else ne=function(){C(V,0)};function se(M){F=M,O||(O=!0,ne())}function ve(M,L){z=C(function(){M(e.unstable_now())},L)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(M){M.callback=null},e.unstable_continueExecution=function(){y||w||(y=!0,se(R))},e.unstable_forceFrameRate=function(M){0>M||125<M?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):J=0<M?Math.floor(1e3/M):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_getFirstCallbackNode=function(){return n(d)},e.unstable_next=function(M){switch(m){case 1:case 2:case 3:var L=3;break;default:L=m}var W=m;m=L;try{return M()}finally{m=W}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(M,L){switch(M){case 1:case 2:case 3:case 4:case 5:break;default:M=3}var W=m;m=M;try{return L()}finally{m=W}},e.unstable_scheduleCallback=function(M,L,W){var le=e.unstable_now();switch(typeof W=="object"&&W!==null?(W=W.delay,W=typeof W=="number"&&0<W?le+W:le):W=le,M){case 1:var we=-1;break;case 2:we=250;break;case 5:we=1073741823;break;case 4:we=1e4;break;default:we=5e3}return we=W+we,M={id:c++,callback:L,priorityLevel:M,startTime:W,expirationTime:we,sortIndex:-1},W>le?(M.sortIndex=W,t(h,M),n(d)===null&&M===n(h)&&(S?(x(z),z=-1):S=!0,ve(_,W-le))):(M.sortIndex=we,t(d,M),y||w||(y=!0,se(R))),M},e.unstable_shouldYield=H,e.unstable_wrapCallback=function(M){var L=m;return function(){var W=m;m=L;try{return M.apply(this,arguments)}finally{m=W}}}}(Pp)),Pp}var sw;function XO(){return sw||(sw=1,kp.exports=YO()),kp.exports}/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KO=function(t){var n={},r=b,i=XO(),s=Object.assign;function o(l){for(var a="https://reactjs.org/docs/error-decoder.html?invariant="+l,f=1;f<arguments.length;f++)a+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+l+"; visit "+a+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var u=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,d=Symbol.for("react.element"),h=Symbol.for("react.portal"),c=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),m=Symbol.for("react.profiler"),w=Symbol.for("react.provider"),y=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),x=Symbol.for("react.suspense_list"),k=Symbol.for("react.memo"),T=Symbol.for("react.lazy"),_=Symbol.for("react.offscreen"),R=Symbol.iterator;function O(l){return l===null||typeof l!="object"?null:(l=R&&l[R]||l["@@iterator"],typeof l=="function"?l:null)}function F(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case c:return"Fragment";case h:return"Portal";case m:return"Profiler";case p:return"StrictMode";case C:return"Suspense";case x:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case y:return(l.displayName||"Context")+".Consumer";case w:return(l._context.displayName||"Context")+".Provider";case S:var a=l.render;return l=l.displayName,l||(l=a.displayName||a.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case k:return a=l.displayName||null,a!==null?a:F(l.type)||"Memo";case T:a=l._payload,l=l._init;try{return F(l(a))}catch{}}return null}function z(l){var a=l.type;switch(l.tag){case 24:return"Cache";case 9:return(a.displayName||"Context")+".Consumer";case 10:return(a._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=a.render,l=l.displayName||l.name||"",a.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return a;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F(a);case 8:return a===p?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a}return null}function J(l){var a=l,f=l;if(l.alternate)for(;a.return;)a=a.return;else{l=a;do a=l,a.flags&4098&&(f=a.return),l=a.return;while(l)}return a.tag===3?f:null}function j(l){if(J(l)!==l)throw Error(o(188))}function H(l){var a=l.alternate;if(!a){if(a=J(l),a===null)throw Error(o(188));return a!==l?null:l}for(var f=l,g=a;;){var v=f.return;if(v===null)break;var P=v.alternate;if(P===null){if(g=v.return,g!==null){f=g;continue}break}if(v.child===P.child){for(P=v.child;P;){if(P===f)return j(v),l;if(P===g)return j(v),a;P=P.sibling}throw Error(o(188))}if(f.return!==g.return)f=v,g=P;else{for(var I=!1,$=v.child;$;){if($===f){I=!0,f=v,g=P;break}if($===g){I=!0,g=v,f=P;break}$=$.sibling}if(!I){for($=P.child;$;){if($===f){I=!0,f=P,g=v;break}if($===g){I=!0,g=P,f=v;break}$=$.sibling}if(!I)throw Error(o(189))}}if(f.alternate!==g)throw Error(o(190))}if(f.tag!==3)throw Error(o(188));return f.stateNode.current===f?l:a}function V(l){return l=H(l),l!==null?ne(l):null}function ne(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var a=ne(l);if(a!==null)return a;l=l.sibling}return null}function Y(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){if(l.tag!==4){var a=Y(l);if(a!==null)return a}l=l.sibling}return null}var de=Array.isArray,se=t.getPublicInstance,ve=t.getRootHostContext,M=t.getChildHostContext,L=t.prepareForCommit,W=t.resetAfterCommit,le=t.createInstance,we=t.appendInitialChild,je=t.finalizeInitialChildren,Re=t.prepareUpdate,be=t.shouldSetTextContent,Ie=t.createTextInstance,Ke=t.scheduleTimeout,ln=t.cancelTimeout,an=t.noTimeout,xt=t.isPrimaryRenderer,Ne=t.supportsMutation,ye=t.supportsPersistence,ae=t.supportsHydration,$e=t.getInstanceFromNode,Mt=t.preparePortalMount,un=t.getCurrentEventPriority,Ht=t.detachDeletedInstance,bt=t.supportsMicrotasks,ol=t.scheduleMicrotask,lr=t.supportsTestSelectors,cs=t.findFiberRoot,B=t.getBoundingRect,Z=t.getTextContent,oe=t.isHiddenSubtree,U=t.matchAccessibilityRole,N=t.setFocusIfFocusable,X=t.setupIntersectionObserver,te=t.appendChild,Pe=t.appendChildToContainer,_e=t.commitTextUpdate,De=t.commitMount,K=t.commitUpdate,ee=t.insertBefore,ue=t.insertInContainerBefore,pe=t.removeChild,fe=t.removeChildFromContainer,Me=t.resetTextContent,Qe=t.hideInstance,Je=t.hideTextInstance,Ye=t.unhideInstance,Rt=t.unhideTextInstance,mt=t.clearContainer,Lt=t.cloneInstance,Hr=t.createContainerChildSet,Er=t.appendChildToContainerChildSet,Zs=t.finalizeContainerChildren,Js=t.replaceContainerChildren,ll=t.cloneHiddenInstance,Fy=t.cloneHiddenTextInstance,wT=t.canHydrateInstance,ST=t.canHydrateTextInstance,kT=t.canHydrateSuspenseInstance,zy=t.isSuspenseInstancePending,Tf=t.isSuspenseInstanceFallback,PT=t.getSuspenseInstanceFallbackErrorDetails,ET=t.registerSuspenseInstanceRetry,Za=t.getNextHydratableSibling,CT=t.getFirstHydratableChild,TT=t.getFirstHydratableChildWithinContainer,bT=t.getFirstHydratableChildWithinSuspenseInstance,RT=t.hydrateInstance,IT=t.hydrateTextInstance,_T=t.hydrateSuspenseInstance,AT=t.getNextHydratableInstanceAfterSuspenseInstance,OT=t.commitHydratedContainer,jT=t.commitHydratedSuspenseInstance,MT=t.clearSuspenseBoundary,LT=t.clearSuspenseBoundaryFromContainer,NT=t.shouldDeleteUnhydratedTailInstances,FT=t.didNotMatchHydratedContainerTextInstance,zT=t.didNotMatchHydratedTextInstance,bf;function al(l){if(bf===void 0)try{throw Error()}catch(f){var a=f.stack.trim().match(/\n( *(at )?)/);bf=a&&a[1]||""}return`
`+bf+l}var Rf=!1;function If(l,a){if(!l||Rf)return"";Rf=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(a)if(a=function(){throw Error()},Object.defineProperty(a.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(a,[])}catch(ie){var g=ie}Reflect.construct(l,[],a)}else{try{a.call()}catch(ie){g=ie}l.call(a.prototype)}else{try{throw Error()}catch(ie){g=ie}l()}}catch(ie){if(ie&&g&&typeof ie.stack=="string"){for(var v=ie.stack.split(`
`),P=g.stack.split(`
`),I=v.length-1,$=P.length-1;1<=I&&0<=$&&v[I]!==P[$];)$--;for(;1<=I&&0<=$;I--,$--)if(v[I]!==P[$]){if(I!==1||$!==1)do if(I--,$--,0>$||v[I]!==P[$]){var Q=`
`+v[I].replace(" at new "," at ");return l.displayName&&Q.includes("<anonymous>")&&(Q=Q.replace("<anonymous>",l.displayName)),Q}while(1<=I&&0<=$);break}}}finally{Rf=!1,Error.prepareStackTrace=f}return(l=l?l.displayName||l.name:"")?al(l):""}var $T=Object.prototype.hasOwnProperty,_f=[],eo=-1;function xi(l){return{current:l}}function et(l){0>eo||(l.current=_f[eo],_f[eo]=null,eo--)}function Ge(l,a){eo++,_f[eo]=l.current,l.current=a}var wi={},Kt=xi(wi),vn=xi(!1),ds=wi;function to(l,a){var f=l.type.contextTypes;if(!f)return wi;var g=l.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===a)return g.__reactInternalMemoizedMaskedChildContext;var v={},P;for(P in f)v[P]=a[P];return g&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=a,l.__reactInternalMemoizedMaskedChildContext=v),v}function xn(l){return l=l.childContextTypes,l!=null}function Ja(){et(vn),et(Kt)}function $y(l,a,f){if(Kt.current!==wi)throw Error(o(168));Ge(Kt,a),Ge(vn,f)}function Dy(l,a,f){var g=l.stateNode;if(a=a.childContextTypes,typeof g.getChildContext!="function")return f;g=g.getChildContext();for(var v in g)if(!(v in a))throw Error(o(108,z(l)||"Unknown",v));return s({},f,g)}function eu(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||wi,ds=Kt.current,Ge(Kt,l),Ge(vn,vn.current),!0}function By(l,a,f){var g=l.stateNode;if(!g)throw Error(o(169));f?(l=Dy(l,a,ds),g.__reactInternalMemoizedMergedChildContext=l,et(vn),et(Kt),Ge(Kt,l)):et(vn),Ge(vn,f)}var ar=Math.clz32?Math.clz32:UT,DT=Math.log,BT=Math.LN2;function UT(l){return l>>>=0,l===0?32:31-(DT(l)/BT|0)|0}var tu=64,nu=4194304;function ul(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function ru(l,a){var f=l.pendingLanes;if(f===0)return 0;var g=0,v=l.suspendedLanes,P=l.pingedLanes,I=f&268435455;if(I!==0){var $=I&~v;$!==0?g=ul($):(P&=I,P!==0&&(g=ul(P)))}else I=f&~v,I!==0?g=ul(I):P!==0&&(g=ul(P));if(g===0)return 0;if(a!==0&&a!==g&&!(a&v)&&(v=g&-g,P=a&-a,v>=P||v===16&&(P&4194240)!==0))return a;if(g&4&&(g|=f&16),a=l.entangledLanes,a!==0)for(l=l.entanglements,a&=g;0<a;)f=31-ar(a),v=1<<f,g|=l[f],a&=~v;return g}function WT(l,a){switch(l){case 1:case 2:case 4:return a+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function HT(l,a){for(var f=l.suspendedLanes,g=l.pingedLanes,v=l.expirationTimes,P=l.pendingLanes;0<P;){var I=31-ar(P),$=1<<I,Q=v[I];Q===-1?(!($&f)||$&g)&&(v[I]=WT($,a)):Q<=a&&(l.expiredLanes|=$),P&=~$}}function Af(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function Uy(){var l=tu;return tu<<=1,!(tu&4194240)&&(tu=64),l}function Of(l){for(var a=[],f=0;31>f;f++)a.push(l);return a}function cl(l,a,f){l.pendingLanes|=a,a!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,a=31-ar(a),l[a]=f}function VT(l,a){var f=l.pendingLanes&~a;l.pendingLanes=a,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=a,l.mutableReadLanes&=a,l.entangledLanes&=a,a=l.entanglements;var g=l.eventTimes;for(l=l.expirationTimes;0<f;){var v=31-ar(f),P=1<<v;a[v]=0,g[v]=-1,l[v]=-1,f&=~P}}function jf(l,a){var f=l.entangledLanes|=a;for(l=l.entanglements;f;){var g=31-ar(f),v=1<<g;v&a|l[g]&a&&(l[g]|=a),f&=~v}}var We=0;function Wy(l){return l&=-l,1<l?4<l?l&268435455?16:536870912:4:1}var Mf=i.unstable_scheduleCallback,Hy=i.unstable_cancelCallback,qT=i.unstable_shouldYield,QT=i.unstable_requestPaint,Nt=i.unstable_now,Lf=i.unstable_ImmediatePriority,YT=i.unstable_UserBlockingPriority,Nf=i.unstable_NormalPriority,XT=i.unstable_IdlePriority,iu=null,Cr=null;function KT(l){if(Cr&&typeof Cr.onCommitFiberRoot=="function")try{Cr.onCommitFiberRoot(iu,l,void 0,(l.current.flags&128)===128)}catch{}}function GT(l,a){return l===a&&(l!==0||1/l===1/a)||l!==l&&a!==a}var ur=typeof Object.is=="function"?Object.is:GT,Vr=null,su=!1,Ff=!1;function Vy(l){Vr===null?Vr=[l]:Vr.push(l)}function ZT(l){su=!0,Vy(l)}function Tr(){if(!Ff&&Vr!==null){Ff=!0;var l=0,a=We;try{var f=Vr;for(We=1;l<f.length;l++){var g=f[l];do g=g(!0);while(g!==null)}Vr=null,su=!1}catch(v){throw Vr!==null&&(Vr=Vr.slice(l+1)),Mf(Lf,Tr),v}finally{We=a,Ff=!1}}return null}var no=[],ro=0,ou=null,lu=0,Un=[],Wn=0,fs=null,qr=1,Qr="";function hs(l,a){no[ro++]=lu,no[ro++]=ou,ou=l,lu=a}function qy(l,a,f){Un[Wn++]=qr,Un[Wn++]=Qr,Un[Wn++]=fs,fs=l;var g=qr;l=Qr;var v=32-ar(g)-1;g&=~(1<<v),f+=1;var P=32-ar(a)+v;if(30<P){var I=v-v%5;P=(g&(1<<I)-1).toString(32),g>>=I,v-=I,qr=1<<32-ar(a)+v|f<<v|g,Qr=P+l}else qr=1<<P|f<<v|g,Qr=l}function zf(l){l.return!==null&&(hs(l,1),qy(l,1,0))}function $f(l){for(;l===ou;)ou=no[--ro],no[ro]=null,lu=no[--ro],no[ro]=null;for(;l===fs;)fs=Un[--Wn],Un[Wn]=null,Qr=Un[--Wn],Un[Wn]=null,qr=Un[--Wn],Un[Wn]=null}var On=null,Hn=null,st=!1,dl=!1,cr=null;function Qy(l,a){var f=Xn(5,null,null,0);f.elementType="DELETED",f.stateNode=a,f.return=l,a=l.deletions,a===null?(l.deletions=[f],l.flags|=16):a.push(f)}function Yy(l,a){switch(l.tag){case 5:return a=wT(a,l.type,l.pendingProps),a!==null?(l.stateNode=a,On=l,Hn=CT(a),!0):!1;case 6:return a=ST(a,l.pendingProps),a!==null?(l.stateNode=a,On=l,Hn=null,!0):!1;case 13:if(a=kT(a),a!==null){var f=fs!==null?{id:qr,overflow:Qr}:null;return l.memoizedState={dehydrated:a,treeContext:f,retryLane:1073741824},f=Xn(18,null,null,0),f.stateNode=a,f.return=l,l.child=f,On=l,Hn=null,!0}return!1;default:return!1}}function Df(l){return(l.mode&1)!==0&&(l.flags&128)===0}function Bf(l){if(st){var a=Hn;if(a){var f=a;if(!Yy(l,a)){if(Df(l))throw Error(o(418));a=Za(f);var g=On;a&&Yy(l,a)?Qy(g,f):(l.flags=l.flags&-4097|2,st=!1,On=l)}}else{if(Df(l))throw Error(o(418));l.flags=l.flags&-4097|2,st=!1,On=l}}}function Xy(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;On=l}function au(l){if(!ae||l!==On)return!1;if(!st)return Xy(l),st=!0,!1;if(l.tag!==3&&(l.tag!==5||NT(l.type)&&!be(l.type,l.memoizedProps))){var a=Hn;if(a){if(Df(l))throw Ky(),Error(o(418));for(;a;)Qy(l,a),a=Za(a)}}if(Xy(l),l.tag===13){if(!ae)throw Error(o(316));if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(o(317));Hn=AT(l)}else Hn=On?Za(l.stateNode):null;return!0}function Ky(){for(var l=Hn;l;)l=Za(l)}function io(){ae&&(Hn=On=null,dl=st=!1)}function Uf(l){cr===null?cr=[l]:cr.push(l)}var JT=u.ReactCurrentBatchConfig;function uu(l,a){if(ur(l,a))return!0;if(typeof l!="object"||l===null||typeof a!="object"||a===null)return!1;var f=Object.keys(l),g=Object.keys(a);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var v=f[g];if(!$T.call(a,v)||!ur(l[v],a[v]))return!1}return!0}function e2(l){switch(l.tag){case 5:return al(l.type);case 16:return al("Lazy");case 13:return al("Suspense");case 19:return al("SuspenseList");case 0:case 2:case 15:return l=If(l.type,!1),l;case 11:return l=If(l.type.render,!1),l;case 1:return l=If(l.type,!0),l;default:return""}}function fl(l,a,f){if(l=f.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(o(309));var g=f.stateNode}if(!g)throw Error(o(147,l));var v=g,P=""+l;return a!==null&&a.ref!==null&&typeof a.ref=="function"&&a.ref._stringRef===P?a.ref:(a=function(I){var $=v.refs;I===null?delete $[P]:$[P]=I},a._stringRef=P,a)}if(typeof l!="string")throw Error(o(284));if(!f._owner)throw Error(o(290,l))}return l}function cu(l,a){throw l=Object.prototype.toString.call(a),Error(o(31,l==="[object Object]"?"object with keys {"+Object.keys(a).join(", ")+"}":l))}function Gy(l){var a=l._init;return a(l._payload)}function Zy(l){function a(q,D){if(l){var G=q.deletions;G===null?(q.deletions=[D],q.flags|=16):G.push(D)}}function f(q,D){if(!l)return null;for(;D!==null;)a(q,D),D=D.sibling;return null}function g(q,D){for(q=new Map;D!==null;)D.key!==null?q.set(D.key,D):q.set(D.index,D),D=D.sibling;return q}function v(q,D){return q=bi(q,D),q.index=0,q.sibling=null,q}function P(q,D,G){return q.index=G,l?(G=q.alternate,G!==null?(G=G.index,G<D?(q.flags|=2,D):G):(q.flags|=2,D)):(q.flags|=1048576,D)}function I(q){return l&&q.alternate===null&&(q.flags|=2),q}function $(q,D,G,he){return D===null||D.tag!==6?(D=Fh(G,q.mode,he),D.return=q,D):(D=v(D,G),D.return=q,D)}function Q(q,D,G,he){var Ce=G.type;return Ce===c?xe(q,D,G.props.children,he,G.key):D!==null&&(D.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===T&&Gy(Ce)===D.type)?(he=v(D,G.props),he.ref=fl(q,D,G),he.return=q,he):(he=Bu(G.type,G.key,G.props,null,q.mode,he),he.ref=fl(q,D,G),he.return=q,he)}function ie(q,D,G,he){return D===null||D.tag!==4||D.stateNode.containerInfo!==G.containerInfo||D.stateNode.implementation!==G.implementation?(D=zh(G,q.mode,he),D.return=q,D):(D=v(D,G.children||[]),D.return=q,D)}function xe(q,D,G,he,Ce){return D===null||D.tag!==7?(D=ws(G,q.mode,he,Ce),D.return=q,D):(D=v(D,G),D.return=q,D)}function Ae(q,D,G){if(typeof D=="string"&&D!==""||typeof D=="number")return D=Fh(""+D,q.mode,G),D.return=q,D;if(typeof D=="object"&&D!==null){switch(D.$$typeof){case d:return G=Bu(D.type,D.key,D.props,null,q.mode,G),G.ref=fl(q,null,D),G.return=q,G;case h:return D=zh(D,q.mode,G),D.return=q,D;case T:var he=D._init;return Ae(q,he(D._payload),G)}if(de(D)||O(D))return D=ws(D,q.mode,G,null),D.return=q,D;cu(q,D)}return null}function ce(q,D,G,he){var Ce=D!==null?D.key:null;if(typeof G=="string"&&G!==""||typeof G=="number")return Ce!==null?null:$(q,D,""+G,he);if(typeof G=="object"&&G!==null){switch(G.$$typeof){case d:return G.key===Ce?Q(q,D,G,he):null;case h:return G.key===Ce?ie(q,D,G,he):null;case T:return Ce=G._init,ce(q,D,Ce(G._payload),he)}if(de(G)||O(G))return Ce!==null?null:xe(q,D,G,he,null);cu(q,G)}return null}function tt(q,D,G,he,Ce){if(typeof he=="string"&&he!==""||typeof he=="number")return q=q.get(G)||null,$(D,q,""+he,Ce);if(typeof he=="object"&&he!==null){switch(he.$$typeof){case d:return q=q.get(he.key===null?G:he.key)||null,Q(D,q,he,Ce);case h:return q=q.get(he.key===null?G:he.key)||null,ie(D,q,he,Ce);case T:var Le=he._init;return tt(q,D,G,Le(he._payload),Ce)}if(de(he)||O(he))return q=q.get(G)||null,xe(D,q,he,Ce,null);cu(D,he)}return null}function Xe(q,D,G,he){for(var Ce=null,Le=null,Oe=D,He=D=0,$t=null;Oe!==null&&He<G.length;He++){Oe.index>He?($t=Oe,Oe=null):$t=Oe.sibling;var Ve=ce(q,Oe,G[He],he);if(Ve===null){Oe===null&&(Oe=$t);break}l&&Oe&&Ve.alternate===null&&a(q,Oe),D=P(Ve,D,He),Le===null?Ce=Ve:Le.sibling=Ve,Le=Ve,Oe=$t}if(He===G.length)return f(q,Oe),st&&hs(q,He),Ce;if(Oe===null){for(;He<G.length;He++)Oe=Ae(q,G[He],he),Oe!==null&&(D=P(Oe,D,He),Le===null?Ce=Oe:Le.sibling=Oe,Le=Oe);return st&&hs(q,He),Ce}for(Oe=g(q,Oe);He<G.length;He++)$t=tt(Oe,q,He,G[He],he),$t!==null&&(l&&$t.alternate!==null&&Oe.delete($t.key===null?He:$t.key),D=P($t,D,He),Le===null?Ce=$t:Le.sibling=$t,Le=$t);return l&&Oe.forEach(function(Ri){return a(q,Ri)}),st&&hs(q,He),Ce}function Pn(q,D,G,he){var Ce=O(G);if(typeof Ce!="function")throw Error(o(150));if(G=Ce.call(G),G==null)throw Error(o(151));for(var Le=Ce=null,Oe=D,He=D=0,$t=null,Ve=G.next();Oe!==null&&!Ve.done;He++,Ve=G.next()){Oe.index>He?($t=Oe,Oe=null):$t=Oe.sibling;var Ri=ce(q,Oe,Ve.value,he);if(Ri===null){Oe===null&&(Oe=$t);break}l&&Oe&&Ri.alternate===null&&a(q,Oe),D=P(Ri,D,He),Le===null?Ce=Ri:Le.sibling=Ri,Le=Ri,Oe=$t}if(Ve.done)return f(q,Oe),st&&hs(q,He),Ce;if(Oe===null){for(;!Ve.done;He++,Ve=G.next())Ve=Ae(q,Ve.value,he),Ve!==null&&(D=P(Ve,D,He),Le===null?Ce=Ve:Le.sibling=Ve,Le=Ve);return st&&hs(q,He),Ce}for(Oe=g(q,Oe);!Ve.done;He++,Ve=G.next())Ve=tt(Oe,q,He,Ve.value,he),Ve!==null&&(l&&Ve.alternate!==null&&Oe.delete(Ve.key===null?He:Ve.key),D=P(Ve,D,He),Le===null?Ce=Ve:Le.sibling=Ve,Le=Ve);return l&&Oe.forEach(function(_2){return a(q,_2)}),st&&hs(q,He),Ce}function Gr(q,D,G,he){if(typeof G=="object"&&G!==null&&G.type===c&&G.key===null&&(G=G.props.children),typeof G=="object"&&G!==null){switch(G.$$typeof){case d:e:{for(var Ce=G.key,Le=D;Le!==null;){if(Le.key===Ce){if(Ce=G.type,Ce===c){if(Le.tag===7){f(q,Le.sibling),D=v(Le,G.props.children),D.return=q,q=D;break e}}else if(Le.elementType===Ce||typeof Ce=="object"&&Ce!==null&&Ce.$$typeof===T&&Gy(Ce)===Le.type){f(q,Le.sibling),D=v(Le,G.props),D.ref=fl(q,Le,G),D.return=q,q=D;break e}f(q,Le);break}else a(q,Le);Le=Le.sibling}G.type===c?(D=ws(G.props.children,q.mode,he,G.key),D.return=q,q=D):(he=Bu(G.type,G.key,G.props,null,q.mode,he),he.ref=fl(q,D,G),he.return=q,q=he)}return I(q);case h:e:{for(Le=G.key;D!==null;){if(D.key===Le)if(D.tag===4&&D.stateNode.containerInfo===G.containerInfo&&D.stateNode.implementation===G.implementation){f(q,D.sibling),D=v(D,G.children||[]),D.return=q,q=D;break e}else{f(q,D);break}else a(q,D);D=D.sibling}D=zh(G,q.mode,he),D.return=q,q=D}return I(q);case T:return Le=G._init,Gr(q,D,Le(G._payload),he)}if(de(G))return Xe(q,D,G,he);if(O(G))return Pn(q,D,G,he);cu(q,G)}return typeof G=="string"&&G!==""||typeof G=="number"?(G=""+G,D!==null&&D.tag===6?(f(q,D.sibling),D=v(D,G),D.return=q,q=D):(f(q,D),D=Fh(G,q.mode,he),D.return=q,q=D),I(q)):f(q,D)}return Gr}var so=Zy(!0),Jy=Zy(!1),du=xi(null),fu=null,oo=null,Wf=null;function Hf(){Wf=oo=fu=null}function ev(l,a,f){xt?(Ge(du,a._currentValue),a._currentValue=f):(Ge(du,a._currentValue2),a._currentValue2=f)}function Vf(l){var a=du.current;et(du),xt?l._currentValue=a:l._currentValue2=a}function qf(l,a,f){for(;l!==null;){var g=l.alternate;if((l.childLanes&a)!==a?(l.childLanes|=a,g!==null&&(g.childLanes|=a)):g!==null&&(g.childLanes&a)!==a&&(g.childLanes|=a),l===f)break;l=l.return}}function lo(l,a){fu=l,Wf=oo=null,l=l.dependencies,l!==null&&l.firstContext!==null&&(l.lanes&a&&(wn=!0),l.firstContext=null)}function Vn(l){var a=xt?l._currentValue:l._currentValue2;if(Wf!==l)if(l={context:l,memoizedValue:a,next:null},oo===null){if(fu===null)throw Error(o(308));oo=l,fu.dependencies={lanes:0,firstContext:l}}else oo=oo.next=l;return a}var ps=null;function Qf(l){ps===null?ps=[l]:ps.push(l)}function tv(l,a,f,g){var v=a.interleaved;return v===null?(f.next=f,Qf(a)):(f.next=v.next,v.next=f),a.interleaved=f,br(l,g)}function br(l,a){l.lanes|=a;var f=l.alternate;for(f!==null&&(f.lanes|=a),f=l,l=l.return;l!==null;)l.childLanes|=a,f=l.alternate,f!==null&&(f.childLanes|=a),f=l,l=l.return;return f.tag===3?f.stateNode:null}var Si=!1;function Yf(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function nv(l,a){l=l.updateQueue,a.updateQueue===l&&(a.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function Yr(l,a){return{eventTime:l,lane:a,tag:0,payload:null,callback:null,next:null}}function ki(l,a,f){var g=l.updateQueue;if(g===null)return null;if(g=g.shared,Fe&2){var v=g.pending;return v===null?a.next=a:(a.next=v.next,v.next=a),g.pending=a,br(l,f)}return v=g.interleaved,v===null?(a.next=a,Qf(g)):(a.next=v.next,v.next=a),g.interleaved=a,br(l,f)}function hu(l,a,f){if(a=a.updateQueue,a!==null&&(a=a.shared,(f&4194240)!==0)){var g=a.lanes;g&=l.pendingLanes,f|=g,a.lanes=f,jf(l,f)}}function rv(l,a){var f=l.updateQueue,g=l.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var v=null,P=null;if(f=f.firstBaseUpdate,f!==null){do{var I={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};P===null?v=P=I:P=P.next=I,f=f.next}while(f!==null);P===null?v=P=a:P=P.next=a}else v=P=a;f={baseState:g.baseState,firstBaseUpdate:v,lastBaseUpdate:P,shared:g.shared,effects:g.effects},l.updateQueue=f;return}l=f.lastBaseUpdate,l===null?f.firstBaseUpdate=a:l.next=a,f.lastBaseUpdate=a}function pu(l,a,f,g){var v=l.updateQueue;Si=!1;var P=v.firstBaseUpdate,I=v.lastBaseUpdate,$=v.shared.pending;if($!==null){v.shared.pending=null;var Q=$,ie=Q.next;Q.next=null,I===null?P=ie:I.next=ie,I=Q;var xe=l.alternate;xe!==null&&(xe=xe.updateQueue,$=xe.lastBaseUpdate,$!==I&&($===null?xe.firstBaseUpdate=ie:$.next=ie,xe.lastBaseUpdate=Q))}if(P!==null){var Ae=v.baseState;I=0,xe=ie=Q=null,$=P;do{var ce=$.lane,tt=$.eventTime;if((g&ce)===ce){xe!==null&&(xe=xe.next={eventTime:tt,lane:0,tag:$.tag,payload:$.payload,callback:$.callback,next:null});e:{var Xe=l,Pn=$;switch(ce=a,tt=f,Pn.tag){case 1:if(Xe=Pn.payload,typeof Xe=="function"){Ae=Xe.call(tt,Ae,ce);break e}Ae=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=Pn.payload,ce=typeof Xe=="function"?Xe.call(tt,Ae,ce):Xe,ce==null)break e;Ae=s({},Ae,ce);break e;case 2:Si=!0}}$.callback!==null&&$.lane!==0&&(l.flags|=64,ce=v.effects,ce===null?v.effects=[$]:ce.push($))}else tt={eventTime:tt,lane:ce,tag:$.tag,payload:$.payload,callback:$.callback,next:null},xe===null?(ie=xe=tt,Q=Ae):xe=xe.next=tt,I|=ce;if($=$.next,$===null){if($=v.shared.pending,$===null)break;ce=$,$=ce.next,ce.next=null,v.lastBaseUpdate=ce,v.shared.pending=null}}while(!0);if(xe===null&&(Q=Ae),v.baseState=Q,v.firstBaseUpdate=ie,v.lastBaseUpdate=xe,a=v.shared.interleaved,a!==null){v=a;do I|=v.lane,v=v.next;while(v!==a)}else P===null&&(v.shared.lanes=0);ms|=I,l.lanes=I,l.memoizedState=Ae}}function iv(l,a,f){if(l=a.effects,a.effects=null,l!==null)for(a=0;a<l.length;a++){var g=l[a],v=g.callback;if(v!==null){if(g.callback=null,g=f,typeof v!="function")throw Error(o(191,v));v.call(g)}}}var hl={},qn=xi(hl),pl=xi(hl),ao=xi(hl);function Rr(l){if(l===hl)throw Error(o(174));return l}function Xf(l,a){Ge(ao,a),Ge(pl,l),Ge(qn,hl),l=ve(a),et(qn),Ge(qn,l)}function uo(){et(qn),et(pl),et(ao)}function sv(l){var a=Rr(ao.current),f=Rr(qn.current);a=M(f,l.type,a),f!==a&&(Ge(pl,l),Ge(qn,a))}function Kf(l){pl.current===l&&(et(qn),et(pl))}var ct=xi(0);function gu(l){for(var a=l;a!==null;){if(a.tag===13){var f=a.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||zy(f)||Tf(f)))return a}else if(a.tag===19&&a.memoizedProps.revealOrder!==void 0){if(a.flags&128)return a}else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break;for(;a.sibling===null;){if(a.return===null||a.return===l)return null;a=a.return}a.sibling.return=a.return,a=a.sibling}return null}var Gf=[];function Zf(){for(var l=0;l<Gf.length;l++){var a=Gf[l];xt?a._workInProgressVersionPrimary=null:a._workInProgressVersionSecondary=null}Gf.length=0}var mu=u.ReactCurrentDispatcher,Jf=u.ReactCurrentBatchConfig,gs=0,dt=null,It=null,Ft=null,yu=!1,gl=!1,ml=0,t2=0;function Gt(){throw Error(o(321))}function eh(l,a){if(a===null)return!1;for(var f=0;f<a.length&&f<l.length;f++)if(!ur(l[f],a[f]))return!1;return!0}function th(l,a,f,g,v,P){if(gs=P,dt=a,a.memoizedState=null,a.updateQueue=null,a.lanes=0,mu.current=l===null||l.memoizedState===null?s2:o2,l=f(g,v),gl){P=0;do{if(gl=!1,ml=0,25<=P)throw Error(o(301));P+=1,Ft=It=null,a.updateQueue=null,mu.current=l2,l=f(g,v)}while(gl)}if(mu.current=wu,a=It!==null&&It.next!==null,gs=0,Ft=It=dt=null,yu=!1,a)throw Error(o(300));return l}function nh(){var l=ml!==0;return ml=0,l}function Ir(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Ft===null?dt.memoizedState=Ft=l:Ft=Ft.next=l,Ft}function Qn(){if(It===null){var l=dt.alternate;l=l!==null?l.memoizedState:null}else l=It.next;var a=Ft===null?dt.memoizedState:Ft.next;if(a!==null)Ft=a,It=l;else{if(l===null)throw Error(o(310));It=l,l={memoizedState:It.memoizedState,baseState:It.baseState,baseQueue:It.baseQueue,queue:It.queue,next:null},Ft===null?dt.memoizedState=Ft=l:Ft=Ft.next=l}return Ft}function yl(l,a){return typeof a=="function"?a(l):a}function rh(l){var a=Qn(),f=a.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=l;var g=It,v=g.baseQueue,P=f.pending;if(P!==null){if(v!==null){var I=v.next;v.next=P.next,P.next=I}g.baseQueue=v=P,f.pending=null}if(v!==null){P=v.next,g=g.baseState;var $=I=null,Q=null,ie=P;do{var xe=ie.lane;if((gs&xe)===xe)Q!==null&&(Q=Q.next={lane:0,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null}),g=ie.hasEagerState?ie.eagerState:l(g,ie.action);else{var Ae={lane:xe,action:ie.action,hasEagerState:ie.hasEagerState,eagerState:ie.eagerState,next:null};Q===null?($=Q=Ae,I=g):Q=Q.next=Ae,dt.lanes|=xe,ms|=xe}ie=ie.next}while(ie!==null&&ie!==P);Q===null?I=g:Q.next=$,ur(g,a.memoizedState)||(wn=!0),a.memoizedState=g,a.baseState=I,a.baseQueue=Q,f.lastRenderedState=g}if(l=f.interleaved,l!==null){v=l;do P=v.lane,dt.lanes|=P,ms|=P,v=v.next;while(v!==l)}else v===null&&(f.lanes=0);return[a.memoizedState,f.dispatch]}function ih(l){var a=Qn(),f=a.queue;if(f===null)throw Error(o(311));f.lastRenderedReducer=l;var g=f.dispatch,v=f.pending,P=a.memoizedState;if(v!==null){f.pending=null;var I=v=v.next;do P=l(P,I.action),I=I.next;while(I!==v);ur(P,a.memoizedState)||(wn=!0),a.memoizedState=P,a.baseQueue===null&&(a.baseState=P),f.lastRenderedState=P}return[P,g]}function ov(){}function lv(l,a){var f=dt,g=Qn(),v=a(),P=!ur(g.memoizedState,v);if(P&&(g.memoizedState=v,wn=!0),g=g.queue,sh(cv.bind(null,f,g,l),[l]),g.getSnapshot!==a||P||Ft!==null&&Ft.memoizedState.tag&1){if(f.flags|=2048,vl(9,uv.bind(null,f,g,v,a),void 0,null),zt===null)throw Error(o(349));gs&30||av(f,a,v)}return v}function av(l,a,f){l.flags|=16384,l={getSnapshot:a,value:f},a=dt.updateQueue,a===null?(a={lastEffect:null,stores:null},dt.updateQueue=a,a.stores=[l]):(f=a.stores,f===null?a.stores=[l]:f.push(l))}function uv(l,a,f,g){a.value=f,a.getSnapshot=g,dv(a)&&fv(l)}function cv(l,a,f){return f(function(){dv(a)&&fv(l)})}function dv(l){var a=l.getSnapshot;l=l.value;try{var f=a();return!ur(l,f)}catch{return!0}}function fv(l){var a=br(l,1);a!==null&&Yn(a,l,1,-1)}function hv(l){var a=Ir();return typeof l=="function"&&(l=l()),a.memoizedState=a.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:yl,lastRenderedState:l},a.queue=l,l=l.dispatch=i2.bind(null,dt,l),[a.memoizedState,l]}function vl(l,a,f,g){return l={tag:l,create:a,destroy:f,deps:g,next:null},a=dt.updateQueue,a===null?(a={lastEffect:null,stores:null},dt.updateQueue=a,a.lastEffect=l.next=l):(f=a.lastEffect,f===null?a.lastEffect=l.next=l:(g=f.next,f.next=l,l.next=g,a.lastEffect=l)),l}function pv(){return Qn().memoizedState}function vu(l,a,f,g){var v=Ir();dt.flags|=l,v.memoizedState=vl(1|a,f,void 0,g===void 0?null:g)}function xu(l,a,f,g){var v=Qn();g=g===void 0?null:g;var P=void 0;if(It!==null){var I=It.memoizedState;if(P=I.destroy,g!==null&&eh(g,I.deps)){v.memoizedState=vl(a,f,P,g);return}}dt.flags|=l,v.memoizedState=vl(1|a,f,P,g)}function gv(l,a){return vu(8390656,8,l,a)}function sh(l,a){return xu(2048,8,l,a)}function mv(l,a){return xu(4,2,l,a)}function yv(l,a){return xu(4,4,l,a)}function vv(l,a){if(typeof a=="function")return l=l(),a(l),function(){a(null)};if(a!=null)return l=l(),a.current=l,function(){a.current=null}}function xv(l,a,f){return f=f!=null?f.concat([l]):null,xu(4,4,vv.bind(null,a,l),f)}function oh(){}function wv(l,a){var f=Qn();a=a===void 0?null:a;var g=f.memoizedState;return g!==null&&a!==null&&eh(a,g[1])?g[0]:(f.memoizedState=[l,a],l)}function Sv(l,a){var f=Qn();a=a===void 0?null:a;var g=f.memoizedState;return g!==null&&a!==null&&eh(a,g[1])?g[0]:(l=l(),f.memoizedState=[l,a],l)}function kv(l,a,f){return gs&21?(ur(f,a)||(f=Uy(),dt.lanes|=f,ms|=f,l.baseState=!0),a):(l.baseState&&(l.baseState=!1,wn=!0),l.memoizedState=f)}function n2(l,a){var f=We;We=f!==0&&4>f?f:4,l(!0);var g=Jf.transition;Jf.transition={};try{l(!1),a()}finally{We=f,Jf.transition=g}}function Pv(){return Qn().memoizedState}function r2(l,a,f){var g=Ci(l);if(f={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null},Ev(l))Cv(a,f);else if(f=tv(l,a,f,g),f!==null){var v=en();Yn(f,l,g,v),Tv(f,a,g)}}function i2(l,a,f){var g=Ci(l),v={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null};if(Ev(l))Cv(a,v);else{var P=l.alternate;if(l.lanes===0&&(P===null||P.lanes===0)&&(P=a.lastRenderedReducer,P!==null))try{var I=a.lastRenderedState,$=P(I,f);if(v.hasEagerState=!0,v.eagerState=$,ur($,I)){var Q=a.interleaved;Q===null?(v.next=v,Qf(a)):(v.next=Q.next,Q.next=v),a.interleaved=v;return}}catch{}finally{}f=tv(l,a,v,g),f!==null&&(v=en(),Yn(f,l,g,v),Tv(f,a,g))}}function Ev(l){var a=l.alternate;return l===dt||a!==null&&a===dt}function Cv(l,a){gl=yu=!0;var f=l.pending;f===null?a.next=a:(a.next=f.next,f.next=a),l.pending=a}function Tv(l,a,f){if(f&4194240){var g=a.lanes;g&=l.pendingLanes,f|=g,a.lanes=f,jf(l,f)}}var wu={readContext:Vn,useCallback:Gt,useContext:Gt,useEffect:Gt,useImperativeHandle:Gt,useInsertionEffect:Gt,useLayoutEffect:Gt,useMemo:Gt,useReducer:Gt,useRef:Gt,useState:Gt,useDebugValue:Gt,useDeferredValue:Gt,useTransition:Gt,useMutableSource:Gt,useSyncExternalStore:Gt,useId:Gt,unstable_isNewReconciler:!1},s2={readContext:Vn,useCallback:function(l,a){return Ir().memoizedState=[l,a===void 0?null:a],l},useContext:Vn,useEffect:gv,useImperativeHandle:function(l,a,f){return f=f!=null?f.concat([l]):null,vu(4194308,4,vv.bind(null,a,l),f)},useLayoutEffect:function(l,a){return vu(4194308,4,l,a)},useInsertionEffect:function(l,a){return vu(4,2,l,a)},useMemo:function(l,a){var f=Ir();return a=a===void 0?null:a,l=l(),f.memoizedState=[l,a],l},useReducer:function(l,a,f){var g=Ir();return a=f!==void 0?f(a):a,g.memoizedState=g.baseState=a,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:a},g.queue=l,l=l.dispatch=r2.bind(null,dt,l),[g.memoizedState,l]},useRef:function(l){var a=Ir();return l={current:l},a.memoizedState=l},useState:hv,useDebugValue:oh,useDeferredValue:function(l){return Ir().memoizedState=l},useTransition:function(){var l=hv(!1),a=l[0];return l=n2.bind(null,l[1]),Ir().memoizedState=l,[a,l]},useMutableSource:function(){},useSyncExternalStore:function(l,a,f){var g=dt,v=Ir();if(st){if(f===void 0)throw Error(o(407));f=f()}else{if(f=a(),zt===null)throw Error(o(349));gs&30||av(g,a,f)}v.memoizedState=f;var P={value:f,getSnapshot:a};return v.queue=P,gv(cv.bind(null,g,P,l),[l]),g.flags|=2048,vl(9,uv.bind(null,g,P,f,a),void 0,null),f},useId:function(){var l=Ir(),a=zt.identifierPrefix;if(st){var f=Qr,g=qr;f=(g&~(1<<32-ar(g)-1)).toString(32)+f,a=":"+a+"R"+f,f=ml++,0<f&&(a+="H"+f.toString(32)),a+=":"}else f=t2++,a=":"+a+"r"+f.toString(32)+":";return l.memoizedState=a},unstable_isNewReconciler:!1},o2={readContext:Vn,useCallback:wv,useContext:Vn,useEffect:sh,useImperativeHandle:xv,useInsertionEffect:mv,useLayoutEffect:yv,useMemo:Sv,useReducer:rh,useRef:pv,useState:function(){return rh(yl)},useDebugValue:oh,useDeferredValue:function(l){var a=Qn();return kv(a,It.memoizedState,l)},useTransition:function(){var l=rh(yl)[0],a=Qn().memoizedState;return[l,a]},useMutableSource:ov,useSyncExternalStore:lv,useId:Pv,unstable_isNewReconciler:!1},l2={readContext:Vn,useCallback:wv,useContext:Vn,useEffect:sh,useImperativeHandle:xv,useInsertionEffect:mv,useLayoutEffect:yv,useMemo:Sv,useReducer:ih,useRef:pv,useState:function(){return ih(yl)},useDebugValue:oh,useDeferredValue:function(l){var a=Qn();return It===null?a.memoizedState=l:kv(a,It.memoizedState,l)},useTransition:function(){var l=ih(yl)[0],a=Qn().memoizedState;return[l,a]},useMutableSource:ov,useSyncExternalStore:lv,useId:Pv,unstable_isNewReconciler:!1};function dr(l,a){if(l&&l.defaultProps){a=s({},a),l=l.defaultProps;for(var f in l)a[f]===void 0&&(a[f]=l[f]);return a}return a}function lh(l,a,f,g){a=l.memoizedState,f=f(g,a),f=f==null?a:s({},a,f),l.memoizedState=f,l.lanes===0&&(l.updateQueue.baseState=f)}var Su={isMounted:function(l){return(l=l._reactInternals)?J(l)===l:!1},enqueueSetState:function(l,a,f){l=l._reactInternals;var g=en(),v=Ci(l),P=Yr(g,v);P.payload=a,f!=null&&(P.callback=f),a=ki(l,P,v),a!==null&&(Yn(a,l,v,g),hu(a,l,v))},enqueueReplaceState:function(l,a,f){l=l._reactInternals;var g=en(),v=Ci(l),P=Yr(g,v);P.tag=1,P.payload=a,f!=null&&(P.callback=f),a=ki(l,P,v),a!==null&&(Yn(a,l,v,g),hu(a,l,v))},enqueueForceUpdate:function(l,a){l=l._reactInternals;var f=en(),g=Ci(l),v=Yr(f,g);v.tag=2,a!=null&&(v.callback=a),a=ki(l,v,g),a!==null&&(Yn(a,l,g,f),hu(a,l,g))}};function bv(l,a,f,g,v,P,I){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(g,P,I):a.prototype&&a.prototype.isPureReactComponent?!uu(f,g)||!uu(v,P):!0}function Rv(l,a,f){var g=!1,v=wi,P=a.contextType;return typeof P=="object"&&P!==null?P=Vn(P):(v=xn(a)?ds:Kt.current,g=a.contextTypes,P=(g=g!=null)?to(l,v):wi),a=new a(f,P),l.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,a.updater=Su,l.stateNode=a,a._reactInternals=l,g&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=v,l.__reactInternalMemoizedMaskedChildContext=P),a}function Iv(l,a,f,g){l=a.state,typeof a.componentWillReceiveProps=="function"&&a.componentWillReceiveProps(f,g),typeof a.UNSAFE_componentWillReceiveProps=="function"&&a.UNSAFE_componentWillReceiveProps(f,g),a.state!==l&&Su.enqueueReplaceState(a,a.state,null)}function ah(l,a,f,g){var v=l.stateNode;v.props=f,v.state=l.memoizedState,v.refs={},Yf(l);var P=a.contextType;typeof P=="object"&&P!==null?v.context=Vn(P):(P=xn(a)?ds:Kt.current,v.context=to(l,P)),v.state=l.memoizedState,P=a.getDerivedStateFromProps,typeof P=="function"&&(lh(l,a,P,f),v.state=l.memoizedState),typeof a.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(a=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),a!==v.state&&Su.enqueueReplaceState(v,v.state,null),pu(l,f,v,g),v.state=l.memoizedState),typeof v.componentDidMount=="function"&&(l.flags|=4194308)}function co(l,a){try{var f="",g=a;do f+=e2(g),g=g.return;while(g);var v=f}catch(P){v=`
Error generating stack: `+P.message+`
`+P.stack}return{value:l,source:a,stack:v,digest:null}}function uh(l,a,f){return{value:l,source:null,stack:f??null,digest:a??null}}function ch(l,a){try{console.error(a.value)}catch(f){setTimeout(function(){throw f})}}var a2=typeof WeakMap=="function"?WeakMap:Map;function _v(l,a,f){f=Yr(-1,f),f.tag=3,f.payload={element:null};var g=a.value;return f.callback=function(){Lu||(Lu=!0,_h=g),ch(l,a)},f}function Av(l,a,f){f=Yr(-1,f),f.tag=3;var g=l.type.getDerivedStateFromError;if(typeof g=="function"){var v=a.value;f.payload=function(){return g(v)},f.callback=function(){ch(l,a)}}var P=l.stateNode;return P!==null&&typeof P.componentDidCatch=="function"&&(f.callback=function(){ch(l,a),typeof g!="function"&&(Pi===null?Pi=new Set([this]):Pi.add(this));var I=a.stack;this.componentDidCatch(a.value,{componentStack:I!==null?I:""})}),f}function Ov(l,a,f){var g=l.pingCache;if(g===null){g=l.pingCache=new a2;var v=new Set;g.set(a,v)}else v=g.get(a),v===void 0&&(v=new Set,g.set(a,v));v.has(f)||(v.add(f),l=k2.bind(null,l,a,f),a.then(l,l))}function jv(l){do{var a;if((a=l.tag===13)&&(a=l.memoizedState,a=a!==null?a.dehydrated!==null:!0),a)return l;l=l.return}while(l!==null);return null}function Mv(l,a,f,g,v){return l.mode&1?(l.flags|=65536,l.lanes=v,l):(l===a?l.flags|=65536:(l.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(a=Yr(-1,1),a.tag=2,ki(f,a,1))),f.lanes|=1),l)}var u2=u.ReactCurrentOwner,wn=!1;function cn(l,a,f,g){a.child=l===null?Jy(a,null,f,g):so(a,l.child,f,g)}function Lv(l,a,f,g,v){f=f.render;var P=a.ref;return lo(a,v),g=th(l,a,f,g,P,v),f=nh(),l!==null&&!wn?(a.updateQueue=l.updateQueue,a.flags&=-2053,l.lanes&=~v,Xr(l,a,v)):(st&&f&&zf(a),a.flags|=1,cn(l,a,g,v),a.child)}function Nv(l,a,f,g,v){if(l===null){var P=f.type;return typeof P=="function"&&!Nh(P)&&P.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(a.tag=15,a.type=P,Fv(l,a,P,g,v)):(l=Bu(f.type,null,g,a,a.mode,v),l.ref=a.ref,l.return=a,a.child=l)}if(P=l.child,!(l.lanes&v)){var I=P.memoizedProps;if(f=f.compare,f=f!==null?f:uu,f(I,g)&&l.ref===a.ref)return Xr(l,a,v)}return a.flags|=1,l=bi(P,g),l.ref=a.ref,l.return=a,a.child=l}function Fv(l,a,f,g,v){if(l!==null){var P=l.memoizedProps;if(uu(P,g)&&l.ref===a.ref)if(wn=!1,a.pendingProps=g=P,(l.lanes&v)!==0)l.flags&131072&&(wn=!0);else return a.lanes=l.lanes,Xr(l,a,v)}return dh(l,a,f,g,v)}function zv(l,a,f){var g=a.pendingProps,v=g.children,P=l!==null?l.memoizedState:null;if(g.mode==="hidden")if(!(a.mode&1))a.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ge(ho,jn),jn|=f;else{if(!(f&1073741824))return l=P!==null?P.baseLanes|f:f,a.lanes=a.childLanes=1073741824,a.memoizedState={baseLanes:l,cachePool:null,transitions:null},a.updateQueue=null,Ge(ho,jn),jn|=l,null;a.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=P!==null?P.baseLanes:f,Ge(ho,jn),jn|=g}else P!==null?(g=P.baseLanes|f,a.memoizedState=null):g=f,Ge(ho,jn),jn|=g;return cn(l,a,v,f),a.child}function $v(l,a){var f=a.ref;(l===null&&f!==null||l!==null&&l.ref!==f)&&(a.flags|=512,a.flags|=2097152)}function dh(l,a,f,g,v){var P=xn(f)?ds:Kt.current;return P=to(a,P),lo(a,v),f=th(l,a,f,g,P,v),g=nh(),l!==null&&!wn?(a.updateQueue=l.updateQueue,a.flags&=-2053,l.lanes&=~v,Xr(l,a,v)):(st&&g&&zf(a),a.flags|=1,cn(l,a,f,v),a.child)}function Dv(l,a,f,g,v){if(xn(f)){var P=!0;eu(a)}else P=!1;if(lo(a,v),a.stateNode===null)Pu(l,a),Rv(a,f,g),ah(a,f,g,v),g=!0;else if(l===null){var I=a.stateNode,$=a.memoizedProps;I.props=$;var Q=I.context,ie=f.contextType;typeof ie=="object"&&ie!==null?ie=Vn(ie):(ie=xn(f)?ds:Kt.current,ie=to(a,ie));var xe=f.getDerivedStateFromProps,Ae=typeof xe=="function"||typeof I.getSnapshotBeforeUpdate=="function";Ae||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||($!==g||Q!==ie)&&Iv(a,I,g,ie),Si=!1;var ce=a.memoizedState;I.state=ce,pu(a,g,I,v),Q=a.memoizedState,$!==g||ce!==Q||vn.current||Si?(typeof xe=="function"&&(lh(a,f,xe,g),Q=a.memoizedState),($=Si||bv(a,f,$,g,ce,Q,ie))?(Ae||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(a.flags|=4194308)):(typeof I.componentDidMount=="function"&&(a.flags|=4194308),a.memoizedProps=g,a.memoizedState=Q),I.props=g,I.state=Q,I.context=ie,g=$):(typeof I.componentDidMount=="function"&&(a.flags|=4194308),g=!1)}else{I=a.stateNode,nv(l,a),$=a.memoizedProps,ie=a.type===a.elementType?$:dr(a.type,$),I.props=ie,Ae=a.pendingProps,ce=I.context,Q=f.contextType,typeof Q=="object"&&Q!==null?Q=Vn(Q):(Q=xn(f)?ds:Kt.current,Q=to(a,Q));var tt=f.getDerivedStateFromProps;(xe=typeof tt=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||($!==Ae||ce!==Q)&&Iv(a,I,g,Q),Si=!1,ce=a.memoizedState,I.state=ce,pu(a,g,I,v);var Xe=a.memoizedState;$!==Ae||ce!==Xe||vn.current||Si?(typeof tt=="function"&&(lh(a,f,tt,g),Xe=a.memoizedState),(ie=Si||bv(a,f,ie,g,ce,Xe,Q)||!1)?(xe||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(g,Xe,Q),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(g,Xe,Q)),typeof I.componentDidUpdate=="function"&&(a.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(a.flags|=1024)):(typeof I.componentDidUpdate!="function"||$===l.memoizedProps&&ce===l.memoizedState||(a.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||$===l.memoizedProps&&ce===l.memoizedState||(a.flags|=1024),a.memoizedProps=g,a.memoizedState=Xe),I.props=g,I.state=Xe,I.context=Q,g=ie):(typeof I.componentDidUpdate!="function"||$===l.memoizedProps&&ce===l.memoizedState||(a.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||$===l.memoizedProps&&ce===l.memoizedState||(a.flags|=1024),g=!1)}return fh(l,a,f,g,P,v)}function fh(l,a,f,g,v,P){$v(l,a);var I=(a.flags&128)!==0;if(!g&&!I)return v&&By(a,f,!1),Xr(l,a,P);g=a.stateNode,u2.current=a;var $=I&&typeof f.getDerivedStateFromError!="function"?null:g.render();return a.flags|=1,l!==null&&I?(a.child=so(a,l.child,null,P),a.child=so(a,null,$,P)):cn(l,a,$,P),a.memoizedState=g.state,v&&By(a,f,!0),a.child}function Bv(l){var a=l.stateNode;a.pendingContext?$y(l,a.pendingContext,a.pendingContext!==a.context):a.context&&$y(l,a.context,!1),Xf(l,a.containerInfo)}function Uv(l,a,f,g,v){return io(),Uf(v),a.flags|=256,cn(l,a,f,g),a.child}var hh={dehydrated:null,treeContext:null,retryLane:0};function ph(l){return{baseLanes:l,cachePool:null,transitions:null}}function Wv(l,a,f){var g=a.pendingProps,v=ct.current,P=!1,I=(a.flags&128)!==0,$;if(($=I)||($=l!==null&&l.memoizedState===null?!1:(v&2)!==0),$?(P=!0,a.flags&=-129):(l===null||l.memoizedState!==null)&&(v|=1),Ge(ct,v&1),l===null)return Bf(a),l=a.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?(a.mode&1?Tf(l)?a.lanes=8:a.lanes=1073741824:a.lanes=1,null):(I=g.children,l=g.fallback,P?(g=a.mode,P=a.child,I={mode:"hidden",children:I},!(g&1)&&P!==null?(P.childLanes=0,P.pendingProps=I):P=Uu(I,g,0,null),l=ws(l,g,f,null),P.return=a,l.return=a,P.sibling=l,a.child=P,a.child.memoizedState=ph(f),a.memoizedState=hh,l):gh(a,I));if(v=l.memoizedState,v!==null&&($=v.dehydrated,$!==null))return c2(l,a,I,g,$,v,f);if(P){P=g.fallback,I=a.mode,v=l.child,$=v.sibling;var Q={mode:"hidden",children:g.children};return!(I&1)&&a.child!==v?(g=a.child,g.childLanes=0,g.pendingProps=Q,a.deletions=null):(g=bi(v,Q),g.subtreeFlags=v.subtreeFlags&14680064),$!==null?P=bi($,P):(P=ws(P,I,f,null),P.flags|=2),P.return=a,g.return=a,g.sibling=P,a.child=g,g=P,P=a.child,I=l.child.memoizedState,I=I===null?ph(f):{baseLanes:I.baseLanes|f,cachePool:null,transitions:I.transitions},P.memoizedState=I,P.childLanes=l.childLanes&~f,a.memoizedState=hh,g}return P=l.child,l=P.sibling,g=bi(P,{mode:"visible",children:g.children}),!(a.mode&1)&&(g.lanes=f),g.return=a,g.sibling=null,l!==null&&(f=a.deletions,f===null?(a.deletions=[l],a.flags|=16):f.push(l)),a.child=g,a.memoizedState=null,g}function gh(l,a){return a=Uu({mode:"visible",children:a},l.mode,0,null),a.return=l,l.child=a}function ku(l,a,f,g){return g!==null&&Uf(g),so(a,l.child,null,f),l=gh(a,a.pendingProps.children),l.flags|=2,a.memoizedState=null,l}function c2(l,a,f,g,v,P,I){if(f)return a.flags&256?(a.flags&=-257,g=uh(Error(o(422))),ku(l,a,I,g)):a.memoizedState!==null?(a.child=l.child,a.flags|=128,null):(P=g.fallback,v=a.mode,g=Uu({mode:"visible",children:g.children},v,0,null),P=ws(P,v,I,null),P.flags|=2,g.return=a,P.return=a,g.sibling=P,a.child=g,a.mode&1&&so(a,l.child,null,I),a.child.memoizedState=ph(I),a.memoizedState=hh,P);if(!(a.mode&1))return ku(l,a,I,null);if(Tf(v))return g=PT(v).digest,P=Error(o(419)),g=uh(P,g,void 0),ku(l,a,I,g);if(f=(I&l.childLanes)!==0,wn||f){if(g=zt,g!==null){switch(I&-I){case 4:v=2;break;case 16:v=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:v=32;break;case 536870912:v=268435456;break;default:v=0}v=v&(g.suspendedLanes|I)?0:v,v!==0&&v!==P.retryLane&&(P.retryLane=v,br(l,v),Yn(g,l,v,-1))}return Lh(),g=uh(Error(o(421))),ku(l,a,I,g)}return zy(v)?(a.flags|=128,a.child=l.child,a=P2.bind(null,l),ET(v,a),null):(l=P.treeContext,ae&&(Hn=bT(v),On=a,st=!0,cr=null,dl=!1,l!==null&&(Un[Wn++]=qr,Un[Wn++]=Qr,Un[Wn++]=fs,qr=l.id,Qr=l.overflow,fs=a)),a=gh(a,g.children),a.flags|=4096,a)}function Hv(l,a,f){l.lanes|=a;var g=l.alternate;g!==null&&(g.lanes|=a),qf(l.return,a,f)}function mh(l,a,f,g,v){var P=l.memoizedState;P===null?l.memoizedState={isBackwards:a,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:v}:(P.isBackwards=a,P.rendering=null,P.renderingStartTime=0,P.last=g,P.tail=f,P.tailMode=v)}function Vv(l,a,f){var g=a.pendingProps,v=g.revealOrder,P=g.tail;if(cn(l,a,g.children,f),g=ct.current,g&2)g=g&1|2,a.flags|=128;else{if(l!==null&&l.flags&128)e:for(l=a.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&Hv(l,f,a);else if(l.tag===19)Hv(l,f,a);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===a)break e;for(;l.sibling===null;){if(l.return===null||l.return===a)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}g&=1}if(Ge(ct,g),!(a.mode&1))a.memoizedState=null;else switch(v){case"forwards":for(f=a.child,v=null;f!==null;)l=f.alternate,l!==null&&gu(l)===null&&(v=f),f=f.sibling;f=v,f===null?(v=a.child,a.child=null):(v=f.sibling,f.sibling=null),mh(a,!1,v,f,P);break;case"backwards":for(f=null,v=a.child,a.child=null;v!==null;){if(l=v.alternate,l!==null&&gu(l)===null){a.child=v;break}l=v.sibling,v.sibling=f,f=v,v=l}mh(a,!0,f,null,P);break;case"together":mh(a,!1,null,null,void 0);break;default:a.memoizedState=null}return a.child}function Pu(l,a){!(a.mode&1)&&l!==null&&(l.alternate=null,a.alternate=null,a.flags|=2)}function Xr(l,a,f){if(l!==null&&(a.dependencies=l.dependencies),ms|=a.lanes,!(f&a.childLanes))return null;if(l!==null&&a.child!==l.child)throw Error(o(153));if(a.child!==null){for(l=a.child,f=bi(l,l.pendingProps),a.child=f,f.return=a;l.sibling!==null;)l=l.sibling,f=f.sibling=bi(l,l.pendingProps),f.return=a;f.sibling=null}return a.child}function d2(l,a,f){switch(a.tag){case 3:Bv(a),io();break;case 5:sv(a);break;case 1:xn(a.type)&&eu(a);break;case 4:Xf(a,a.stateNode.containerInfo);break;case 10:ev(a,a.type._context,a.memoizedProps.value);break;case 13:var g=a.memoizedState;if(g!==null)return g.dehydrated!==null?(Ge(ct,ct.current&1),a.flags|=128,null):f&a.child.childLanes?Wv(l,a,f):(Ge(ct,ct.current&1),l=Xr(l,a,f),l!==null?l.sibling:null);Ge(ct,ct.current&1);break;case 19:if(g=(f&a.childLanes)!==0,l.flags&128){if(g)return Vv(l,a,f);a.flags|=128}var v=a.memoizedState;if(v!==null&&(v.rendering=null,v.tail=null,v.lastEffect=null),Ge(ct,ct.current),g)break;return null;case 22:case 23:return a.lanes=0,zv(l,a,f)}return Xr(l,a,f)}function _r(l){l.flags|=4}function qv(l,a){if(l!==null&&l.child===a.child)return!0;if(a.flags&16)return!1;for(l=a.child;l!==null;){if(l.flags&12854||l.subtreeFlags&12854)return!1;l=l.sibling}return!0}var xl,wl,Eu,Cu;if(Ne)xl=function(l,a){for(var f=a.child;f!==null;){if(f.tag===5||f.tag===6)we(l,f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===a)break;for(;f.sibling===null;){if(f.return===null||f.return===a)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},wl=function(){},Eu=function(l,a,f,g,v){if(l=l.memoizedProps,l!==g){var P=a.stateNode,I=Rr(qn.current);f=Re(P,f,l,g,v,I),(a.updateQueue=f)&&_r(a)}},Cu=function(l,a,f,g){f!==g&&_r(a)};else if(ye){xl=function(l,a,f,g){for(var v=a.child;v!==null;){if(v.tag===5){var P=v.stateNode;f&&g&&(P=ll(P,v.type,v.memoizedProps,v)),we(l,P)}else if(v.tag===6)P=v.stateNode,f&&g&&(P=Fy(P,v.memoizedProps,v)),we(l,P);else if(v.tag!==4){if(v.tag===22&&v.memoizedState!==null)P=v.child,P!==null&&(P.return=v),xl(l,v,!0,!0);else if(v.child!==null){v.child.return=v,v=v.child;continue}}if(v===a)break;for(;v.sibling===null;){if(v.return===null||v.return===a)return;v=v.return}v.sibling.return=v.return,v=v.sibling}};var Qv=function(l,a,f,g){for(var v=a.child;v!==null;){if(v.tag===5){var P=v.stateNode;f&&g&&(P=ll(P,v.type,v.memoizedProps,v)),Er(l,P)}else if(v.tag===6)P=v.stateNode,f&&g&&(P=Fy(P,v.memoizedProps,v)),Er(l,P);else if(v.tag!==4){if(v.tag===22&&v.memoizedState!==null)P=v.child,P!==null&&(P.return=v),Qv(l,v,!0,!0);else if(v.child!==null){v.child.return=v,v=v.child;continue}}if(v===a)break;for(;v.sibling===null;){if(v.return===null||v.return===a)return;v=v.return}v.sibling.return=v.return,v=v.sibling}};wl=function(l,a){var f=a.stateNode;if(!qv(l,a)){l=f.containerInfo;var g=Hr(l);Qv(g,a,!1,!1),f.pendingChildren=g,_r(a),Zs(l,g)}},Eu=function(l,a,f,g,v){var P=l.stateNode,I=l.memoizedProps;if((l=qv(l,a))&&I===g)a.stateNode=P;else{var $=a.stateNode,Q=Rr(qn.current),ie=null;I!==g&&(ie=Re($,f,I,g,v,Q)),l&&ie===null?a.stateNode=P:(P=Lt(P,ie,f,I,g,a,l,$),je(P,f,g,v,Q)&&_r(a),a.stateNode=P,l?_r(a):xl(P,a,!1,!1))}},Cu=function(l,a,f,g){f!==g?(l=Rr(ao.current),f=Rr(qn.current),a.stateNode=Ie(g,l,f,a),_r(a)):a.stateNode=l.stateNode}}else wl=function(){},Eu=function(){},Cu=function(){};function Sl(l,a){if(!st)switch(l.tailMode){case"hidden":a=l.tail;for(var f=null;a!==null;)a.alternate!==null&&(f=a),a=a.sibling;f===null?l.tail=null:f.sibling=null;break;case"collapsed":f=l.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?a||l.tail===null?l.tail=null:l.tail.sibling=null:g.sibling=null}}function Zt(l){var a=l.alternate!==null&&l.alternate.child===l.child,f=0,g=0;if(a)for(var v=l.child;v!==null;)f|=v.lanes|v.childLanes,g|=v.subtreeFlags&14680064,g|=v.flags&14680064,v.return=l,v=v.sibling;else for(v=l.child;v!==null;)f|=v.lanes|v.childLanes,g|=v.subtreeFlags,g|=v.flags,v.return=l,v=v.sibling;return l.subtreeFlags|=g,l.childLanes=f,a}function f2(l,a,f){var g=a.pendingProps;switch($f(a),a.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Zt(a),null;case 1:return xn(a.type)&&Ja(),Zt(a),null;case 3:return f=a.stateNode,uo(),et(vn),et(Kt),Zf(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(l===null||l.child===null)&&(au(a)?_r(a):l===null||l.memoizedState.isDehydrated&&!(a.flags&256)||(a.flags|=1024,cr!==null&&(jh(cr),cr=null))),wl(l,a),Zt(a),null;case 5:Kf(a),f=Rr(ao.current);var v=a.type;if(l!==null&&a.stateNode!=null)Eu(l,a,v,g,f),l.ref!==a.ref&&(a.flags|=512,a.flags|=2097152);else{if(!g){if(a.stateNode===null)throw Error(o(166));return Zt(a),null}if(l=Rr(qn.current),au(a)){if(!ae)throw Error(o(175));l=RT(a.stateNode,a.type,a.memoizedProps,f,l,a,!dl),a.updateQueue=l,l!==null&&_r(a)}else{var P=le(v,g,f,l,a);xl(P,a,!1,!1),a.stateNode=P,je(P,v,g,f,l)&&_r(a)}a.ref!==null&&(a.flags|=512,a.flags|=2097152)}return Zt(a),null;case 6:if(l&&a.stateNode!=null)Cu(l,a,l.memoizedProps,g);else{if(typeof g!="string"&&a.stateNode===null)throw Error(o(166));if(l=Rr(ao.current),f=Rr(qn.current),au(a)){if(!ae)throw Error(o(176));if(l=a.stateNode,f=a.memoizedProps,(g=IT(l,f,a,!dl))&&(v=On,v!==null))switch(v.tag){case 3:FT(v.stateNode.containerInfo,l,f,(v.mode&1)!==0);break;case 5:zT(v.type,v.memoizedProps,v.stateNode,l,f,(v.mode&1)!==0)}g&&_r(a)}else a.stateNode=Ie(g,l,f,a)}return Zt(a),null;case 13:if(et(ct),g=a.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(st&&Hn!==null&&a.mode&1&&!(a.flags&128))Ky(),io(),a.flags|=98560,v=!1;else if(v=au(a),g!==null&&g.dehydrated!==null){if(l===null){if(!v)throw Error(o(318));if(!ae)throw Error(o(344));if(v=a.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(o(317));_T(v,a)}else io(),!(a.flags&128)&&(a.memoizedState=null),a.flags|=4;Zt(a),v=!1}else cr!==null&&(jh(cr),cr=null),v=!0;if(!v)return a.flags&65536?a:null}return a.flags&128?(a.lanes=f,a):(f=g!==null,f!==(l!==null&&l.memoizedState!==null)&&f&&(a.child.flags|=8192,a.mode&1&&(l===null||ct.current&1?_t===0&&(_t=3):Lh())),a.updateQueue!==null&&(a.flags|=4),Zt(a),null);case 4:return uo(),wl(l,a),l===null&&Mt(a.stateNode.containerInfo),Zt(a),null;case 10:return Vf(a.type._context),Zt(a),null;case 17:return xn(a.type)&&Ja(),Zt(a),null;case 19:if(et(ct),v=a.memoizedState,v===null)return Zt(a),null;if(g=(a.flags&128)!==0,P=v.rendering,P===null)if(g)Sl(v,!1);else{if(_t!==0||l!==null&&l.flags&128)for(l=a.child;l!==null;){if(P=gu(l),P!==null){for(a.flags|=128,Sl(v,!1),l=P.updateQueue,l!==null&&(a.updateQueue=l,a.flags|=4),a.subtreeFlags=0,l=f,f=a.child;f!==null;)g=f,v=l,g.flags&=14680066,P=g.alternate,P===null?(g.childLanes=0,g.lanes=v,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=P.childLanes,g.lanes=P.lanes,g.child=P.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=P.memoizedProps,g.memoizedState=P.memoizedState,g.updateQueue=P.updateQueue,g.type=P.type,v=P.dependencies,g.dependencies=v===null?null:{lanes:v.lanes,firstContext:v.firstContext}),f=f.sibling;return Ge(ct,ct.current&1|2),a.child}l=l.sibling}v.tail!==null&&Nt()>Ih&&(a.flags|=128,g=!0,Sl(v,!1),a.lanes=4194304)}else{if(!g)if(l=gu(P),l!==null){if(a.flags|=128,g=!0,l=l.updateQueue,l!==null&&(a.updateQueue=l,a.flags|=4),Sl(v,!0),v.tail===null&&v.tailMode==="hidden"&&!P.alternate&&!st)return Zt(a),null}else 2*Nt()-v.renderingStartTime>Ih&&f!==1073741824&&(a.flags|=128,g=!0,Sl(v,!1),a.lanes=4194304);v.isBackwards?(P.sibling=a.child,a.child=P):(l=v.last,l!==null?l.sibling=P:a.child=P,v.last=P)}return v.tail!==null?(a=v.tail,v.rendering=a,v.tail=a.sibling,v.renderingStartTime=Nt(),a.sibling=null,l=ct.current,Ge(ct,g?l&1|2:l&1),a):(Zt(a),null);case 22:case 23:return Mh(),f=a.memoizedState!==null,l!==null&&l.memoizedState!==null!==f&&(a.flags|=8192),f&&a.mode&1?jn&1073741824&&(Zt(a),Ne&&a.subtreeFlags&6&&(a.flags|=8192)):Zt(a),null;case 24:return null;case 25:return null}throw Error(o(156,a.tag))}function h2(l,a){switch($f(a),a.tag){case 1:return xn(a.type)&&Ja(),l=a.flags,l&65536?(a.flags=l&-65537|128,a):null;case 3:return uo(),et(vn),et(Kt),Zf(),l=a.flags,l&65536&&!(l&128)?(a.flags=l&-65537|128,a):null;case 5:return Kf(a),null;case 13:if(et(ct),l=a.memoizedState,l!==null&&l.dehydrated!==null){if(a.alternate===null)throw Error(o(340));io()}return l=a.flags,l&65536?(a.flags=l&-65537|128,a):null;case 19:return et(ct),null;case 4:return uo(),null;case 10:return Vf(a.type._context),null;case 22:case 23:return Mh(),null;case 24:return null;default:return null}}var Tu=!1,Jt=!1,p2=typeof WeakSet=="function"?WeakSet:Set,ge=null;function fo(l,a){var f=l.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(g){ot(l,a,g)}else f.current=null}function yh(l,a,f){try{f()}catch(g){ot(l,a,g)}}var Yv=!1;function g2(l,a){for(L(l.containerInfo),ge=a;ge!==null;)if(l=ge,a=l.child,(l.subtreeFlags&1028)!==0&&a!==null)a.return=l,ge=a;else for(;ge!==null;){l=ge;try{var f=l.alternate;if(l.flags&1024)switch(l.tag){case 0:case 11:case 15:break;case 1:if(f!==null){var g=f.memoizedProps,v=f.memoizedState,P=l.stateNode,I=P.getSnapshotBeforeUpdate(l.elementType===l.type?g:dr(l.type,g),v);P.__reactInternalSnapshotBeforeUpdate=I}break;case 3:Ne&&mt(l.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(o(163))}}catch($){ot(l,l.return,$)}if(a=l.sibling,a!==null){a.return=l.return,ge=a;break}ge=l.return}return f=Yv,Yv=!1,f}function kl(l,a,f){var g=a.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var v=g=g.next;do{if((v.tag&l)===l){var P=v.destroy;v.destroy=void 0,P!==void 0&&yh(a,f,P)}v=v.next}while(v!==g)}}function bu(l,a){if(a=a.updateQueue,a=a!==null?a.lastEffect:null,a!==null){var f=a=a.next;do{if((f.tag&l)===l){var g=f.create;f.destroy=g()}f=f.next}while(f!==a)}}function vh(l){var a=l.ref;if(a!==null){var f=l.stateNode;switch(l.tag){case 5:l=se(f);break;default:l=f}typeof a=="function"?a(l):a.current=l}}function Xv(l){var a=l.alternate;a!==null&&(l.alternate=null,Xv(a)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(a=l.stateNode,a!==null&&Ht(a)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function Kv(l){return l.tag===5||l.tag===3||l.tag===4}function Gv(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||Kv(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function xh(l,a,f){var g=l.tag;if(g===5||g===6)l=l.stateNode,a?ue(f,l,a):Pe(f,l);else if(g!==4&&(l=l.child,l!==null))for(xh(l,a,f),l=l.sibling;l!==null;)xh(l,a,f),l=l.sibling}function wh(l,a,f){var g=l.tag;if(g===5||g===6)l=l.stateNode,a?ee(f,l,a):te(f,l);else if(g!==4&&(l=l.child,l!==null))for(wh(l,a,f),l=l.sibling;l!==null;)wh(l,a,f),l=l.sibling}var Vt=null,fr=!1;function Ar(l,a,f){for(f=f.child;f!==null;)Sh(l,a,f),f=f.sibling}function Sh(l,a,f){if(Cr&&typeof Cr.onCommitFiberUnmount=="function")try{Cr.onCommitFiberUnmount(iu,f)}catch{}switch(f.tag){case 5:Jt||fo(f,a);case 6:if(Ne){var g=Vt,v=fr;Vt=null,Ar(l,a,f),Vt=g,fr=v,Vt!==null&&(fr?fe(Vt,f.stateNode):pe(Vt,f.stateNode))}else Ar(l,a,f);break;case 18:Ne&&Vt!==null&&(fr?LT(Vt,f.stateNode):MT(Vt,f.stateNode));break;case 4:Ne?(g=Vt,v=fr,Vt=f.stateNode.containerInfo,fr=!0,Ar(l,a,f),Vt=g,fr=v):(ye&&(g=f.stateNode.containerInfo,v=Hr(g),Js(g,v)),Ar(l,a,f));break;case 0:case 11:case 14:case 15:if(!Jt&&(g=f.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){v=g=g.next;do{var P=v,I=P.destroy;P=P.tag,I!==void 0&&(P&2||P&4)&&yh(f,a,I),v=v.next}while(v!==g)}Ar(l,a,f);break;case 1:if(!Jt&&(fo(f,a),g=f.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=f.memoizedProps,g.state=f.memoizedState,g.componentWillUnmount()}catch($){ot(f,a,$)}Ar(l,a,f);break;case 21:Ar(l,a,f);break;case 22:f.mode&1?(Jt=(g=Jt)||f.memoizedState!==null,Ar(l,a,f),Jt=g):Ar(l,a,f);break;default:Ar(l,a,f)}}function Zv(l){var a=l.updateQueue;if(a!==null){l.updateQueue=null;var f=l.stateNode;f===null&&(f=l.stateNode=new p2),a.forEach(function(g){var v=E2.bind(null,l,g);f.has(g)||(f.add(g),g.then(v,v))})}}function hr(l,a){var f=a.deletions;if(f!==null)for(var g=0;g<f.length;g++){var v=f[g];try{var P=l,I=a;if(Ne){var $=I;e:for(;$!==null;){switch($.tag){case 5:Vt=$.stateNode,fr=!1;break e;case 3:Vt=$.stateNode.containerInfo,fr=!0;break e;case 4:Vt=$.stateNode.containerInfo,fr=!0;break e}$=$.return}if(Vt===null)throw Error(o(160));Sh(P,I,v),Vt=null,fr=!1}else Sh(P,I,v);var Q=v.alternate;Q!==null&&(Q.return=null),v.return=null}catch(ie){ot(v,a,ie)}}if(a.subtreeFlags&12854)for(a=a.child;a!==null;)Jv(a,l),a=a.sibling}function Jv(l,a){var f=l.alternate,g=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(hr(a,l),Or(l),g&4){try{kl(3,l,l.return),bu(3,l)}catch(ce){ot(l,l.return,ce)}try{kl(5,l,l.return)}catch(ce){ot(l,l.return,ce)}}break;case 1:hr(a,l),Or(l),g&512&&f!==null&&fo(f,f.return);break;case 5:if(hr(a,l),Or(l),g&512&&f!==null&&fo(f,f.return),Ne){if(l.flags&32){var v=l.stateNode;try{Me(v)}catch(ce){ot(l,l.return,ce)}}if(g&4&&(v=l.stateNode,v!=null)){var P=l.memoizedProps;if(f=f!==null?f.memoizedProps:P,g=l.type,a=l.updateQueue,l.updateQueue=null,a!==null)try{K(v,a,g,f,P,l)}catch(ce){ot(l,l.return,ce)}}}break;case 6:if(hr(a,l),Or(l),g&4&&Ne){if(l.stateNode===null)throw Error(o(162));v=l.stateNode,P=l.memoizedProps,f=f!==null?f.memoizedProps:P;try{_e(v,f,P)}catch(ce){ot(l,l.return,ce)}}break;case 3:if(hr(a,l),Or(l),g&4){if(Ne&&ae&&f!==null&&f.memoizedState.isDehydrated)try{OT(a.containerInfo)}catch(ce){ot(l,l.return,ce)}if(ye){v=a.containerInfo,P=a.pendingChildren;try{Js(v,P)}catch(ce){ot(l,l.return,ce)}}}break;case 4:if(hr(a,l),Or(l),g&4&&ye){P=l.stateNode,v=P.containerInfo,P=P.pendingChildren;try{Js(v,P)}catch(ce){ot(l,l.return,ce)}}break;case 13:hr(a,l),Or(l),v=l.child,v.flags&8192&&(P=v.memoizedState!==null,v.stateNode.isHidden=P,!P||v.alternate!==null&&v.alternate.memoizedState!==null||(Rh=Nt())),g&4&&Zv(l);break;case 22:var I=f!==null&&f.memoizedState!==null;if(l.mode&1?(Jt=(f=Jt)||I,hr(a,l),Jt=f):hr(a,l),Or(l),g&8192){if(f=l.memoizedState!==null,(l.stateNode.isHidden=f)&&!I&&l.mode&1)for(ge=l,g=l.child;g!==null;){for(a=ge=g;ge!==null;){I=ge;var $=I.child;switch(I.tag){case 0:case 11:case 14:case 15:kl(4,I,I.return);break;case 1:fo(I,I.return);var Q=I.stateNode;if(typeof Q.componentWillUnmount=="function"){var ie=I,xe=I.return;try{var Ae=ie;Q.props=Ae.memoizedProps,Q.state=Ae.memoizedState,Q.componentWillUnmount()}catch(ce){ot(ie,xe,ce)}}break;case 5:fo(I,I.return);break;case 22:if(I.memoizedState!==null){n0(a);continue}}$!==null?($.return=I,ge=$):n0(a)}g=g.sibling}if(Ne){e:if(g=null,Ne)for(a=l;;){if(a.tag===5){if(g===null){g=a;try{v=a.stateNode,f?Qe(v):Ye(a.stateNode,a.memoizedProps)}catch(ce){ot(l,l.return,ce)}}}else if(a.tag===6){if(g===null)try{P=a.stateNode,f?Je(P):Rt(P,a.memoizedProps)}catch(ce){ot(l,l.return,ce)}}else if((a.tag!==22&&a.tag!==23||a.memoizedState===null||a===l)&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===l)break e;for(;a.sibling===null;){if(a.return===null||a.return===l)break e;g===a&&(g=null),a=a.return}g===a&&(g=null),a.sibling.return=a.return,a=a.sibling}}}break;case 19:hr(a,l),Or(l),g&4&&Zv(l);break;case 21:break;default:hr(a,l),Or(l)}}function Or(l){var a=l.flags;if(a&2){try{if(Ne){e:{for(var f=l.return;f!==null;){if(Kv(f)){var g=f;break e}f=f.return}throw Error(o(160))}switch(g.tag){case 5:var v=g.stateNode;g.flags&32&&(Me(v),g.flags&=-33);var P=Gv(l);wh(l,P,v);break;case 3:case 4:var I=g.stateNode.containerInfo,$=Gv(l);xh(l,$,I);break;default:throw Error(o(161))}}}catch(Q){ot(l,l.return,Q)}l.flags&=-3}a&4096&&(l.flags&=-4097)}function m2(l,a,f){ge=l,e0(l)}function e0(l,a,f){for(var g=(l.mode&1)!==0;ge!==null;){var v=ge,P=v.child;if(v.tag===22&&g){var I=v.memoizedState!==null||Tu;if(!I){var $=v.alternate,Q=$!==null&&$.memoizedState!==null||Jt;$=Tu;var ie=Jt;if(Tu=I,(Jt=Q)&&!ie)for(ge=v;ge!==null;)I=ge,Q=I.child,I.tag===22&&I.memoizedState!==null?r0(v):Q!==null?(Q.return=I,ge=Q):r0(v);for(;P!==null;)ge=P,e0(P),P=P.sibling;ge=v,Tu=$,Jt=ie}t0(l)}else v.subtreeFlags&8772&&P!==null?(P.return=v,ge=P):t0(l)}}function t0(l){for(;ge!==null;){var a=ge;if(a.flags&8772){var f=a.alternate;try{if(a.flags&8772)switch(a.tag){case 0:case 11:case 15:Jt||bu(5,a);break;case 1:var g=a.stateNode;if(a.flags&4&&!Jt)if(f===null)g.componentDidMount();else{var v=a.elementType===a.type?f.memoizedProps:dr(a.type,f.memoizedProps);g.componentDidUpdate(v,f.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var P=a.updateQueue;P!==null&&iv(a,P,g);break;case 3:var I=a.updateQueue;if(I!==null){if(f=null,a.child!==null)switch(a.child.tag){case 5:f=se(a.child.stateNode);break;case 1:f=a.child.stateNode}iv(a,I,f)}break;case 5:var $=a.stateNode;f===null&&a.flags&4&&De($,a.type,a.memoizedProps,a);break;case 6:break;case 4:break;case 12:break;case 13:if(ae&&a.memoizedState===null){var Q=a.alternate;if(Q!==null){var ie=Q.memoizedState;if(ie!==null){var xe=ie.dehydrated;xe!==null&&jT(xe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(o(163))}Jt||a.flags&512&&vh(a)}catch(Ae){ot(a,a.return,Ae)}}if(a===l){ge=null;break}if(f=a.sibling,f!==null){f.return=a.return,ge=f;break}ge=a.return}}function n0(l){for(;ge!==null;){var a=ge;if(a===l){ge=null;break}var f=a.sibling;if(f!==null){f.return=a.return,ge=f;break}ge=a.return}}function r0(l){for(;ge!==null;){var a=ge;try{switch(a.tag){case 0:case 11:case 15:var f=a.return;try{bu(4,a)}catch(Q){ot(a,f,Q)}break;case 1:var g=a.stateNode;if(typeof g.componentDidMount=="function"){var v=a.return;try{g.componentDidMount()}catch(Q){ot(a,v,Q)}}var P=a.return;try{vh(a)}catch(Q){ot(a,P,Q)}break;case 5:var I=a.return;try{vh(a)}catch(Q){ot(a,I,Q)}}}catch(Q){ot(a,a.return,Q)}if(a===l){ge=null;break}var $=a.sibling;if($!==null){$.return=a.return,ge=$;break}ge=a.return}}var Ru=0,Iu=1,_u=2,Au=3,Ou=4;if(typeof Symbol=="function"&&Symbol.for){var Pl=Symbol.for;Ru=Pl("selector.component"),Iu=Pl("selector.has_pseudo_class"),_u=Pl("selector.role"),Au=Pl("selector.test_id"),Ou=Pl("selector.text")}function kh(l){var a=$e(l);if(a!=null){if(typeof a.memoizedProps["data-testname"]!="string")throw Error(o(364));return a}if(l=cs(l),l===null)throw Error(o(362));return l.stateNode.current}function Ph(l,a){switch(a.$$typeof){case Ru:if(l.type===a.value)return!0;break;case Iu:e:{a=a.value,l=[l,0];for(var f=0;f<l.length;){var g=l[f++],v=l[f++],P=a[v];if(g.tag!==5||!oe(g)){for(;P!=null&&Ph(g,P);)v++,P=a[v];if(v===a.length){a=!0;break e}else for(g=g.child;g!==null;)l.push(g,v),g=g.sibling}}a=!1}return a;case _u:if(l.tag===5&&U(l.stateNode,a.value))return!0;break;case Ou:if((l.tag===5||l.tag===6)&&(l=Z(l),l!==null&&0<=l.indexOf(a.value)))return!0;break;case Au:if(l.tag===5&&(l=l.memoizedProps["data-testname"],typeof l=="string"&&l.toLowerCase()===a.value.toLowerCase()))return!0;break;default:throw Error(o(365))}return!1}function Eh(l){switch(l.$$typeof){case Ru:return"<"+(F(l.value)||"Unknown")+">";case Iu:return":has("+(Eh(l)||"")+")";case _u:return'[role="'+l.value+'"]';case Ou:return'"'+l.value+'"';case Au:return'[data-testname="'+l.value+'"]';default:throw Error(o(365))}}function i0(l,a){var f=[];l=[l,0];for(var g=0;g<l.length;){var v=l[g++],P=l[g++],I=a[P];if(v.tag!==5||!oe(v)){for(;I!=null&&Ph(v,I);)P++,I=a[P];if(P===a.length)f.push(v);else for(v=v.child;v!==null;)l.push(v,P),v=v.sibling}}return f}function Ch(l,a){if(!lr)throw Error(o(363));l=kh(l),l=i0(l,a),a=[],l=Array.from(l);for(var f=0;f<l.length;){var g=l[f++];if(g.tag===5)oe(g)||a.push(g.stateNode);else for(g=g.child;g!==null;)l.push(g),g=g.sibling}return a}var y2=Math.ceil,ju=u.ReactCurrentDispatcher,Th=u.ReactCurrentOwner,wt=u.ReactCurrentBatchConfig,Fe=0,zt=null,Pt=null,qt=0,jn=0,ho=xi(0),_t=0,El=null,ms=0,Mu=0,bh=0,Cl=null,Sn=null,Rh=0,Ih=1/0,Kr=null;function po(){Ih=Nt()+500}var Lu=!1,_h=null,Pi=null,Nu=!1,Ei=null,Fu=0,Tl=0,Ah=null,zu=-1,$u=0;function en(){return Fe&6?Nt():zu!==-1?zu:zu=Nt()}function Ci(l){return l.mode&1?Fe&2&&qt!==0?qt&-qt:JT.transition!==null?($u===0&&($u=Uy()),$u):(l=We,l!==0?l:un()):1}function Yn(l,a,f,g){if(50<Tl)throw Tl=0,Ah=null,Error(o(185));cl(l,f,g),(!(Fe&2)||l!==zt)&&(l===zt&&(!(Fe&2)&&(Mu|=f),_t===4&&Ti(l,qt)),kn(l,g),f===1&&Fe===0&&!(a.mode&1)&&(po(),su&&Tr()))}function kn(l,a){var f=l.callbackNode;HT(l,a);var g=ru(l,l===zt?qt:0);if(g===0)f!==null&&Hy(f),l.callbackNode=null,l.callbackPriority=0;else if(a=g&-g,l.callbackPriority!==a){if(f!=null&&Hy(f),a===1)l.tag===0?ZT(o0.bind(null,l)):Vy(o0.bind(null,l)),bt?ol(function(){!(Fe&6)&&Tr()}):Mf(Lf,Tr),f=null;else{switch(Wy(g)){case 1:f=Lf;break;case 4:f=YT;break;case 16:f=Nf;break;case 536870912:f=XT;break;default:f=Nf}f=g0(f,s0.bind(null,l))}l.callbackPriority=a,l.callbackNode=f}}function s0(l,a){if(zu=-1,$u=0,Fe&6)throw Error(o(327));var f=l.callbackNode;if(xs()&&l.callbackNode!==f)return null;var g=ru(l,l===zt?qt:0);if(g===0)return null;if(g&30||g&l.expiredLanes||a)a=Du(l,g);else{a=g;var v=Fe;Fe|=2;var P=u0();(zt!==l||qt!==a)&&(Kr=null,po(),ys(l,a));do try{w2();break}catch($){a0(l,$)}while(!0);Hf(),ju.current=P,Fe=v,Pt!==null?a=0:(zt=null,qt=0,a=_t)}if(a!==0){if(a===2&&(v=Af(l),v!==0&&(g=v,a=Oh(l,v))),a===1)throw f=El,ys(l,0),Ti(l,g),kn(l,Nt()),f;if(a===6)Ti(l,g);else{if(v=l.current.alternate,!(g&30)&&!v2(v)&&(a=Du(l,g),a===2&&(P=Af(l),P!==0&&(g=P,a=Oh(l,P))),a===1))throw f=El,ys(l,0),Ti(l,g),kn(l,Nt()),f;switch(l.finishedWork=v,l.finishedLanes=g,a){case 0:case 1:throw Error(o(345));case 2:vs(l,Sn,Kr);break;case 3:if(Ti(l,g),(g&130023424)===g&&(a=Rh+500-Nt(),10<a)){if(ru(l,0)!==0)break;if(v=l.suspendedLanes,(v&g)!==g){en(),l.pingedLanes|=l.suspendedLanes&v;break}l.timeoutHandle=Ke(vs.bind(null,l,Sn,Kr),a);break}vs(l,Sn,Kr);break;case 4:if(Ti(l,g),(g&4194240)===g)break;for(a=l.eventTimes,v=-1;0<g;){var I=31-ar(g);P=1<<I,I=a[I],I>v&&(v=I),g&=~P}if(g=v,g=Nt()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*y2(g/1960))-g,10<g){l.timeoutHandle=Ke(vs.bind(null,l,Sn,Kr),g);break}vs(l,Sn,Kr);break;case 5:vs(l,Sn,Kr);break;default:throw Error(o(329))}}}return kn(l,Nt()),l.callbackNode===f?s0.bind(null,l):null}function Oh(l,a){var f=Cl;return l.current.memoizedState.isDehydrated&&(ys(l,a).flags|=256),l=Du(l,a),l!==2&&(a=Sn,Sn=f,a!==null&&jh(a)),l}function jh(l){Sn===null?Sn=l:Sn.push.apply(Sn,l)}function v2(l){for(var a=l;;){if(a.flags&16384){var f=a.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var g=0;g<f.length;g++){var v=f[g],P=v.getSnapshot;v=v.value;try{if(!ur(P(),v))return!1}catch{return!1}}}if(f=a.child,a.subtreeFlags&16384&&f!==null)f.return=a,a=f;else{if(a===l)break;for(;a.sibling===null;){if(a.return===null||a.return===l)return!0;a=a.return}a.sibling.return=a.return,a=a.sibling}}return!0}function Ti(l,a){for(a&=~bh,a&=~Mu,l.suspendedLanes|=a,l.pingedLanes&=~a,l=l.expirationTimes;0<a;){var f=31-ar(a),g=1<<f;l[f]=-1,a&=~g}}function o0(l){if(Fe&6)throw Error(o(327));xs();var a=ru(l,0);if(!(a&1))return kn(l,Nt()),null;var f=Du(l,a);if(l.tag!==0&&f===2){var g=Af(l);g!==0&&(a=g,f=Oh(l,g))}if(f===1)throw f=El,ys(l,0),Ti(l,a),kn(l,Nt()),f;if(f===6)throw Error(o(345));return l.finishedWork=l.current.alternate,l.finishedLanes=a,vs(l,Sn,Kr),kn(l,Nt()),null}function l0(l){Ei!==null&&Ei.tag===0&&!(Fe&6)&&xs();var a=Fe;Fe|=1;var f=wt.transition,g=We;try{if(wt.transition=null,We=1,l)return l()}finally{We=g,wt.transition=f,Fe=a,!(Fe&6)&&Tr()}}function Mh(){jn=ho.current,et(ho)}function ys(l,a){l.finishedWork=null,l.finishedLanes=0;var f=l.timeoutHandle;if(f!==an&&(l.timeoutHandle=an,ln(f)),Pt!==null)for(f=Pt.return;f!==null;){var g=f;switch($f(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&Ja();break;case 3:uo(),et(vn),et(Kt),Zf();break;case 5:Kf(g);break;case 4:uo();break;case 13:et(ct);break;case 19:et(ct);break;case 10:Vf(g.type._context);break;case 22:case 23:Mh()}f=f.return}if(zt=l,Pt=l=bi(l.current,null),qt=jn=a,_t=0,El=null,bh=Mu=ms=0,Sn=Cl=null,ps!==null){for(a=0;a<ps.length;a++)if(f=ps[a],g=f.interleaved,g!==null){f.interleaved=null;var v=g.next,P=f.pending;if(P!==null){var I=P.next;P.next=v,g.next=I}f.pending=g}ps=null}return l}function a0(l,a){do{var f=Pt;try{if(Hf(),mu.current=wu,yu){for(var g=dt.memoizedState;g!==null;){var v=g.queue;v!==null&&(v.pending=null),g=g.next}yu=!1}if(gs=0,Ft=It=dt=null,gl=!1,ml=0,Th.current=null,f===null||f.return===null){_t=1,El=a,Pt=null;break}e:{var P=l,I=f.return,$=f,Q=a;if(a=qt,$.flags|=32768,Q!==null&&typeof Q=="object"&&typeof Q.then=="function"){var ie=Q,xe=$,Ae=xe.tag;if(!(xe.mode&1)&&(Ae===0||Ae===11||Ae===15)){var ce=xe.alternate;ce?(xe.updateQueue=ce.updateQueue,xe.memoizedState=ce.memoizedState,xe.lanes=ce.lanes):(xe.updateQueue=null,xe.memoizedState=null)}var tt=jv(I);if(tt!==null){tt.flags&=-257,Mv(tt,I,$,P,a),tt.mode&1&&Ov(P,ie,a),a=tt,Q=ie;var Xe=a.updateQueue;if(Xe===null){var Pn=new Set;Pn.add(Q),a.updateQueue=Pn}else Xe.add(Q);break e}else{if(!(a&1)){Ov(P,ie,a),Lh();break e}Q=Error(o(426))}}else if(st&&$.mode&1){var Gr=jv(I);if(Gr!==null){!(Gr.flags&65536)&&(Gr.flags|=256),Mv(Gr,I,$,P,a),Uf(co(Q,$));break e}}P=Q=co(Q,$),_t!==4&&(_t=2),Cl===null?Cl=[P]:Cl.push(P),P=I;do{switch(P.tag){case 3:P.flags|=65536,a&=-a,P.lanes|=a;var q=_v(P,Q,a);rv(P,q);break e;case 1:$=Q;var D=P.type,G=P.stateNode;if(!(P.flags&128)&&(typeof D.getDerivedStateFromError=="function"||G!==null&&typeof G.componentDidCatch=="function"&&(Pi===null||!Pi.has(G)))){P.flags|=65536,a&=-a,P.lanes|=a;var he=Av(P,$,a);rv(P,he);break e}}P=P.return}while(P!==null)}d0(f)}catch(Ce){a=Ce,Pt===f&&f!==null&&(Pt=f=f.return);continue}break}while(!0)}function u0(){var l=ju.current;return ju.current=wu,l===null?wu:l}function Lh(){(_t===0||_t===3||_t===2)&&(_t=4),zt===null||!(ms&268435455)&&!(Mu&268435455)||Ti(zt,qt)}function Du(l,a){var f=Fe;Fe|=2;var g=u0();(zt!==l||qt!==a)&&(Kr=null,ys(l,a));do try{x2();break}catch(v){a0(l,v)}while(!0);if(Hf(),Fe=f,ju.current=g,Pt!==null)throw Error(o(261));return zt=null,qt=0,_t}function x2(){for(;Pt!==null;)c0(Pt)}function w2(){for(;Pt!==null&&!qT();)c0(Pt)}function c0(l){var a=p0(l.alternate,l,jn);l.memoizedProps=l.pendingProps,a===null?d0(l):Pt=a,Th.current=null}function d0(l){var a=l;do{var f=a.alternate;if(l=a.return,a.flags&32768){if(f=h2(f,a),f!==null){f.flags&=32767,Pt=f;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{_t=6,Pt=null;return}}else if(f=f2(f,a,jn),f!==null){Pt=f;return}if(a=a.sibling,a!==null){Pt=a;return}Pt=a=l}while(a!==null);_t===0&&(_t=5)}function vs(l,a,f){var g=We,v=wt.transition;try{wt.transition=null,We=1,S2(l,a,f,g)}finally{wt.transition=v,We=g}return null}function S2(l,a,f,g){do xs();while(Ei!==null);if(Fe&6)throw Error(o(327));f=l.finishedWork;var v=l.finishedLanes;if(f===null)return null;if(l.finishedWork=null,l.finishedLanes=0,f===l.current)throw Error(o(177));l.callbackNode=null,l.callbackPriority=0;var P=f.lanes|f.childLanes;if(VT(l,P),l===zt&&(Pt=zt=null,qt=0),!(f.subtreeFlags&2064)&&!(f.flags&2064)||Nu||(Nu=!0,g0(Nf,function(){return xs(),null})),P=(f.flags&15990)!==0,f.subtreeFlags&15990||P){P=wt.transition,wt.transition=null;var I=We;We=1;var $=Fe;Fe|=4,Th.current=null,g2(l,f),Jv(f,l),W(l.containerInfo),l.current=f,m2(f),QT(),Fe=$,We=I,wt.transition=P}else l.current=f;if(Nu&&(Nu=!1,Ei=l,Fu=v),P=l.pendingLanes,P===0&&(Pi=null),KT(f.stateNode),kn(l,Nt()),a!==null)for(g=l.onRecoverableError,f=0;f<a.length;f++)v=a[f],g(v.value,{componentStack:v.stack,digest:v.digest});if(Lu)throw Lu=!1,l=_h,_h=null,l;return Fu&1&&l.tag!==0&&xs(),P=l.pendingLanes,P&1?l===Ah?Tl++:(Tl=0,Ah=l):Tl=0,Tr(),null}function xs(){if(Ei!==null){var l=Wy(Fu),a=wt.transition,f=We;try{if(wt.transition=null,We=16>l?16:l,Ei===null)var g=!1;else{if(l=Ei,Ei=null,Fu=0,Fe&6)throw Error(o(331));var v=Fe;for(Fe|=4,ge=l.current;ge!==null;){var P=ge,I=P.child;if(ge.flags&16){var $=P.deletions;if($!==null){for(var Q=0;Q<$.length;Q++){var ie=$[Q];for(ge=ie;ge!==null;){var xe=ge;switch(xe.tag){case 0:case 11:case 15:kl(8,xe,P)}var Ae=xe.child;if(Ae!==null)Ae.return=xe,ge=Ae;else for(;ge!==null;){xe=ge;var ce=xe.sibling,tt=xe.return;if(Xv(xe),xe===ie){ge=null;break}if(ce!==null){ce.return=tt,ge=ce;break}ge=tt}}}var Xe=P.alternate;if(Xe!==null){var Pn=Xe.child;if(Pn!==null){Xe.child=null;do{var Gr=Pn.sibling;Pn.sibling=null,Pn=Gr}while(Pn!==null)}}ge=P}}if(P.subtreeFlags&2064&&I!==null)I.return=P,ge=I;else e:for(;ge!==null;){if(P=ge,P.flags&2048)switch(P.tag){case 0:case 11:case 15:kl(9,P,P.return)}var q=P.sibling;if(q!==null){q.return=P.return,ge=q;break e}ge=P.return}}var D=l.current;for(ge=D;ge!==null;){I=ge;var G=I.child;if(I.subtreeFlags&2064&&G!==null)G.return=I,ge=G;else e:for(I=D;ge!==null;){if($=ge,$.flags&2048)try{switch($.tag){case 0:case 11:case 15:bu(9,$)}}catch(Ce){ot($,$.return,Ce)}if($===I){ge=null;break e}var he=$.sibling;if(he!==null){he.return=$.return,ge=he;break e}ge=$.return}}if(Fe=v,Tr(),Cr&&typeof Cr.onPostCommitFiberRoot=="function")try{Cr.onPostCommitFiberRoot(iu,l)}catch{}g=!0}return g}finally{We=f,wt.transition=a}}return!1}function f0(l,a,f){a=co(f,a),a=_v(l,a,1),l=ki(l,a,1),a=en(),l!==null&&(cl(l,1,a),kn(l,a))}function ot(l,a,f){if(l.tag===3)f0(l,l,f);else for(;a!==null;){if(a.tag===3){f0(a,l,f);break}else if(a.tag===1){var g=a.stateNode;if(typeof a.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Pi===null||!Pi.has(g))){l=co(f,l),l=Av(a,l,1),a=ki(a,l,1),l=en(),a!==null&&(cl(a,1,l),kn(a,l));break}}a=a.return}}function k2(l,a,f){var g=l.pingCache;g!==null&&g.delete(a),a=en(),l.pingedLanes|=l.suspendedLanes&f,zt===l&&(qt&f)===f&&(_t===4||_t===3&&(qt&130023424)===qt&&500>Nt()-Rh?ys(l,0):bh|=f),kn(l,a)}function h0(l,a){a===0&&(l.mode&1?(a=nu,nu<<=1,!(nu&130023424)&&(nu=4194304)):a=1);var f=en();l=br(l,a),l!==null&&(cl(l,a,f),kn(l,f))}function P2(l){var a=l.memoizedState,f=0;a!==null&&(f=a.retryLane),h0(l,f)}function E2(l,a){var f=0;switch(l.tag){case 13:var g=l.stateNode,v=l.memoizedState;v!==null&&(f=v.retryLane);break;case 19:g=l.stateNode;break;default:throw Error(o(314))}g!==null&&g.delete(a),h0(l,f)}var p0;p0=function(l,a,f){if(l!==null)if(l.memoizedProps!==a.pendingProps||vn.current)wn=!0;else{if(!(l.lanes&f)&&!(a.flags&128))return wn=!1,d2(l,a,f);wn=!!(l.flags&131072)}else wn=!1,st&&a.flags&1048576&&qy(a,lu,a.index);switch(a.lanes=0,a.tag){case 2:var g=a.type;Pu(l,a),l=a.pendingProps;var v=to(a,Kt.current);lo(a,f),v=th(null,a,g,l,v,f);var P=nh();return a.flags|=1,typeof v=="object"&&v!==null&&typeof v.render=="function"&&v.$$typeof===void 0?(a.tag=1,a.memoizedState=null,a.updateQueue=null,xn(g)?(P=!0,eu(a)):P=!1,a.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,Yf(a),v.updater=Su,a.stateNode=v,v._reactInternals=a,ah(a,g,l,f),a=fh(null,a,g,!0,P,f)):(a.tag=0,st&&P&&zf(a),cn(null,a,v,f),a=a.child),a;case 16:g=a.elementType;e:{switch(Pu(l,a),l=a.pendingProps,v=g._init,g=v(g._payload),a.type=g,v=a.tag=T2(g),l=dr(g,l),v){case 0:a=dh(null,a,g,l,f);break e;case 1:a=Dv(null,a,g,l,f);break e;case 11:a=Lv(null,a,g,l,f);break e;case 14:a=Nv(null,a,g,dr(g.type,l),f);break e}throw Error(o(306,g,""))}return a;case 0:return g=a.type,v=a.pendingProps,v=a.elementType===g?v:dr(g,v),dh(l,a,g,v,f);case 1:return g=a.type,v=a.pendingProps,v=a.elementType===g?v:dr(g,v),Dv(l,a,g,v,f);case 3:e:{if(Bv(a),l===null)throw Error(o(387));g=a.pendingProps,P=a.memoizedState,v=P.element,nv(l,a),pu(a,g,null,f);var I=a.memoizedState;if(g=I.element,ae&&P.isDehydrated)if(P={element:g,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},a.updateQueue.baseState=P,a.memoizedState=P,a.flags&256){v=co(Error(o(423)),a),a=Uv(l,a,g,f,v);break e}else if(g!==v){v=co(Error(o(424)),a),a=Uv(l,a,g,f,v);break e}else for(ae&&(Hn=TT(a.stateNode.containerInfo),On=a,st=!0,cr=null,dl=!1),f=Jy(a,null,g,f),a.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(io(),g===v){a=Xr(l,a,f);break e}cn(l,a,g,f)}a=a.child}return a;case 5:return sv(a),l===null&&Bf(a),g=a.type,v=a.pendingProps,P=l!==null?l.memoizedProps:null,I=v.children,be(g,v)?I=null:P!==null&&be(g,P)&&(a.flags|=32),$v(l,a),cn(l,a,I,f),a.child;case 6:return l===null&&Bf(a),null;case 13:return Wv(l,a,f);case 4:return Xf(a,a.stateNode.containerInfo),g=a.pendingProps,l===null?a.child=so(a,null,g,f):cn(l,a,g,f),a.child;case 11:return g=a.type,v=a.pendingProps,v=a.elementType===g?v:dr(g,v),Lv(l,a,g,v,f);case 7:return cn(l,a,a.pendingProps,f),a.child;case 8:return cn(l,a,a.pendingProps.children,f),a.child;case 12:return cn(l,a,a.pendingProps.children,f),a.child;case 10:e:{if(g=a.type._context,v=a.pendingProps,P=a.memoizedProps,I=v.value,ev(a,g,I),P!==null)if(ur(P.value,I)){if(P.children===v.children&&!vn.current){a=Xr(l,a,f);break e}}else for(P=a.child,P!==null&&(P.return=a);P!==null;){var $=P.dependencies;if($!==null){I=P.child;for(var Q=$.firstContext;Q!==null;){if(Q.context===g){if(P.tag===1){Q=Yr(-1,f&-f),Q.tag=2;var ie=P.updateQueue;if(ie!==null){ie=ie.shared;var xe=ie.pending;xe===null?Q.next=Q:(Q.next=xe.next,xe.next=Q),ie.pending=Q}}P.lanes|=f,Q=P.alternate,Q!==null&&(Q.lanes|=f),qf(P.return,f,a),$.lanes|=f;break}Q=Q.next}}else if(P.tag===10)I=P.type===a.type?null:P.child;else if(P.tag===18){if(I=P.return,I===null)throw Error(o(341));I.lanes|=f,$=I.alternate,$!==null&&($.lanes|=f),qf(I,f,a),I=P.sibling}else I=P.child;if(I!==null)I.return=P;else for(I=P;I!==null;){if(I===a){I=null;break}if(P=I.sibling,P!==null){P.return=I.return,I=P;break}I=I.return}P=I}cn(l,a,v.children,f),a=a.child}return a;case 9:return v=a.type,g=a.pendingProps.children,lo(a,f),v=Vn(v),g=g(v),a.flags|=1,cn(l,a,g,f),a.child;case 14:return g=a.type,v=dr(g,a.pendingProps),v=dr(g.type,v),Nv(l,a,g,v,f);case 15:return Fv(l,a,a.type,a.pendingProps,f);case 17:return g=a.type,v=a.pendingProps,v=a.elementType===g?v:dr(g,v),Pu(l,a),a.tag=1,xn(g)?(l=!0,eu(a)):l=!1,lo(a,f),Rv(a,g,v),ah(a,g,v,f),fh(null,a,g,!0,l,f);case 19:return Vv(l,a,f);case 22:return zv(l,a,f)}throw Error(o(156,a.tag))};function g0(l,a){return Mf(l,a)}function C2(l,a,f,g){this.tag=l,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=a,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xn(l,a,f,g){return new C2(l,a,f,g)}function Nh(l){return l=l.prototype,!(!l||!l.isReactComponent)}function T2(l){if(typeof l=="function")return Nh(l)?1:0;if(l!=null){if(l=l.$$typeof,l===S)return 11;if(l===k)return 14}return 2}function bi(l,a){var f=l.alternate;return f===null?(f=Xn(l.tag,a,l.key,l.mode),f.elementType=l.elementType,f.type=l.type,f.stateNode=l.stateNode,f.alternate=l,l.alternate=f):(f.pendingProps=a,f.type=l.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=l.flags&14680064,f.childLanes=l.childLanes,f.lanes=l.lanes,f.child=l.child,f.memoizedProps=l.memoizedProps,f.memoizedState=l.memoizedState,f.updateQueue=l.updateQueue,a=l.dependencies,f.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext},f.sibling=l.sibling,f.index=l.index,f.ref=l.ref,f}function Bu(l,a,f,g,v,P){var I=2;if(g=l,typeof l=="function")Nh(l)&&(I=1);else if(typeof l=="string")I=5;else e:switch(l){case c:return ws(f.children,v,P,a);case p:I=8,v|=8;break;case m:return l=Xn(12,f,a,v|2),l.elementType=m,l.lanes=P,l;case C:return l=Xn(13,f,a,v),l.elementType=C,l.lanes=P,l;case x:return l=Xn(19,f,a,v),l.elementType=x,l.lanes=P,l;case _:return Uu(f,v,P,a);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case w:I=10;break e;case y:I=9;break e;case S:I=11;break e;case k:I=14;break e;case T:I=16,g=null;break e}throw Error(o(130,l==null?l:typeof l,""))}return a=Xn(I,f,a,v),a.elementType=l,a.type=g,a.lanes=P,a}function ws(l,a,f,g){return l=Xn(7,l,g,a),l.lanes=f,l}function Uu(l,a,f,g){return l=Xn(22,l,g,a),l.elementType=_,l.lanes=f,l.stateNode={isHidden:!1},l}function Fh(l,a,f){return l=Xn(6,l,null,a),l.lanes=f,l}function zh(l,a,f){return a=Xn(4,l.children!==null?l.children:[],l.key,a),a.lanes=f,a.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},a}function b2(l,a,f,g,v){this.tag=a,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=an,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Of(0),this.expirationTimes=Of(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Of(0),this.identifierPrefix=g,this.onRecoverableError=v,ae&&(this.mutableSourceEagerHydrationData=null)}function m0(l,a,f,g,v,P,I,$,Q){return l=new b2(l,a,f,$,Q),a===1?(a=1,P===!0&&(a|=8)):a=0,P=Xn(3,null,null,a),l.current=P,P.stateNode=l,P.memoizedState={element:g,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},Yf(P),l}function y0(l){if(!l)return wi;l=l._reactInternals;e:{if(J(l)!==l||l.tag!==1)throw Error(o(170));var a=l;do{switch(a.tag){case 3:a=a.stateNode.context;break e;case 1:if(xn(a.type)){a=a.stateNode.__reactInternalMemoizedMergedChildContext;break e}}a=a.return}while(a!==null);throw Error(o(171))}if(l.tag===1){var f=l.type;if(xn(f))return Dy(l,f,a)}return a}function v0(l){var a=l._reactInternals;if(a===void 0)throw typeof l.render=="function"?Error(o(188)):(l=Object.keys(l).join(","),Error(o(268,l)));return l=V(a),l===null?null:l.stateNode}function x0(l,a){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var f=l.retryLane;l.retryLane=f!==0&&f<a?f:a}}function Wu(l,a){x0(l,a),(l=l.alternate)&&x0(l,a)}function R2(l){return l=V(l),l===null?null:l.stateNode}function I2(){return null}return n.attemptContinuousHydration=function(l){if(l.tag===13){var a=br(l,134217728);if(a!==null){var f=en();Yn(a,l,134217728,f)}Wu(l,134217728)}},n.attemptDiscreteHydration=function(l){if(l.tag===13){var a=br(l,1);if(a!==null){var f=en();Yn(a,l,1,f)}Wu(l,1)}},n.attemptHydrationAtCurrentPriority=function(l){if(l.tag===13){var a=Ci(l),f=br(l,a);if(f!==null){var g=en();Yn(f,l,a,g)}Wu(l,a)}},n.attemptSynchronousHydration=function(l){switch(l.tag){case 3:var a=l.stateNode;if(a.current.memoizedState.isDehydrated){var f=ul(a.pendingLanes);f!==0&&(jf(a,f|1),kn(a,Nt()),!(Fe&6)&&(po(),Tr()))}break;case 13:l0(function(){var g=br(l,1);if(g!==null){var v=en();Yn(g,l,1,v)}}),Wu(l,1)}},n.batchedUpdates=function(l,a){var f=Fe;Fe|=1;try{return l(a)}finally{Fe=f,Fe===0&&(po(),su&&Tr())}},n.createComponentSelector=function(l){return{$$typeof:Ru,value:l}},n.createContainer=function(l,a,f,g,v,P,I){return m0(l,a,!1,null,f,g,v,P,I)},n.createHasPseudoClassSelector=function(l){return{$$typeof:Iu,value:l}},n.createHydrationContainer=function(l,a,f,g,v,P,I,$,Q){return l=m0(f,g,!0,l,v,P,I,$,Q),l.context=y0(null),f=l.current,g=en(),v=Ci(f),P=Yr(g,v),P.callback=a??null,ki(f,P,v),l.current.lanes=v,cl(l,v,g),kn(l,g),l},n.createPortal=function(l,a,f){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:h,key:g==null?null:""+g,children:l,containerInfo:a,implementation:f}},n.createRoleSelector=function(l){return{$$typeof:_u,value:l}},n.createTestNameSelector=function(l){return{$$typeof:Au,value:l}},n.createTextSelector=function(l){return{$$typeof:Ou,value:l}},n.deferredUpdates=function(l){var a=We,f=wt.transition;try{return wt.transition=null,We=16,l()}finally{We=a,wt.transition=f}},n.discreteUpdates=function(l,a,f,g,v){var P=We,I=wt.transition;try{return wt.transition=null,We=1,l(a,f,g,v)}finally{We=P,wt.transition=I,Fe===0&&po()}},n.findAllNodes=Ch,n.findBoundingRects=function(l,a){if(!lr)throw Error(o(363));a=Ch(l,a),l=[];for(var f=0;f<a.length;f++)l.push(B(a[f]));for(a=l.length-1;0<a;a--){f=l[a];for(var g=f.x,v=g+f.width,P=f.y,I=P+f.height,$=a-1;0<=$;$--)if(a!==$){var Q=l[$],ie=Q.x,xe=ie+Q.width,Ae=Q.y,ce=Ae+Q.height;if(g>=ie&&P>=Ae&&v<=xe&&I<=ce){l.splice(a,1);break}else if(g!==ie||f.width!==Q.width||ce<P||Ae>I){if(!(P!==Ae||f.height!==Q.height||xe<g||ie>v)){ie>g&&(Q.width+=ie-g,Q.x=g),xe<v&&(Q.width=v-ie),l.splice(a,1);break}}else{Ae>P&&(Q.height+=Ae-P,Q.y=P),ce<I&&(Q.height=I-Ae),l.splice(a,1);break}}}return l},n.findHostInstance=v0,n.findHostInstanceWithNoPortals=function(l){return l=H(l),l=l!==null?Y(l):null,l===null?null:l.stateNode},n.findHostInstanceWithWarning=function(l){return v0(l)},n.flushControlled=function(l){var a=Fe;Fe|=1;var f=wt.transition,g=We;try{wt.transition=null,We=1,l()}finally{We=g,wt.transition=f,Fe=a,Fe===0&&(po(),Tr())}},n.flushPassiveEffects=xs,n.flushSync=l0,n.focusWithin=function(l,a){if(!lr)throw Error(o(363));for(l=kh(l),a=i0(l,a),a=Array.from(a),l=0;l<a.length;){var f=a[l++];if(!oe(f)){if(f.tag===5&&N(f.stateNode))return!0;for(f=f.child;f!==null;)a.push(f),f=f.sibling}}return!1},n.getCurrentUpdatePriority=function(){return We},n.getFindAllNodesFailureDescription=function(l,a){if(!lr)throw Error(o(363));var f=0,g=[];l=[kh(l),0];for(var v=0;v<l.length;){var P=l[v++],I=l[v++],$=a[I];if((P.tag!==5||!oe(P))&&(Ph(P,$)&&(g.push(Eh($)),I++,I>f&&(f=I)),I<a.length))for(P=P.child;P!==null;)l.push(P,I),P=P.sibling}if(f<a.length){for(l=[];f<a.length;f++)l.push(Eh(a[f]));return`findAllNodes was able to match part of the selector:
  `+(g.join(" > ")+`

No matching component was found for:
  `)+l.join(" > ")}return null},n.getPublicRootInstance=function(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return se(l.child.stateNode);default:return l.child.stateNode}},n.injectIntoDevTools=function(l){if(l={bundleType:l.bundleType,version:l.version,rendererPackageName:l.rendererPackageName,rendererConfig:l.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:u.ReactCurrentDispatcher,findHostInstanceByFiber:R2,findFiberByHostInstance:l.findFiberByHostInstance||I2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")l=!1;else{var a=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(a.isDisabled||!a.supportsFiber)l=!0;else{try{iu=a.inject(l),Cr=a}catch{}l=!!a.checkDCE}}return l},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(l,a,f,g){if(!lr)throw Error(o(363));l=Ch(l,a);var v=X(l,f,g).disconnect;return{disconnect:function(){v()}}},n.registerMutableSourceForHydration=function(l,a){var f=a._getVersion;f=f(a._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[a,f]:l.mutableSourceEagerHydrationData.push(a,f)},n.runWithPriority=function(l,a){var f=We;try{return We=l,a()}finally{We=f}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(l,a,f,g){var v=a.current,P=en(),I=Ci(v);return f=y0(f),a.context===null?a.context=f:a.pendingContext=f,a=Yr(P,I),a.payload={element:l},g=g===void 0?null:g,g!==null&&(a.callback=g),l=ki(v,a,I),l!==null&&(Yn(l,v,I,P),hu(l,v,I)),I},n};aE.exports=KO;var GO=aE.exports;const ZO=Jo(GO);var JO=Object.defineProperty,ej=(e,t,n)=>t in e?JO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,cc=(e,t,n)=>(ej(e,typeof t!="symbol"?t+"":t,n),n);function _s(e){return e.endsWith("info.json")?e:e.endsWith("/")?`${e}info.json`:`${e}/info.json`}var tj="http://library.stanford.edu/iiif/image-api/compliance.html#level0",uE="http://library.stanford.edu/iiif/image-api/compliance.html#level1",cE="http://library.stanford.edu/iiif/image-api/compliance.html#level2",nj="http://library.stanford.edu/iiif/image-api/conformance.html#level0",dE="http://library.stanford.edu/iiif/image-api/conformance.html#level1",fE="http://library.stanford.edu/iiif/image-api/conformance.html#level2",rj="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",hE="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",pE="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",ij="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",gE="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",mE="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",sj="http://iiif.io/api/image/1/level0.json",oj="http://iiif.io/api/image/1/profiles/level0.json",yE="http://iiif.io/api/image/1/level1.json",vE="http://iiif.io/api/image/1/profiles/level1.json",xE="http://iiif.io/api/image/1/level2.json",wE="http://iiif.io/api/image/1/profiles/level2.json",lj="http://iiif.io/api/image/2/level0.json",aj="http://iiif.io/api/image/2/profiles/level0.json",SE="http://iiif.io/api/image/2/level1.json",kE="http://iiif.io/api/image/2/profiles/level1.json",PE="http://iiif.io/api/image/2/level2.json",EE="http://iiif.io/api/image/2/profiles/level2.json",uj="level0",CE="level1",TE="level2",cj="http://iiif.io/api/image/2/level0",bE="http://iiif.io/api/image/2/level1",RE="http://iiif.io/api/image/2/level2",dj="https://iiif.io/api/image/1.1/compliance/#level0",IE="https://iiif.io/api/image/1.1/compliance/#level1",_E="https://iiif.io/api/image/1.1/compliance/#level2",AE=[RE,cE,fE,pE,mE,xE,wE,PE,EE,TE,_E],OE=[...AE,bE,uE,dE,hE,gE,yE,vE,SE,kE,CE,IE],fj=[cj,bE,RE,tj,uE,cE,nj,dE,fE,rj,hE,pE,ij,gE,mE,sj,oj,yE,vE,xE,wE,lj,aj,SE,kE,PE,EE,uj,CE,TE,dj,IE,_E],hj={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},pj={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},gj={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]};function mj(e){return AE.indexOf(e)!==-1?gj:OE.indexOf(e)!==-1?pj:hj}function yj(e){let t=e?Array.isArray(e.profile)?e.profile:[e.profile]:[],n={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let r of t)if(typeof r=="string"&&(r=mj(r)),!!r){if(r.formats)for(let i of r.formats)n.extraFormats.indexOf(i)===-1&&n.extraFormats.push(i);if(r.qualities)for(let i of r.qualities)n.extraQualities.indexOf(i)===-1&&n.extraQualities.push(i);if(r.supports)for(let i of r.supports)n.extraFeatures.indexOf(i)===-1&&n.extraFeatures.push(i);if(r.maxHeight&&(n.maxHeight=r.maxHeight),r.maxWidth&&(n.maxWidth=r.maxWidth),r.maxArea&&(n.maxArea=r.maxArea),r.extraFormats)for(let i of r.extraFormats)n.extraFormats.indexOf(i)===-1&&n.extraFormats.push(i);if(r.extraQualities)for(let i of r.extraQualities)n.extraQualities.indexOf(i)===-1&&n.extraQualities.push(i);if(r.extraFeatures)for(let i of r.extraFeatures)n.extraFeatures.indexOf(i)===-1&&n.extraFeatures.push(i);r.maxHeight&&(n.maxHeight=r.maxHeight),r.maxWidth&&(n.maxWidth=r.maxWidth),r.maxArea&&(n.maxArea=r.maxArea)}if(e.extraFormats)for(let r of e.extraFormats)n.extraFormats.indexOf(r)===-1&&n.extraFormats.push(r);if(e.extraFeatures)for(let r of e.extraFeatures)n.extraFeatures.indexOf(r)===-1&&n.extraFeatures.push(r);if(e.extraQualities)for(let r of e.extraQualities)n.extraQualities.indexOf(r)===-1&&n.extraQualities.push(r);return n}function vj(e){try{if(e==="full")return{full:!0};if(e==="square")return{square:!0};let t=e.startsWith("pct:"),n=e.substr(t?4:0).split(",").map(r=>parseFloat(r));return{x:n[0],y:n[1],w:n[2],h:n[3],percent:t}}catch{throw new Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+e)}}function xj(e){let t={upscaled:!1,max:!1,confined:!1};if(e[0]==="^"&&(t.upscaled=!0,e=e.slice(1)),e==="max"||e==="full")return t.max=!0,t.serialiseAsFull=e==="full",t;if(e[0]==="!"&&(t.confined=!0,e=e.slice(1)),e[0]==="p")return t.percentScale=parseFloat(e.slice(4)),t;let n=e.split(",").map(r=>r.trim());return n.length&&typeof n[0]<"u"&&(n[0]!==""&&(t.width=parseInt(n[0],10)),typeof n[1]<"u"&&n[1]!==""?(t.height=parseInt(n[1],10),t.version=2):t.version=3),t}function wj(e){let t={angle:0};if(e[0]==="!"&&(t.mirror=!0,e=e.substr(1)),t.angle=parseFloat(e)%360,Number.isNaN(t.angle))throw new Error(`Invalid rotation ${e}`);return t}function Sj(e,t=""){let n=e.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!n)throw new Error(`Invalid or unknown input ${e}`);let r=n[2],i=n[3],s=n[4];if(s[0]==="/"&&(s=s.substring(1)),t.length>0){if(t[0]==="/"&&(t=t.substring(1)),t!==s.substring(0,t.length))throw new Error(`Path does not start with prefix (path: ${s}, prefix: ${t})`);s=s.substring(t.length)}return{scheme:r,server:i,path:s,prefix:t}}function kj(e,t=""){let{path:n,scheme:r,server:i,prefix:s}=Sj(e,t),o=(n||"").split("/").reverse(),[u,d,h,c,...p]=o,m=p.reverse().filter(Boolean).join("/");if(o.length===1||u==="")return{type:"base",scheme:r,server:i,prefix:s,identifier:m};if(u==="info.json"){let[,...y]=o;return{type:"info",scheme:r,server:i,prefix:s,identifier:y.reverse().filter(Boolean).join("/")}}let w=(u||"").split(".");if(typeof w[1]>"u"||typeof w[0]>"u"||typeof c>"u"||typeof h>"u"||typeof d>"u")throw new Error("Invalid image request");return{type:"image",scheme:r,server:i,prefix:s,identifier:m,originalPath:n,region:vj(c),size:xj(h),rotation:wj(d),quality:w[0],format:w[1]}}function Pj(e){let t=kj(_s(e.id));if(t.type!=="info")throw new Error("Invalid service URL");let n=yj(e);return{identifier:t.identifier,originalPath:"",server:t.server,prefix:t.prefix,scheme:t.scheme,type:"image",quality:n.extraQualities.indexOf("default")===-1?n.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function Ej(e,t,n){let r=n.length,i=[];for(let s=0;s<r;s++){let o=n[s];if(o){let u=o.width;i.push(e/u)}}return i}function Cj(e,t,n){let r=n.length,i=[];for(let s=0;s<r;s++){let o=n[s];o&&i.push({width:Math.floor(e/o),height:Math.floor(t/o)})}return i}function yt(e){if(e["@id"])return e["@id"];if(e.id)return e.id}function of(e){if(!e||!e.profile||!yt(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let n of t)if(typeof n=="string"&&fj.indexOf(n)!==-1)return!0;return!1}function Tj(e){if(!of(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let n of t)if(typeof n=="string"){if(OE.indexOf(n)!==-1)return!0}else{let r=[...n.supports||[],...n.extraFeatures||[]];if(r.indexOf("regionByPx")!==-1&&(r.indexOf("sizeByW")!==-1||r.indexOf("sizeByWh")!==-1))return!0}return!1}function Bc(e,t){if(t&&t.profile){let n=t.profile;if(n){let r=Array.isArray(n)?n:[n];return r.includes(`level${e}`)||r.includes(`http://iiif.io/api/image/2/level${e}.json`)||r.includes(`http://iiif.io/api/image/1/level${e}.json`)||r.includes(`http://iiif.io/api/image/1/profiles/level${e}.json`)}}return!1}function Gg(e){return of(e)?Bc(0,e)?0:Bc(1,e)?1:Bc(2,e)?2:null:null}function jE(e){return(e["@context"]?Array.isArray(e["@context"])?e["@context"]:[e["@context"]]:[]).indexOf("http://iiif.io/api/image/3/context.json")!==-1}function bj(e){if(!Tj(e))return[];let t=[],n=Array.isArray(e.profile)?e.profile:[e.profile],r=n.length;for(let i=0;i<r;i++){let s=n[i];if(s&&typeof s!="string"&&(s.maxHeight||s.maxWidth))return[{id:yt(e),type:"variable",minWidth:0,minHeight:0,maxHeight:s.maxHeight||s.maxWidth,maxWidth:s.maxWidth||s.maxHeight,level:Gg(e),version:e["@context"]==="http://iiif.io/api/image/3/context.json"?3:2}]}if(e.tiles){let i=e.tiles.length;for(let s=0;s<i;s++){let o=e.tiles[s];o&&(o.height||o.width)&&t.push({id:yt(e),type:"variable",minHeight:0,minWidth:0,maxHeight:o.height||o.width,maxWidth:o.width,level:Gg(e),version:jE(e)?3:2})}}return t}function ow(e){let t=/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/,n=e.match(t);if(n&&n[4]&&n[5]){let r=n[1],i=parseInt(n[4],10),s=parseInt(n[5],10),o=n[7];if((r==="max"||r==="full")&&i&&s&&o)return{type:"fixed",id:e,height:s,width:i}}return{type:"unknown",id:e}}function Rj(e){if(e["@type"])return e["@type"];if(e.type)return e.type}function Ij(e){if(typeof e=="string")return ow(e);let t=Rj(e);if(t!=="Image"&&t!=="sc:Image")return null;let n=e,r=yt(n);return r?r&&n.width&&n.height?{id:r,type:"fixed",width:n.width,height:n.height,unsafe:!0}:ow(r):null}function _j(e){return of(e)?(e&&e.sizes?e.sizes:[]).map(t=>({id:yt(e),type:"fixed-service",height:t.height,width:t.width,level:Gg(e),version:jE(e)?3:2})):[]}function lw(e){let t=[],n=e.length;for(let r=0;r<n;r++){let i=e[r];if(!i)continue;let s=_j(i);s.length&&t.push(...s);let o=bj(i);o.length&&t.push(...o)}return t}function ME(e){let t=e.service?Array.isArray(e.service)?e.service:[e.service]:[],n=t.length,r=[];for(let i=0;i<n;i++)of(t[i])&&r.push(t[i]);return r}function Aj(e,t=!0,n){let r=[],i=Ij(e);if(i===null)return r;let s=e;if(r.push(i),t&&s&&s.width&&s.height){let o=[],u=ME(s);for(let d of u){let h={id:yt(d),width:s.width,height:s.height};if(n.canLoadSync(h)){let c=n.loadServiceSync(h);c&&(c.height||(c.height=s.height),c.width||(c.width=s.width),o.push(...lw([c])))}}if(o.length)return r.push(...o),r}return s.service&&r.push(...lw(s.service)),r}function Oj({x:e=0,y:t=0,w:n,h:r,full:i,square:s,percent:o}){return"full"}function jj({max:e,percentScale:t,upscaled:n,confined:r,width:i,height:s,serialiseAsFull:o,version:u}){let d=[];return n&&d.push("^"),e?(d.push(o?"full":"max"),d.join("")):(r&&d.push("!"),t&&d.push(`pct:${t}`),i&&d.push(`${i}`),d.push(","),s&&u===3&&d.push(`${s}`),d.join(""))}function Mj(e){return`${e.mirror?"!":""}${(e.angle||0)%360}`}function Lj(e,t){let n=e.prefix.startsWith("/")?e.prefix.substr(1):e.prefix,r=`${e.scheme}://${e.server}/${n?`${n}/`:""}${e.identifier}`,{size:i}=e,{region:s,rotation:o,format:u,quality:d}=e;return[r,Oj(s),jj(i),Mj(o),`${d}.${u}`].filter(Boolean).join("/")}function Ep(e,t,n){let r=Pj({"@context":e.version===3?"http://iiif.io/api/image/3/context.json":"http://iiif.io/api/image/2/context.json",id:_s(yt(e)),profile:e.level===null||typeof e.level>"u"?"level0":`level${e.level}`,type:e.version===3?"ImageService3":"ImageService2"});return r.size.max=!1,r.size.width=t,r.size.height=n,{id:Lj(r),type:"fixed",width:t,height:n||e.height/(e.width||1)*t,unsafe:e.width>t}}function yo(e){let t=e.replace(/(https?:\/\/)?(www.)?/i,"");return t.indexOf("/")!==-1?t.split("/")[0]:t}function Nj(e,t,n){let r=e.width?e.width:e.maxWidth;return n.height<=e.maxHeight&&n.width<=e.maxWidth&&n.height>=e.minHeight&&n.width>=e.minWidth&&(!t||Math.abs(n.width-r)<Math.abs(t.width-r))}function Fj(e,t){let n=[],r=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},e),i=(c,p=0)=>r.explain?n.push(new Array(p).fill(0).map(m=>"    ").join("")+c().trim()):void 0,s=[],o=[],u=null;i(()=>`Using configuration: ${JSON.stringify(r,null,2)}`);let d=(c,p)=>{if(i(()=>"Swapping choice",3),Nj(r,p,c)){if(r.preferFixedSize&&c.unsafe){i(()=>`We found an image that was marked as unsafe, but it was the best size. (${c.id})`,4),o.push(c);return}r.returnAllOptions&&p&&o.push(p),i(()=>`We found a new image that was the best size. (${c.id})`,4),u=c}else r.returnAllOptions&&o.push(c)};i(()=>`The input shows we have ${t.length} list(s) of candidates to choose from.`);let h=t.length;for(let c=0;c<h;c++){let p=t[c]();i(()=>`Candidate group ${c}: ${JSON.stringify(p,null,2)}`,1);let m=p.length;i(()=>`Checking candidate list number ${c} and found ${m} potential ways of creating image(s)`,1);for(let w=0;w<m;w++){let y=p[w];if(i(()=>`-> Checking candidate ${w}`,1),y.type==="unknown"&&r.atAnyCost&&(i(()=>`We've found an unknown image type, adding this to the "last resort" list`,2),s.push(y)),y.type==="fixed"&&(y.unsafe?(i(()=>`We've found an unsafe fixed image type, adding this to the "last resort" list`,2),s.push(y)):(i(()=>"We've found a fixed size image, checking if it matches the request",2),d(y,u))),y.type==="fixed-service")if(r.unsafeImageService){i(()=>"Checking for an image from the tile source, without calculating the right height and width (unsafeImageService)",2);let S=Ep(y,r.width,r.height);d(S,u)}else{i(()=>"Checking for an image from the tile source 3",2);let S=Ep(y,y.width,y.height);d(S,u)}if(y.type==="variable"&&y.maxWidth){let S=Ep({id:y.id,width:y.maxWidth,height:y.maxWidth,level:y.level,version:y.version},y.maxWidth);d(S,u)}}if(u&&!r.returnAllOptions){if(u.unsafe||r.allowUnsafe)continue;i(()=>`We found a match in choice list number ${c}, no searching any more`);break}}return r.atAnyCost&&o.length===0?(i(()=>u?`We found an image! ${u.id} of type ${u.type}`:'We found no images, but "atAnyCost" is set, so returning that'),{best:u||s[0]||null,fallback:s.slice(1),log:n}):r.returnAllOptions?(i(()=>"Returning all options that we have found"),{best:(r.atAnyCost?u||o[0]||s[0]:u||o[0])||null,fallback:[...o,...s],log:n}):(i(()=>"Returning the best image that we found, and a fallback"),{best:u||o[0]||null,fallback:u?o:o.slice(1),log:n})}function zj(e,t,n){let r=e>t?e:t,i=n.length,s=[];for(let o=0;o<i;o++){let u=n[o];if(!u||u.scaleFactors.length===0)continue;let d=u.scaleFactors[0];if(!d)continue;let h=r/d,c=[d];for(;h>=u.width;)d=d*2,c.push(d),h=h/2;s.push({...u,scaleFactors:c})}return s}function $j(e,t){if(e.length!==t.length)return!1;if(e.length===0&&t.length===0)return!0;let n=e.length,r=!0;for(let s=0;s<n;s++){let o=e[s],u=t[s];if(o.width!==u.width||o.height!==u.height){r=!1;break}}if(r)return!0;let i=0;for(let s=0;s<n;s++)for(let o=0;o<n;o++)if(e[s].width===t[o].width&&e[s].height===t[o].height){i++;break}return i===n}function aw(e){return Bc(0,e)}var Dj=class{constructor(e={}){cc(this,"config",{verificationsRequired:1,approximateServices:!1,enableFetching:!0,disableThrottling:!1}),cc(this,"fetchingCount",0),cc(this,"imageServices",{}),cc(this,"knownImageServers",{}),this.config=Object.assign(this.config,e)}setConfig(e){Object.assign(this.config,e)}sample(e,t,n=!0){let r=yo(yt(e)),i=_s(yt(e)),s=this.knownImageServers[r];return this.imageServices[i]=Object.assign(e,{real:!0}),!s&&e.tiles&&!aw(e)?(this.knownImageServers[r]={verifications:0,malformed:!1,root:r,preLoaded:n,sampledId:yt(e),verified:!1,server:null,result:{context:e["@context"]||[],sampledProfile:e.profile,resourceServiceRatio:t&&e.height?t.height/e.height:1,sampledSizes:e.sizes||[],sizeRatios:Ej(e.width,e.height,e.sizes||[]),sampledTiles:e.tiles||[]}},!0):this.verify(e)}preLoad(e,t=!0){this.knownImageServers[e.root]=e,t&&(this.knownImageServers[e.root].malformed=!1,this.knownImageServers[e.root].verifications=this.config.verificationsRequired)}predict(e,t=!1,n=!1){let r=e==null?void 0:e.source,i=yo(yt(e)),s=this.knownImageServers[i],o=_s(yt(e));return this.imageServices[o]?this.imageServices[o]||null:!this.config.approximateServices||!s||!s.result||!(r!=null&&r.height||e.height)||!(r!=null&&r.width||e.width)||!n&&(s.malformed||s.verifications<this.config.verificationsRequired)||aw(e.source)?null:(this.imageServices[o]||(this.imageServices[o]={"@context":s.result.context,"@id":yt(e),id:yt(e),protocol:"http://iiif.io/api/image",tiles:(r==null?void 0:r.tiles)||zj(e.width,e.height,s.result.sampledTiles),sizes:(r==null?void 0:r.sizes)||Cj(Math.round(e.width/s.result.resourceServiceRatio),Math.round(e.height/s.result.resourceServiceRatio),s.result.sizeRatios),profile:(r==null?void 0:r.profile)||s.result.sampledProfile,height:(r==null?void 0:r.height)||e.height,width:(r==null?void 0:r.width)||e.width,real:!1}),this.imageServices[o]||null)}async getThumbnailFromResource(e,t,n=!0,r=[]){let i=e?await this.getImageCandidates(e,n):[];return Fj(t,[()=>r,()=>i])}async getImageCandidates(e,t=!0){let n=e;if(t&&n&&n.height&&n.width){let r=ME(n);for(let i of r){let s={id:yt(i),width:i.width?i.width:n.width,height:i.height?i.height:n.height,source:i};await this.loadService(s)}}return Aj(e,t,this)}async verify(e){let t=this.predict(e,!1,!0),n=await this.fetchService(yt(e));if(!t)return!1;let r=t.height===n.height&&t.width===n.width&&t["@context"]===n["@context"]&&$j(t.sizes||[],n.sizes||[]);if(r){let i=yo(yt(e)),s=this.knownImageServers[i];s&&(s.verifications+=1,s.verifications>=this.config.verificationsRequired&&(s.verified=!0))}return r}canLoadSync(e){let t=typeof e=="string"?e:yt(e),n=_s(t);if(this.imageServices[n])return!0;let r=this.knownImageServers[yo(t)];return!!(r&&!r.malformed&&r.verifications>=this.config.verificationsRequired)}async markAsMalformed(e){return this.knownImageServers[yo(yt(e))].malformed=!0,this.loadService(e,!0)}async fetchService(e,t=!1){let n=_s(e),r=this.imageServices[n];if(r&&(!t||r.real))return r;if(!this.config.enableFetching)throw new Error("Fetching is not enabled");let i=await this.fetch(n).then(s=>s.json());return!i.id&&i["@id"]&&(i.id=i["@id"]),i.id!==e&&(i.id=e,i["@id"]&&(i["@id"]=e)),this.imageServices[n]=Object.assign(i,{real:!0}),this.imageServices[n]}async fetch(e,t){return fetch(e,t)}async loadService(e,t=!1){if(!this.config.disableThrottling){let i=!0;for(;i;)if(this.fetchingCount>=this.config.verificationsRequired)await new Promise(s=>setTimeout(s,500));else{i=!1;break}}let n=this.knownImageServers[yo(yt(e))];if(n&&!n.malformed&&!t){await n.result;let i=this.loadServiceSync(e);if(i)return i}this.fetchingCount++;let r=await this.fetchService(yt(e),t);return this.fetchingCount--,r.real&&this.sample(r,e),r}loadServiceSync(e){let t=_s(yt(e));return this.imageServices[t]?this.imageServices[t]:this.config.approximateServices?this.predict(e):null}};new Dj;const dc={},qa={get(e){return e},setMetaValue([e,t,n],r){let i=qa.getResourceMeta(e,t),s=i?i[n]:void 0,o=typeof r=="function"?r(s):r;dc[e]={...dc[e]||{},[t]:{...(dc[e]||{})[t]||{},[n]:o}}},getResourceMeta:(e,t)=>{let n=dc[e];if(n)return t?n[t]:n},async load(e){let t=typeof e=="string"?e:e.id;return fetch(t).then(n=>n.json())},requestStatus(e){}};function Bj(e){try{if(e==="full")return{full:!0};if(e==="square")return{square:!0};let t=e.startsWith("pct:"),n=e.substr(t?4:0).split(","),r=n.map(i=>parseFloat(i));return{x:r[0],y:r[1],w:r[2],h:r[3],percent:t}}catch{throw Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+e)}}function Uj(e){let t={upscaled:!1,max:!1,confined:!1};if(e[0]==="^"&&(t.upscaled=!0,e=e.slice(1)),e==="max"||e==="full")return t.max=!0,t.serialiseAsFull=e==="full",t;if(e[0]==="!"&&(t.confined=!0,e=e.slice(1)),e[0]==="p")return t.percentScale=parseFloat(e.slice(4)),t;let n=e.split(",").map(r=>r.trim());return n.length&&(n[0]!==""&&(t.width=parseInt(n[0],10)),n[1]!==""&&(t.height=parseInt(n[1],10))),t}function Wj(e){let t={angle:0};if(e[0]==="!"&&(t.mirror=!0,e=e.substr(1)),t.angle=parseFloat(e)%360,Number.isNaN(t.angle))throw Error(`Invalid rotation ${e}`);return t}function Hj(e,t=""){let n=e.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!n)throw Error(`Invalid or unknown input ${e}`);let r=n[2],i=n[3],s=n[4];if(s[0]==="/"&&(s=s.substring(1)),t.length>0){if(t[0]==="/"&&(t=t.substring(1)),t!==s.substring(0,t.length))throw Error(`Path does not start with prefix (path: ${s}, prefix: ${t})`);s=s.substring(t.length)}return{scheme:r,server:i,path:s,prefix:t}}function Vj(e,t=""){let{path:n,scheme:r,server:i,prefix:s}=Hj(e,t),o=n.split("/").reverse(),[u,d,h,c,...p]=o,m=p.reverse().filter(Boolean).join("/");if(o.length===1||u==="")return{type:"base",scheme:r,server:i,prefix:s,identifier:m};if(u==="info.json"){let[,...S]=o;return{type:"info",scheme:r,server:i,prefix:s,identifier:S.reverse().filter(Boolean).join("/")}}if(r===void 0||i===void 0||n===void 0||c===void 0||h===void 0||d===void 0||u===void 0)throw Error("Invalid image service URL");let[w="",y=""]=u.split(".");return{type:"image",scheme:r,server:i,prefix:s,identifier:m,originalPath:n,region:Bj(c),size:Uj(h),rotation:Wj(d),quality:w,format:y}}function qj(e){return Kd.indexOf(e)!==-1?TI:uy.indexOf(e)!==-1?CI:EI}function Qj(e){let t=e?Array.isArray(e.profile)?e.profile:[e.profile]:[],n={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let r of t)if(typeof r=="string"&&(r=qj(r)),!!r){if(r.formats)for(let i of r.formats)n.extraFormats.indexOf(i)===-1&&n.extraFormats.push(i);if(r.qualities)for(let i of r.qualities)n.extraQualities.indexOf(i)===-1&&n.extraQualities.push(i);if(r.supports)for(let i of r.supports)n.extraFeatures.indexOf(i)===-1&&n.extraFeatures.push(i);if(r.maxHeight&&(n.maxHeight=r.maxHeight),r.maxWidth&&(n.maxWidth=r.maxWidth),r.maxArea&&(n.maxArea=r.maxArea),r.extraFormats)for(let i of r.extraFormats)n.extraFormats.indexOf(i)===-1&&n.extraFormats.push(i);if(r.extraQualities)for(let i of r.extraQualities)n.extraQualities.indexOf(i)===-1&&n.extraQualities.push(i);if(r.extraFeatures)for(let i of r.extraFeatures)n.extraFeatures.indexOf(i)===-1&&n.extraFeatures.push(i);r.maxHeight&&(n.maxHeight=r.maxHeight),r.maxWidth&&(n.maxWidth=r.maxWidth),r.maxArea&&(n.maxArea=r.maxArea)}if(e.extraFormats)for(let r of e.extraFormats)n.extraFormats.indexOf(r)===-1&&n.extraFormats.push(r);if(e.extraFeatures)for(let r of e.extraFeatures)n.extraFeatures.indexOf(r)===-1&&n.extraFeatures.push(r);if(e.extraQualities)for(let r of e.extraQualities)n.extraQualities.indexOf(r)===-1&&n.extraQualities.push(r);return n}function uw(e){let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let n of t)if(typeof n=="string"&&rP.indexOf(n)!==-1)return!0;return!1}function rt(e){if(e["@id"])return e["@id"];if(e.id)return e.id}function lf(e){if(!e||!e.profile||!rt(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let n of t)if(typeof n=="string"&&nP.indexOf(n)!==-1)return!0;return!1}function Yj(e){if(!lf(e))return!1;let t=Array.isArray(e.profile)?e.profile:[e.profile];for(let n of t)if(typeof n=="string"){if(uy.indexOf(n)!==-1)return!0}else{let r=[...n.supports||[],...n.extraFeatures||[]];if(r.indexOf("regionByPx")!==-1&&(r.indexOf("sizeByW")!==-1||r.indexOf("sizeByWh")!==-1))return!0}return!1}function Xj({x:e=0,y:t=0,w:n,h:r,full:i,square:s,percent:o}){return"full"}function Kj({max:e,percentScale:t,upscaled:n,confined:r,width:i,height:s,serialiseAsFull:o,version:u}){let d=[];return n&&d.push("^"),e?(d.push(o?"full":"max"),d.join("")):(r&&d.push("!"),t&&d.push(`pct:${t}`),i&&d.push(`${i}`),d.push(","),s&&u===3&&d.push(`${s}`),d.join(""))}function Gj(e){return`${e.mirror?"!":""}${(e.angle||0)%360}`}function Zj(e,t){let n=e.prefix.startsWith("/")?e.prefix.substring(1):e.prefix,r=`${e.scheme}://${e.server}/${n?`${n}/`:""}${e.identifier}`,{size:i}=e,{region:s,rotation:o,format:u,quality:d}=e;return[r,Xj(s),Kj(i),Gj(o),`${d}.${u}`].filter(Boolean).join("/")}function As(e){return e.endsWith("info.json")?e:e.endsWith("/")?`${e}info.json`:`${e}/info.json`}function Jj(e){let t=Vj(As(e.id));if(t.type!=="info")throw Error("Invalid service URL");let n=Qj(e);return{identifier:t.identifier,originalPath:"",server:t.server,prefix:t.prefix,scheme:t.scheme,type:"image",quality:n.extraQualities.indexOf("default")===-1?n.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function eM(e,t,n){let r=n.length,i=[];for(let s=0;s<r;s++){let o=n[s];if(!o)continue;let u=o.width;i.push(e/u)}return i}function tM(e,t,n){let r=n.length,i=[];for(let s=0;s<r;s++){let o=n[s];o&&i.push({width:Math.floor(e/o),height:Math.floor(t/o)})}return i}function la(e,t){if(t&&t.profile){let n=t.profile;if(n){let r=Array.isArray(n)?n:[n];if(r.includes(`level${e}`)||r.includes(`http://iiif.io/api/image/2/level${e}.json`)||r.includes(`http://iiif.io/api/image/1/level${e}.json`)||r.includes(`http://iiif.io/api/image/1/profiles/level${e}.json`))return!0;if(e===2){for(let i of r)if(Kd.includes(i))return!0}if(e===1){for(let i of r)if(uy.includes(i))return!0}if(e===0){for(let i of r)if(rP.includes(i))return!0}}}return!1}function Zg(e){return lf(e)?la(2,e)?2:la(1,e)?1:la(0,e)?0:null:null}function vy(e){let t=e.service?Array.isArray(e.service)?e.service:[e.service]:[],n=t.length,r=[];for(let i=0;i<n;i++)lf(t[i])&&r.push(t[i]);return r}function nM(e){if(e["@type"])return e["@type"];if(e.type)return e.type}function vo(e){let t=e.replace(/(https?:\/\/)?(www.)?/i,"");return t.indexOf("/")===-1?t:t.split("/")[0]}function rM(e,t,n){let r=e>t?e:t,i=n.length,s=[];for(let o=0;o<i;o++){let u=n[o];if(!u||u.scaleFactors.length===0)continue;let d=u.scaleFactors[0];if(!d)continue;let h=r/d,c=[d];for(;h>=u.width;)d*=2,c.push(d),h/=2;s.push({...u,scaleFactors:c})}return s}function Cp(e,t,n){let r=Jj({"@context":e.version===3?"http://iiif.io/api/image/3/context.json":"http://iiif.io/api/image/2/context.json",id:As(rt(e)),profile:e.level===null||e.level===void 0?"level0":`level${e.level}`,type:e.version===3?"ImageService3":"ImageService2"});return r.size.max=!1,r.size.width=t,r.size.height=n,{id:Zj(r),type:"fixed",width:t,height:n||e.height/(e.width||1)*t,unsafe:e.width>t}}function iM(e,t,n){let r=e.width?e.width:e.maxWidth;return n.height<=e.maxHeight&&n.width<=e.maxWidth&&n.height>=e.minHeight&&n.width>=e.minWidth&&(!t||Math.abs(n.width-r)<Math.abs(t.width-r))}function sM(e,t){let n=[],r=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},e),i=(c,p=0)=>r.explain?n.push(Array(p).fill(0).map(m=>"    ").join("")+c().trim()):void 0,s=[],o=[],u=null;i(()=>`Using configuration: ${JSON.stringify(r,null,2)}`);let d=(c,p)=>{if(i(()=>"Swapping choice",3),iM(r,p,c)){if(r.preferFixedSize&&c.unsafe){i(()=>`We found an image that was marked as unsafe, but it was the best size. (${c.id})`,4),o.push(c);return}r.returnAllOptions&&p&&o.push(p),i(()=>`We found a new image that was the best size. (${c.id})`,4),u=c}else r.returnAllOptions&&o.push(c)};i(()=>`The input shows we have ${t.length} list(s) of candidates to choose from.`);let h=t.length;for(let c=0;c<h;c++){let p=t[c]();i(()=>`Candidate group ${c}: ${JSON.stringify(p,null,2)}`,1);let m=p.length;i(()=>`Checking candidate list number ${c} and found ${m} potential ways of creating image(s)`,1);for(let w=0;w<m;w++){let y=p[w];if(i(()=>`-> Checking candidate ${w}`,1),y.type==="unknown"&&r.atAnyCost&&(i(()=>`We've found an unknown image type, adding this to the "last resort" list`,2),s.push(y)),y.type==="fixed"&&(y.unsafe?(i(()=>`We've found an unsafe fixed image type, adding this to the "last resort" list`,2),s.push(y)):(i(()=>"We've found a fixed size image, checking if it matches the request",2),d(y,u))),y.type==="fixed-service")if(r.unsafeImageService){i(()=>"Checking for an image from the tile source, without calculating the right height and width (unsafeImageService)",2);let S=Cp(y,r.width,r.height);d(S,u)}else{i(()=>"Checking for an image from the tile source 3",2);let S=Cp(y,y.width,y.height);d(S,u)}if(y.type==="variable"&&y.maxWidth){let S=Cp({id:y.id,type:"fixed-service",width:y.maxWidth,height:y.maxWidth,level:y.level,version:y.version},y.maxWidth);d(S,u)}}if(u&&!r.returnAllOptions){if(u.unsafe||r.allowUnsafe)continue;i(()=>`We found a match in choice list number ${c}, no searching any more`);break}}return r.atAnyCost&&o.length===0?(i(()=>u?`We found an image! ${u.id} of type ${u.type}`:'We found no images, but "atAnyCost" is set, so returning that'),{best:u||s[0]||null,fallback:s.slice(1),log:n}):r.returnAllOptions?(i(()=>"Returning all options that we have found"),{best:(r.atAnyCost?u||o[0]||s[0]:u||o[0])||null,fallback:[...o,...s],log:n}):(i(()=>"Returning the best image that we found, and a fallback"),{best:u||o[0]||null,fallback:u?o:o.slice(1),log:n})}function LE(e){return(e["@context"]?Array.isArray(e["@context"])?e["@context"]:[e["@context"]]:[]).indexOf("http://iiif.io/api/image/3/context.json")!==-1}function oM(e){return lf(e)?(e&&e.sizes?e.sizes:[]).map(t=>({id:rt(e),type:"fixed-service",height:t.height,width:t.width,level:Zg(e),version:LE(e)?3:2})):[]}function lM(e){if(!Yj(e))return[];let t=[],n=Array.isArray(e.profile)?e.profile:[e.profile],r=n.length;for(let i=0;i<r;i++){let s=n[i];if(s&&typeof s!="string"&&(s.maxHeight||s.maxWidth))return[{id:rt(e),type:"variable",minWidth:0,minHeight:0,maxHeight:s.maxHeight||s.maxWidth,maxWidth:s.maxWidth||s.maxHeight,level:Zg(e),version:e["@context"]==="http://iiif.io/api/image/3/context.json"?3:2}]}if(e.tiles){let i=e.tiles.length;for(let s=0;s<i;s++){let o=e.tiles[s];o&&(o.height||o.width)&&t.push({id:rt(e),type:"variable",minHeight:0,minWidth:0,maxHeight:o.height||o.width,maxWidth:o.width,level:Zg(e),version:LE(e)?3:2})}}return t}function cw(e){let t=[],n=e.length;for(let r=0;r<n;r++){let i=e[r];if(!i)continue;let s=oM(i);s.length&&t.push(...s);let o=lM(i);o.length&&t.push(...o)}return t}function dw(e){let t=/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/,n=e.match(t);if(n&&n[4]&&n[5]){let r=n[1],i=parseInt(n[4],10),s=parseInt(n[5],10),o=n[7];if((r==="max"||r==="full")&&i&&s&&o)return{type:"fixed",id:e,height:s,width:i}}return{type:"unknown",id:e}}function Jg(e){if(typeof e=="string")return dw(e);let t=nM(e);if(t!=="Image"&&t!=="sc:Image")return null;let n=e,r=rt(n);return r?r&&n.width&&n.height?{id:r,type:"fixed",width:n.width,height:n.height,unsafe:!0}:dw(r):null}function aM(e,t=!0,n){let r=[],i=Jg(e);if(i===null)return r;let s=e;if(r.push(i),t&&s&&s.width&&s.height){let o=[],u=vy(s);for(let d of u){let h={id:rt(d),width:s.width,height:s.height};if(n.canLoadSync(h)){let c=n.loadServiceSync(h);c&&(c.height||(c.height=s.height),c.width||(c.width=s.width),o.push(...cw([c])))}}if(o.length)return r.push(...o),r}return s.service&&r.push(...cw(s.service)),r}function uM(e,t){if(e.length!==t.length)return!1;if(e.length===0&&t.length===0)return!0;let n=e.length,r=!0;for(let s=0;s<n;s++){let o=e[s],u=t[s];if(o.width!==u.width||o.height!==u.height){r=!1;break}}if(r)return!0;let i=0;for(let s=0;s<n;s++)for(let o=0;o<n;o++)if(e[s].width===t[o].width&&e[s].height===t[o].height){i++;break}return i===n}var xy=class{constructor(t={}){rn(this,"config",{verificationsRequired:1,approximateServices:!1,enableFetching:!0,disableThrottling:!1}),rn(this,"fetchingCount",0),rn(this,"imageServices",{}),rn(this,"knownImageServers",{}),this.config=Object.assign(this.config,t)}setConfig(t){Object.assign(this.config,t)}sample(t,n,r=!0){let i=vo(rt(t)),s=As(rt(t)),o=this.knownImageServers[i];return this.imageServices[s]=Object.assign(t,{real:!0}),!o&&t.tiles&&!uw(t)?(this.knownImageServers[i]={verifications:0,malformed:!1,root:i,preLoaded:r,sampledId:rt(t),verified:!1,server:null,result:{context:t["@context"]||[],sampledProfile:t.profile,resourceServiceRatio:n&&t.height?n.height/t.height:1,sampledSizes:t.sizes||[],sizeRatios:eM(t.width,t.height,t.sizes||[]),sampledTiles:t.tiles||[]}},!0):this.verify(t)}preLoad(t,n=!0){this.knownImageServers[t.root]=t,n&&(this.knownImageServers[t.root].malformed=!1,this.knownImageServers[t.root].verifications=this.config.verificationsRequired)}predict(t,n=!1,r=!1){let i=t==null?void 0:t.source,s=vo(rt(t)),o=this.knownImageServers[s],u=As(rt(t));return this.imageServices[u]?this.imageServices[u]||null:!this.config.approximateServices||!o||!o.result||!(i!=null&&i.height||t.height)||!(i!=null&&i.width||t.width)||!r&&(o.malformed||o.verifications<this.config.verificationsRequired)||t.source&&uw(t.source)?null:(this.imageServices[u]||(this.imageServices[u]={"@context":o.result.context,"@id":rt(t),id:rt(t),protocol:"http://iiif.io/api/image",tiles:(i==null?void 0:i.tiles)||rM(t.width,t.height,o.result.sampledTiles),sizes:(i==null?void 0:i.sizes)||tM(Math.round(t.width/o.result.resourceServiceRatio),Math.round(t.height/o.result.resourceServiceRatio),o.result.sizeRatios),profile:(i==null?void 0:i.profile)||o.result.sampledProfile,height:(i==null?void 0:i.height)||t.height,width:(i==null?void 0:i.width)||t.width,real:!1}),this.imageServices[u]||null)}async getThumbnailFromResource(t,n,r=!0,i=[]){let s=t?await this.getImageCandidates(t,r):[];return sM(n,[()=>i,()=>s])}async getImageCandidates(t,n=!0){let r=t;if(n&&r&&r.height&&r.width){let i=vy(r);for(let s of i){let o={id:rt(s),width:s.width?s.width:r.width,height:s.height?s.height:r.height,source:s};await this.loadService(o)}}return aM(t,n,this)}async verify(t){let n=this.predict(t,!1,!0),r=await this.fetchService(rt(t));if(!n)return!1;let i=n.height===r.height&&n.width===r.width&&n["@context"]===r["@context"]&&uM(n.sizes||[],r.sizes||[]);if(i){let s=vo(rt(t)),o=this.knownImageServers[s];o&&(o.verifications+=1,o.verifications>=this.config.verificationsRequired&&(o.verified=!0))}return i}canLoadSync(t){let n=typeof t=="string"?t:rt(t),r=As(n);if(this.imageServices[r])return!0;let i=this.knownImageServers[vo(n)];return!!(i&&!i.malformed&&i.verifications>=this.config.verificationsRequired)}async markAsMalformed(t){return this.knownImageServers[vo(rt(t))].malformed=!0,this.loadService(t,!0)}async fetchService(t,n=!1){let r=As(t),i=this.imageServices[r];if(i&&(!n||i.real))return i;if(!this.config.enableFetching)throw Error("Fetching is not enabled");let s=await this.fetch(r).then(o=>o.json());return!s.id&&s["@id"]&&(s.id=s["@id"]),s.id!==t&&(s.id=t,s["@id"]&&(s["@id"]=t)),this.imageServices[r]=Object.assign(s,{real:!0}),this.imageServices[r]}async fetch(t,n){return fetch(t,n)}async loadService(t,n=!1){if(!this.config.disableThrottling){let s=!0;for(;s;)if(this.fetchingCount>=this.config.verificationsRequired)await new Promise(o=>setTimeout(o,500));else{s=!1;break}}let r=this.knownImageServers[vo(rt(t))];if(r&&!r.malformed&&!n){await r.result;let s=this.loadServiceSync(t);if(s)return s}this.fetchingCount++;let i=await this.fetchService(rt(t),n);return this.fetchingCount--,i.real&&this.sample(i,t),i}loadServiceSync(t){let n=As(rt(t));return this.imageServices[n]?this.imageServices[n]:this.config.approximateServices?this.predict(t):null}};function cM(e={}){let t=e.events||Ek(),n=e.loader||new xy;return{store:Pk((i,s)=>({loaded:{},loadServiceSync:(o,u,d)=>{let h=o.id||o["@id"],c=s().loaded[h];if(c&&c.status==="done")return c.service;if(c&&c.status==="loading")return null;if(c&&c.status==="error")throw Error("Failed to load image service");let p={id:rt(o),width:o.width||(u==null?void 0:u.width)||0,height:o.height||(u==null?void 0:u.height)||0,source:o},m=n.loadServiceSync(p);return m?(i(w=>({loaded:{...w.loaded,[h]:{status:"done",service:m,real:!0}}})),t.emit("image-service.loaded",{id:h,service:m})):d&&s().loadService(o,u).then(()=>{}),m},loadService:async(o,u)=>{let d=o.id||o["@id"],h=s().loaded[d];if(h&&h.status==="done")return h.service;if(h&&h.status==="loading")return new Promise((c,p)=>{let m=w=>{w.id===d&&(t.off("image-service.loaded",m),c(w.service||o))};t.on("image-service.loaded",m)});if(h&&h.status==="error"&&!(u!=null&&u.force))throw Error("Failed to load image service");t.emit("image-service.loading",{id:d});try{let c={id:rt(o),width:o.width||0,height:o.height||0,source:o},p=await n.loadService(c,u==null?void 0:u.force);return i(m=>({loaded:{...m.loaded,[d]:{status:"done",service:p,real:p.real}}})),t.emit("image-service.loaded",{id:d,service:p}),p}catch(c){throw t.emit("image-service.error",{id:d,error:c}),c}}})),events:t}}const dM=cM(),fM=new xy;function hM(e=qa,t={}){let n=t.imageServiceLoader||fM;async function r(i,s,o=!1,u=[],d){let h=()=>n.getThumbnailFromResource(void 0,s,o,u);if(!i)return await n.getThumbnailFromResource(void 0,s,o,u);if(typeof i=="string"){let m=Jg(i);return m&&u.push(m),await n.getThumbnailFromResource(void 0,s,o,u)}let c=e.get(i,{skipSelfReturn:!1});if(typeof c=="string")return{best:Jg(c),fallback:[],log:[]};if(!c)return await h();switch(await(async m=>{if(m&&m.thumbnail&&m.thumbnail.length){let w=e.get(m.thumbnail[0]),y=await n.getImageCandidates(w,o);y&&y.length&&u.push(...y)}})(c),c.type){case"Annotation":{let m=Array.isArray(c.body)?c.body:[c.body],w=e.get(m[0]);return d&&!w.width&&(w.width=d.width,w.height=d.height),await n.getThumbnailFromResource(w,s,o,u)}case"Canvas":{let m=c;return r(m.items[0],s,o,u,{width:m.width,height:m.height})}case"AnnotationPage":return r(c.items[0],s,o,u,d);case"Choice":{let m=c;return!m.items||m.items[0]?await h():r(m.items[0],s,o,u,d)}case"Collection":{let m=c,w=m.items[0];return w?r(w,s,o,u,d):await h()}case"Manifest":{let m=c,w=m.items[0];return w?r(w,s,o,u,d):await h()}case"SpecificResource":case"Image":case"Dataset":case"Sound":case"Text":case"TextualBody":case"Video":return d&&!c.width&&(c.width=d.width,c.height=d.height),n.getThumbnailFromResource(c,s,o,u)}return await h()}return{getBestThumbnailAtSize:r}}var pM=Object.defineProperty,gM=(e,t,n)=>t in e?pM(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,A=(e,t,n)=>(gM(e,typeof t!="symbol"?t+"":t,n),n),af=["onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onScroll","onWheel","onClick","onDragStart","onDragEnd","onDragEnter","onDragExit","onDrag","onDragOver","onContextMenu"];function mM(){return af.reduce((e,t)=>(e[t]=[],e),{})}var Zo=af.reduce((e,t)=>(e[t.slice(2).toLowerCase()]=t,e[t]=t,e),{}),yM="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",uf=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e));for(;e--;)t+=yM[n[e]&63];return t},Ur=class{constructor(){A(this,"__id"),A(this,"__revision",0),A(this,"__host"),A(this,"__onCreate"),A(this,"__parent"),A(this,"__owner",{value:void 0}),A(this,"__state",{}),A(this,"eventHandlers"),A(this,"scale",1),A(this,"layers",[]),A(this,"time",[]),A(this,"_crop"),A(this,"cropData"),A(this,"id"),A(this,"addEventListener",(t,n,r)=>{let i=Zo[t];if(!this.eventHandlers[i])throw new Error(`Unknown event ${i}`);this.eventHandlers[i].indexOf(n)===-1&&this.eventHandlers[i].push(n)}),A(this,"removeEventListener",(t,n)=>{let r=Zo[t];if(!this.eventHandlers[r]){console.warn(`Unknown event ${r}`);return}this.eventHandlers[r].indexOf(n)!==-1&&(this.eventHandlers[r]=this.eventHandlers[r].filter(i=>i!==n))}),this.id=this.__id=uf(),this.eventHandlers=mM()}get crop(){return this._crop}set crop(t){this._crop=t}getObjectsAt(t){return[]}getAllPointsAt(t,n,r){return[]}getScheduledUpdates(t,n){return[]}dispatchEvent(t,n){let r=this.eventHandlers[t],i=r?r.length:0,s=!1;if(i)for(let o=0;o<i;o++)try{r[o](n),s=!0}catch(u){console.error(t,u)}return s}get x(){return this.points[1]}get y(){return this.points[2]}get width(){return this.points[3]-this.points[1]}get height(){return this.points[4]-this.points[2]}translate(t,n){zr(this.points,hn(t,n))}atScale(t){zr(this.points,Ma(t,this.x,this.y)),this.scale*=t}transform(t){zr(this.points,t)}applyProps(t){this.__revision++}appendChild(t){}removeChild(t){}insertBefore(t,n){}hideInstance(){}},rs=class em extends Ur{constructor(t){if(super(),A(this,"type","spacial-content"),A(this,"id"),A(this,"uri"),A(this,"display"),A(this,"points"),A(this,"priority"),A(this,"style",{opacity:1}),!t)this.id="",this.uri="",this.display={x:0,y:0,scale:1,width:0,height:0,points:Ee(5)},this.points=Ee(5);else{let n=t.scale||1;this.id=t.id||t.uri,this.uri=t.uri,this.points=Be.singleBox(t.width,t.height,t.x,t.y),this.display={x:0,y:0,scale:n,width:t.width/n,height:t.height/n,points:Be.singleBox(t.width/n,t.height/n),rotation:t==null?void 0:t.rotation}}}applyProps(t){let n=t.display?t.display.width:t.target.width,r=t.target.width/n;if(this.id=t.id||t.uri,this.uri=t.uri,this.points.set(Be.singleBox(t.target.width,t.target.height,t.target.x,t.target.y)),t.style&&typeof t.style.opacity<"u"&&(this.style.opacity=t.style.opacity),t.crop){this.cropData=t.crop;let i=Be.singleBox(t.crop.width,t.crop.height,t.crop.x,t.crop.y);zr(i,hn(-t.crop.x,-t.crop.y)),this.crop?this.crop.set(i):this.crop=Ee(i)}t.display?(this.display.scale=r,this.display.width=t.display.width,this.display.height=t.display.height,this.display.rotation=t.display.rotation,this.display.points=Be.singleBox(t.display.width,t.display.height)):(this.display.scale=r,this.display.width=t.target.width/r,this.display.height=t.target.height/r,this.display.points=Be.singleBox(t.target.width/r,t.target.height/r))}getAllPointsAt(t,n,r){return[[this,this.crop||this.points,n]]}static fromSvg(t,n,r,i){return em.fromImage("data:image/svg+xml;base64,"+btoa(t),n,r,i)}static fromImage(t,n,r,i){let s=new em;return s.applyProps({uri:t,id:i,display:r,target:n}),s}getImageUrl(){return this.uri}},tm=class extends Ur{constructor(t){if(super(),A(this,"type","spacial-content"),A(this,"id"),A(this,"uri"),A(this,"display"),A(this,"points"),A(this,"getTexture"),this.getTexture=()=>({source:void 0,hash:-1}),!t)this.id="",this.uri="",this.display={x:0,y:0,scale:1,width:0,height:0,points:Ee(5)},this.points=Ee(5);else{let n=t.scale||1;this.id=t.id||t.uri,this.uri=t.uri,this.points=Be.singleBox(t.width,t.height),this.display={x:0,y:0,scale:n,width:t.width/n,height:t.height/n,points:n!==1?Be.singleBox(t.width/n,t.height/n):this.points}}}applyProps(t){let n=t.display?t.display.width:t.target.width,r=t.target.width/n;this.id=t.id,this.points.set(Be.singleBox(t.target.width,t.target.height)),this.display.scale=r,this.display.width=t.target.width/r,this.display.height=t.target.height/r,this.getTexture=t.getTexture,this.display.points=r!==1?Be.singleBox(t.target.width/r,t.target.height/r):this.points}getAllPointsAt(t,n,r){return[[this,this.points,n]]}};function vM(e,t,n=1){let r=t.length;if(r===0)throw new Error("No resources passed in.");let i=0,s=1/0;for(let o=0;o<r&&!(!t[o]||!t[o].display);o++){let u=nm(t[o].display.scale,e/(n||1));u<s&&(s=u,i=o)}return i}function nm(e,t){return Math.abs(e-t)}function xd(e,t){let n=nm(e.x,t.x),r=nm(e.y,t.y);return Math.sqrt(Math.pow(n,2)+Math.pow(r,2))}function xM(e){let t=e.length;return e.indexOf("/info.json")===t-10?e.slice(0,-10):e}function fc(e,t,n){return Math.min(Math.max(e,t),n)}var La=class NE extends Ur{constructor(t){super(),A(this,"id"),A(this,"type","spacial-content"),A(this,"display"),A(this,"tileWidth"),A(this,"style",{opacity:1}),A(this,"points"),A(this,"service"),A(this,"format","jpg"),A(this,"crop2"),A(this,"version3"),A(this,"tileUrl"),this.tileUrl=xM(t.url),this.id=t.id||`${this.tileUrl}--${t.scaleFactor}`,this.points=t.displayPoints?t.displayPoints:li(t.points,ns(t.scaleFactor)),this.tileWidth=t.tileWidth,this.version3=t.version3,this.display={x:0,y:0,width:t.width/t.scaleFactor,height:t.height/t.scaleFactor,points:t.points,scale:t.scaleFactor},t.format&&(this.format=t.format)}applyProps(t){if(t.style&&typeof t.style.opacity<"u"&&(this.style.opacity=t.style.opacity),t.service!==this.service&&(this.service=t.service),t.format?this.format=t.format:this.format="jpg",typeof t.version3<"u"&&(this.version3=t.version3),t.crop){this.cropData=t.crop;let n=Ee([...this.points]),r=n.length/5,i=t.crop.x||0,s=t.crop.y||0,o=t.crop.x+t.crop.width,u=t.crop.y+t.crop.height;for(let d=0;d<r;d++){let h=d*5;n[h+1]<o&&n[h+3]>i&&n[h+2]<u&&n[h+4]>s?(n[h+1]=fc(n[h+1],i,o),n[h+3]=fc(n[h+3],i,o),n[h+2]=fc(n[h+2],s,u),n[h+4]=fc(n[h+4],s,u)):n[h]=0}zr(n,hn(-t.crop.x,-t.crop.y)),this.crop?this.crop.set(n):this.crop=n}}static fromTile(t,n,r,i,s,o,u,d){r.height=r.height?r.height:r.width;let h=u?Math.floor(n.width/i):Math.ceil(n.width/i),c=u?Math.floor(n.height/i):Math.ceil(n.height/i),p=Math.ceil(h/r.width),m=Math.ceil(c/r.height),w=Be.grid(p,m),y=Be.grid(p,m),S=s?s["@context"]?Array.isArray(s["@context"])?s["@context"]:[s["@context"]]:[]:[],C=typeof d<"u"?d:S.indexOf("http://iiif.io/api/image/3/context.json")!==-1;for(let k=0;k<m;k++)for(let T=0;T<p;T++){let _=T*r.width,R=k*r.height;y.addPoints(_*i,R*i,T===p-1?n.width:(_+r.width)*i,k===m-1?n.height:(R+r.height)*i),w.addPoints(_,R,T===p-1?h:_+r.width,k===m-1?c:R+r.height)}let x=new NE({url:t,scaleFactor:i,points:w.build(),displayPoints:y.build(),width:n.width,height:n.height,tileWidth:r.width,format:o,version3:C});return x.applyProps({service:s}),x}getImageUrl(t){let n=this.points.slice(t*5,t*5+5),r=n[3]-n[1],i=n[4]-n[2],s=Math.ceil(r/this.display.scale),o=Math.ceil(i/this.display.scale),u=`${s>this.tileWidth?this.tileWidth:s},`;return this.version3&&(u+=`${o>this.tileWidth?this.tileWidth:o}`),`${this.tileUrl}/${n[1]},${n[2]},${r},${i}/${u}/0/default.${this.format||"jpg"}`}getAllPointsAt(t,n,r){let i=ja(this.crop||this.points,t);return[[this,i,n]]}transform(t){zr(this.points,t)}getScheduledUpdates(t,n){return[]}},wM=class extends Ur{constructor(){super(...arguments),A(this,"type","spacial-content")}getAllPointsAt(t,n,r){return[[this,this.points,n]]}},SM=class extends wM{constructor(t){super(),A(this,"id"),A(this,"display"),A(this,"points"),A(this,"images",[]),A(this,"allImages",[]),A(this,"scaleFactors",[]),A(this,"aggregateBuffer",Ee(9)),A(this,"lazyLoader"),A(this,"isFullyLoaded",!1),A(this,"maxScaleFactor",0),A(this,"renderOptions"),A(this,"_scheduleSortByScales",!1),A(this,"_sortByScales",()=>{this._scheduleSortByScales=!1,this.allImages.sort((r,i)=>i.display.width-r.display.width),this.images=[];let n=.1;for(let r of this.allImages)if(!(r.display.width<this.renderOptions.minSize&&r.display.height<this.renderOptions.minSize&&!r.priority||r instanceof rs&&(r.display.width>this.renderOptions.maxImageSize||r.display.height>this.renderOptions.maxImageSize)&&!r.priority)){if(Math.abs(r.display.scale-n)<.25||r.priority){let i=this.images.pop();i&&(i instanceof rs||i.priority)?(r.priority&&this.images.push(r),this.images.push(i)):r&&this.images.push(r)}else r&&this.images.push(r);n=r.display.scale}this.images.length===0&&(this.images=[...this.allImages]),this.scaleFactors=this.images.map(r=>r.display.scale),this.maxScaleFactor=Math.max(...this.scaleFactors)}),A(this,"loadFullResource",async()=>{if(!this.isFullyLoaded&&this.lazyLoader){this.isFullyLoaded=!0;let n=await this.lazyLoader();this.addImages(n)}}),A(this,"fallback",[this.loadFullResource]),this.id=t.id,this.points=Be.singleBox(t.width,t.height),this.lazyLoader=t.loadFullImages,t.loadFullImages||(this.isFullyLoaded=!0),this.display={x:0,y:0,points:Be.singleBox(t.width,t.height),height:t.height,width:t.width,scale:1},this.renderOptions={renderSmallestFallback:!0,renderLayers:3,minSize:255,maxImageSize:2048,quality:1.5,...t.renderOptions||{}},this.addImages(t.images)}applyProps(t){typeof t.renderSmallestFallback<"u"&&t.renderSmallestFallback!==this.renderOptions.renderSmallestFallback&&(this.renderOptions.renderSmallestFallback=t.renderSmallestFallback),typeof t.renderLayers<"u"&&t.renderLayers!==this.renderOptions.renderLayers&&(this.renderOptions.renderLayers=t.renderLayers),typeof t.minSize<"u"&&t.minSize!==this.renderOptions.minSize&&(this.renderOptions.minSize=t.minSize),typeof t.maxImageSize<"u"&&t.maxImageSize!==this.renderOptions.maxImageSize&&(this.renderOptions.maxImageSize=t.maxImageSize),typeof t.quality<"u"&&t.quality!==this.renderOptions.quality&&(this.renderOptions.quality=t.quality)}appendChild(t){this.addImages([t])}removeChild(t){this.images.indexOf(t)!==-1&&(this.images=this.images.filter(n=>n!==t),this.sortByScales())}insertBefore(t,n){this.addImages([t])}hideInstance(){}addImages(t){for(let n of t)n.__parent=this,n.__owner=this.__owner;this.allImages.push(...t.filter(Boolean)),this.sortByScales()}sortByScales(){this._scheduleSortByScales=!0}getScheduledUpdates(t,n){return this._scheduleSortByScales?[this._sortByScales]:this.isFullyLoaded?[]:n>1/this.maxScaleFactor?this.fallback:[]}getAllPointsAt(t,n,r){if(this.images.length===0)return[];let i=vM(1/(r||1)/(window.devicePixelRatio||1),this.images,this.renderOptions.quality),s=this.images.length,o=n?oi(n,hn(this.x,this.y)):hn(this.x,this.y);if(i!==this.images.length-1&&this.images[i+1]){let u=[];for(let c=s-1;c>=i;c--)u.push(c);let d=u[0];this.renderOptions.renderLayers&&(u=u.slice(-Math.min(u.length,this.renderOptions.renderLayers))),this.renderOptions.renderSmallestFallback&&u.indexOf(d)===-1&&u.unshift(d);let h=[];for(let c=0;c<u.length;c++)h.push(...this.images[u[c]].getAllPointsAt(t,o,r));return h}return this.images[i].getAllPointsAt(t,o,r)}};function hc(e,t,n,r,i){let s=Math.PI/180*i,o=Math.cos(s),u=Math.sin(s),d=o*(n-e)+u*(r-t)+e,h=o*(r-t)-u*(n-e)+t;return[d,h]}var wy=class FE extends Ur{constructor(t,n){super(),A(this,"id"),A(this,"type","world-object"),A(this,"scale"),A(this,"layers"),A(this,"points"),A(this,"worldPoints"),A(this,"intersectionBuffer",Ee(5)),A(this,"aggregateBuffer",Ee(9)),A(this,"invertedBuffer",Ee(9)),A(this,"rotation",0),A(this,"filteredPointsBuffer"),A(this,"_updatedList",[]),A(this,"geometry");let{x:r=0,y:i=0}=n||{};t?(this.id=t.id||"",this.scale=1,this.layers=t.layers,this.points=Ee([1,r,i,r+t.width,i+t.height]),this.worldPoints=Ee([1,r,i,r+t.width,i+t.height]),this.filteredPointsBuffer=Ee(t.layers.length*5)):(this.id="",this.scale=1,this.layers=[],this.points=Ee(5),this.worldPoints=Ee(5),this.filteredPointsBuffer=Ee(5))}static createWithProps(t){let n=new FE;return n.applyProps(t),n}applyProps(t){let n=t.x||0,r=t.y||0;this.id=t.id;let i=typeof t.scale<"u"?t.scale:this.scale;this.points[0]=1,this.points[1]=n,this.points[2]=r,this.points[3]=n+t.width,this.points[4]=r+t.height,this.rotation=t.rotation||0,this.worldPoints[3]=this.worldPoints[1]+t.width,this.worldPoints[4]=this.worldPoints[2]+t.height,t.scale&&t.scale!==1&&this.atScale(i),this.scale=i}appendChild(t){t.points[0]===0&&t.points.set(this.points),t.__owner.value=this,this.addLayers([t])}removeChild(t){this.layers=this.layers.filter(n=>n!==t),this.filteredPointsBuffer=Ee(this.layers.length*5)}insertBefore(t,n){let r=this.layers.indexOf(n);if(r===-1||this.layers.indexOf(t)!==-1)return;let i=this.layers.slice(0,r),s=this.layers.slice(r);this.layers=[...i,t,...s]}hideInstance(){console.warn("hideInstance: not yet implemented")}getObjectsAt(t,n){if(this.rotation&&(t=this.applyRotation(t)),ja(this.points,t,this.filteredPointsBuffer)[0]===0)return[];let r=this.layers.length,i=[];for(let s=0;s<r;s++){let o=this.layers[s];if(n&&o.isShape){let u=li(o.points,hn(this.x,this.y));if(!o.intersects([t[1]-u[1],t[2]-u[2]]))continue}if(ja(li(o.points,hn(this.x,this.y)),t,this.filteredPointsBuffer)[0]!==0&&i.push(o),n){let u=o;i.push(...u.getObjectsAt(t,n))}}return i}applyRotation(t){if(this.rotation){let n={x:t[1],y:t[2]},r={x:t[1],y:t[4]},i={x:t[3],y:t[2]},s={x:t[3],y:t[4]},o=this.points[1]+(this.points[3]-this.points[1])/2,u=this.points[2]+(this.points[4]-this.points[2])/2,[d,h]=hc(o,u,n.x,n.y,this.rotation),[c,p]=hc(o,u,r.x,r.y,this.rotation),[m,w]=hc(o,u,i.x,i.y,this.rotation),[y,S]=hc(o,u,s.x,s.y,this.rotation),C=Math.min(d,c,m,y),x=Math.max(d,c,m,y),k=Math.min(h,p,w,S),T=Math.max(h,p,w,S);return Ee([t[0],C,k,x,T])}return t}getAllPointsAt(t,n,r){let i=oi(hn(this.x,this.y),ns(this.scale),this.aggregateBuffer);this.rotation&&(t=this.applyRotation(t));let s=TO(t,this.points,this.intersectionBuffer),o=this.layers.length,u=[],d=li(s,oi(ns(1/this.scale),hn(-this.x,-this.y),this.invertedBuffer)),h=n?oi(n,i,this.aggregateBuffer):i,c=r*this.scale;for(let p=0;p<o;p++)u.push(...this.layers[p].getAllPointsAt(d,h,c));return u}addLayers(t){let n=[];for(let r of t)this.layers.indexOf(r)===-1&&(n.push(r),r.points.length===5&&(r.points[1]<this.worldPoints[1]/this.scale||r.points[2]<this.worldPoints[2]/this.scale||r.points[3]>this.worldPoints[3]/this.scale||r.points[4]>this.worldPoints[4]/this.scale)&&(r.crop=r.crop||Ee([1,Math.max(this.worldPoints[1]/this.scale,r.points[1]),Math.max(this.worldPoints[2]/this.scale,r.points[2]),Math.min(this.worldPoints[3]/this.scale,r.points[3]),Math.min(this.worldPoints[4]/this.scale,r.points[4])])));this.layers=this.layers.concat(n),this.filteredPointsBuffer=Ee(this.layers.length*5)}getScheduledUpdates(t,n){let r=this.layers.length;this._updatedList=[];let i=n*this.scale;for(let s=0;s<r;s++){let o=this.layers[s].getScheduledUpdates(t,i);o&&this._updatedList.push(...o)}return this._updatedList}},cf=class zE extends Ur{constructor(t=0,n=0,r=100,i="left-to-right"){super(),A(this,"id","world"),A(this,"_width"),A(this,"_height"),A(this,"aspectRatio"),A(this,"viewingDirection"),A(this,"aggregateBuffer",Ee(9)),A(this,"isDirty",!1),A(this,"zones",[]),A(this,"filteredPointsBuffer"),A(this,"selectedZone"),A(this,"triggerQueue",[]),A(this,"activatedEvents",[]),A(this,"_updatedList",[]),A(this,"translationBuffer",Ee(9)),A(this,"needsRecalculate",!0),A(this,"emptyPaintables",[]),A(this,"renderOrder",[]),A(this,"points"),A(this,"objects",[]),A(this,"subscriptions",[]),A(this,"_propagateEventTargets",[]),A(this,"_alreadyFlushed",[]),this._width=t,this._height=n,this.aspectRatio=Number.isNaN(t/n)?1:t/n,this.viewingDirection=i,this.points=Ee(r*5),this.filteredPointsBuffer=Ee(r*5)}get x(){return 0}get y(){return 0}get width(){return this._width}get height(){return this._height}static withProps(t){let n=new zE;return n.applyProps(t),n}applyProps(t){typeof t.width<"u"&&typeof t.height<"u"&&(t.width!==this._width||t.height!==this._height)&&this.resize(t.width,t.height),t.viewingDirection!==this.viewingDirection&&(this.viewingDirection=t.viewingDirection,this.triggerRepaint())}propagateTouchEvent(t,n,r){let i=[];for(let s of r)if(s.x&&s.y){let o=Be.singleBox(1,1,s.x,s.y);i.push(this.getObjectsAt(o,!0).reverse())}return i.map(s=>this.propagateEvent(t,n,s,{bubbles:!0,cancelable:!0}))}propagatePointerEvent(t,n,r,i,s={}){let o=Be.singleBox(1,1,r,i),u=this.getObjectsAt(o,!0).reverse();return this.propagateEvent(t,n,u,s)}propagateEvent(t,n,r,{bubbles:i=!1,cancelable:s=!1}={}){n.atlasTarget=this,this._propagateEventTargets.length=1,this._propagateEventTargets[0]=this;let o=!1;n.stopPropagation=()=>{o=!0};let u=r.length;for(let c=u-1;c>=0;c--){this._propagateEventTargets.unshift(r[c][0]);let p=r[c][1].length;if(p)for(let m=0;m<p;m++)this._propagateEventTargets.unshift(r[c][1][m])}let d=this._propagateEventTargets.length,h=!1;for(let c=0;c<d&&(n.atlasTarget=this._propagateEventTargets[c],n.atlasWorld=this,h=this._propagateEventTargets[c].dispatchEvent(t,n)||h,!o);c++);return h&&this.triggerRepaint(),this._propagateEventTargets}appendChild(t){let n=this.appendWorldObject(t);this.renderOrder.push(n/5)}removeChild(t){let n=this.objects.indexOf(t);if(n===-1){for(let r of this.objects)if(r&&r.id===t.id){this.removeChild(r);return}return}this.objects[n]=null,this.renderOrder=this.renderOrder.filter(r=>r!==n),this.points[n*5]=0,this.triggerRepaint(),this.needsRecalculate=!0}insertBefore(t,n){let r=this.objects.indexOf(n);if(r===-1)return;let i=this.appendWorldObject(t);this.renderOrder.splice(r-1,0,i/5)}hideInstance(){}asWorldObject(){return null}addZone(t){this.zones.push(t)}selectZone(t){if(typeof t=="string"){let n=this.zones.length;for(let r=0;r<n;r++)if(this.zones[r].id===t){this.selectedZone=r,this.trigger("zone-changed");return}}else this.zones[t]&&(this.selectedZone=t,this.trigger("zone-changed"))}deselectZone(){this.selectedZone=void 0}getActiveZone(){if(this.selectedZone)return this.zones[this.selectedZone]}hasActiveZone(){return typeof this.selectedZone<"u"}checkResizeInternalBuffer(){if(bO(this.points)===this.objects.length){let t=this.points,n=Ee(this.points.length*2);n.set(t,0),this.points=n}}appendWorldObject(t){this.checkResizeInternalBuffer();let n=this.objects.length*5,r=t.points;return t.points=this.points.subarray(this.objects.length*5,this.objects.length*5+5),t.points[1]=r[1],t.points[2]=r[2],t.points[3]=r[3],t.points[4]=r[4],this.objects.push(t),this.filteredPointsBuffer=Ee(this.objects.length*5),this.needsRecalculate=!0,this.triggerRepaint(),n}recalculateWorldSize(){let t=!1;if(this.needsRecalculate){let n=new Int32Array(this.objects.length),r=new Int32Array(this.objects.length),i=this.renderOrder.length;for(let u=0;u<i;u++){let d=this.renderOrder[u];this.objects[d]&&(n[u]=this.points[d*5+3],r[u]=this.points[d*5+4])}let s=Math.max(...n);s!==this._width&&(this._width=s,t=!0);let o=Math.max(...r);o!==this._height&&(this._height=o,t=!0),t&&this.trigger("recalculate-world-size",{width:s,height:o}),this.needsRecalculate=!1}return t}addObjectAt(t,n){n.width&&!n.height?n.height=n.width/t.width*t.height:n.height&&!n.width&&(n.width=n.height/t.height*t.width),(!n||!n.width||!n.height)&&(n.width=t.width,n.height=t.height);let{width:r,x:i,y:s}=n,o=r/t.width;this.checkResizeInternalBuffer(),this.points.set(Be.singleBox(t.width,t.height,0,0),this.objects.length*5);let u=new wy(t);return u.points=this.points.subarray(this.objects.length*5,this.objects.length*5+5),this.objects.push(u),this.scaleWorldObject(this.objects.length-1,o),this.translateWorldObject(this.objects.length-1,i,s),this.filteredPointsBuffer=Ee(this.points.length*2),this.triggerRepaint(),this.needsRecalculate=!0,u}scaleWorldObject(t,n){zr(this.points.subarray(t*5,t*5+5),Ma(n,this.points[t*5+1],this.points[t*5+2]));let r=this.objects[t];r&&(r.atScale(n),this.triggerRepaint())}translateWorldObject(t,n,r){zr(this.points.subarray(t*5,t*5+5),hn(n,r));let i=this.objects[t];i&&(i.translate(n,r),this.triggerRepaint())}resize(t,n){return this._width=t,this._height=n,this.aspectRatio=t/n,this.triggerRepaint(),this}getObjects(){return this.objects}getPoints(){return this.points}getPointsFromViewer(t,n){let r=Be.singleBox(t.width,t.height,t.x,t.y);return this.getPointsAt(r,n,t.scale)}addLayoutSubscriber(t){return this.subscriptions.push(t),()=>{this.subscriptions.splice(this.subscriptions.indexOf(t),1)}}getScheduledUpdates(t,n){let r=ja(this.points,t,this.filteredPointsBuffer),i=this.objects.length;this._updatedList=[];for(let s=0;s<i;s++)if(r[s*5]!==0){if(!this.objects[s])continue;this._updatedList.push(...this.objects[s].getScheduledUpdates(t,n))}return this._updatedList}getObjectsAt(t,n=!1){let r=this.getActiveZone(),i=ja(this.points,t,this.filteredPointsBuffer),s=this.renderOrder.length,o=[];for(let u=0;u<s;u++){let d=this.renderOrder[u];if(i[d*5]!==0){let h=this.objects[d];if(!h||r&&r.objects.indexOf(h)===-1)continue;if(h.type!=="world-object"){o.push([h,[h]]);continue}n?o.push([h,h.getObjectsAt(t,n)]):o.push([h,this.emptyPaintables])}}return o}getPointsAt(t,n,r=1){let i=this.getObjectsAt(t),s=oi(ns(r),hn(-t[1],-t[2]),this.translationBuffer),o=n?oi(n,s,this.aggregateBuffer):s,u=i.length,d=[];for(let h=0;h<u;h++)i[h]&&d.push(...i[h][0].getAllPointsAt(t,o,r));return d}flushSubscriptions(){if(this.triggerQueue.length){this._alreadyFlushed=[];let t=this.triggerQueue.length;for(let n=0;n<t;n++){if(this._alreadyFlushed.indexOf(this.triggerQueue[n][0])!==-1)continue;typeof this.triggerQueue[n][1]>"u"&&this._alreadyFlushed.push(this.triggerQueue[n][0]);let r=this.subscriptions.length;for(let i=0;i<r;i++)this.subscriptions[i].apply(null,this.triggerQueue[n])}this.triggerQueue=[]}}trigger(t,n){this.triggerQueue.push([t,n])}triggerEventActivation(){this.trigger("event-activation")}triggerRepaint(){this.trigger("repaint")}gotoRegion(t){this.trigger("goto-region",t)}goHome(t=!1){this.trigger("go-home",{immediate:t})}zoomTo(t,n,r){this.trigger("zoom-to",{point:n,factor:t,stream:r})}zoomIn(t){this.trigger("zoom-to",{point:t,factor:.5})}zoomOut(t){this.trigger("zoom-to",{point:t,factor:2})}constraintBounds(t){this.trigger("constrain-bounds",{immediate:t})}},pc=/([0-9]+(px|em)\s+)+(solid)\s+(.*)/g,gc={},kM=["backgroundColor","opacity","boxShadow","borderColor","borderWidth","borderStyle","outlineColor","outlineWidth","outlineOffset","outlineStyle"],aa=class extends Ur{constructor(){super(),A(this,"id"),A(this,"type","spacial-content"),A(this,"points"),A(this,"hoverEvents",!1),A(this,"activeEvents",!1),A(this,"display",{x:0,y:0,scale:1,width:-1,height:-1,points:Ee(5)}),A(this,"_parsed",{border:{id:null,match:[]},outline:{id:null,match:[]}}),A(this,"hovering"),A(this,"pressing"),A(this,"props",{}),A(this,"addHover",()=>{this.hovering=!0,this.__revision++}),A(this,"removeHover",()=>{this.hovering=!1,this.pressing=!1,this.__revision++}),A(this,"addPress",()=>{this.pressing=!0,this.__revision++}),A(this,"removePress",()=>{this.pressing=!1,this.__revision++}),this.id=uf(12),this.points=Ee(5)}getAllPointsAt(e,t){return[[this,this.points,t]]}applyProps(e={}){let t=!1;if(e.interactive!==this.props.interactive&&(t=!0,this.props.interactive=e.interactive),e.style){let n=e.border||e.style.border;if(n!==this._parsed.border.id)if(!n)this._parsed.border.id=null,this._parsed.border.match=[];else{let r=gc[n]||pc.exec(n)||pc.exec(n);r&&(this._parsed.border.id=n,this._parsed.border.match=gc[n]=r)}if(this._parsed.border.id&&(e.style.borderWidth=this._parsed.border.match[1],e.style.borderStyle="solid",e.style.borderColor=this._parsed.border.match[4]),e.style.outline!==this._parsed.outline.id)if(!e.style.outline)this._parsed.outline.id=null,this._parsed.outline.match=[];else{let r=gc[e.style.outline]||pc.exec(e.style.outline)||pc.exec(e.style.outline);r&&(this._parsed.outline.id=e.style.outline,this._parsed.outline.match=gc[e.style.outline]=r)}this._parsed.outline.id&&(e.style.outlineWidth=this._parsed.outline.match[1],e.style.outlineStyle="solid",e.style.outlineColor=this._parsed.outline.match[4]),this.props.style=e.style,e.backgroundColor&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.backgroundColor,t=!0),e.style.background&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.style.background,t=!0);for(let r of kM)if(this.props.style[r]!==e.style[r]){t=!0;break}e.style[":hover"]!==this.props.hoverStyles&&(this.props.hoverStyles=e.style[":hover"],this.hoverEvents||(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),t=!0),e.style[":active"]!==this.props.pressStyles&&(this.props.pressStyles=e.style[":active"],this.activeEvents||(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0)}e.href!==this.props.href&&(this.props.href=e.href,t=!0),e.hrefTarget!==this.props.hrefTarget&&(this.props.hrefTarget=e.hrefTarget,t=!0),e.title!==this.props.title&&(this.props.title=e.title,t=!0),e.className!==this.props.className&&(this.props.className=e.className,e.className&&!this.hoverEvents&&(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),e.className&&!this.activeEvents&&(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0),e.relativeSize!==this.props.relativeSize&&(this.props.relativeSize=e.relativeSize,t=!0),e.relativeStyle!==this.props.relativeStyle&&(this.props.relativeStyle=e.relativeStyle,t=!0),e.html!==this.props.html&&(this.props.html=e.html,t=!0),e.target&&(e.target.width!==this.display.width||e.target.height!==this.display.height||e.target.x!==this.points[1]||e.target.y!==this.points[2])&&(t=!0,this.points=Be.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.points=Be.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.width=e.target.width,this.display.height=e.target.height),t&&this.__revision++}},Uc=class extends Ur{constructor(){super(),A(this,"type","spacial-content"),A(this,"id"),A(this,"points"),A(this,"color","#000"),A(this,"backgroundColor"),A(this,"hovering"),A(this,"pressing"),A(this,"text",""),A(this,"display",{x:0,y:0,scale:1,width:100,height:100,points:Ee(5)}),A(this,"className"),A(this,"html"),A(this,"interactive",!1),A(this,"props",{font:"18px Arial, sans-serif",lineHeight:1,textAlign:"left",verticalAlign:"top",paddingX:0,paddingY:0,fitParent:!1,lineBreak:"auto",strokeText:!1,sizeToFill:!1,maxFontSizeToFill:void 0,allowNewLine:!0,justifyLines:!1,renderHDPI:!1,textDecoration:"none",interactive:!1,relativeSize:!1}),this.id="",this.points=Ee(5)}getAllPointsAt(e,t){return[[this,this.points,t]]}applyProps({id:e,target:t,text:n,color:r,backgroundColor:i,fontSize:s=18,interactive:o,fontFamily:u="Arial, sans-serif",...d}){d.font=`${s}px ${u}`,this.interactive=o||!1,typeof n<"u"&&(this.text=n||""),r&&(this.color=r),i&&(this.backgroundColor=i),e&&(this.id=e),t&&(this.points=Be.singleBox(t.width,t.height,t.x,t.y),this.display.points=this.points,this.display.width=t.width,this.display.height=t.height),this.props={...this.props,...d},this.__revision++}},Dl=Math.pow,PM=Math.cos,EM=Math.PI,Fi={easeInOutQuad:function(e){return e<.5?2*e*e:1-Dl(-2*e+2,2)/2},easeOutQuart:function(e){return 1-Dl(1-e,4)},easeInOutSine:function(e){return-(PM(EM*e)-1)/2},easeOutExpo:function(e){return e===1?1:1-Dl(2,-10*e)},easeInOutExpo:function(e){return e===0?0:e===1?1:e<.5?Dl(2,20*e-10)/2:(2-Dl(2,-20*e+10))/2}},CM=class{constructor(e){A(this,"runtime"),A(this,"pendingTransition"),A(this,"lastZoomTo",null),A(this,"isConstraining",!1),A(this,"lastGoToRegion",null),this.runtime=e,this.pendingTransition={from:Ee(5),to:Ee(5),elapsed_time:0,done:!0,total_time:0,timingFunction:Fi.easeInOutQuad,constrain:!1}}hasPending(){return!this.pendingTransition.done}getPendingTransition(){return this.pendingTransition}getPendingFrom(){return this.pendingTransition.from}customTransition(e){e(this.pendingTransition)}stopTransition(){this.pendingTransition.from=Ee(this.runtime.target),this.pendingTransition.to=Ee(this.runtime.target),this.pendingTransition.done=!0,this.pendingTransition.elapsed_time=0,this.pendingTransition.total_time=0}runTransition(e,t){var n,r;if(!this.pendingTransition.done){let i=this.pendingTransition,s=i.total_time===0?0:(i.elapsed_time+t)/i.total_time,o=i.total_time===0?1:s===0?0:i.timingFunction(s);e[1]=i.from[1]+(i.to[1]-i.from[1])*o,e[2]=i.from[2]+(i.to[2]-i.from[2])*o,e[3]=i.from[3]+(i.to[3]-i.from[3])*o,e[4]=i.from[4]+(i.to[4]-i.from[4])*o,this.pendingTransition.elapsed_time+=t,this.pendingTransition.elapsed_time>=this.pendingTransition.total_time&&(this.pendingTransition.done=!0,(r=(n=this.pendingTransition).callback)==null||r.call(n),this.pendingTransition.constrain&&this.constrainBounds({transition:{duration:this.pendingTransition.total_time===0?0:500,easing:Fi.easeOutExpo}}))}}resumeTransition(){this.lastZoomTo&&this.zoomTo(this.lastZoomTo.factor,this.lastZoomTo.options),this.isConstraining&&this.constrainBounds(),this.lastGoToRegion&&this.goToRegion(this.lastGoToRegion.target,this.lastGoToRegion.options)}zoomTo(e,t={}){let{origin:n,stream:r=!1,transition:i}=t;this.lastZoomTo={factor:e,options:t};let s=this.runtime.getZoomedPosition(e,{origin:n}),o=Math.abs(1-e);this.applyTransition(s,i,{duration:2e3*o,easing:Fi.easeOutExpo,constrain:!0,callback:()=>{this.lastZoomTo=null}},{stream:!1})}constrainBounds({transition:e,panPadding:t=0}={}){this.isConstraining=!0;let[n,r]=this.runtime.constrainBounds(this.runtime.target,{panPadding:t});n&&(this.applyTransition(r,e,{duration:500,easing:Fi.easeOutQuart,constrain:!1,callback:()=>{this.isConstraining=!1}}),this.runtime.updateNextFrame())}applyTransition(e,t,n,{stream:r}={}){this.pendingTransition.from=Ee(this.runtime.target),this.pendingTransition.to=e,r||(this.pendingTransition.elapsed_time=0),this.pendingTransition.done=!1,this.pendingTransition.total_time=typeof(t==null?void 0:t.duration)<"u"?t.duration:typeof(n==null?void 0:n.duration)<"u"?n.duration:1e3,this.pendingTransition.constrain=typeof(t==null?void 0:t.constrain)<"u"?t.constrain:typeof(n==null?void 0:n.constrain)<"u"?n.constrain:!1,this.pendingTransition.timingFunction=(t==null?void 0:t.easing)||(n==null?void 0:n.easing)||Fi.easeInOutSine}goToRegion(e,{transition:t}={}){this.lastGoToRegion={target:e,options:{transition:t}};let n=this.runtime.clampRegion(e);this.applyTransition(Be.singleBox(n.width,n.height,n.x,n.y),t,{duration:1e3,easing:Fi.easeOutExpo,constrain:!0,callback:()=>{this.lastGoToRegion=null}}),this.runtime.updateNextFrame()}},df=class{constructor(t,n,r,i=[],s){A(this,"id",uf()),A(this,"ready",!1),A(this,"renderer"),A(this,"world"),A(this,"target"),A(this,"homePosition"),A(this,"manualHomePosition"),A(this,"manualFocalPosition"),A(this,"focalPosition"),A(this,"transitionManager"),A(this,"aggregate"),A(this,"transformBuffer",Ee(500)),A(this,"lastTarget",Ee(5)),A(this,"zoomBuffer",Ee(5)),A(this,"logNextRender",!1),A(this,"pendingUpdate",!0),A(this,"isCommitting",!1),A(this,"firstRender",!0),A(this,"lastTime"),A(this,"stopId"),A(this,"mode","explore"),A(this,"controllers",[]),A(this,"controllersRunning",!1),A(this,"controllerStopFunctions",[]),A(this,"maxScaleFactor",1),A(this,"_viewerToWorld",{x:0,y:0}),A(this,"_lastGoodScale",1),A(this,"hooks",{useFrame:[],useBeforeFrame:[],useAfterPaint:[],useAfterFrame:[]}),A(this,"fpsLimit"),A(this,"options"),A(this,"hookOptions",{filters:{grayscale:0,contrast:0,brightness:0,saturate:0,sepia:0,invert:0,hueRotate:0,blur:0}}),A(this,"_viewport",{x:0,y:0,width:0,height:0}),A(this,"setViewport",o=>{let u=Math.round(typeof o.x>"u"?this.target[1]:o.x),d=Math.round(typeof o.y>"u"?this.target[2]:o.y);o.width?this.target[3]=u+o.width:this.target[3]=this.target[3]-this.target[1]+u,o.height?this.target[4]=d+o.height:this.target[4]=this.target[4]-this.target[2]+d,Math.abs(this.target[1]-u)>.01&&(this.target[1]=u),Math.abs(this.target[2]-d)>.01&&(this.target[2]=d),this.pendingUpdate=!0}),A(this,"render",o=>{let u=o-this.lastTime;if(this.isCommitting||this.fpsLimit&&u<1e3/this.fpsLimit){this.stopId=window.requestAnimationFrame(this.render);return}this.lastTime=o,this.world.flushSubscriptions(),this.stopId=window.requestAnimationFrame(this.render),this.hook("useFrame",u);let d=this.pendingUpdate,h=this.renderer.pendingUpdate();if(this.transitionManager.hasPending()&&(this.transitionManager.runTransition(this.target,u),this.pendingUpdate=!0,this.updateControllerPosition()),!this.firstRender&&!d&&!h&&this.target[0]===this.lastTarget[0]&&this.target[1]===this.lastTarget[1]&&this.target[2]===this.lastTarget[2]&&this.target[3]===this.lastTarget[3]&&this.target[4]===this.lastTarget[4])return;this.hook("useBeforeFrame",u),this.renderer.beforeFrame(this.world,u,this.target,this.hookOptions);let c=this.getScaleFactor(),p=this.renderer.getPointsAt(this.world,this.target,this.aggregate,c),m=p.length;for(let S=0;S<m;S++){let C=p[S][0],x=p[S][1],k=p[S][2],T=k?li(x,k,this.transformBuffer):x;this.renderer.prepareLayer(C,C.__parent&&k?li(C.__parent.crop||C.__parent.points,k):T);let _=T.length/5;for(let R=0;R<_;R++){let O=R*5;T[O]!==0&&(this.renderer.paint(C,R,T[O+1],T[O+2],T[O+3]-T[O+1],T[O+4]-T[O+2]),this.hook("useAfterPaint",C))}this.renderer.finishLayer(C,x)}this.renderer.afterFrame(this.world,u,this.target,this.hookOptions),this.hook("useAfterFrame",u),this.lastTarget[0]=this.target[0],this.lastTarget[1]=this.target[1],this.lastTarget[2]=this.target[2],this.lastTarget[3]=this.target[3],this.lastTarget[4]=this.target[4],this.firstRender=!1,this.pendingUpdate=!1,this.logNextRender=!1,this.renderer.isReady()&&(this.ready=!0,this.world.trigger("ready")),this.world.flushSubscriptions();let w=this.world.getScheduledUpdates(this.target,c),y=w.length;if(y>0)for(let S=0;S<y;S++){let C=w[y-S-1]();C?C.then(()=>{this.pendingUpdate=!0}):this.pendingUpdate=!0}}),this.renderer=t,this.world=n,this.options={maxOverZoom:1,maxUnderZoom:1,visibilityRatio:1.5,...s||{}},this.target=Be.projection(r),this.manualHomePosition=!1,this.pendingUpdate=!0,this.homePosition=Be.projection(this.world),this.manualFocalPosition=!1,this.focalPosition=this.target,this.updateFocalPosition(),this.transitionManager=new CM(this),this.aggregate=ns(1),this.world.addLayoutSubscriber(o=>{o==="repaint"&&(this.pendingUpdate=!0),o==="recalculate-world-size"&&(this.manualHomePosition||(this.setHomePosition(),this.goHome()),this.updateFocalPosition())}),this.lastTime=performance.now(),this.controllers=i,this.render(this.lastTime),this.startControllers()}get x(){return this.target[1]}set x(t){this.target[1]=t}get y(){return this.target[2]}set y(t){this.target[2]=t}get x2(){return this.target[3]}set x2(t){this.target[3]=t}get y2(){return this.target[4]}set y2(t){this.target[4]=t}get width(){return this.target[3]-this.target[1]}set width(t){this.target[3]=this.target[1]+t}get height(){return this.target[4]-this.target[2]}set height(t){this.target[4]=this.target[2]=t}setHomePosition(t){this.homePosition.set(Be.projection(t||this.world)),this.pendingUpdate=!0}startControllers(){if(!this.controllersRunning){for(let t of this.controllers)this.controllerStopFunctions.push(t.start(this));this.controllersRunning=!0}}stopControllers(){if(this.controllersRunning){for(let t of this.controllerStopFunctions)t();this.controllersRunning=!1,this.controllerStopFunctions=[]}}updateControllerPosition(){for(let t of this.controllers)t.updatePosition(this.x,this.y,this.width,this.height)}triggerResize(){this.renderer.triggerResize&&this.renderer.triggerResize(),this.pendingUpdate=!0}addController(t){this.controllers.push(t),this.controllersRunning&&t.start(this),this.pendingUpdate=!0}cover(){return this.goHome({cover:!0})}getRendererScreenPosition(){return this.renderer.getRendererScreenPosition()}updateRendererScreenPosition(){this.pendingUpdate=!0,this.renderer.resize()}setOptions(t){this.options={...this.options,...t}}goHome(t={}){if(this.world.width<=0||this.world.height<=0)return;let n=this.getScaleFactor(),r=t.position?{x:t.position[1],y:t.position[2],width:t.position[3]-t.position[1],height:t.position[4]-t.position[2]}:{x:this.homePosition[1],y:this.homePosition[2],width:this.homePosition[3]-this.homePosition[1],height:this.homePosition[4]-this.homePosition[2]},i=this.width*n,s=this.height*n,o=r.width/i,u=r.height/s,d=i/s;if(t.cover?o>u:o<u){let h=d*r.height,c=(h-r.width)/2;this.target[1]=Math.round(-c+r.x),this.target[2]=Math.round(r.y),this.target[3]=Math.round(h-c+r.x),this.target[4]=Math.round(r.height+r.y)}else{let h=r.width/d,c=(h-r.height)/2;this.target[1]=Math.round(r.x),this.target[2]=Math.round(r.y-c),this.target[3]=Math.round(r.x+r.width),this.target[4]=Math.round(r.y+h-c)}this.constrainBounds(this.target),this.updateControllerPosition()}resize(t,n,r,i){this.transitionManager.hasPending()&&this.transitionManager.stopTransition(),this.updateFocalPosition(t-n,r-i);let s=n/t,o=i/r;this.target[3]=this.target[1]+(this.target[3]-this.target[1])*s,this.target[4]=this.target[2]+(this.target[4]-this.target[2])*o,this.goHome({position:this.focalPosition}),this.renderer.resize(n,i),this.pendingUpdate=!0,this.transitionManager.resumeTransition()}updateFocalPosition(t,n){if(!this.manualFocalPosition){let r=this.width,i=this.height,s=Math.min(r,i),o=0,u=0,d=this.x+o,h=this.y+u;if(r<i){let c=this.height-this.width;this.focalPosition=Be.projection({x:d,y:h+c/2,width:s-o*2,height:s-u*2}),this.pendingUpdate=!0}else{let c=this.width-this.height;this.focalPosition=Be.projection({x:d+c/2,y:h,width:s-o*2,height:s-u*2}),this.pendingUpdate=!0}}}getViewport(){return this._viewport.x=this.target[1],this._viewport.y=this.target[2],this._viewport.width=this.target[3]-this.target[1],this._viewport.height=this.target[4]-this.target[2],this._viewport}constrainBounds(t,{panPadding:n=0,ref:r=!1}={}){let{minX:i,maxX:s,minY:o,maxY:u}=this.getBounds({target:t,padding:n}),d=!1,h=r?t:Ee(t),c=Math.round(t[3]-t[1]),p=Math.round(t[4]-t[2]);return i>t[1]&&(d=!0,h[1]=i,h[3]=i+c),o>t[2]&&(d=!0,h[2]=o,h[4]=o+p),s<t[1]&&(d=!0,h[1]=s,h[3]=s+c),u<t[2]&&(d=!0,h[2]=u,h[4]=u+p),[d,h]}getBounds(t){let n=t.target||this.target,r=t.padding,i=this.options.visibilityRatio,s=Math.abs(1-i);if(this.world.hasActiveZone()){let k=this.world.getActiveZone();if(k){let T=n[3]-n[1]<k.points[3]-k.points[1],_=n[4]-n[2]<k.points[4]-k.points[2];return{minX:T?k.points[1]-r:k.points[1]+(k.points[3]-k.points[1])/2-(n[3]-n[1])/2,maxX:_?k.points[2]-r:k.points[2]+(k.points[4]-k.points[2])/2-(n[4]-n[2])/2,minY:T?k.points[3]+r:k.points[1]+(k.points[3]-k.points[1])/2-(n[3]-n[1])/2,maxY:_?k.points[4]+r:k.points[2]+(k.points[4]-k.points[2])/2-(n[4]-n[2])/2}}}let o=n[3]-n[1],u=this.world.width,d=-o*s,h=u-o-d,c=n[4]-n[2],p=this.world.height,m=-c*s,w=p-c-m,y=Math.round(Math.max(d,h)),S=Math.round(Math.min(d,h)),C=Math.round(Math.max(m,w)),x=Math.round(Math.min(m,w));return{minX:S,maxX:y,minY:x,maxY:C}}getScaleFactor(t=!1){let n=this.renderer.getScale(this.target[3]-this.target[1],this.target[4]-this.target[2],t);return n===0?this._lastGoodScale:(this._lastGoodScale=n,n)}getZoomedPosition(t,{origin:n,fromPos:r}){var C;let i=r?{width:r[3]-r[1],height:r[4]-r[2]}:void 0,s=i?this.renderer.getScale(i.width,i.height):this.getScaleFactor(),o=i?i.width:this.width,u=i?i.height:this.height,d=(C=this.getRendererScreenPosition())==null?void 0:C.width,h=this.world.width,c=d?d/h:1,p=this.options.maxUnderZoom,m=Math.max(c||1,this.options.maxOverZoom),w=1/t,y=s*w;if(w<1){let x=o*s,k=u*s,T=this.world.width/x,_=this.world.height/k;if(T>_){let R=this.world.width*y,O=~~(o*s)*p;R<O&&(t=this.world.width*s/(o*s*p))}else{let R=this.world.height*y,O=~~(u*s)*p;R<O&&(t=this.world.height*s/(u*s*p))}}else y>m&&(t=s/m);let S=li(this.target,Ma(t,n?n.x:this.target[1]+(this.target[3]-this.target[1])/2,n?n.y:this.target[2]+(this.target[4]-this.target[2])/2),this.zoomBuffer);return this.constrainBounds(S,{ref:!0,panPadding:100}),S}clampRegion({x:t,y:n,width:r,height:i,padding:s=0}){let o=this.width,u=this.height,d=r/o<i/u,h=t-s,c=n-s,p=r+s*2,m=i+s*2;if(d){let y=m/u*o;return{x:h-(y-p)/2,y:c,width:y,height:m}}let w=p/o*u;return{x:h,y:c-(w-m)/2,width:p,height:w}}viewerToWorld(t,n){let r=this.getScaleFactor();return this._viewerToWorld.x=this.target[1]+t/r,this._viewerToWorld.y=this.target[2]+n/r,this._viewerToWorld}worldToViewer(t,n,r,i){let s=Be.singleBox(r,i,t,n);return zr(s,oi(ns(this.getScaleFactor()),hn(-this.target[1],-this.target[2]))),{x:s[1],y:s[2],width:s[3]-s[1],height:s[4]-s[2],strand:s}}setScale(t,n){zr(this.target,Ma(t,n?n.x:this.target[1]+(this.target[3]-this.target[1])/2,n?n.y:this.target[2]+(this.target[4]-this.target[2])/2)),this.pendingUpdate=!0}syncTo(t){let n=this.target;return this.target=t.target,this.pendingUpdate=!0,()=>{this.target=n}}stop(){return typeof this.stopId<"u"&&(window.cancelAnimationFrame(this.stopId),this.stopId=void 0),()=>{this.render(performance.now())}}reset(){this.renderer.reset()}selectZone(t){this.world.selectZone(t),this.pendingUpdate=!0}deselectZone(){this.world.deselectZone(),this.pendingUpdate=!0}hook(t,n){let r=this.hooks[t].length;if(r!==0)for(let i=0;i<r;i++)this.hooks[t][i](n)}registerHook(t,n){return this.hooks[t].push(n),()=>{this.hooks[t]=this.hooks[t].filter(r=>r!==n)}}updateNextFrame(){this.pendingUpdate=!0}},mc=/([0-9]+(px|em)\s+)+(solid)\s+(.*)/g,yc={},TM=["backgroundColor","opacity","boxShadow","borderColor","borderWidth","borderStyle","outlineColor","outlineWidth","outlineOffset","outlineStyle"],$E=class extends Ur{constructor(){super(),A(this,"id"),A(this,"type","spacial-content"),A(this,"isShape",!0),A(this,"points"),A(this,"hoverEvents",!1),A(this,"activeEvents",!1),A(this,"display",{x:0,y:0,scale:1,width:-1,height:-1,points:Ee(5)}),A(this,"boundingBox",null),A(this,"_parsed",{border:{id:null,match:[]},outline:{id:null,match:[]}}),A(this,"hovering"),A(this,"pressing"),A(this,"props",{}),A(this,"shape",{type:"none"}),A(this,"addHover",()=>{this.hovering=!0,this.__revision++}),A(this,"removeHover",()=>{this.hovering=!1,this.pressing=!1,this.__revision++}),A(this,"addPress",()=>{this.pressing=!0,this.__revision++}),A(this,"removePress",()=>{this.pressing=!1,this.__revision++}),this.id=uf(12),this.points=Ee(5),this.shape={type:"none"}}updateBoundingBox(){if(this.shape.type==="none")return;let e=this.shape.points;if(this.shape.points.length>2){let t=Math.min(...e.map(s=>s[0])),n=Math.min(...e.map(s=>s[1])),r=Math.max(0,...e.map(s=>s[0])),i=Math.max(0,...e.map(s=>s[1]));this.boundingBox={x:t,y:n,width:r-t,height:i-n};return}this.boundingBox=null}intersects(e){if(!e||this.shape.type==="none")return!1;let[t,n]=e,r=this.shape.points,i=this.boundingBox;if(i||(this.updateBoundingBox(),i=this.boundingBox),!i||t<i.x||t>i.x+i.width||n<i.y||n>i.height+i.y)return!1;let s=!1;for(let o=0,u=r.length-1;o<r.length;u=o++)r[o][1]>n!=r[u][1]>n&&t<(r[u][0]-r[o][0])*(n-r[o][1])/(r[u][1]-r[o][1])+r[o][0]&&(s=!s);return s}getAllPointsAt(e,t){return e[3]-e[1]===1&&e[4]-e[2]===1?this.intersects([e[1],e[2]])?[[this,this.points,t]]:[]:[[this,this.points,t]]}applyProps(e={}){let t=!1;if(e.points)if(this.shape.type!=="polygon"||this.shape.points.length!==e.points.length)this.shape={type:"polygon",points:e.points,open:e.open},this.updateBoundingBox();else{let n=!1,r=e.points.length;for(let i=0;i<r;i++)if(e.points[i][0]!==this.shape.points[i][0]||e.points[i][1]!==this.shape.points[i][1]){n=!0;break}n&&(this.shape={type:"polygon",points:e.points,open:e.open},this.updateBoundingBox())}if(e.interactive!==this.props.interactive&&(t=!0,this.props.interactive=e.interactive),(e.open||e.open===!1)&&(t=!0,this.shape.open=e.open),e.style){let n=e.border||e.style.border;if(n!==this._parsed.border.id)if(!n)this._parsed.border.id=null,this._parsed.border.match=[];else{let r=yc[n]||mc.exec(n)||mc.exec(n);r&&(this._parsed.border.id=n,this._parsed.border.match=yc[n]=r)}if(this._parsed.border.id&&(e.style.borderWidth=this._parsed.border.match[1],e.style.borderStyle="solid",e.style.borderColor=this._parsed.border.match[4]),e.style.outline!==this._parsed.outline.id)if(!e.style.outline)this._parsed.outline.id=null,this._parsed.outline.match=[];else{let r=yc[e.style.outline]||mc.exec(e.style.outline)||mc.exec(e.style.outline);r&&(this._parsed.outline.id=e.style.outline,this._parsed.outline.match=yc[e.style.outline]=r)}this._parsed.outline.id&&(e.style.outlineWidth=this._parsed.outline.match[1],e.style.outlineStyle="solid",e.style.outlineColor=this._parsed.outline.match[4]),this.props.style=e.style,e.backgroundColor&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.backgroundColor,t=!0),e.style.background&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=e.style.background,t=!0);for(let r of TM)if(this.props.style[r]!==e.style[r]){t=!0;break}e.style[":hover"]!==this.props.hoverStyles&&(this.props.hoverStyles=e.style[":hover"],this.hoverEvents||(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),t=!0),e.style[":active"]!==this.props.pressStyles&&(this.props.pressStyles=e.style[":active"],this.activeEvents||(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0)}e.href!==this.props.href&&(this.props.href=e.href,t=!0),e.hrefTarget!==this.props.hrefTarget&&(this.props.hrefTarget=e.hrefTarget,t=!0),e.title!==this.props.title&&(this.props.title=e.title,t=!0),e.className!==this.props.className&&(this.props.className=e.className,e.className&&!this.hoverEvents&&(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),e.className&&!this.activeEvents&&(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),t=!0),e.relativeSize!==this.props.relativeSize&&(this.props.relativeSize=e.relativeSize,t=!0),e.relativeStyle!==this.props.relativeStyle&&(this.props.relativeStyle=e.relativeStyle,t=!0),e.html!==this.props.html&&(this.props.html=e.html,t=!0),e.target&&(e.target.width!==this.display.width||e.target.height!==this.display.height||e.target.x!==this.points[1]||e.target.y!==this.points[2])&&(t=!0,this.points=Be.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.points=Be.singleBox(e.target.width,e.target.height,e.target.x,e.target.y),this.display.width=e.target.width,this.display.height=e.target.height),t&&this.__revision++}},fw=/(-?[0-9]+(px|em)\s+|0\s+)(-?[0-9]+(px|em)\s+|0\s+)(-?[0-9]+(px|em)\s+|0\s+)?(-?[0-9]+(px|em)\s+|0\s+)?(.*)/g,hw={},bM=typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes("firefox"),vc={},RM=class{constructor(e,t){A(this,"canvas"),A(this,"ctx"),A(this,"options"),A(this,"imagesPending",0),A(this,"imagesLoaded",0),A(this,"imageIdsLoaded",[]),A(this,"frameIsRendering",!1),A(this,"pendingDrawCall",!1),A(this,"firstMeaningfulPaint",!1),A(this,"parallelTasks",8),A(this,"frameTasks",0),A(this,"loadingQueueOrdered",!0),A(this,"loadingQueue",[]),A(this,"currentTask",Promise.resolve()),A(this,"tasksRunning",0),A(this,"stats"),A(this,"averageJobTime",64),A(this,"lastKnownScale",1),A(this,"visible",[]),A(this,"previousVisible",[]),A(this,"rendererPosition"),A(this,"dpi"),A(this,"drawCalls",[]),A(this,"lastPaintedObject"),A(this,"hostCache"),A(this,"invalidated",[]),A(this,"_worker",()=>{if(this.loadingQueue.length){let n=this.loadingQueue.pop();n&&(this.tasksRunning++,this.frameTasks++,this.currentTask=n.task().then(()=>{this.tasksRunning--}).catch(()=>{this.tasksRunning--}))}}),A(this,"_scheduled",0),A(this,"_doWork",()=>{this.loadingQueue.length===0&&this.tasksRunning===0&&this._scheduled&&(clearInterval(this._scheduled),this._scheduled=0);let n=this.parallelTasks||1;!this.firstMeaningfulPaint&&this.loadingQueue.length&&(n=this.loadingQueue.length);for(let r=0;r<=n;r++)this._worker()}),this.canvas=e,this.rendererPosition=e.getBoundingClientRect(),this.ctx=e.getContext("2d",{alpha:!0}),this.ctx.imageSmoothingEnabled=!0,this.options=t||{},this.canvas.style.transition="opacity .3s",this.dpi=(t==null?void 0:t.dpi)||1,this.hostCache=t!=null&&t.lruCache?new qs({maxSize:1024*512*512,dispose:(n,r,i)=>{this.invalidated.push(r),n.width=0,n.height=0},sizeCalculation:(n,r)=>n.width*n.height}):{store:{},get(n){return this.store[n]},set(n,r){this.store[n]=r}}}getCanvasDims(){return{width:this.canvas.width/this.dpi,height:this.canvas.height/this.dpi}}resize(){this.rendererPosition=this.canvas.getBoundingClientRect()}isReady(){return this.firstMeaningfulPaint}afterFrame(e){if(this.clearTransform(),this.lastPaintedObject=void 0,this.frameIsRendering=!1,this.imagesPending=Math.max(0,this.imagesPending-this.imagesLoaded),this.imagesLoaded=0,this.loadingQueueOrdered||(this.loadingQueue=this.loadingQueue.sort((t,n)=>t.network&&t.scale===n.scale?n.distance-t.distance:t.scale<n.scale?-1:1),this.loadingQueueOrdered=!0),this.previousVisible=this.visible,this.pendingDrawCall=!!this.drawCalls.length,this.pendingDrawCall)for(let t=0;t<this.drawCalls.length;t++){let n=this.drawCalls.shift();n&&n()}this.doOffscreenWork(),this.options.debug&&this.stats&&this.stats.end()}doOffscreenWork(){this.frameTasks=0,this.loadingQueue.length&&(this._worker(),this.loadingQueue.length&&(this._scheduled||(this._scheduled=setInterval(this._doWork,0))))}getScale(e,t,n){if(Number.isNaN(e)||Number.isNaN(t))return this.lastKnownScale;let r=this.getCanvasDims(),i=r.width/e,s=r.height/t,o=(i<s?s:i)*(n&&this.dpi||1);return Number.isNaN(o)||(this.lastKnownScale=o),this.lastKnownScale}beforeFrame(e,t,n,r){this.options.debug&&this.stats&&this.stats.begin(),this.frameIsRendering=!0,this.visible=[],this.options.beforeFrame&&this.options.beforeFrame(t);let i=this.getCanvasDims();if(this.ctx.globalAlpha=1,this.ctx.fillStyle=this.canvas.dataset.background??"rgb(0, 0, 0)",this.ctx.fillRect(0,0,i.width,i.height),r.enableFilters&&(r.filters.brightness||r.filters.contrast||r.filters.grayscale||r.filters.invert||r.filters.sepia||r.filters.saturate||r.filters.hueRotate||r.filters.blur)){let s="";r.filters.brightness&&(s+=`brightness(${~~(100+r.filters.brightness*100)}%) `),r.filters.contrast&&(s+=`contrast(${~~(100+r.filters.contrast*100)}%) `),r.filters.grayscale&&(s+=`grayscale(${~~(r.filters.grayscale*100)}%) `),r.filters.invert&&(s+=`invert(${~~(r.filters.invert*100)}%) `),r.filters.sepia&&(s+=`sepia(${~~(r.filters.sepia*100)}%) `),r.filters.saturate&&(s+=`saturate(${~~(100+r.filters.saturate*100)}%) `),r.filters.hueRotate&&(s+=`hue-rotate(${r.filters.hueRotate}deg) `),r.filters.blur&&(s+=`blur(${r.filters.blur}px) `),this.ctx.filter=s}else this.ctx.filter="none"}applyTransform(e,t,n,r,i){let s=e.__owner.value;if(s&&s.rotation){this.ctx.save();let o=t+r/2,u=n+i/2;this.ctx.translate(o,u),this.ctx.rotate(s.rotation*Math.PI/180),this.ctx.translate(-o,-u),this.lastPaintedObject=s}}clearTransform(){this.lastPaintedObject&&(this.lastPaintedObject.rotation&&this.ctx.restore(),this.lastPaintedObject=void 0)}paint(e,t,n,r,i,s){let o=this.ctx.globalAlpha;if(e instanceof rs||e instanceof La){if(e.display.rotation){this.ctx.save();let h=n+i/2,c=r+s/2;e.crop&&(h-=e.crop[t*5+1],c-=e.crop[t*5+2]),this.ctx.translate(h,c),this.ctx.rotate(e.display.rotation*Math.PI/180),this.ctx.translate(-h,-c)}if(this.visible.push(e),typeof e.style&&e.style.opacity!=="undefined"){if(!e.style.opacity)return;this.ctx.globalAlpha=e.style.opacity}try{let h=e.__host.canvas,c=this.getCanvasDims();if((h.indices.indexOf(t)===-1||this.invalidated.indexOf(h.canvases[t])!==-1)&&this.schedulePaintToCanvas(h,e,t,xd({x:n+i/2,y:r+i/2},{x:c.width/2,y:c.height/2})),!this.firstMeaningfulPaint)return;let p=this.hostCache.get(h.canvases[t]);if(p)if(e.crop&&e.cropData){if(e.crop[t*5]){let m=[e.crop[t*5+1]/e.display.scale-e.display.points[t*5+1],e.crop[t*5+2]/e.display.scale-e.display.points[t*5+2],1+(e.crop[t*5+3]-e.crop[t*5+1])/e.display.scale,1+(e.crop[t*5+4]-e.crop[t*5+2])/e.display.scale];m[0]+=e.cropData.x/e.display.scale,m[1]+=e.cropData.y/e.display.scale;let w=e.x*this.lastKnownScale,y=e.y*this.lastKnownScale,S=[n+w,r+y,i,s];S[0]+=w,S[1]+=y,this.ctx.drawImage(p,m[0],m[1],m[2],m[3],S[0],S[1],S[2]+1,S[3]+1)}}else bM?this.ctx.drawImage(p,0,0,e.display.points[t*5+3]-e.display.points[t*5+1],e.display.points[t*5+4]-e.display.points[t*5+2],n,r,i+1,s+1):this.ctx.drawImage(p,0,0,e.display.points[t*5+3]-e.display.points[t*5+1],e.display.points[t*5+4]-e.display.points[t*5+2],n,r,i+Number.MIN_VALUE+.5,s+Number.MIN_VALUE+.5)}catch{}e.display.rotation&&this.ctx.restore()}let u=e instanceof aa&&this.options.box,d=e instanceof $E&&this.options.polygon;if((u||d)&&!e.props.className&&!e.props.html&&!e.props.href){if(this.visible.push(e),e.props.style){let h=Object.assign({},e.props.style||{},e.hovering?e.props.hoverStyles:{},e.pressing?e.props.pressStyles:{}),c=e.props.relativeStyle?1:i/e.width;typeof h.opacity<"u"&&(this.ctx.globalAlpha=h.opacity);let p=0;typeof h.borderWidth<"u"&&(p=parseInt(h.borderWidth,10)*c);let m=0;typeof h.outlineWidth<"u"&&(m=parseInt(h.outlineWidth,10)*c);let w=0;if(typeof h.outlineOffset<"u"&&(w=parseInt(h.outlineOffset,10)*c),h.borderColor&&(this.ctx.strokeStyle=h.borderColor),h.boxShadow){let y=h.boxShadow.split(/,(?![^(]*\))/);for(let S of y){let C=hw[S]||fw.exec(S)||fw.exec(S);hw[S]=C,C&&(this.ctx.save(),this.ctx.shadowOffsetX=parseInt(C[1])*this.dpi*c,this.ctx.shadowOffsetY=parseInt(C[3])*this.dpi*c,this.ctx.shadowBlur=parseInt(C[5])*this.dpi*c,this.ctx.shadowColor=C[9],this.ctx.fillStyle="rgba(0,0,0,1)",this.ctx.fillRect(n+p,r+p,i,s),this.ctx.restore())}}if(this.ctx.fillStyle=h.backgroundColor||"transparent",this.ctx.lineWidth=p,d){let y=e.shape,S=y.points||[],C=S.length;this.ctx.beginPath();for(let x=0;x<C;x++)this.ctx.lineTo(n+S[x][0]*this.lastKnownScale,r+S[x][1]*this.lastKnownScale);y.open||this.ctx.closePath(),p&&this.ctx.stroke(),y.open||this.ctx.fill()}else p&&this.ctx.strokeRect(n+p/2,r+p/2,i+p,s+p),this.ctx.fillRect(n+p,r+p,i,s);m&&(h.outlineColor&&(this.ctx.strokeStyle=h.outlineColor),this.ctx.lineWidth=m,this.ctx.strokeRect(n-m/2-w,r-m/2-w,i+p*2+m+w*2,s+p*2+m+w*2))}this.ctx.globalAlpha=o}}loadImage(e,t,n,r=!1){if(vc[e]&&vc[e].naturalWidth>0){t(vc[e]);return}try{let i=!1;r||setTimeout(()=>{i||this.loadImage(e,t,n,!0)},3e3);let s=document.createElement("img");s.decoding="auto",s.onload=function(){i=!0,t(s),vc[e]=s,s.onload=null},this.options.crossOrigin&&(s.crossOrigin="anonymous"),s.src=e,s.complete&&s.onload({}),s.width}catch(i){console.log("image error",i),n(i)}}schedulePaintToCanvas(e,t,n,r){this.imagesPending++,e.indices.push(n);let i=`${t.id}--${t.display.scale}-${n}`,s=this.invalidated.indexOf(i);s!==-1&&this.invalidated.splice(s,1),e.canvases[n]=i,t.__host.canvas.loading=!0,this.loadingQueueOrdered=!1,this.loadingQueue.push({id:i,scale:t.display.scale,network:!0,distance:r,task:()=>new Promise(o=>{if(this.visible.indexOf(t)===-1){this.imagesPending--,e.indices.splice(e.indices.indexOf(n),1),o();return}let u=t.getImageUrl(n);this.loadImage(u,d=>{this.loadingQueue.push({id:i,scale:t.display.scale,distance:r,task:()=>new Promise(h=>{this.imageIdsLoaded.includes(i)||(this.imagesLoaded++,this.imageIdsLoaded.push(i)),e.loaded.push(n),e.loaded.length===e.indices.length&&(e.loading=!1);let c=t.display.points.slice(n*5,n*5+5),p=document.createElement("canvas"),m=p.getContext("2d");p.width=c[3]-c[1],p.height=c[4]-c[2],this.hostCache.set(e.canvases[n],p),this.drawCalls.push(()=>{m.drawImage(d,0,0,c[3]-c[1],c[4]-c[2]),h()})})}),o()},d=>{this.imagesPending--,e.indices.splice(e.indices.indexOf(n),1),o()})})})}afterPaintLayer(e,t){}prepareLayer(e,t){e.__owner.value&&(e.cropData?(this.lastKnownScale*(1/e.display.scale),this.applyTransform(e,t[1],t[2],t[3]-t[1],t[4]-t[2])):this.applyTransform(e,t[1],t[2],t[3]-t[1],t[4]-t[2])),(!e.__host||!e.__host.canvas)&&(e instanceof rs||e instanceof La)&&this.createImageHost(e)}finishLayer(){this.lastPaintedObject&&this.clearTransform()}createImageHost(e){e.__host=e.__host?e.__host:{},e.__host.canvas={canvas:void 0,canvases:[],indices:[],loaded:[],loading:!1}}getPointsAt(e,t,n,r){return e.getPointsAt(t,n,r)}getViewportBounds(e,t,n){let r=e.getActiveZone();if(r){let i=t[3]-t[1]<r.points[3]-r.points[1],s=t[4]-t[2]<r.points[4]-r.points[2];return{x1:i?r.points[1]-n:r.points[1]+(r.points[3]-r.points[1])/2-(t[3]-t[1])/2,y1:s?r.points[2]-n:r.points[2]+(r.points[4]-r.points[2])/2-(t[4]-t[2])/2,x2:i?r.points[3]+n:r.points[1]+(r.points[3]-r.points[1])/2-(t[3]-t[1])/2,y2:s?r.points[4]+n:r.points[2]+(r.points[4]-r.points[2])/2-(t[4]-t[2])/2}}return null}pendingUpdate(){let e=!this.pendingDrawCall&&this.drawCalls.length===0&&this.imagesPending===0&&this.loadingQueue.length===0&&this.tasksRunning===0;return!e&&this.visible.length===0&&setTimeout(()=>{this.canvas.style.opacity="1",this.firstMeaningfulPaint=!0},500),!this.firstMeaningfulPaint&&e&&this.visible.length?(this.canvas.style.opacity="1",this.firstMeaningfulPaint=e,!0):this.options.debug?!0:!e}getRendererScreenPosition(){return this.rendererPosition}reset(){this.loadingQueue=[],this.drawCalls=[]}},DE=class{constructor(e){A(this,"renderers",[]),A(this,"length");for(let t of e)t&&this.renderers.push(t);this.length=this.renderers.length}afterFrame(e,t,n,r){for(let i=0;i<this.length;i++)this.renderers[i].afterFrame(e,t,n,r)}afterPaintLayer(e,t){for(let n=0;n<this.length;n++)this.renderers[n].afterPaintLayer(e,t)}beforeFrame(e,t,n,r){for(let i=0;i<this.length;i++)this.renderers[i].beforeFrame(e,t,n,r)}triggerResize(){for(let e=0;e<this.length;e++){let t=this.renderers[e];t.triggerResize&&t.triggerResize()}}getPointsAt(e,t,n,r){return this.renderers[0].getPointsAt(e,t,n,r)}getScale(e,t){return this.renderers[0].getScale(e,t)}getViewportBounds(e,t,n){return this.renderers[0].getViewportBounds(e,t,n)}getRendererScreenPosition(){return this.renderers[0].getRendererScreenPosition()}isReady(){for(let e=0;e<this.length;e++)if(!this.renderers[e].isReady())return!1;return!0}paint(e,t,n,r,i,s){for(let o=0;o<this.length;o++)this.renderers[o].paint(e,t,n,r,i,s)}pendingUpdate(){for(let e=0;e<this.length;e++)if(this.renderers[e].pendingUpdate())return!0;return!1}prepareLayer(e,t){for(let n=0;n<this.length;n++)this.renderers[n].prepareLayer(e,t)}finishLayer(e,t){for(let n=0;n<this.length;n++)this.renderers[n].finishLayer(e,t)}resize(e,t){for(let n=0;n<this.length;n++)this.renderers[n].resize(e,t)}reset(){for(let e=0;e<this.length;e++)this.renderers[e].reset()}},IM=class{constructor(e){A(this,"canvas"),A(this,"context"),A(this,"heightRatio",1),A(this,"widthRatio",1),A(this,"target",new Float32Array(5)),A(this,"initialWidth"),A(this,"initialHeight"),A(this,"bounds"),A(this,"aggregate"),A(this,"delta",0),A(this,"renderNextFrame",!0),this.canvas=e,this.initialWidth=e.width,this.initialHeight=e.height,this.context=e.getContext("2d"),this.context.globalAlpha=.5,this.aggregate=ns(1)}isReady(){return!0}resize(){this.initialWidth=this.canvas.width,this.initialHeight=this.canvas.height,this.renderNextFrame=!0}afterFrame(e,t,n){if(this.renderNextFrame){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);let r=this.initialWidth/e.width,i=this.initialHeight/e.height,s=this.widthRatio>this.heightRatio?r:i;if(this.target=n,this.bounds){let o=e.getPointsAt(this.bounds,this.aggregate,s);for(let[u,d]of o)if(u instanceof rs&&u.__host.canvas){let h=d.length/5;for(let c=0;c<h;c++)u.__host.canvas.canvases[c]&&(d[c+1]*s,d[c+2]*s,(d[c+3]-d[c+1])*s,(d[c+4]-d[c+2])*s)}}e.getPoints().forEach((o,u,d)=>{if(u%5===0&&o){let h={x1:d[u+1]*s,y1:d[u+2]*s,x2:d[u+3]*s,y2:d[u+4]*s,width:(d[u+3]-d[u+1])*s,height:(d[u+4]-d[u+2])*s};this.context.strokeStyle="red",this.context.strokeRect(h.x1,h.y1,h.width,h.height)}}),n&&(this.context.strokeStyle="red",this.context.lineWidth=window.devicePixelRatio||1,this.context.strokeRect(n[1]*s,n[2]*s,(n[3]-n[1])*s,(n[4]-n[2])*s))}}getActiveZone(e){return null}getPointsAt(e,t,n,r){return e.getPointsAt(t,n,r)}getScale(e,t){return 1}beforeFrame(e,t){this.bounds=Be.singleBox(e.width,e.height)}drawImage(){}afterPaintLayer(e,t){}paint(e,t,n,r,i,s){this.renderNextFrame=!0}prepareLayer(e){}pendingUpdate(){return!1}hasActiveZone(){return!1}getViewportBounds(e,t,n){return null}getRendererScreenPosition(){return this.canvas.getBoundingClientRect()}finishLayer(){}reset(){}};function _M(e){return{x:e[1],y:e[2],width:e[3]-e[1],height:e[4]-e[2]}}var pw="pan",gw="scroll",AM="gesture",OM={zoomOutFactor:.8,zoomInFactor:1.25,maxZoomFactor:1,minZoomFactor:.05,zoomDuration:300,zoomWheelConstant:20,zoomClamp:.6,panBounceStiffness:120,panBounceDamping:15,panTimeConstant:240,panPower:.1,nudgeDistance:100,panPadding:0,devicePixelRatio:1,enableWheel:!0,enableClickToZoom:!0,ignoreSingleFingerTouch:!1,enablePanOnWait:!1,requireMetaKeyForWheelZoom:!1,panOnWaitDelay:40,onPanInSketchMode:()=>{},parentElement:null},BE=(e={})=>({start:function(t){let{zoomWheelConstant:n,enableWheel:r,enableClickToZoom:i,ignoreSingleFingerTouch:s,enablePanOnWait:o,panOnWaitDelay:u,parentElement:d,requireMetaKeyForWheelZoom:h}={...OM,...e},c={pointerStart:{x:0,y:0},isPressing:!1,mousemoveBuffer:Ee(5)};t.world.activatedEvents.push("onMouseUp","onMouseDown","onMouseMove","onTouchStart","onTouchEnd","onTouchMove","onContextMenu");function p(){S=0,x="",T(),T(void 0,"notice"),C=0}function m(){t.world.constraintBounds(),p()}function w(j){if(j.which>1){c.isPressing=!1;return}t.mode==="explore"&&(j.preventDefault(),c.pointerStart.x=j.atlas.x,c.pointerStart.y=j.atlas.y,t.transitionManager.stopTransition(),c.isPressing=!0)}function y(){p(),c.isPressing&&(t.mode==="explore"&&t.world.constraintBounds(),c.isPressing=!1)}let S=0,C=0,x="";function k(j){if(t.mode==="explore"){if(j.atlasTouches.length===1&&(C=performance.now(),s==!1&&j.preventDefault(),c.pointerStart.x=j.atlasTouches[0].x,c.pointerStart.y=j.atlasTouches[0].y),j.atlasTouches.length===2){x=AM,j.preventDefault();let H=j.atlasTouches[0].x,V=j.atlasTouches[1].x;c.pointerStart.x=(H+V)/2;let ne=j.atlasTouches[0].y,Y=j.atlasTouches[1].y;c.pointerStart.y=(ne+Y)/2,S=xd({x:j.touches[0].clientX,y:j.touches[0].clientY},{x:j.touches[1].clientX,y:j.touches[1].clientY})}t.transitionManager.stopTransition(),c.isPressing=!0}}function T(j,H="intent"){d&&(d.dataset[H]=j)}function _(j){let H=null,V=null,ne=0;if(c.isPressing&&j.touches.length===2){let Y=j.touches[0].clientX,de=j.touches[1].clientX;H=(Y+de)/2;let se=j.touches[0].clientY,ve=j.touches[1].clientY;V=(se+ve)/2,ne=xd({x:j.touches[0].clientX,y:j.touches[0].clientY},{x:j.touches[1].clientX,y:j.touches[1].clientY})}if(T(x),c.isPressing&&j.touches.length===1){if(o&&(performance.now()-C<u&&x==""&&(x=gw),x==""&&(x=pw)),T(x),x==""&&s==!0||x==gw){T("require-two-finger","notice");return}let Y=j.touches[0];H=Y.clientX,V=Y.clientY}if(H!==null&&V!==null){let Y=t.getRendererScreenPosition();if(Y){let{x:de,y:se}=t.viewerToWorld(H-Y.x,V-Y.y),ve=ne&&S?ne/S:1;t.transitionManager.customTransition(M=>{M.from=Ee(t.target),M.to=li(M.from,oi(hn(c.pointerStart.x-de,c.pointerStart.y-se),Ma(1/ve,de,se)),c.mousemoveBuffer),M.elapsed_time=0,M.total_time=0,M.timingFunction=Fi.easeInOutExpo,M.done=!1})}S=ne}x==pw&&j.preventDefault()}function R(j){if(c.isPressing){let H=t.getRendererScreenPosition();if(H){let{x:V,y:ne}=t.viewerToWorld(j.clientX-H.x,j.clientY-H.y);t.transitionManager.customTransition(Y=>{Y.from=Ee(t.target),Y.to=li(Y.from,hn(c.pointerStart.x-V,c.pointerStart.y-ne),c.mousemoveBuffer),Y.elapsed_time=0,Y.total_time=0,Y.timingFunction=Fi.easeInOutExpo,Y.done=!1})}}}function O(j){t.mode==="explore"&&t.world.zoomIn(j.atlas)}function F(j){let H=1+WO(j).spinY/n;t.world.zoomTo(H,j.atlas,!0)}function z(j){return h&&j.metaKey==!1?(T("meta-required","notice"),j.stopPropagation(),!1):!0}t.world.addEventListener("mouseup",m),t.world.addEventListener("touchend",m),t.world.addEventListener("touchstart",k),t.world.addEventListener("mousedown",w),window.addEventListener("touchend",y),window.addEventListener("mouseup",y),window.addEventListener("mousemove",R),d&&d.addEventListener("touchmove",_),i&&(t.world.activatedEvents.push("onClick"),t.world.addEventListener("click",O)),r&&(t.world.activatedEvents.push("onWheel"),h&&(d==null||d.addEventListener("wheel",z,{passive:!0,capture:!0})),t.world.addEventListener("wheel",F));let J=t.world.addLayoutSubscriber((j,H)=>{if(j==="zone-changed"&&t.transitionManager.constrainBounds({transition:{duration:0}}),j==="zoom-to"&&H&&t.transitionManager.zoomTo(H.factor,{origin:H.point,stream:H.stream}),j==="go-home"){let V=H.immediate?{duration:0}:void 0;t.transitionManager.goToRegion(_M(t.homePosition),{transition:V})}if(j==="goto-region"&&H){let V=H.immediate?{duration:0}:{};t.transitionManager.goToRegion(H,{transition:V})}j==="constrain-bounds"&&t.transitionManager.constrainBounds({transition:H!=null&&H.immediate?{duration:0}:void 0})});return()=>{t.world.removeEventListener("mouseup",m),t.world.removeEventListener("touchend",m),t.world.removeEventListener("touchstart",k),t.world.removeEventListener("mousedown",w),window.removeEventListener("touchend",y),window.removeEventListener("mouseup",y),t.world.removeEventListener("mousemove",R),d&&(d.removeEventListener("touchmove",R),d.removeEventListener("wheel",z,{passive:!0,capture:!0})),i&&t.world.removeEventListener("click",O),r&&t.world.removeEventListener("wheel",F),J()}},updatePosition(){}}),Qa=at.createContext("explore");Qa.displayName="Mode";var jM=()=>b.useContext(Qa),Ya=at.createContext(null);Ya.displayName="Atlas";var ff=at.createContext(null);ff.displayName="Bounds";var wd,MM=typeof performance=="object"&&typeof performance.now=="function";if(MM){let e=performance;wd=()=>e.now()}else{let e=Date,t=e.now();wd=()=>e.now()-t}var LM=16;function mw(e,t){e&&e.appendChild&&t&&e.appendChild(t)}function UE(e,t){e&&e.removeChild&&t&&e.removeChild(t)}function NM(e,t){return UE(e.world,t)}function FM(e,t,n){return WE(e.world,t,n)}function WE(e,t,n){e&&e instanceof df&&(e=e.world),e&&e.insertBefore&&e.insertBefore(t,n)}function HE(e,t,n){if(n&&(e.applyProps&&e.applyProps(n),e instanceof Ur))for(let r of af){let i=r.slice(2).toLowerCase();n[r]!==t[r]&&(t[r]&&e.removeEventListener(i,t[r]),e.addEventListener(i,n[r]))}}function VE(e,t){let n=Object.keys(t),r=!1;for(let i of n)if(af.indexOf(i)!==-1){let s=Zo[i];if(s){if(e.activatedEvents.indexOf(s)!==-1)continue;r=!0,e.activatedEvents.push(s)}}r&&e.triggerEventActivation()}var Sd=new Map,yw={};function zM(e,{args:t=[],...n},r,i,s){if(!(r instanceof df)&&s){let d=h=>h.return?d(h.return):h.stateNode&&h.stateNode.containerInfo;r=d(s)}let o,u=r.world;switch(e){case"world":o=cf.withProps({width:n.width,height:n.height,viewingDirection:"left-to-right"}),o.activatedEvents=u.activatedEvents,o.eventHandlers=u.eventHandlers,o.subscriptions=u.subscriptions,o.triggerEventActivation(),u=o;break;case"box":o=new aa;break;case"shape":o=new $E;break;case"worldObject":case"world-object":o=new wy;break;case"worldImage":case"world-image":o=new rs;break;case"texture":o=new tm;break;case"compositeImage":case"composite-image":o=new SM({id:n.id,width:n.width,height:n.height,images:[],renderOptions:n.renderOptions});break;case"tiledImage":case"tiled-image":o=La.fromTile(n.uri,n.display,n.tile,n.scaleFactor,void 0,n.format,n.useFloorCalc,n.version3);break;case"paragraph":o=new Uc,o.text=n.children;break;default:return}return VE(u,n),HE(o,{},n),o}function $M(e,t){if(t instanceof cf)e.world=t;else if(t instanceof wy)e.world.appendChild(t);else if(t)throw new Error("Invalid root")}var ua=ZO({unstable_now:wd,now:wd,createInstance:zM,removeChild:UE,appendChild:mw,appendInitialChild:mw,insertBefore:WE,warnsIfNotActing:!0,supportsMutation:!0,isPrimaryRenderer:!1,scheduleTimeout:typeof setTimeout<"u"?setTimeout:void 0,cancelTimeout:typeof clearTimeout<"u"?clearTimeout:void 0,setTimeout:typeof setTimeout<"u"?setTimeout:void 0,clearTimeout:typeof clearTimeout<"u"?clearTimeout:void 0,noTimeout:-1,appendChildToContainer:$M,removeChildFromContainer:NM,createTextInstance(){},insertInContainerBefore:FM,prepareUpdate(e,t,n,r,i){return VE(i.world,r),r},commitUpdate(e,t,n,r,i,s){e.applyProps&&t&&HE(e,r,t)},finalizeInitialChildren(e){return e==null?void 0:e.__handlers},getChildHostContext(){return yw},getRootHostContext(){return yw},prepareForCommit(e){return e.isCommitting=!0,null},preparePortalMount(){},hideInstance(e){e&&e.points&&(e.points[0]=0)},unhideInstance(e,t){e&&e.points&&(e.points[0]=1)},getPublicInstance(e){return e},hideTextInstance(){throw new Error("Text is not allowed in the react-three-fibre tree. You may have extraneous whitespace between components.")},resetAfterCommit(e){e.isCommitting=!1,e.pendingUpdate=!0,e.world&&e.world.needsRecalculate&&(e.world.recalculateWorldSize(),e.world.triggerRepaint())},shouldSetTextContent(){return!1},clearContainer(){return!1},supportsHydration:!1,supportsPersistence:!1,detachDeletedInstance(e){},afterActiveInstanceBlur(){},beforeActiveInstanceBlur(){},getCurrentEventPriority(){return console.log("getCurrentEventPriority"),LM},getInstanceFromNode(e){throw console.log("getInstanceFromNode",e),new Error("Not implemented")},getInstanceFromScope(e){throw console.log("getInstanceFromScope",e),new Error("Not implemented")},prepareScopeUpdate(e,t){throw console.log("prepareScopeUpdate",e,t),new Error("Not implemented")},logRecoverableError(){},requestPostPaintCallback(){}});ua.injectIntoDevTools({bundleType:0,version:b.version,rendererPackageName:"@atlas-viewer/atlas"});function Sy(e,t){let n=Sd.get(e);n&&ua.updateContainer(null,n,null,()=>{Sd.delete(e),t&&t(e)})}var vw={render(e,t){let n=Sd.get(t);if(n)ua.updateContainer(e,n,null);else{let r=ua.createContainer(t,0,null,!1,null,"",()=>{},null);ua.updateContainer(e,r,null),Sd.set(t,r)}},unmountComponentAtNode(e,t){Sy(e,t)}},Zw,Jw,ca=typeof window<"u"&&((Zw=window.document)!=null&&Zw.createElement||((Jw=window.navigator)==null?void 0:Jw.product)==="ReactNative")?b.useLayoutEffect:b.useEffect,DM=at.memo(({children:e,setIsReady:t,onCreated:n,bounds:r,preset:i,mode:s="explore"})=>{let o=b.useCallback(function(u){let d=b.useRef(!1),h=()=>{t(!0)};return b.useEffect(()=>{if(i&&!d.current){i.runtime.goHome();let c=n&&n(i);return void(c&&c.then?c.then(h):h())}return()=>{}},[]),b.useEffect(()=>{d.current=!0},[]),u.children},[i]);return ca(()=>{if(i){let u=i.runtime;s!==u.mode&&(u.mode=s),vw.render(E.jsx(at.StrictMode,{children:E.jsx(o,{children:E.jsx(ff.Provider,{value:r,children:E.jsx(Qa.Provider,{value:s,children:E.jsx(Ya.Provider,{value:i,children:e})})})})}),u)}},[i,s,e]),ca(()=>{if(i){let u=i.runtime;return()=>{vw.unmountComponentAtNode(u)}}return()=>{}},[i]),null}),BM=class{constructor(e,t){A(this,"canvas"),A(this,"gl"),A(this,"program"),A(this,"fragmentShader"),A(this,"vertexShader"),A(this,"rectBuffer"),A(this,"fragmentShaderSource",`
    precision mediump float;

    uniform sampler2D u_image;
    varying vec2 v_texCoord;

    void main() {
        gl_FragColor = texture2D(u_image, v_texCoord);
    }
  `),A(this,"vertexShaderSource",`
    attribute vec2 a_position;
    uniform vec2 u_resolution;
    varying vec4 v_color;
    uniform sampler2D u_texture;

    attribute vec2 a_texCoord;
    varying vec2 v_texCoord;

    void main() {

        // convert the position from pixels to 0.0 to 1.0
        vec2 zeroToOne = a_position / u_resolution;

        // convert from 0->1 to 0->2
        vec2 zeroToTwo = zeroToOne * 2.0;

        // convert from 0->2 to -1->+1 (clip space)
        vec2 clipSpace = zeroToTwo - 1.0;

        gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);
        
        v_texCoord = a_texCoord;
    }
  `),A(this,"attributes"),A(this,"uniforms"),A(this,"buffers"),A(this,"rendererPosition"),A(this,"dpi"),A(this,"lastResize",0),A(this,"lastKnownScale",1),this.canvas=e,this.rendererPosition=e.getBoundingClientRect(),this.gl=e.getContext("webgl2"),this.fragmentShader=this.createShader(this.gl.FRAGMENT_SHADER,this.fragmentShaderSource),this.vertexShader=this.createShader(this.gl.VERTEX_SHADER,this.vertexShaderSource),this.program=this.createProgram(this.vertexShader,this.fragmentShader),this.dpi=(t==null?void 0:t.dpi)||1,this.attributes={position:this.gl.getAttribLocation(this.program,"a_position"),texCoord:this.gl.getAttribLocation(this.program,"a_texCoord")},this.uniforms={resolution:this.gl.getUniformLocation(this.program,"u_resolution"),texture:this.gl.getUniformLocation(this.program,"u_texture")},this.buffers={position:this.createArrayBuffer(),texCoord:this.createArrayBuffer(new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]))},this.rectBuffer=new Float32Array(12),this.resize(),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.useProgram(this.program),this.gl.enableVertexAttribArray(this.attributes.position)}resize(){this.resizeCanvasToDisplaySize(),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.rendererPosition=this.canvas.getBoundingClientRect()}isReady(){return!0}beforeFrame(e,t,n){this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.vertexAttribPointer(this.attributes.position,2,this.gl.FLOAT,!1,0,0),this.gl.uniform2f(this.uniforms.resolution,this.gl.canvas.width,this.gl.canvas.height),this.lastResize>1e3&&(this.lastResize=0,this.resizeCanvasToDisplaySize()),this.lastResize+=t}prepareLayer(e){(!e.__host||!e.__host.webgl)&&((e instanceof rs||e instanceof La)&&this.createImageHost(e),e instanceof tm&&this.createTextureHost(e))}createTextureHost(e){e.__host=e.__host?e.__host:{};let t=this.gl,n=this.gl.createTexture();t.bindTexture(t.TEXTURE_2D,n),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1);let r;if(e instanceof tm){let i=e.getTexture();i.source&&t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i.source),r=i}t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),e.__host.webgl={height:e.height,width:e.width,texture:n,lastImage:r}}createImageHost(e){let t=[...new Array(e.points.length/5)];e.__host=e.__host?e.__host:{},e.__host.webgl={height:e.height,width:e.width,textures:t,loading:[],loaded:[],lastLevelRendered:-1,onLoad:(n,r)=>{let i=this.gl,s=this.gl.createTexture();i.bindTexture(i.TEXTURE_2D,s),i.pixelStorei(i.UNPACK_FLIP_Y_WEBGL,!1),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,r),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.LINEAR),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.bindTexture(i.TEXTURE_2D,null),e.__host.webgl.textures[n]=s,e.__host.webgl.loaded.push(n)}}}paint(e,t,n,r,i,s){if(e.type==="spacial-content"&&e.__host&&e.__host.webgl){if(e.getTexture){let u=e==null?void 0:e.getTexture();if(u&&e.__host.webgl.lastImage!==u.hash&&u.source&&!e.__host.webgl.error)try{let d=this.gl.RGBA,h=this.gl.RGBA,c=this.gl.UNSIGNED_BYTE;this.gl.bindTexture(this.gl.TEXTURE_2D,e.__host.webgl.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,d,h,c,u.source),e.__host.webgl.lastImage=u.hash}catch(d){e.__host.webgl.error=d}}if(e.__host.webgl.loading&&e.__host.webgl.loading.indexOf(t)===-1&&e.getImageUrl){e.__host.webgl.loading.push(t);let u=document.createElement("img");u.decoding="async",u.crossOrigin="anonymous",u.src=e.getImageUrl(t),u.onload=()=>(u.onload=null,e.__host.webgl.onLoad(t,u))}let o=e.__host.webgl.texture?e.__host.webgl.texture:e.__host.webgl.textures[t];o&&(this.gl.enableVertexAttribArray(this.attributes.texCoord),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffers.texCoord),this.gl.enableVertexAttribArray(this.attributes.texCoord),this.gl.vertexAttribPointer(this.attributes.texCoord,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffers.position),this.gl.enableVertexAttribArray(this.attributes.position),this.gl.vertexAttribPointer(this.attributes.position,2,this.gl.FLOAT,!1,0,0),this.gl.bindTexture(this.gl.TEXTURE_2D,o),this.gl.uniform1i(this.uniforms.texture,0),this.setRectangle(n,r,i,s),this.gl.drawArrays(this.gl.TRIANGLES,0,6))}}afterPaintLayer(e,t){}pendingUpdate(){return!0}getPointsAt(e,t,n,r){return e.getPointsAt(t,n,r)}afterFrame(){}getScale(e,t,n){if(Number.isNaN(e)||Number.isNaN(t))return this.lastKnownScale;let r=this.getCanvasDims(),i=r.width/e,s=r.height/t,o=(i<s?s:i)*(n&&this.dpi||1);return Number.isNaN(o)||(this.lastKnownScale=o),this.lastKnownScale}getCanvasDims(){return{width:this.canvas.width/this.dpi,height:this.canvas.height/this.dpi}}getViewportBounds(e,t,n){return null}createShader(e,t){let n=this.gl.createShader(e);if(n){if(this.gl.shaderSource(n,t),this.gl.compileShader(n),this.gl.getShaderParameter(n,this.gl.COMPILE_STATUS))return n;let r=this.gl.getShaderInfoLog(n);if(this.gl.deleteShader(n),r)throw new Error(r)}throw new Error("Invalid shader")}createProgram(e,t){let n=this.gl.createProgram();if(n){if(this.gl.attachShader(n,e),this.gl.attachShader(n,t),this.gl.linkProgram(n),this.gl.getProgramParameter(n,this.gl.LINK_STATUS))return n;let r=this.gl.getProgramInfoLog(n);if(this.gl.deleteProgram(n),r)throw new Error(r)}throw new Error("Invalid program")}resizeCanvasToDisplaySize(){let e=this.gl.canvas,t=e.clientWidth,n=e.clientHeight,r=e.width!==t||e.height!==n;return r&&(e.width=t,e.height=n),r}createArrayBuffer(e){let t=this.gl.createBuffer();if(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,t),e&&this.gl.bufferData(this.gl.ARRAY_BUFFER,e,this.gl.STATIC_DRAW),!t)throw new Error("Cannot create buffer");return t}setRectangle(e,t,n,r){this.gl.bufferData(this.gl.ARRAY_BUFFER,this.getRectangle(e,t,n,r),this.gl.STATIC_DRAW)}getRectangle(e,t,n,r){let i=e,s=e+n,o=t,u=t+r;return this.rectBuffer.set([i,o,s,o,i,u,i,u,s,o,s,u]),this.rectBuffer}getRendererScreenPosition(){return this.rendererPosition}finishLayer(){}reset(){}};function rm(e,t){let n=t?e:JSON.stringify(e),r=5381,i=n.length;for(;i;)r=r*33^n.charCodeAt(--i);let s=(r>>>0).toString(16);return s.length%2?"0"+s:s}var qE=class{constructor(e){A(this,"$element"),A(this,"stylesheetClasses"),A(this,"activeStylesheetClasses"),A(this,"sheetsDidUpdate"),A(this,"sheetPrefix"),A(this,"stylesheetEntries"),this.sheetPrefix=(e==null?void 0:e.sheetPrefix)||"a-",this.$element=document.createElement("style"),this.stylesheetClasses=[],this.activeStylesheetClasses=[],this.sheetsDidUpdate=!1,this.stylesheetEntries={}}getElement(){return this.$element}addStylesheet(e){let t=e.replace(/\s\s+/g," ").replace(/: /g,":").replace(/; /g,";").trim(),n=this.sheetPrefix+rm(t,!0);return this.stylesheetClasses.indexOf(n)!==-1||(this.stylesheetClasses.push(n),this.activeStylesheetClasses.push(n),this.stylesheetEntries[n]=t,this.sheetsDidUpdate=!0),n}removeStylesheet(e){let t=this.sheetPrefix+rm(e,!0);this.stylesheetClasses.indexOf(t)&&(this.stylesheetClasses=this.stylesheetClasses.filter(n=>n!==t)),this.sheetsDidUpdate=!0}clearClasses(){this.activeStylesheetClasses=[]}didUpdateActive(){if(this.activeStylesheetClasses.length){for(let e of this.activeStylesheetClasses)if(this.stylesheetClasses.indexOf(e)===-1)return!0;for(let e of this.stylesheetClasses)if(this.activeStylesheetClasses.indexOf(e)===-1)return!0}return!1}updateSheet(){(this.sheetsDidUpdate||this.didUpdateActive())&&(this.$element.innerText=this.activeStylesheetClasses.map(e=>`.${e}{${this.stylesheetEntries[e]}}`).join(""),this.sheetsDidUpdate=!1,this.stylesheetClasses=[...this.activeStylesheetClasses])}},QE=class{constructor(t,n){A(this,"htmlContainer"),A(this,"visible",[]),A(this,"previousVisible",[]),A(this,"htmlIds",[]),A(this,"firstMeaningfulPaint",!1),A(this,"rendererPosition"),A(this,"stylesheet"),A(this,"options"),A(this,"paintTx",1),A(this,"zIndex",0),A(this,"classes"),this.htmlContainer=t,this.htmlContainer.innerHTML="",this.rendererPosition=this.htmlContainer.getBoundingClientRect(),this.options={triggerResize:()=>{},box:!1,text:!1,sheetPrefix:"",inlineStyles:!1,background:"",...n||{}},this.stylesheet=new qE({sheetPrefix:this.options.sheetPrefix}),this.options.inlineStyles||this.htmlContainer.appendChild(this.stylesheet.getElement()),this.options.background&&this.htmlContainer.classList.add(this.stylesheet.addStylesheet(`
        background: ${this.options.background};
      `)),this.classes={hostClassName:this.stylesheet.addStylesheet(`
        position: absolute;
        transform-origin: 0px 0px;
      `),interactive:this.stylesheet.addStylesheet("pointer-events: all"),nonInteractive:this.stylesheet.addStylesheet("pointer-events: none")},this.stylesheet.updateSheet()}createHtmlHost(t){if(this.htmlContainer&&(this.options.box||t.props.className||t.props.html||t.props.href)){let n=document.createElement(t.props.href?"a":"div");if(t.props.href){n.style.display="block",n.href=t.props.href;let r=t.props.hrefTarget||"_blank";n.target=r,r!=="_self"&&(n.rel="noopener noreferrer")}n.title=t.props.title||"",this.options.inlineStyles?(n.style.display="block",n.style.position="absolute",n.style.overflow="hidden",n.style.transformOrigin="0px 0px"):n.classList.add(this.classes.hostClassName),t.__host={element:n,revision:null,relative:!1},this.updateHtmlHost(t,t.width,t.height),t.__onCreate&&t.__onCreate()}}triggerResize(){this.options.triggerResize()}updateHtmlHost(t,n,r){if(t.__revision!==t.__host.revision){let i=t.__host.element,s=[this.classes.hostClassName];if(t.props.interactive?this.options.inlineStyles?i.style.pointerEvents="all":s.push(this.classes.interactive):this.options.inlineStyles?i.style.pointerEvents="none":s.push(this.classes.nonInteractive),t.props.href){i.style.display="block",i.href=t.props.href;let u=t.props.hrefTarget||"_blank";i.target=u,u!=="_self"?i.rel="noopener noreferrer":i.rel=""}else i.href&&i.removeAttribute("href");if(t.props.title&&(i.title=t.props.title||""),t.props.className&&(s.push(t.props.className),t.hovering&&s.push(`${t.props.className}--hover`),t.pressing&&s.push(`${t.props.className}--active`)),t.props.relativeStyle?(i.style.width=`${n||t.width}px`,i.style.height=`${r||t.height}px`):(i.style.width=`${t.width}px`,i.style.height=`${t.height}px`),t.props.style){Object.assign(i.style,t.props.style||{},t.hovering?t.props.hoverStyles||{}:{},t.pressing?t.props.pressStyles||{}:{});return}if(this.options.text&&t instanceof Uc){t.text&&(i.innerText=t.text),t.backgroundColor&&(i.style.backgroundColor=t.backgroundColor),t.color&&(i.style.color=t.color),t.props.font&&(i.style.font=t.props.font),t.props.textAlign&&(i.style.textAlign=t.props.textAlign),t.__host.revision=t.__revision;let u=s.join(" ");i.className=u,i.part=u}t instanceof aa&&(this.options.box||t.props.className||t.props.html)&&(t.props.backgroundColor&&(i.style.backgroundColor=t.props.backgroundColor),t.props.border!==i.style.border&&(i.style.border=t.props.border));let o=s.join(" ");i.className=o,i.part=o}}afterFrame(t,n,r){this.stylesheet.updateSheet();for(let i of this.previousVisible)this.visible.indexOf(i)===-1&&this.htmlContainer&&i.__id&&this.htmlIds.indexOf(i.__id)!==-1&&this.htmlContainer.removeChild(i.__host.element);this.previousVisible=this.visible}afterPaintLayer(t,n){}beforeFrame(t,n,r){this.stylesheet.clearClasses(),this.paintTx++,this.zIndex=0,this.visible=[]}getPointsAt(t,n,r,i){return t.getPointsAt(n,r,i)}getScale(t,n){let r=this.rendererPosition.width/t,i=this.rendererPosition.height/n;return r<i?i:r}getViewportBounds(t,n,r){return null}isReady(){return!1}paint(t,n,r,i,s,o){if(this.zIndex++,(this.options.text&&t instanceof Uc||t instanceof aa&&(this.options.box||t.props.className||t.props.html))&&t.__host.tx!==this.paintTx&&(this.visible.push(t),t.__host.tx=this.paintTx,this.htmlContainer)){this.updateHtmlHost(t,s,o);let u=s/t.width,d=t.__host.element;d.style.zIndex=`${this.zIndex}`,t.props.relativeStyle?d.style.transform=`translate(${Math.round(r)}px, ${Math.round(i)}px)`:d.style.transform=`translate(${Math.round(r)}px, ${Math.round(i)}px) scale(${u})`,this.previousVisible.indexOf(t)===-1&&this.htmlContainer.appendChild(d),this.htmlIds.indexOf(t.__id)===-1&&this.htmlIds.push(t.__id)}}pendingUpdate(){return!1}prepareLayer(t){t.__host||(t instanceof Uc||t instanceof aa)&&this.createHtmlHost(t)}resize(t,n){typeof t<"u"&&typeof n<"u"&&(this.htmlContainer.style.width=`${t}px`,this.htmlContainer.style.height=`${n}px`),this.rendererPosition=this.htmlContainer.getBoundingClientRect()}getRendererScreenPosition(){return this.rendererPosition}finishLayer(){}reset(){}},YE=class Wc{constructor(t,n,r){A(this,"element"),A(this,"runtime"),A(this,"unsubscribe"),A(this,"activatedEvents",[]),A(this,"eventHandlers",[]),A(this,"bounds"),A(this,"listening"),A(this,"pointerMoveEvent"),A(this,"pointerEventState",{isClicking:!1,isDragging:!1,isPressed:!1,mousedOver:[],itemsBeingDragged:[],mouseDownStart:{x:0,y:0},lastTouches:[]}),A(this,"options"),A(this,"_realPointerMove",s=>{this.pointerMoveEvent=s}),A(this,"onWheelEvent",s=>{s.preventDefault(),this.onPointerEvent(s)}),A(this,"onContextMenu",s=>{s.preventDefault();let o="onContextMenu";if(this.runtime.world.activatedEvents.indexOf(o)!==-1){let{x:u,y:d}=this.runtime.viewerToWorld(s.clientX-this.bounds.left,s.clientY-this.bounds.top);this.assignToEvent(s,u,d),this.runtime.world.propagatePointerEvent(o,s,u,d)}}),A(this,"onTouchEvent",s=>{let o=Zo[s.type],u=[],d=s.touches.length;for(let h=0;h<d;h++){let c=s.touches.item(h);if(!c)continue;let{x:p,y:m}=this.runtime.viewerToWorld(c.clientX-this.bounds.left,c.clientY-this.bounds.top),w={id:c.identifier,x:p,y:m};u.push(w)}u.length&&this.assignToEvent(s,u[0].x,u[0].y),o!=="onTouchEnd"?(this.pointerEventState.lastTouches=u,s.atlasTouches=u,this.runtime.world.propagateTouchEvent(o,s,u)):(s.atlasTouches=[],this.runtime.world.propagateTouchEvent(o,s,this.pointerEventState.lastTouches),this.pointerEventState.lastTouches=[])}),A(this,"onPointerEvent",s=>{if(s.button===2)return;let o=Zo[s.type];if(o&&this.runtime.world.activatedEvents.indexOf(o)!==-1){let{x:u,y:d}=this.runtime.viewerToWorld(s.clientX-this.bounds.left,s.clientY-this.bounds.top);this.assignToEvent(s,u,d),this.runtime.world.propagatePointerEvent(o,s,u,d)}}),A(this,"onPointerDown",s=>{s.button!==2&&(this.pointerEventState.isPressed=!0,this.pointerEventState.isClicking=!0,this.pointerEventState.mouseDownStart.x=s.clientX,this.pointerEventState.mouseDownStart.y=s.clientY,setTimeout(()=>{this.runtime&&(this.pointerEventState.isClicking=!1)},250),setTimeout(()=>{if(this.runtime&&this.pointerEventState.isPressed&&!this.pointerEventState.isDragging){let o=this.runtime.viewerToWorld(this.pointerEventState.mouseDownStart.x-this.bounds.left,this.pointerEventState.mouseDownStart.y-this.bounds.top);this.pointerEventState.isDragging=!0,this.pointerEventState.itemsBeingDragged=this.runtime.world.propagatePointerEvent("onDragStart",s,o.x,o.y)}},800),this.onPointerEvent(s))}),A(this,"onPointerUp",s=>{if(s.button!==2){if(this.pointerEventState.isClicking){let{x:o,y:u}=this.runtime.viewerToWorld(s.clientX-this.bounds.left,s.clientY-this.bounds.top);this.assignToEvent(s,o,u),this.runtime.world.propagatePointerEvent("onClick",s,o,u)}if(this.pointerEventState.isDragging){for(let o of this.pointerEventState.itemsBeingDragged)o.dispatchEvent("onDragEnd",s);this.pointerEventState.isDragging=!1}this.pointerEventState.isClicking=!1,this.pointerEventState.isPressed=!1,this.pointerEventState.itemsBeingDragged=[],this.onPointerEvent(s)}}),A(this,"onPointerMove",s=>{this.pointerMoveEvent=void 0;let{x:o,y:u}=this.runtime.viewerToWorld(s.clientX-this.bounds.left,s.clientY-this.bounds.top);if(Number.isNaN(o)||Number.isNaN(u))return;this.assignToEvent(s,o,u),this.runtime.world.propagatePointerEvent("onPointerMove",s,o,u);let d=this.runtime.world.propagatePointerEvent("onMouseMove",s,o,u),h=[],c=[];for(let p of d)h.push(p.id),c.push(p),this.pointerEventState.mousedOver.indexOf(p)===-1&&(p.dispatchEvent("onMouseEnter",s),p.dispatchEvent("onPointerEnter",s),p.dispatchEvent("onMouseOver",s),p.dispatchEvent("onPointerOver",s));for(let p of this.pointerEventState.mousedOver)h.indexOf(p.id)===-1&&(p.dispatchEvent("onMouseLeave",s),p.dispatchEvent("onPointerLeave",s),p.dispatchEvent("onMouseOut",s),p.dispatchEvent("onPointerOut",s));if(this.pointerEventState.isDragging)for(let p of this.pointerEventState.itemsBeingDragged)p.dispatchEvent("onDrag",s);if(this.pointerEventState.isPressed&&!this.pointerEventState.isDragging&&xd(this.pointerEventState.mouseDownStart,{x:s.clientX,y:s.clientY})>50){let p=this.runtime.viewerToWorld(this.pointerEventState.mouseDownStart.x-this.bounds.left,this.pointerEventState.mouseDownStart.y-this.bounds.top);this.pointerEventState.isDragging=!0,this.pointerEventState.itemsBeingDragged=this.runtime.world.propagatePointerEvent("onDragStart",{...s,atlas:{x:p.x,y:p.y}},p.x,p.y)}this.pointerEventState.mousedOver=c}),this.element=t,this.runtime=n,this.unsubscribe=n.world.addLayoutSubscriber(this.layoutSubscriber.bind(this)),this.bounds=t.getBoundingClientRect(),this.listening=!1,this.options={simulationRate:0,...r||{}};let i=0;n.registerHook("useFrame",s=>{i+=s,i>this.options.simulationRate&&this.pointerMoveEvent&&(i=0,n.updateNextFrame())}),n.registerHook("useBeforeFrame",()=>{this.pointerMoveEvent&&this.onPointerMove(this.pointerMoveEvent)}),this.activateEvents()}updateBounds(){this.bounds=this.element.getBoundingClientRect(),this.runtime.updateRendererScreenPosition()}layoutSubscriber(t){t==="event-activation"&&this.listening==!1&&this.activateEvents()}assignToEvent(t,n,r){Wc.eventPool.atlas.x=n,Wc.eventPool.atlas.y=r,t.atlas=Wc.eventPool.atlas}activateEvents(){this.listening=!0,this.element.addEventListener("pointermove",this._realPointerMove),this.element.addEventListener("pointerup",this.onPointerUp),this.element.addEventListener("pointerdown",this.onPointerDown),this.element.addEventListener("mousedown",this.onPointerEvent),this.element.addEventListener("mouseup",this.onPointerEvent),this.element.addEventListener("pointercancel",this.onPointerEvent),this.element.addEventListener("wheel",this.onWheelEvent),this.element.addEventListener("contextmenu",this.onContextMenu),this.element.addEventListener("touchstart",this.onTouchEvent),this.element.addEventListener("touchcancel",this.onTouchEvent),this.element.addEventListener("touchend",this.onTouchEvent),this.element.addEventListener("touchmove",this.onTouchEvent)}normalizeEventName(t){return t.startsWith("on")?t.slice(2).toLowerCase():t.toLowerCase()}stop(){this.listening=!1,this.element.removeEventListener("pointermove",this._realPointerMove),this.element.removeEventListener("pointerup",this.onPointerUp),this.element.removeEventListener("pointerdown",this.onPointerDown),this.element.removeEventListener("mousedown",this.onPointerEvent),this.element.removeEventListener("mouseup",this.onPointerEvent),this.element.removeEventListener("pointercancel",this.onPointerEvent),this.element.removeEventListener("wheel",this.onWheelEvent),this.element.removeEventListener("touchstart",this.onTouchEvent),this.element.removeEventListener("touchcancel",this.onTouchEvent),this.element.removeEventListener("touchend",this.onTouchEvent),this.element.removeEventListener("touchmove",this.onTouchEvent),this.unsubscribe();for(let[t,n]of this.eventHandlers)this.element.removeEventListener(this.normalizeEventName(t),n)}};A(YE,"eventPool",{atlas:{x:0,y:0}});var XE=YE;function KE({interactive:e=!0,viewport:t,forceRefresh:n,canvasElement:r,overlayElement:i,controllerConfig:s,unstable_webglRenderer:o,dpi:u,debug:d,canvasBox:h=!0,polygon:c=!0,navigatorElement:p,runtimeOptions:m}){if(!r)throw new Error("Invalid container");r.style.userSelect="none";let w=e?BE({minZoomFactor:.5,maxZoomFactor:3,enableClickToZoom:!1,parentElement:r,...s||{}}):void 0,y=new DE([o?new BM(r,{dpi:u}):new RM(r,{dpi:u,debug:d,box:h,polygon:c}),i?new QE(i,{box:o||!h,text:!0,triggerResize:n}):void 0,p?new IM(p):void 0]),S=new df(y,new cf(1024,1024),t,w?[w]:[],m),C=new XE(r,S);return{name:"default-preset",em:C,runtime:S,renderer:y,controller:w,canvas:r,navigator:p,unmount(){Sy(S),S.stopControllers(),S.stop(),S.reset(),C&&C.stop()}}}var Oi=1+Number.MIN_VALUE,UM=class{constructor(e,t){A(this,"container"),A(this,"width"),A(this,"height"),A(this,"pending",!0),A(this,"options"),A(this,"stylesheet"),A(this,"zIndex",0),A(this,"lastKnownScale",1),A(this,"rendererPosition"),A(this,"currentlyVisible",[]),A(this,"previouslyVisible",[]),this.container=e,this.rendererPosition=e.getBoundingClientRect();let{width:n,height:r}=this.rendererPosition;this.width=n,this.height=r,this.options={addPart:!1,setDraggableFalse:!1,imageClass:"",widthStylesheet:!1,sheetPrefix:"position-",background:"#000",...t||{}},this.stylesheet=new qE({sheetPrefix:this.options.sheetPrefix}),this.container.classList.add(this.stylesheet.addStylesheet(`
        background: ${this.options.background};
      `)),this.options.widthStylesheet&&this.container.appendChild(this.stylesheet.getElement())}isReady(){return!0}resize(){this.rendererPosition=this.container.getBoundingClientRect(),this.width=this.rendererPosition.width,this.height=this.rendererPosition.height}getRendererScreenPosition(){return this.rendererPosition}afterFrame(e,t,n){this.stylesheet.updateSheet();for(let r of this.previouslyVisible)this.currentlyVisible.indexOf(r)===-1&&this.container.removeChild(r);for(let r of this.currentlyVisible)this.previouslyVisible.indexOf(r)===-1&&this.container.appendChild(r);this.previouslyVisible=this.currentlyVisible,this.currentlyVisible=[]}afterPaintLayer(e,t){}beforeFrame(e,t,n){this.stylesheet.clearClasses(),this.zIndex=0}getPointsAt(e,t,n,r){return e.getPointsAt(t,n,r)}getScale(e,t){if(Number.isNaN(e)||Number.isNaN(t))return this.lastKnownScale;let n=this.width/e,r=this.height/t,i=n<r?r:n;return Number.isNaN(i)||(this.lastKnownScale=i),this.lastKnownScale}getViewportBounds(e,t,n){return null}createImage(){let e=document.createElement("img");return this.options.imageClass?(e.className=this.options.imageClass,this.options.addPart&&e.setAttribute("part",this.options.imageClass)):(e.style.position="absolute",e.style.pointerEvents="none",e.style.userSelect="none"),this.options.setDraggableFalse&&e.setAttribute("draggable","false"),e}paint(e,t,n,r,i,s){if(this.pending=!1,this.zIndex++,e instanceof rs){if(!e.__host){let u=this.createImage();u.src=e.uri,e.__host=u,this.container.appendChild(e.__host)}let o=e.__host;this.currentlyVisible.push(o),o.style.zIndex=`${this.zIndex}`,o.style.opacity=`${e.style.opacity}`,this.options.widthStylesheet?o.className=this.options.imageClass+" "+this.stylesheet.addStylesheet(`width:${(i+Oi).toFixed(2)}px;height:${(s+Oi).toFixed(2)}px;`):(o.style.width=`${i+Oi}px`,o.style.height=`${s+Oi}px`),o.style.transform=`translate(${n}px, ${r}px)`}if(e instanceof La){if(e.__host||(e.__host={images:[]}),!e.__host.images[t]){let u=e.getImageUrl(t),d=this.createImage();d.src=u,e.__host.images[t]=d,this.container.appendChild(d)}let o=e.__host.images[t];o.style.zIndex=`${this.zIndex}`,o.style.opacity=`${e.style.opacity}`,this.currentlyVisible.push(o),this.options.widthStylesheet?o.className=this.options.imageClass+" "+this.stylesheet.addStylesheet(`width:${(i+Oi).toFixed(2)}px;height:${(s+Oi).toFixed(2)}px;`):(o.style.width=`${i+Oi}px`,o.style.height=`${s+Oi}px`),o.style.transform=`translate(${n}px, ${r}px)`}}pendingUpdate(){return this.pending}prepareLayer(e){}finishLayer(e){}reset(){}};function WM({interactive:e,viewport:t,forceRefresh:n,containerElement:r,overlayElement:i,controllerConfig:s}){if(!r)throw new Error("Invalid container");r.style.userSelect="none";let o=e?BE({minZoomFactor:.5,maxZoomFactor:3,enableClickToZoom:!1,parentElement:r,...s||{}}):void 0,u=new UM(r,{addPart:!1,setDraggableFalse:!1,imageClass:"atlas-static-image"}),d=i?new DE([u,new QE(i,{box:!0,text:!0,triggerResize:n})]):u,h=new df(d,new cf(1024,1024),t,o?[o]:[]),c=new XE(r,h);return{name:"static-preset",em:c,runtime:h,renderer:d,controller:o,container:r,overlay:i,unmount(){Sy(h),h.stopControllers(),h.stop(),c&&c.stop()}}}var HM={"default-preset":KE,"static-preset":WM},VM={};function qM(e,t){let n=b.useRef(),r=b.useRef(),i=b.useRef(),s=b.useRef(),o=b.useRef({width:t.width,height:t.height,didUpdate:!0}),[u="default-preset",d=VM]=Array.isArray(e)?e||[]:[e],[h,c]=b.useState(null);b.useLayoutEffect(()=>{let m=r.current,w=s.current,y=n.current,S=i.current,C=(HM[u]||KE)({containerElement:w,canvasElement:m,overlayElement:y,navigatorElement:S,viewport:o.current,dpi:window.devicePixelRatio||1,forceRefresh:t.forceRefresh,unstable_webglRenderer:t.unstable_webglRenderer,...d||{}});return c(C),()=>{C&&(C.unmount(),m&&(m.height=0,m.width=0),y&&(y.innerHTML=""),S&&(S.height=0,S.width=0))}},[u,d]);let p=b.useMemo(()=>({canvas:r,overlay:n,container:s,navigator:i}),[]);return[u,h,o,p]}function QM(e){return b.useMemo(()=>rm(e),e)}var ql=at.forwardRef((e,t)=>E.jsx("div",{...e,ref:t,part:e.className})),xw=["brightness","contrast","grayscale","hueRotate","invert","saturate","sepia","blur"],YM=({htmlChildren:e,renderPreset:t,onCreated:n,mode:r="explore",resetWorldOnChange:i=!0,unstable_webglRenderer:s=!1,unstable_noReconciler:o=!1,hideInlineStyle:u=!1,controllerConfig:d,children:h,overlayStyle:c,containerStyle:p,enableNavigator:m,className:w,containerProps:y={},homePosition:S,homeOnResize:C,homeCover:x,background:k,runtimeOptions:T,debug:_,filters:R,...O})=>{let[F,z]=b.useState(r),[J,j]=b.useState(!1),H=b.useRef(!1),V=b.useMemo(()=>(typeof t=="string"&&(t=[t,{}]),_?t?[t[0],{debug:_,...t[1]||{}}]:["default-preset",{debug:_}]:t||"default-preset"),[t,_]),[ne,Y,de]=oE({scroll:!0}),se=b.useRef(),ve=ye=>{se.current=ye,ne(ye)},[M,L,W,le]=qM(V,{width:O.width,height:O.height,forceRefresh:de,unstable_webglRenderer:s}),[we,je]=b.useState("");b.useEffect(()=>{z(r)},[r]),b.useEffect(()=>{L&&L.em&&L.em.updateBounds()},[L,Y]),b.useEffect(()=>{L==null||L.runtime.setOptions(T||{})},[T]),b.useEffect(()=>{L&&L.runtime&&(L.runtime.mode=F),J&&L&&(L.ready=!0)},[L,J,F]),b.useEffect(()=>{L&&(x||(L.runtime.manualHomePosition=!!S,L.runtime.setHomePosition(S)))},[L,x,S]),b.useEffect(()=>{if(L){let ye=L.runtime;ye.resize(W.current.width,O.width,W.current.height,O.height),W.current.width=O.width,W.current.height=O.height,ye.updateNextFrame(),W.current.didUpdate=!0}},[L,O.width,O.height]),b.useEffect(()=>{if(R&&L){let ye=L.runtime,ae=!1;ye.hookOptions.enableFilters=!0;for(let $e of xw)R[$e]?R[$e]!==L.runtime.hookOptions.filters[$e]&&(ye.hookOptions.filters[$e]=R[$e],ae=!0):ye.hookOptions.filters[$e]&&(ye.hookOptions.filters[$e]=0,ae=!0);ae&&ye.updateNextFrame()}else if(L){let ye=L.runtime;for(let ae of xw)ye.hookOptions.filters[ae]=0;ye.hookOptions.enableFilters=!1,ye.updateNextFrame()}},[L,R]),ca(()=>{if(L&&(L.overlay&&(L.overlay.style.width=`${Y.width}px`,L.overlay.style.height=`${Y.height}px`),L.container&&(L.container.style.width=`${Y.width}px`,L.container.style.height=`${Y.height}px`),x)){let ye=L.runtime.world.width,ae=L.runtime.world.height,$e=ye/ae,Mt=W.current.width,un=W.current.height,Ht=Mt/un;if($e>Ht){Ht=un/Mt,L.runtime.manualHomePosition=!0;let bt=(ye-ae/Ht)/2;x==="start"&&(bt=0),x==="end"&&(bt=ye-ae/Ht),L.runtime.setHomePosition({x:bt,y:0,width:ae/Ht,height:ae})}else{let bt=(ae-ye/Ht)/2;x==="start"&&(bt=0),x==="end"&&(bt=ae-ye/Ht),L.runtime.manualHomePosition=!0,L.runtime.setHomePosition({x:0,y:bt,width:ye,height:ye/Ht})}C&&L.runtime.goHome({})}},[L,Y.height,Y.width,x]),ca(()=>{let ye=()=>{if(L){let ae=L.runtime;W.current.width!==O.width&&W.current.height!==O.height&&(ae.resize(W.current.width,O.width,W.current.height,O.height),W.current.width=O.width,W.current.height=O.height,ae.updateNextFrame(),W.current.didUpdate=!0)}};return window.addEventListener("resize",ye),()=>window.removeEventListener("resize",ye)},[L,O.height,O.width]);let Re={width:120},be=()=>{if(L&&L.navigator){let ye=L.runtime.world.height,ae=L.runtime.world.width,$e=window.devicePixelRatio||1,Mt=Re.width,un=Re.width/ae*ye;L.navigator.width=Mt*$e,L.navigator.height=un*$e,L.navigator.style.width=Mt+"px",L.navigator.style.height=un+"px"}};ca(()=>{if(L){be();let ye=L.runtime;return ye.world.addLayoutSubscriber(ae=>{ae==="recalculate-world-size"&&(be(),ye.resize(W.current.width,O.width,W.current.height,O.height))})}return()=>{}},[L,O.width,O.height]);let Ie=b.useCallback(function(ye){let ae=()=>{j(!0)};return b.useEffect(()=>{if(L){L.runtime.goHome();let $e=n&&n(L);return void($e&&$e.then?$e.then(ae):ae())}else throw new Error("Invalid configuration - no runtime found")},[]),ye.children},[L]);b.useEffect(()=>{if(L){let ye=L.runtime;if(i)return ye.world.addLayoutSubscriber(ae=>{ae==="recalculate-world-size"&&ye.goHome()})}return()=>{}},[L,i]),b.useEffect(()=>L?L.runtime.registerHook("useBeforeFrame",()=>{var ye;if(W.current.didUpdate&&L.canvas){let ae=window.devicePixelRatio||1,$e=W.current.width,Mt=W.current.height;L.canvas.width=$e*ae,L.canvas.height=Mt*ae,L.canvas.style.width=$e+"px",L.canvas.style.height=Mt+"px",(ye=L.canvas.getContext("2d"))==null||ye.scale(ae,ae),L&&L.em&&L.em.updateBounds(),W.current.didUpdate=!1}}):()=>{},[L,i]),b.useEffect(()=>{let ye=()=>{L&&(z("sketch"),je("mode-sketch")),window.removeEventListener("keyup",ye)},ae=$e=>{var Mt,un,Ht;if($e.code==="Space"&&L&&L.runtime.mode==="sketch"){let bt=(un=(Mt=$e.target)==null?void 0:Mt.tagName)==null?void 0:un.toLowerCase();if(bt==="input"||bt==="textarea"||(Ht=$e.target)!=null&&Ht.isContentEditable)return;$e.preventDefault(),z("explore"),je("mode-explore"),window.addEventListener("keyup",ye)}};return window.addEventListener("keydown",ae),()=>{window.removeEventListener("keydown",ae),window.removeEventListener("keyup",ye)}},[L]),H.current=!0;let{height:Ke,width:ln,...an}=O,xt=QM([O.width,O.height]),Ne=!0;return V&&Array.isArray(V)&&V.length>1&&V[1].interactive===!1&&(Ne=!1),k=k??"#000",se.current&&(k=getComputedStyle(se.current).getPropertyValue("--atlas-background")||k),E.jsxs(ql,{ref:ve,className:["atlas",u?"":`atlas-width-${xt}`,we,w,`atlas-${M}`].filter(Boolean).join(" ").trim(),style:{...p,...u?{}:{width:O.width,height:O.height}},children:[M==="static-preset"?E.jsx(ql,{className:"atlas-static-container",ref:le.container,tabIndex:0,...y}):E.jsx("canvas",{className:"atlas-canvas",part:"atlas-canvas",tabIndex:0,...an,...y,ref:le.canvas,"data-background":k}),E.jsx(ql,{className:["atlas-overlay",Ne?"atlas-overlay--interactive":""].filter(Boolean).join(" ").trim(),style:{...c||{}},ref:le.overlay,children:o?E.jsx(Ie,{children:E.jsx(ff.Provider,{value:Y,children:E.jsx(Qa.Provider,{value:F,children:E.jsx(Ya.Provider,{value:L,children:h})})})}):E.jsx(DM,{bounds:Y,preset:L,mode:F,setIsReady:j,onCreated:n,children:h})}),m?E.jsx(ql,{className:"atlas-navigator",children:E.jsx("canvas",{className:"atlas-navigator-canvas",part:"atlas-navigator-canvas",ref:le.navigator})}):null,u?E.jsx("style",{children:`.atlas-width-${xt} { width: ${O.width}px; height: ${O.height}px; }`}):E.jsx("style",{children:`
        .atlas { position: relative; display: flex; background: ${k}; z-index: var(--atlas-z-index, 10); -webkit-touch-callout: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; }
        .atlas-width-${xt} { width: ${O.width}px; height: ${O.height}px; }
        .atlas-canvas { flex: 1 1 0px; }
        .atlas-canvas:focus, .atlas-static-container:focus { outline: none }
        .atlas-canvas:focus-visible, .atlas-canvas-container:focus-visible { outline: var(--atlas-focus, 2px solid darkorange) }
        .atlas-static-preset { touch-action: inherit; }
        .atlas-static-container { position: relative; overflow: hidden; flex: 1 1 0px; }
        .atlas-overlay { position: absolute; top: 0; left: 0; none; overflow: hidden; }
        /** setting the pointer events to none means that Atlas will own the touch and mousewheel events **/
        .atlas-overlay--interactive { pointer-events: none; }
        .atlas-static-image { position: absolute; user-select: none; transform-origin: 0px 0px; }
        .atlas-navigator { position: absolute; top: var(--atlas-navigator-top, 10px); right: var(--atlas-navigator-bottom, 10px); left: var(--atlas-navigator-left); bottom: var(--atlas-navigator-bottom); opacity: .8 }
        .atlas-navigator-canvas { width: 100%; }
      `}),e]})};function XM(e){return Number(e)==e?`${e}px`:e}var KM=({resizeHash:e,aspectRatio:t,containerProps:n={},...r})=>{let[i,s,o]=oE(),{height:u,width:d,...h}=r;b.useEffect(()=>{o()},[d,u,e,o]);let c=b.useMemo(()=>t?{width:s.width,height:s.width*(1/t)}:s,[s,t]);return E.jsxs(ql,{ref:i,className:"atlas-container",...n,children:[c.width?E.jsx(YM,{width:c.width||100,height:c.height||100,...h,children:r.children}):null,r.hideInlineStyle?null:E.jsx("style",{children:`
          .atlas-container { 
            display: var(--atlas-container-display, block);
            flex: var(--atlas-container-flex, none);
            width: var(--atlas-container-width, ${d?`${d}px`:"100%"});
            height: var(--atlas-container-height, ${XM(u||(t?c.height:512))})  
          }
      `}),r.htmlChildren]})},ky=()=>b.useContext(Ya),hf=()=>{let e=ky();return e?e.runtime:void 0},GE=(e,t=[])=>{let n=hf();b.useEffect(()=>n?n.registerHook("useFrame",e):()=>{},t)},GM=()=>{let e=ky();return e&&e.canvas?e.canvas:void 0};function ZM(){return b.useContext(ff)}async function JM(e,t,n){if(b.version.startsWith("18.")){let r=await Zx(()=>Promise.resolve().then(()=>pI),void 0),i=r.default?r.default.createRoot:r.createRoot;n.current||(n.current=i(e)),n.current.render(t)}else if(typeof ReactDOM<"u"){let{render:r,unmountComponentAtNode:i}=ReactDOM;r(t,e),n.current={unmount(){i(e)}}}else{let r=await Zx(()=>Promise.resolve().then(()=>hI),void 0),i=r.default?r.default.render:r.render,s=r.default?r.default.unmountComponentAtNode:r.unmountComponentAtNode;i(t,e),n.current={unmount(){s(e)}}}}var ai=at.forwardRef(({children:e,...t},n)=>{let r=b.useRef(),i=hf(),s=b.useRef(0),o=b.useRef(),u=b.useRef();return GE(()=>{var d,h,c,p;if(t.relative){let m=r.current;if(m&&i){let w=i.getScaleFactor();s.current!==w&&(s.current=w,m.style.transformOrigin="0 0",m.style.transform=`scale(${1/s.current})`,m.style.width=`${s.current*100}%`,m.style.height=`${s.current*100}%`,r.current&&((h=(d=o.current)==null?void 0:d.__owner.value)!=null&&h.rotation)&&(m.style.transform=`scale(${1/s.current}) translate(50%, 50%) rotate(${((p=(c=o.current)==null?void 0:c.__owner.value)==null?void 0:p.rotation)||0}deg)  translate(-50%, -50%)`))}}},[t.relative]),b.useLayoutEffect(()=>{let d=o.current;n&&d&&(typeof n=="function"?n(d):n.current=d);async function h(){if(d&&d.__host){let c=t.relative?E.jsx("div",{ref:r,children:e}):e;await JM(d.__host.element,c,u)}}d&&d.__host?h():d&&(d.__onCreate=h)},[n,e,o,t.relative]),b.useLayoutEffect(()=>()=>{u.current&&setTimeout(()=>{u.current.unmount()},0)},[]),E.jsx("box",{html:!0,...t,ref:o})});ai.displayName="HTMLPortal";var ww=(e,t,n=[])=>{let r=hf(),i=r?r.world:void 0;b.useEffect(()=>{if(r){let s=t,o=Zo[e];r.world.activatedEvents.push(o);let u=o.slice(2).toLowerCase();return r.world.addEventListener(u,s),()=>{r.world.removeEventListener(u,s)}}return()=>{}},[i,e,...n])};function Sw(e,t){if(e===0)return[0,1];if(t===0)return[1,0];let n=Math.abs(e)/Math.abs(t);return[n,1-n]}function eL(){let e=b.useRef({ctrl:!1,shift:!1,alt:!1});return b.useLayoutEffect(()=>{function t(r){r.key==="Shift"&&(e.current.shift=!0),r.key==="Control"&&(e.current.ctrl=!0),r.key==="Alt"&&(e.current.alt=!0)}function n(r){r.key==="Shift"&&(e.current.shift=!1),r.key==="Control"&&(e.current.ctrl=!1),r.key==="Alt"&&(e.current.alt=!1)}return window.addEventListener("keydown",t),window.addEventListener("keyup",n),()=>{window.removeEventListener("keydown",t),window.removeEventListener("keyup",n)}},[]),e}var tL=(e,t)=>{let n=jM(),r=hf(),i=ZM(),s=b.useRef(),o=b.useRef(null),u=b.useRef(),[d,h]=b.useState(!1),c=b.useRef(!1),p=b.useRef({north:0,south:0,east:0,west:0}),m=eL(),w=b.useCallback(k=>T=>{if(c.current=!0,h(!0),i&&r){let{top:_,left:R}=i,O=r.viewerToWorld(T.pageX-R,T.pageY-_);u.current={x:O.x,y:O.y},s.current=k}},[i,r]),y=b.useMemo(()=>e.width/e.height,[e.width,e.height]),S=b.useCallback(k=>{if(!Math.abs(k.north-k.south+(k.east-k.west)))return;let T=-k.west+k.east,_=-k.north+k.south,R=e.width+T,O=e.height+_;if(R/O>=y){let F=O*y,z=R-F,[J,j]=Sw(k.east,k.west);k.west=k.west+z*j,k.east=k.east-z*J}else{let F=R/y,z=O-F,[J,j]=Sw(k.north,k.south);k.north=k.north+z*J,k.south=k.south-z*j}},[e.width,e.height,y]);GE(()=>{u&&r&&r.updateNextFrame()}),b.useEffect(()=>{r&&r.updateNextFrame()},[r,d]);let C=b.useCallback(k=>{var J;if(!r||!i||r.mode!=="sketch")return;let{top:T,left:_}=i,R=r.viewerToWorld(k.pageX-_,k.pageY-T),O=o.current,F=!e.maintainAspectRatio&&m.current.alt,z=!F&&m.current.shift&&((J=s.current)==null?void 0:J.indexOf("-"))!==-1;if((s.current==="translate"||s.current==="east"||s.current==="north-east"||s.current==="south-east")&&(p.current.east=R.x-(u.current?u.current.x:0),F&&(p.current.west=-p.current.east)),(s.current==="translate"||s.current==="west"||s.current==="north-west"||s.current==="south-west")&&(p.current.west=R.x-(u.current?u.current.x:0),F&&(p.current.east=-p.current.west)),(s.current==="translate"||s.current==="north"||s.current==="north-east"||s.current==="north-west")&&(p.current.north=R.y-(u.current?u.current.y:0),F&&(p.current.south=-p.current.north)),(s.current==="translate"||s.current==="south"||s.current==="south-west"||s.current==="south-east")&&(p.current.south=R.y-(u.current?u.current.y:0),F&&(p.current.north=-p.current.south)),(e.maintainAspectRatio||z)&&S(p.current),O){let j=p.current.west,H=p.current.north,V=e.width+p.current.east,ne=e.height+p.current.south;O.points[1]=Math.min(j,V),O.points[2]=Math.min(H,ne),O.points[3]=Math.max(j,V),O.points[4]=Math.max(H,ne),r.updateNextFrame()}},[r,e.width,e.height,e.maintainAspectRatio,i]);ww("mousemove",C,[e.width,e.height,i]),ww("pointermove",C,[e.width,e.height,i]);let x=b.useRef();return b.useEffect(()=>{x.current=()=>{if(c.current){let k=p.current.west,T=p.current.north,_=e.width+p.current.east,R=e.height+p.current.south,O=Math.min(k,_),F=Math.min(T,R),z=Math.max(k,_),J=Math.max(T,R),j={x:(e.x||0)+O,y:(e.y||0)+F,width:z-O||1,height:J-F||1};e.maintainAspectRatio,t(j),s.current=void 0,u.current=void 0,p.current.east=0,p.current.west=0,p.current.north=0,p.current.south=0,c.current=!1,h(!1)}}},[t,e.height,e.width,e.x,e.y]),b.useEffect(()=>{let k=()=>{x.current&&x.current()};return window.addEventListener("pointerup",k),window.addEventListener("touchend",k),()=>{window.removeEventListener("pointerup",k),window.removeEventListener("touchend",k)}},[]),{portalRef:o,mode:n,mouseEvent:w,onPointerMoveCallback:C,isEditing:d}};function nL({handleSize:e,resizable:t,onSave:n,children:r,maintainAspectRatio:i,disableCardinalControls:s,...o}){let u=typeof e>"u"?i?10:8:e,{portalRef:d,mode:h,mouseEvent:c,isEditing:p}=tL({x:o.x||0,y:o.y||0,width:o.width,height:o.height,maintainAspectRatio:i},n),m=b.useMemo(()=>c("translate"),[c]),w=b.useMemo(()=>c("east"),[c]),y=b.useMemo(()=>c("west"),[c]),S=b.useMemo(()=>c("south"),[c]),C=b.useMemo(()=>c("north"),[c]),x=b.useMemo(()=>c("south-east"),[c]),k=b.useMemo(()=>c("south-west"),[c]),T=b.useMemo(()=>c("north-east"),[c]),_=b.useMemo(()=>c("north-west"),[c]),R=h==="sketch",O={zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.2)",border:"1px solid rgba(155,155,155,.7)",borderRadius:i||s?"50%":2,position:"absolute",background:"#fff",pointerEvents:p?"none":R?"initial":"none"};return E.jsx(E.Fragment,{children:E.jsxs("world-object",{...o,children:[r,R&&t?E.jsx(ai,{ref:d,target:{x:0,y:0,height:o.height,width:o.width},relative:!0,interactive:!1,children:R&&t?E.jsxs(E.Fragment,{children:[E.jsx("div",{onMouseDown:m,onTouchStart:m,style:{display:"block",width:"100%",height:"100%",position:"relative",border:"1px solid rgba(155,155,155, .7)",boxSizing:"border-box",pointerEvents:p?"none":R?"initial":"none"}}),i?null:E.jsxs(E.Fragment,{children:[E.jsx("div",{title:"east",onTouchStart:w,onMouseDown:w,style:{...O,cursor:"e-resize",height:u*2,width:u,right:0,top:"50%",opacity:s?0:1,transform:`translate(${u/2}px, -${u}px)`}}),E.jsx("div",{title:"west",onMouseDown:y,style:{...O,cursor:"w-resize",position:"absolute",height:u*2,width:u,left:0,top:"50%",opacity:s?0:1,transform:`translate(-${u/2}px, -${u}px)`}}),E.jsx("div",{title:"north",onMouseDown:C,style:{...O,cursor:"n-resize",position:"absolute",height:u,width:u*2,left:"50%",top:0,opacity:s?0:1,transform:`translate(-${u}px, -${u/2}px)`}}),E.jsx("div",{title:"south",onMouseDown:S,style:{...O,cursor:"s-resize",position:"absolute",height:u,width:u*2,left:"50%",bottom:0,opacity:s?0:1,transform:`translate(-${u}px, ${u/2}px)`}})]}),E.jsx("div",{title:"north-east",onMouseDown:T,style:{...O,cursor:"ne-resize",position:"absolute",height:u,width:u,right:0,top:0,transform:`translate(${u/2}px, -${u/2}px)`}}),E.jsx("div",{title:"south-east",onMouseDown:x,style:{...O,cursor:"se-resize",position:"absolute",height:u,width:u,bottom:0,right:0,transform:`translate(${u/2}px, ${u/2}px)`}}),E.jsx("div",{title:"south-west",onMouseDown:k,style:{...O,cursor:"sw-resize",position:"absolute",height:u,width:u,bottom:0,left:0,transform:`translate(-${u/2}px, ${u/2}px)`}}),E.jsx("div",{title:"north-west",onMouseDown:_,style:{...O,cursor:"nw-resize",position:"absolute",height:u,width:u,top:0,left:0,transform:`translate(-${u/2}px, -${u/2}px)`}})]}):null}):null]})})}function rL({interactive:e,region:t,onClick:n,onSave:r,maintainAspectRatio:i,disableCardinalControls:s,isEditing:o,rotation:u,style:d={backgroundColor:"rgba(0,0,0,.5)"}}){let h=b.useCallback(c=>{r({id:t.id,x:t.x,y:t.y,height:t.height,width:t.width,...c})},[r,t.id,t.x,t.y,t.height,t.width]);return E.jsx(nL,{x:t.x,y:t.y,rotation:u,width:t.width,height:t.height,resizable:o,onSave:h,maintainAspectRatio:i,disableCardinalControls:s,children:E.jsx("box",{interactive:e,onContextMenu:c=>{c.preventDefault(),console.log("menu!")},onClick:c=>{c.preventDefault(),c.stopPropagation(),n(t)},target:{x:0,y:0,width:t.width,height:t.height},style:d})})}function kw(e,t){return e?t?{...e,...t||{},":hover":e[":hover"]?Object.assign(e[":hover"]||{},t[":hover"]||{}):t[":hover"],":active":e[":active"]?Object.assign(e[":active"]||{},t[":active"]||{}):t[":hover"]}:e:t}function pf(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(i){i(n)}),(r=e.get("*"))&&r.slice().map(function(i){i(t,n)})}}}const iL=pf(),ZE=b.createContext(iL);function sL(){return b.useContext(ZE)}function Hc(e,t,n=[]){const r=b.useContext(ZE);b.useEffect(()=>{const i=s=>{t(s)};return r.on(e,i),()=>{r.off(e,i)}},[r,e,...n])}function oL(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(i){i(n)}),(r=e.get("*"))&&r.slice().map(function(i){i(t,n)})}}}function lL(e,t,n){let[r,i]=e,[s,o]=t,[u,d]=n,h=u-s,c=d-o,p=Math.sqrt(h*h+c*c);if(p===0)return{distance:Math.sqrt((r-s)**2+(i-o)**2),closestPoint:[s,o]};let m=Math.max(0,Math.min(1,((r-s)*h+(i-o)*c)/(p*p))),w=s+m*h,y=o+m*c,S=[w,y];return{distance:Math.sqrt((r-w)**2+(i-y)**2),closestPoint:S}}function aL(e,t,n,r){let[i,s]=e,[o,u]=t,[d,h]=n,[c,p]=r,m=(i-o)*(h-p)-(s-u)*(d-c);if(Math.abs(m)<1e-10)return null;let w=((i-d)*(h-p)-(s-h)*(d-c))/m,y=-((i-o)*(s-h)-(s-u)*(i-d))/m;if(w>=0&&w<=1&&y>=0&&y<=1){let S=i+w*(o-i),C=s+w*(u-s);return[S,C]}return null}function uL(e,t,n){let r=t.snapThreshold||15,i=[],[s,o]=e,u=t.polygon.points,d=t.slowState.transitionIntentType==="move-point";if(t.slowState.snapToPoints)for(let h=0;h<u.length;h++){if(d&&t.selectedPoints.includes(h))continue;let c=u[h];if(c[0]===s&&c[1]===o)continue;let p=c[0]-s,m=c[1]-o,w=Math.sqrt(p*p+m*m);w<=r&&i.push({type:"point",point:[c[0],c[1]],source:{pointIndex:h,polygon:t.polygon},distance:w})}if(t.slowState.snapToLines)for(let h=0;h<u.length;h++){if(d&&t.selectedPoints.includes(h))continue;let c=(h+1)%u.length;if(h===c)continue;let p=u[h],m=u[c],{distance:w,closestPoint:y}=lL(e,p,m);w<=r&&i.push({type:"line",point:y,source:{lineIndex:h,polygon:t.polygon},distance:w})}if(t.slowState.snapToIntersections&&u.length>=4)for(let h=0;h<u.length;h++){if(d&&t.selectedPoints.includes(h))continue;let c=(h+1)%u.length,p=u[h],m=u[c];for(let w=h+2;w<u.length;w++){if(d&&t.selectedPoints.includes(w))continue;let y=(w+1)%u.length;if(w===c||y===h)continue;let S=u[w],C=u[y],x=aL(p,m,S,C);if(x){let[k,T]=x,_=Math.sqrt((s-k)**2+(o-T)**2);_<=r&&i.push({type:"intersection",point:x,source:{lineIndex:h,polygon:t.polygon},distance:_})}}}if(t.slowState.snapToParallel)for(let h=0;h<u.length;h++){if(d&&t.selectedPoints.includes(h))continue;let c=u[h],[p,m]=c,w=Math.abs(o-m);w<=r&&i.push({type:"parallel",point:[s,m],source:{pointIndex:h,polygon:t.polygon},distance:w});let y=Math.abs(s-p);y<=r&&i.push({type:"parallel",point:[p,o],source:{pointIndex:h,polygon:t.polygon},distance:y})}return i.sort((h,c)=>h.distance-c.distance)}function cL(e){return e.sort((t,n)=>{let r=t.type==="point"?0:t.type==="intersection"?1:t.type==="parallel"?2:3,i=n.type==="point"?0:n.type==="intersection"?1:n.type==="parallel"?2:3;return r!==i?r-i:t.distance-n.distance})}function dL(e,t){var r,i;let n=[];for(let s of e)switch(s.type){case"point":n.push({type:"point",points:[s.point],target:s});break;case"line":if(((r=s.source)==null?void 0:r.lineIndex)!==void 0){let o=t.polygon.points,u=s.source.lineIndex,d=(u+1)%o.length,h=o[u],c=o[d];n.push({type:"line",points:[h,c,s.point],target:s})}else n.push({type:"point",points:[s.point],target:s});break;case"intersection":n.push({type:"cross",points:[s.point],target:s});break;case"parallel":if(((i=s.source)==null?void 0:i.pointIndex)!==void 0){let o=t.polygon.points[s.source.pointIndex];n.push({type:"parallel-line",points:[o,s.point],target:s})}break}return n}function Zi(e,t,n=5,r){if(!t.slowState.snapEnabled)return t.snapTargets=[],t.activeSnapGuides=[],t.isSnapping=!1,t.snapPoint=null,null;let i=uL(e,t);if(i.length===0)return t.snapTargets=[],t.activeSnapGuides=[],t.isSnapping=!1,t.snapPoint=null,null;let s=cL(i);return t.snapTargets=s,t.activeSnapGuides=dL(s.slice(0,n),t),t.isSnapping=!0,t.snapPoint=s[0].point,t.snapPoint}function JE(e){e.snapTargets=[],e.activeSnapGuides=[],e.isSnapping=!1,e.snapPoint=null}function fL(e){return e.isSnapping&&e.snapPoint!==null}function Xa(e,t){return fL(t)&&t.snapPoint?t.snapPoint:e}var hL={type:"add-open-point",label:"Add point",tools:["pen","line","lineBox"],trigger:{type:"click"},isValid(e,t,n){if(!t.isOpen)return!1;if(t.polygon.points.length===0)return!0;if(t.selectedPoints.length!==1||t.polygon.points.length>=2&&(t.slowState.currentTool==="line"||t.slowState.currentTool==="lineBox"))return!1;if(t.slowState.bounds){let{x:i,y:s,width:o,height:u}=t.slowState.bounds,[d,h]=e[0];if(d<i||d>i+o||h<s||h>s+u)return!1}let r=t.selectedPoints[0];return r===0||r===t.polygon.points.length-1},commit(e,t,n){let r=t.line?t.line[1]:e[0];!n.Shift&&t.slowState.snapEnabled&&(Zi(r,t,3),r=Xa(r,t));let i=t.polygon.points;if(i.length===0)return{selectedPoints:[0],points:[r]};n.Shift;let s=t.selectedPoints[0],o=t.slowState.currentTool==="line"||t.slowState.currentTool==="lineBox";if(s===0)return~~i[0][0]===~~r[0]&&~~i[0][1]===~~r[1]?{selectedPoints:[0],points:i}:{selectedPoints:o?[]:[0],points:[r,...i]};let u=i[i.length-1];return~~u[0]===~~r[0]&&~~u[1]===~~r[1]?{selectedPoints:[i.length-1],points:i}:(t.line=null,{selectedPoints:o?[]:[i.length],points:[...i,r]})}};function Pw(e,t){return Math.abs(e-t)}function Ln(e,t){let n=Pw(e[0],t[0]),r=Pw(e[1],t[1]);return Math.sqrt(n**2+r**2)}function im(e,t){return[e[0]-t[0],e[1]-t[1]]}function pL(e,t){return e[0]*t[0]+e[1]*t[1]}function eC(e){return e[0]*e[0]+e[1]*e[1]}function xc(e,t){return eC(im(e,t))}function tC(e,t,n,r){return r&&n&&(e<0?e=Math.max(e,-r.x-n.x):e>0&&(e=Math.min(e,r.x+r.width-n.x-n.width)),t<0?t=Math.max(t,-r.y-n.y):t>0&&(t=Math.min(t,r.y+r.height-n.y-n.height))),[e,t]}function nC(e,t){let n,r,i,s;var o=(y,S,C,x,k)=>{if(x<=C+1)return;let T=C,_=0,R=y*y;n=[S[C],S[x]],r=im(n[1],n[0]);let O=eC(r),F,z,J,j,H;for(let V=C+1;V<x;V++)F=im(S[V],n[0]),j=pL(F,r),j<=0?H=xc(S[V],n[0]):O<=j?H=xc(S[V],n[1]):(J=j/O,z=[n[0][0]+J*r[0],n[0][1]+J*r[1]],H=xc(S[V],z)),!(H<=_)&&(T=V,_=H);_>R&&(k[T]=1,o(y,S,C,T,k),o(y,S,T,x,k))};let u=e.length,d=[],h,c,p,m,w=t*t;for(i=[],s=[],i[0]=e[0],h=c=1,m=0;h<u;h++)xc(e[h],e[m])<w||(i[c++]=e[h],m=h);for(m<u-1&&(i[c++]=e[u-1]),s[0]=s[c-1]=1,o(t,i,0,c-1,s),h=p=0;h<c;h++)s[h]&&(d[p++]=i[h]);return d}function gL(e){if(e.length!==4)return!1;let t=1e-10,n=Math.min(...e.map(u=>u[0])),r=Math.max(...e.map(u=>u[0])),i=Math.min(...e.map(u=>u[1])),s=Math.max(...e.map(u=>u[1]));for(let u of e){let d=Math.abs(u[0]-n)<t||Math.abs(u[0]-r)<t,h=Math.abs(u[1]-i)<t||Math.abs(u[1]-s)<t;if(!d||!h)return!1}let o=[[n,i],[n,s],[r,i],[r,s]];for(let u of o)if(!e.some(d=>Math.abs(d[0]-u[0])<t&&Math.abs(d[1]-u[1])<t))return!1;return!0}function rC(e){let t=e.points.length,n=!1,r=[];if(t>1){e.iedges=[];let i=e.points[t-1];for(let s=0;s<t;s++){let o=i;if(i=e.points[s],i.length===6){let h=i[2],c=i[3],p=i[4],m=i[5];r.push([s,[i[0]+h,i[1]+c],[i[0]+p,i[1]+m]]),n=!0}let u=[i[0]-o[0],i[1]-o[1]],d=u[0]*u[0]+u[1]*u[1];d>0?e.iedges.push([u[0]/d,u[1]/d]):e.iedges.push([0,0])}}else t===1?e.iedges=[[0,0]]:e.iedges=null;e.isBezier=n,e.bezierLines=r}function mL(e,t){let n=1/0,r=null,i=-1,s=e.points.length;if(s<=1)return[null,n,i];let o=e.points[s-1];for(let u=0;u<s;u++){let d=o;o=e.points[u];let h=d[0]-t[0],c=d[1]-t[1],p=h*h+c*c;p<n&&(r=d,n=p,i=u===0?s-1:u-1)}return[r,n,i]}function kd(e){if(e.points.length>2){let t=Math.min(...e.points.map(s=>s[0])),n=Math.min(...e.points.map(s=>s[1])),r=Math.max(0,...e.points.map(s=>s[0])),i=Math.max(0,...e.points.map(s=>s[1]));e.boundingBox={x:t,y:n,width:r-t,height:i-n};return}e.boundingBox=null}function yL(e){return e[0]*e[0]+e[1]*e[1]}function Ew(e,t){let n=1/0,r=null,i=-1,s=[],o=e.points.length;if(o<=1)return[null,n,s,i];if(e.iedges===null&&(rC(e),!e.iedges))return[null,n,s,i];let u=e.points[o-1];for(let d=0;d<o;d++){let h=u;u=e.points[d];let c=(t[0]-h[0])*e.iedges[d][0]+(t[1]-h[1])*e.iedges[d][1],p;c<=0?p=h:c<1?p=[(1-c)*h[0]+c*u[0],(1-c)*h[1]+c*u[1]]:p=u;let m=yL([p[0]-t[0],p[1]-t[1]]);m<n&&(r=p,n=m,s=[h,u],i=d===0?o-1:d-1)}return[r,n,s,i]}var Ql={type:"bounding-box-corners",label:"Drag to resize",tools:["pointer","box"],modifiers:{Shift:"Maintain aspect ratio",Alt:"Scale from center",Meta:"Rotate"},isValid(e,t,n){if(t.transitionDirection=null,t.transitionRotate=!1,t.isOpen||!t.slowState.boxMode&&t.selectedPoints.length!==t.polygon.points.length||!t.polygon.boundingBox)return!1;let r=n.proximity*.5,i=n.proximity*5,s=e[0],o=t.polygon.boundingBox,u=o.x+r,d=o.x+o.width-r*2,h=o.y+r,c=o.y+o.height-r*2;if(s[0]>u&&s[0]<d&&s[1]>h&&s[1]<c)return!1;let p=[o.x+o.width,o.y+o.height],m=[o.x,o.y],w=[o.x+o.width,o.y],y=[o.x,o.y+o.height],S=["ne","nw","se","sw"],C={ne:w,nw:m,se:p,sw:y},x=[Ln(e[0],w),Ln(e[0],m),Ln(e[0],p),Ln(e[0],y)],k=Math.min(...x),T=x.indexOf(k),_=T===-1?null:S[T],R=_?C[_]:null;if(x[0]<i||x[1]<i||x[2]<i||x[3]<i){if(_){let[O,F]=s;(n.Meta||O>=R[0]-n.proximity*4&&F>=R[1]-n.proximity*4&&O<=R[0]+n.proximity*4&&F<=R[1]+n.proximity*4&&!(O>=R[0]-n.proximity*2&&F>=R[1]-n.proximity*2&&O<=R[0]+n.proximity*2&&F<=R[1]+n.proximity*2))&&(t.slowState.boxMode||(t.transitionRotate=!0)),t.transitionDirection=_}return!0}return!1},start(e,t,n){e[0];let r=t.polygon.boundingBox,i=[r.x+r.width,r.y+r.height],s=[r.x,r.y],o=[r.x+r.width,r.y],u=[r.x,r.y+r.height],d=["ne","nw","se","sw"],h=[Ln(e[0],o),Ln(e[0],s),Ln(e[0],i),Ln(e[0],u)],c=Math.min(...h),p=h.indexOf(c);t.transitionDirection=p!==-1?d[p]:null},transition(e,t,n){let r=t.polygon.boundingBox,i=t.transitionOrigin||e[0],[s,o]=e[0];if((n.Meta||t.transitionRotate)&&!t.slowState.boxMode){let k=[r.x+r.width/2,r.y+r.height/2],T=Math.atan2(i[1]-k[1],i[0]-k[0]),_=Math.atan2(o-k[1],s-k[0]),R=n.Shift,O=Math.PI/(n.Alt?4:12),F=_-T;R&&(F=Math.round(F/O)*O);let z=Math.cos(F),J=Math.sin(F),j=[];for(let H of t.polygon.points){let V=H[0]-k[0],ne=H[1]-k[1],Y=V*z-ne*J,de=V*J+ne*z,se=Y+k[0],ve=de+k[1];j.push(H.length===6?[se,ve,H[2],H[3],H[4],H[5]]:[se,ve])}t.transitionPoints=j,kd({points:j,boundingBox:null}),t.transitionBoundingBox=t.polygon.boundingBox?{...t.polygon.boundingBox,rotation:F}:null;return}let u=t.transitionDirection,d=u.includes("e")?1:-1,h=u.includes("s")?1:-1,c=!!n.Alt,p;if(c)p=[r.x+r.width/2,r.y+r.height/2];else switch(u){case"se":p=[r.x,r.y];break;case"sw":p=[r.x+r.width,r.y];break;case"ne":p=[r.x,r.y+r.height];break;case"nw":p=[r.x+r.width,r.y+r.height];break}let m=c?r.width/2:r.width,w=c?r.height/2:r.height,y,S;if(n.Shift||t.slowState.fixedAspectRatio){let k=d*m,T=h*w,_=s-p[0],R=o-p[1],O=k*k+T*T,F=O>0?(_*k+R*T)/O:1;F=Math.max(F,.01),y=F,S=F}else{let k=0,T=0;switch(u){case"se":k=s-i[0],T=o-i[1];break;case"sw":k=i[0]-s,T=o-i[1];break;case"ne":k=s-i[0],T=i[1]-o;break;case"nw":k=i[0]-s,T=i[1]-o;break}c&&(k*=2,T*=2),y=(r.width+k)/r.width,S=(r.height+T)/r.height}let C=[];for(let k of t.polygon.points){let T=k[0]-p[0],_=k[1]-p[1],R=T*y,O=_*S,F=R+p[0],z=O+p[1];C.push(k.length===6?[F,z,k[2],k[3],k[4],k[5]]:[F,z])}t.transitionPoints=C;let x={points:C,boundingBox:null};kd(x),t.transitionBoundingBox=x.boundingBox},commit(e,t,n){let r=t.transitionPoints;return t.transitionPoints=null,t.transitionBoundingBox=null,t.transitionRotate=!1,{points:r}}},vL={type:"close-line-box",label:"Close Line Box",tools:["lineBox"],trigger:{type:"click"},isValid(e,t,n){return t.polygon.points.length===2&&t.lineBox!==null&&t.slowState.boxMode===!1},commit(e,t,n){return t.lineBox?{isOpen:!1,points:t.lineBox,tool:"pen"}:{}}},iC={type:"close-shape",label:"Close shape",tools:["pen","line"],trigger:{type:"click"},isValid(e,t,n){if(!t.isOpen||t.slowState.boxMode||t.selectedPoints.length!==1||t.polygon.points.length<2||n.Meta)return!1;let r=t.selectedPoints[0];if(r===0){let i=t.polygon.points[t.polygon.points.length-1];return Ln(e[0],i)<n.proximity}if(r===t.polygon.points.length-1){let i=t.polygon.points[0];return Ln(e[0],i)<n.proximity}return!1},commit(e,t,n){let r=t.selectedPoints[0];if(t.line=null,r===0)return{selectedPoints:[],points:t.polygon.points.slice(0).reverse(),isOpen:!1};if(r===t.polygon.points.length-1)return{selectedPoints:[],isOpen:!1}}},xL={type:"close-shape-line",label:"Close shape line",trigger:{type:"click"},tools:["pen"],isValid(e,t,n){return!t.isOpen||t.slowState.boxMode||t.polygon.points.length<3||!t.closestLinePoint||t.closestLineDistance>=n.proximity*2?!1:(t.closestLineIndex===0||(t.closestLineIndex,t.polygon.points.length-2),!0)},commit(e,t,n){return iC.commit(e,t,n)}},sC={type:"split-line",label:"Split line",tools:["pen"],isValid(e,t,n){let r=t.slowState.currentTool==="line";return n.Meta||r?!1:!!(t.closestLinePoint&&t.closestLineDistance<n.proximity)},transition(e,t,n){let r=e[0];!n.Shift&&t.slowState.snapEnabled&&(Zi(r,t,3,t.closestLineIndex),r=Xa(r,t));let i=t.transitionOrigin||r,[s,o]=r,u=t.polygon.points,d=[],h=s-i[0],c=o-i[1];for(let p=0;p<u.length;p++)if(d.push(u[p]),t.closestLineIndex===p){let m=t.closestLinePoint;d.push([m[0]+h,m[1]+c])}t.transitionPoints=d},commit(e,t,n){let r=t.transitionPoints;return t.transitionPoints=null,t.transitionBoundingBox=null,{selectedPoints:[t.closestLineIndex+1],points:r}}},wL={type:"cut-line",label:"Add new point",tools:["pen"],trigger:{type:"click"},modifiers:{Shift:"Cut line"},isValid(e,t,n){return t.slowState.boxMode?!1:sC.isValid(e,t,n)},commit(e,t,n){if(n.Shift&&!t.isOpen){let s=t.polygon.points,o=[],u=[],d=!1;for(let h=0;h<s.length;h++)d?u.push(s[h]):o.push(s[h]),t.closestLineIndex===h&&(d=!0);return{isOpen:!0,points:[...u,...o]}}let r=t.polygon.points,i=[];for(let s=0;s<r.length;s++)if(i.push(r[s]),t.closestLineIndex===s){let o=t.closestLinePoint;i.push(o)}return{points:i}}},SL={type:"delete-point",label:"Delete point",tools:["pointer","pen","lineBox","line"],trigger:{type:"key",key:"Backspace"},isValid(e,t,n){return t.selectedPoints.length>0&&t.slowState.canDelete},commit(e,t,n){let r=t.polygon.points.filter((i,s)=>!t.selectedPoints.includes(s));return{isOpen:r.length<3,selectedPoints:[],points:r,tool:t.slowState.boxMode?"box":void 0}}},kL={type:"deselect-bounding-box",label:"Deselect bounding box",tools:["pointer"],trigger:{type:"click"},isValid(e,t,n){return t.slowState.canDeselect&&!t.isOpen&&!t.slowState.boxMode&&t.selectedPoints.length>2&&t.selectedPoints.length===t.polygon.points.length},commit(e,t,n){return t.slowState.lastCreationTool==="pen"?{selectedPoints:[],tool:"pen"}:{selectedPoints:[]}}},PL={type:"deselect-draw",label:"Deselect draw",trigger:{type:"key",key:"Escape"},tools:["pointer","pen","box","lineBox","stamp","hand","pencil"],isValid(e,t,n){return t.slowState.canDeselect},commit(e,t,n){return{selectedPoints:[]}}},EL={type:"deselect-points",label:"Deselect points",trigger:{type:"click"},tools:["pointer","pen"],isValid(e,t,n){return t.selectedPoints.length>0&&t.slowState.canDeselect},commit(e,t,n){return{selectedPoints:[]}}},CL={type:"draw-shape",label:"Draw shape",tools:["pen","pencil"],modifiers:{Alt:"Freehand drawing"},isValid(e,t,n){let r=n.Alt||t.slowState.currentTool==="pencil";return!!(t.isOpen&&(t.line||t.polygon.points.length===0)&&r)},start(e,t,n){t.transitionDraw=[]},transition(e,t,n){let r=e[0];!n.Shift&&t.slowState.snapEnabled&&(Zi(r,t,3),r=Xa(r,t)),t.transitionDraw.push(r)},commit(e,t,n){let r=t.slowState.currentTool==="pencil"?t.scale*1.5:t.scale*3,i=nC(t.transitionDraw,r);if(t.transitionDraw=[],i.length===0)return;let s=!0,o=3,u=t.selectedPoints[0],d=[...t.polygon.points,...i],h=d[0],c=d[d.length-1];u===0&&(h=d[d.length-1],c=d[0],d=[...i,...t.polygon.points.slice(0).reverse()]);let p=[d.length-1],m=Ln(h,c)/n.proximity<o,w="";return m&&(s=!1,w="pointer",p=d.map((y,S)=>S)),{isOpen:s,tool:w||void 0,points:d,selectedPoints:p}}},TL={type:"move-line",label:"Move line",tools:["line"],isValid(e,t,n){return t.slowState.currentTool!=="line"||t.slowState.boxMode?!1:!!(t.closestLinePoint&&t.closestLineDistance<n.proximity)},transition(e,t){let n=t.transitionOrigin,r=t.polygon.boundingBox,i=e[0],[s,o]=tC(i[0]-n[0],i[1]-n[1],r,t.slowState.bounds);t.transitionPoints=t.polygon.points.map(u=>u.length===6?[u[0]+s,u[1]+o,u[2],u[3],u[4],u[5]]:[u[0]+s,u[1]+o])},commit(e,t,n){let r=t.transitionPoints;return t.transitionPoints=null,t.transitionBoundingBox=null,{points:r}}},bL={type:"move-point",label:"Move point",tools:["pointer","pen","line"],modifiers:{Shift:"Constrain to axis"},isValid(e,t,n){if(n.Alt)return!1;let r=n.proximity,[i,s]=e[0],o=t.polygon.points;t.selectedPoints;for(let u=0;u<o.length;u++){let d=o[u],h=d[0]-i,c=d[1]-s;if(h*h+c*c<r*r)return!0}return!1},start(e,t,n){if(t.slowState.boxMode)return Ql.start?Ql.start(e,t,n):void 0;if(t.selectedPoints.length<2){let[r,i,s]=mL(t.polygon,e[0]);return{selectedPoints:[s]}}if(t.slowState.closestPoint&&!t.selectedPoints.includes(t.slowState.closestPoint))return{selectedPoints:[t.slowState.closestPoint]}},transition(e,t,n){if(t.slowState.boxMode)return Ql.transition(e,t,n);let r=t.transitionOrigin,i=e[0];!n.Shift&&t.slowState.snapEnabled&&(Zi(i,t,3),i=Xa(i,t));let[s,o]=i,u=t.polygon.points,d=t.selectedPoints;if(t.slowState.closestPoint){let m=t.slowState.closestPoint;d.indexOf(m)===-1&&(d=[m])}let h=[],c=s-r[0],p=o-r[1];n.Shift&&!t.slowState.snapEnabled&&(Math.abs(c)>Math.abs(p)?p=0:c=0);for(let m=0;m<u.length;m++){let w=d.indexOf(m)!==-1,y=u[m];w?y.length===6?h.push([y[0]+c,y[1]+p,y[2],y[3],y[4],y[5]]):h.push([y[0]+c,y[1]+p]):h.push(y)}t.transitionPoints=h},commit(e,t,n){if(t.slowState.boxMode)return Ql.commit(e,t,n);let r=t.transitionPoints;return t.transitionPoints=null,t.transitionBoundingBox=null,{points:r}}},oC={type:"move-bounding-box",label:"Move bounding box",tools:["pointer"],isValid(e,t,n){let r=t.polygon.points.length,i=r===t.selectedPoints.length,s=t.polygon.boundingBox;if(r<1||!i||!s)return!1;let o=e[0],u=o[0],d=o[1];return u>=s.x&&u<=s.x+s.width&&d>=s.y&&d<=s.y+s.height},transition(e,t,n){let r=t.slowState.bounds,i=t.transitionOrigin,s=t.polygon.boundingBox,o=e[0],[u,d]=tC(o[0]-i[0],o[1]-i[1],s,r);t.transitionPoints=t.polygon.points.map(h=>h.length===6?[h[0]+u,h[1]+d,h[2],h[3],h[4],h[5]]:[h[0]+u,h[1]+d]),s&&(t.transitionBoundingBox={x:s.x+u,y:s.y+d,width:s.width,height:s.height})},commit(e,t,n){let r=t.transitionPoints;return t.transitionPoints=null,t.transitionBoundingBox=null,{points:r}}},lC={type:"move-shape",label:"Move shape",tools:["pointer","hand","box"],isValid(e,t,n){return n.Shift?!1:t.slowState.pointerInsideShape&&(!t.isOpen||t.line===null)},transition(e,t,n){oC.transition(e,t,n)},commit(e,t,n){let r=t.transitionPoints;return t.transitionPoints=null,t.transitionBoundingBox=null,{points:r}}},RL={type:"nudge-right",label:"Nudge right",trigger:{type:"key",key:"ArrowRight"},tools:["pointer","pen"],modifiers:{Shift:"Nudge right more"},isValid(e,t,n){return t.selectedPoints.length>0},commit(e,t,n){let r=n.proximity*.3,i=t.polygon.points,s=t.selectedPoints;return{points:i.map((o,u)=>s.includes(u)?[o[0]+(n.Shift?4*r:1),o[1]]:o)}}},IL={type:"nudge-left",label:"Nudge left",trigger:{type:"key",key:"ArrowLeft"},tools:["pointer","pen"],modifiers:{Shift:"Nudge left more"},isValid(e,t,n){return t.selectedPoints.length>0},commit(e,t,n){let r=n.proximity*.3,i=t.polygon.points,s=t.selectedPoints;return{points:i.map((o,u)=>s.includes(u)?[Math.max(0,o[0]-(n.Shift?4*r:1)),o[1]]:o)}}},_L={type:"nudge-up",label:"Nudge up",trigger:{type:"key",key:"ArrowUp"},tools:["pointer","pen"],modifiers:{Shift:"Nudge up more"},isValid(e,t,n){return t.selectedPoints.length>0},commit(e,t,n){let r=n.proximity*.3,i=t.polygon.points,s=t.selectedPoints;return{points:i.map((o,u)=>{if(s.includes(u)){let d=o[0],h=Math.max(0,o[1]-(n.Shift?4*r:1));return o.length===6?[d,h,o[2],o[3],o[4],o[5]]:[d,h]}return o})}}},AL={type:"nudge-down",label:"Nudge down",trigger:{type:"key",key:"ArrowDown"},tools:["pointer","pen"],modifiers:{Shift:"Nudge down more"},isValid(e,t,n){return t.selectedPoints.length>0},commit(e,t,n){let r=n.proximity*.3,i=t.polygon.points,s=t.selectedPoints;return{points:i.map((o,u)=>{let d=o[0],h=Math.max(0,o[1]+(n.Shift?4*r:1));return s.includes(u)?o.length===6?[d,h,o[2],o[3],o[4],o[5]]:[d,h]:o})}}},OL={type:"select-multiple-points",label:"Drag to select multiple points",tools:["pointer","pen"],isValid(e,t,n){return t.slowState.currentTool==="line"&&t.polygon.points.length>=2?!0:!(t.slowState.boxMode||t.line)},transition(e,t,n){if(!t.transitionOrigin)return;let r=t.transitionOrigin[0],i=t.transitionOrigin[1],s=e[0][0],o=e[0][1],u=Math.min(r,s),d=Math.min(i,o),h=Math.abs(r-s),c=Math.abs(i-o);t.selectionBox={x:u,y:d,width:h,height:c}},commit(e,t,n){if(t.selectionBox){let r=[];n.Shift&&r.push(...t.selectedPoints);for(let i=0;i<t.polygon.points.length;i++){let s=t.polygon.points[i];s[0]>=t.selectionBox.x&&s[0]<=t.selectionBox.x+t.selectionBox.width&&s[1]>=t.selectionBox.y&&s[1]<=t.selectionBox.y+t.selectionBox.height&&r.push(i)}return{selectedPoints:r}}}},Cw=10,jL={type:"select-point",label:"Select point",trigger:{type:"click"},tools:["pointer","pen","line"],modifiers:{Shift:"Add to selection"},isValid(e,t,n){let r=-1;if(t.selectedPoints.length===1){let u=t.selectedPoints[0];u===0&&(r=t.polygon.points.length-1),u===t.polygon.points.length-1&&(r=0)}if(t.slowState.boxMode)return!1;let[i,s]=e[0],o=t.polygon.points;for(let u=0;u<o.length;u++){let d=o[u],h=d[0]-i,c=d[1]-s;if(h*h+c*c<Cw*Cw)return r!==u}return!1},commit(e,t,n){let r=n.Shift?[...t.selectedPoints]:[],[i,s]=e[0],o=t.polygon.points.map((u,d)=>{let h=u[0]-i,c=u[1]-s;return[h*h+c*c,d]}).sort((u,d)=>u[0]-d[0])[0];if(t.line=null,!r.includes(o[1]))r.push(o[1]);else if(n.Shift)return{selectedPoints:r.filter(u=>u!==o[1])};return{selectedPoints:r}}},ML={type:"select-shape",label:"Select shape",trigger:{type:"click"},tools:["pointer","pen"],isValid(e,t,n){return lC.isValid(e,t,n)},commit(e,t,n){return{tool:"pointer",selectedPoints:t.polygon.points.map((r,i)=>i)}}},LL={type:"snap",label:"Smart snap",tools:["pointer","pen","line"],modifiers:{Shift:"Disable snapping"},isValid(e,t,n){return n.Shift||!t.slowState.snapEnabled||t.slowState.transitioning&&t.slowState.transitionIntentType!=="snap"||!t.slowState.snapToPoints&&!t.slowState.snapToLines&&!t.slowState.snapToIntersections?!1:Zi(e[0],t,0)!==null},start(e,t,n){Zi(e[0],t,5)},transition(e,t,n){let r=Zi(e[0],t,5);r&&(t.pointer=r)},commit(e,t,n){JE(t)}},NL={type:"stamp-fixed-size-shape",label:"Stamp fixed size shape",trigger:{type:"click"},tools:["stamp"],isValid(e,t,n){return t.slowState.selectedStamp!==null},commit(e,t,n){let r=e[0],i=t.slowState.selectedStamp;if(!r||!i)return;let s=r[0],o=r[1],u=[],d=Math.min(...i.points.map(y=>y[0])),h=Math.min(...i.points.map(y=>y[1])),c=Math.max(...i.points.map(y=>y[0]))-d,p=Math.max(...i.points.map(y=>y[1]))-h,m=4*n.proximity,w=c/m;p/m>w&&(w=p/m),s-=c/w/2,o-=p/w/2;for(let y of i.points)u.push([s+(y[0]-d)/w,o+(y[1]-h)/w]);return{isOpen:!1,points:u}}},aC={id:"square",open:!1,points:[[0,0],[0,100],[100,100],[100,0]]},FL={id:"triangle",open:!1,points:[[50,0],[0,100],[100,100]]},zL={id:"pentagon",open:!1,points:[[0,0],[0,100],[100,100],[100,0],[50,-50]]},$L={id:"hexagon",open:!1,points:[[50,0],[0,25],[0,75],[50,100],[100,75],[100,25]]},DL={id:"circle",open:!1,points:[[948.949,571.107],[954.545,500],[954.545,500],[948.949,428.893],[948.949,428.893],[932.298,359.538],[932.298,359.538],[905.003,293.641],[905.003,293.641],[867.735,232.825],[867.735,232.825],[821.412,178.588],[821.412,178.588],[767.175,132.265],[767.175,132.265],[706.359,94.997],[706.359,94.997],[640.462,67.702],[640.462,67.702],[571.107,51.051],[571.107,51.051],[500,45.455],[500,45.455],[428.893,51.051],[428.893,51.051],[359.538,67.702],[359.538,67.702],[293.641,94.997],[293.641,94.997],[232.825,132.265],[232.825,132.265],[178.588,178.588],[178.588,178.588],[132.265,232.825],[132.265,232.825],[94.997,293.641],[94.997,293.641],[67.702,359.538],[67.702,359.538],[51.051,428.893],[51.051,428.893],[45.455,500],[45.455,500],[51.051,571.107],[51.051,571.107],[67.702,640.462],[67.702,640.462],[94.997,706.359],[94.997,706.359],[132.265,767.175],[132.265,767.175],[178.588,821.412],[178.588,821.412],[232.825,867.735],[232.825,867.735],[293.641,905.003],[293.641,905.003],[359.538,932.298],[359.538,932.298],[428.893,948.949],[428.893,948.949],[500,954.545],[500,954.545],[571.107,948.949],[571.107,948.949],[640.462,932.298],[640.462,932.298],[706.359,905.003],[706.359,905.003],[767.175,867.735],[767.175,867.735],[821.412,821.412],[821.412,821.412],[867.735,767.175],[867.735,767.175],[905.003,706.359],[905.003,706.359],[932.298,640.462],[932.298,640.462],[948.949,571.107]]},BL={type:"stamp-shape",label:"Stamp shape",tools:["stamp","box"],modifiers:{Shift:"Maintain aspect ratio"},isValid(e,t,n){return!(t.polygon.points.length&&!t.slowState.canDelete)},start(e,t,n){let r=e[0],i=t.slowState.selectedStamp||aC;if(r){let s=r[0],o=r[1],u=[],d=Math.min(...i.points.map(S=>S[0])),h=Math.min(...i.points.map(S=>S[1])),c=Math.max(...i.points.map(S=>S[0]))-d,p=Math.max(...i.points.map(S=>S[1]))-h,m=c/32;p/32>m&&(m=p/32);let w=[],y=0;for(let S of i.points)w.push(y),u.push([s+(S[0]-d)/m,o+(S[1]-h)/m]),y++;return t.transitionPoints=u,{isOpen:!1,selectedPoints:w,points:u}}},transition(e,t,n){if(!t.transitionOrigin)return;let r=t.polygon.boundingBox,i=[r.x,r.y];t.transitionOrigin||e[0];let[s,o]=e[0],u=t.transitionOrigin[0],d=t.transitionOrigin[1],h=e[0][0],c=e[0][1],p=h-u-32,m=c-d-32;if(n.Shift||t.slowState.fixedAspectRatio){let x=r.width/r.height;Math.abs(r.width/p)>Math.abs(r.height/m)?m=p/x:p=m*x}let w=(r.width+p)/r.width,y=(r.height+m)/r.height,S=[];for(let x of t.polygon.points){let k=x[0]-i[0],T=x[1]-i[1],_=k*w,R=T*y,O=_+i[0],F=R+i[1];if(x.length===6){S.push([O,F,x[2],x[3],x[4],x[5]]);continue}S.push([O,F])}t.transitionPoints=S;let C={points:S,boundingBox:null};kd(C),t.transitionBoundingBox=C.boundingBox},commit(e,t,n){return{isOpen:!1,points:t.transitionPoints,tool:"pointer"}}},UL={type:"toggle-snap",label:"Toggle snapping",trigger:{type:"key",key:"`"},tools:["pointer","pen","line","lineBox","box","stamp"],modifiers:{},isValid(e,t,n){return!0},commit(e,t,n){let r=!t.slowState.snapEnabled;return t.slowState.snapEnabled=r,r||(t.snapTargets=[],t.activeSnapGuides=[],t.isSnapping=!1,t.snapPoint=null),{}}};function WL(e={}){let t=e.proximityThreshold||10,n=e.closestLinePointFill||{selected:"#fff",unselected:"rgba(255, 255, 255, .5)"},r=e.closestLinePointStroke||{selected:"#000",unselected:"rgba(0, 0, 0, .5)"};function i(y,S,C){y&&S.transitionBoundingBox&&C.transitioning&&(y.setAttribute("x",""+S.transitionBoundingBox.x),y.setAttribute("y",""+S.transitionBoundingBox.y),y.setAttribute("width",""+S.transitionBoundingBox.width),y.setAttribute("height",""+S.transitionBoundingBox.height))}function s(y,S,C){y&&S.polygon.boundingBox&&C.showBoundingBox&&(y.setAttribute("x",""+S.polygon.boundingBox.x),y.setAttribute("y",""+S.polygon.boundingBox.y),y.setAttribute("width",""+S.polygon.boundingBox.width),y.setAttribute("height",""+S.polygon.boundingBox.height))}function o(y,S,C){if(y&&S.polygon.boundingBox&&C.showBoundingBox){let x=S.transitionBoundingBox||S.polygon.boundingBox;x.rotation?(y.style.transformOrigin=`${x.x+x.width/2}px ${x.y+x.height/2}px`,y.style.transform=`rotate(${Math.round(100*x.rotation*(180/Math.PI))/100}deg)`):y.style.transform="",y.setAttribute("points",[[x.x,x.y],[x.x+x.width,x.y],[x.x+x.width,x.y+x.height],[x.x,x.y+x.height]].map(k=>k.join(",")).join(" "))}}function u(y,S,C){y&&S.transitionPoints&&C.transitioning&&y.setAttribute("points",S.transitionPoints.map(x=>x.join(",")).join(" "))}function d(y,S,C){y&&S.closestLinePoint&&C.hasClosestLine&&(y.setAttribute("cx",""+S.closestLinePoint[0]),y.setAttribute("cy",""+S.closestLinePoint[1]),y.setAttribute("fill",S.closestLineDistance<t?n.selected:n.unselected),y.setAttribute("stroke",S.closestLineDistance<t?r.selected:r.unselected))}function h(y,S,C){y&&S.closestLinePoint&&C.hasClosestLine&&y.setAttribute("transform",`translate(${S.closestLinePoint[0]}, ${S.closestLinePoint[1]})`)}function c(y,S,C){y&&S.selectionBox&&C.transitionIntentType==="select-multiple-points"&&(y.setAttribute("x",""+S.selectionBox.x),y.setAttribute("y",""+S.selectionBox.y),y.setAttribute("width",""+S.selectionBox.width),y.setAttribute("height",""+S.selectionBox.height))}function p(y,S,C){if(y&&S.pointer&&S.selectedPoints.length)if(C.actionIntentType==="close-shape"||C.actionIntentType==="close-shape-line"){let x=S.polygon.points[0],k=S.polygon.points[S.polygon.points.length-1];x&&k&&y.setAttribute("points",`${x.join(",")} ${k.join(",")}`)}else if(S.line)y.setAttribute("points",`${S.line[0].join(",")} ${S.line[1].join(",")}`);else{let x=S.polygon.points[S.selectedPoints[0]];x&&x.length&&y.setAttribute("points",`${S.pointer[0]},${S.pointer[1]} ${x.join(",")}`)}}function m(y,S,C,x=3){y&&S.transitionDraw.length&&y.setAttribute("points",nC(S.transitionDraw,x*S.scale).map(k=>k.join(",")).join(" "))}function w(y,S){y&&S.lineBox&&y.setAttribute("points",S.lineBox.map(C=>C.join(",")).join(" "))}return{updateTransitionBoundingBox:i,updateClosestLinePointTransform:h,updateBoundingBoxPolygon:o,updateBoundingBox:s,updateTransitionShape:u,updateClosestLinePoint:d,updateSelectBox:c,updatePointLine:p,updateDrawPreview:m,updateLineBox:w}}var HL=typeof window<"u"?window.requestAnimationFrame:e=>setTimeout(e,16),VL=typeof window<"u"?window.cancelAnimationFrame:e=>clearTimeout(e);function Tw(e){return!["hand","pointer"].includes(e)}var da=[Ql,bL,TL,sC,lC,oC,CL,OL,BL,LL],qL=da.length,Yl=[vL,NL,iC,jL,xL,wL,hL,ML,kL,EL],wo=[PL,RL,IL,_L,AL,SL,UL],Na={};da.forEach(e=>{Na[e.type]=e});Yl.forEach(e=>{Na[e.type]=e});wo.forEach(e=>{Na[e.type]=e});var wc=10;function QL(e,t){let n=(e==null?void 0:e.fixedAspectRatio)||!1,r=(e==null?void 0:e.tool)||"pointer",i=(e==null?void 0:e.keyboardShortcutMapping)||{},s=typeof(e==null?void 0:e.keyboardShortcutsEnabled)=="boolean"?e.keyboardShortcutsEnabled:!0,o=(e==null?void 0:e.enabledTools)||["pointer","pen","box","lineBox","stamp","hand","line","pencil"],u=(e==null?void 0:e.emitter)||oL(),d={V:"pointer",P:"pen",B:"box",L:"lineBox",S:"stamp",H:"hand",N:"line",D:"pencil",...(e==null?void 0:e.toolMap)||{}},h={shapeId:(e==null?void 0:e.id)||null,noShape:e===null,transitioning:!1,actionIntentType:null,transitionIntentType:null,selectedPoints:[],hasClosestLine:!1,modifiers:{Alt:!1,Shift:!1,Meta:!1,proximity:wc},bounds:(e==null?void 0:e.bounds)||null,showBoundingBox:!1,currentModifiers:{},validIntentKeys:{},pointerInsideShape:!1,closestPoint:null,selectedStamp:null,transitionModifiers:null,boxMode:!1,bezierLines:[],fixedAspectRatio:n,isToolSwitchingLocked:!1,canDeselect:!1,canDelete:!0,cursor:"default",enabledTools:o,currentTool:r,lastCreationTool:Tw(r)?r:null,snapEnabled:!1,snapToPoints:!0,snapToLines:!0,snapToIntersections:!0,snapToGrid:!1,snapToParallel:!0},c={isOpen:typeof(e==null?void 0:e.open)=="boolean"?e.open:!1,polygon:{points:(e==null?void 0:e.points)||[],iedges:null,boundingBox:null,isBezier:null,bezierLines:[]},scale:1,selectedPoints:[],pointer:null,line:null,lineBox:null,transitionPoints:null,transitionOrigin:null,transitionBoundingBox:null,closestLinePoint:null,closestLineDistance:0,closestLineIndex:-1,transitionRotate:!1,transitionDirection:null,transitionBezierLine:null,selectionBox:null,slowState:h,transitionDraw:[],isPanning:!1,panStart:null,snapTargets:[],activeSnapGuides:[],snapThreshold:15,isSnapping:!1,snapPoint:null},p={startTime:0,time:0,shouldUpdate:!1,nextSlowState:null,renderFunc:()=>{},setStateFunc:()=>{},animationFrame:0,actionIntent:null,transitionIntent:null,undoStack:[],undoStackPointer:-1},m={isPressed:!1,isClicking:!1,lastPress:null,pressTimeout:0,noTransition:!1};function w(B){rC(B),B.isBezier&&y({bezierLines:B.bezierLines}),kd(B),p.shouldUpdate=!0}w(c.polygon);function y(B){let Z=Object.keys(B);if(Z.length===0)return;let oe=p.nextSlowState||c.slowState,U=!1;if(Z.length===1&&Z[0]==="validIntentKeys"&&oe.validIntentKeys){let N=Object.keys(oe.validIntentKeys),X=Object.keys(B.validIntentKeys||{});if(N.length===X.length){for(let te of N)oe.validIntentKeys[te]!==B.validIntentKeys[te]&&(U=!0);if(!U)return}}if(B.selectedPoints){let N=Array.from(oe.selectedPoints||[]),X=Array.from(B.selectedPoints||[]);if(N.length===X.length){for(let te of N)if(!X.includes(te)){U=!0;break}}else U=!0;U||delete B.selectedPoints}if(!(Z.length===1&&Z.includes("hasClosestLine")&&B.hasClosestLine===oe.hasClosestLine)){if(p.nextSlowState){p.nextSlowState={...p.nextSlowState,...B};return}p.nextSlowState={...c.slowState,...B}}}function S(B,Z=!1){p.time+=B,C(),x(),J(),z(),F(),H(),ne(),V(),O(),p.renderFunc(c,c.slowState,B),!Z&&(p.animationFrame=HL(S))}function C(){var B;if(p.shouldUpdate&&(t({id:c.slowState.shapeId||void 0,open:c.isOpen,points:c.polygon.points}),p.shouldUpdate=!1),p.nextSlowState&&p.nextSlowState!==c.slowState){let Z=Object.keys(c.slowState),oe={},U={},N=!1;for(let X of Z){let te=c.slowState[X],Pe=p.nextSlowState[X];te!==Pe?(N=!0,oe[X]=Pe,U[X]=Pe):oe[X]=te}N&&(c.slowState=oe,p.nextSlowState=null,p.setStateFunc(c.slowState),(B=e==null?void 0:e.customSetState)==null||B.call(e,U))}}function x(){let B=!c.slowState.noShape&&c.polygon.points.length>2&&c.selectedPoints.length===c.polygon.points.length&&!c.isOpen&&(c.slowState.currentTool==="pointer"||c.slowState.currentTool==="box");c.slowState.showBoundingBox!==B&&y({showBoundingBox:B})}function k(B){c.selectedPoints=B.selectedPoints,y({selectedPoints:B.selectedPoints}),c.polygon.points=B.points,c.polygon.boundingBox=null,c.polygon.iedges=null,c.polygon.isBezier=null,w(c.polygon),y({closestPoint:null}),(B.isOpen===!0||B.isOpen===!1)&&(c.isOpen=B.isOpen,p.shouldUpdate=!0)}function T(){if(p.undoStackPointer===-1)return;p.undoStackPointer--;let B=p.undoStack[p.undoStackPointer];k(B)}function _(){if(p.undoStackPointer===p.undoStack.length-1)return;p.undoStackPointer++;let B=p.undoStack[p.undoStackPointer];k(B)}function R(B){p.undoStackPointer++,p.undoStack[p.undoStackPointer]=B,p.undoStack.length>15&&(p.undoStack.shift(),p.undoStackPointer--)}function O(){y({boxMode:gL(c.polygon.points||[])})}function F(){if(!c.pointer||c.slowState.noShape){y({pointerInsideShape:!1});return}let[B,Z]=c.pointer,oe=c.polygon.points,U=c.polygon.boundingBox;if(!U){y({pointerInsideShape:!1});return}if(B<U.x||B>U.x+U.width||Z<U.y||Z>U.height+U.y){y({pointerInsideShape:!1});return}let N=!1;for(let X=0,te=oe.length-1;X<oe.length;te=X++)oe[X][1]>Z!=oe[te][1]>Z&&B<(oe[te][0]-oe[X][0])*(Z-oe[X][1])/(oe[te][1]-oe[X][1])+oe[X][0]&&(N=!N);y({pointerInsideShape:N})}function z(){if(c.slowState.noShape||!c.pointer||c.slowState.transitioning||!c.polygon.points||c.polygon.points.length===0)return;let[B,Z]=c.pointer,oe=c.polygon.points.map((U,N)=>{let X=U[0]-B,te=U[1]-Z;return[X*X+te*te,N]}).sort((U,N)=>U[0]-N[0]);oe.length&&y({closestPoint:oe[0][1]})}function J(){if(!c.pointer||c.slowState.transitioning)return;if(c.slowState.noShape){c.closestLineIndex=-1,c.closestLinePoint=null,c.closestLineDistance=0;return}let[B,Z,oe,U]=Ew(c.polygon,c.pointer),N=je()*je();Z<N&&(!c.isOpen||c.slowState.currentTool==="line"||c.polygon.points.length-1!==U)?(c.closestLinePoint=B,c.closestLineDistance=Math.sqrt(Z),c.closestLineIndex=U,y({hasClosestLine:!0})):(c.closestLinePoint=null,c.closestLineDistance=0,c.closestLineIndex=-1,y({hasClosestLine:!1}))}function j(B,Z=null){let oe={},U=Z||(c.pointer?[c.pointer[0],c.pointer[1]]:null);for(let N of[...da,...Yl,...wo])N.tools.includes(B)&&(U&&N.isValid([U],c,Y())?oe[N.type]=N.label:U||(oe[N.type]=N.label));return oe}function H(){if(c.slowState.transitioning||c.slowState.noShape||!c.pointer||!Array.isArray(c.pointer)||c.pointer.length<2||typeof c.pointer[0]!="number"||typeof c.pointer[1]!="number")return;let B=c.slowState.currentTool;$e(B);let Z=!1;for(let N=0;N<qL;N++){let X=da[N];if(X.tools.includes(B)&&X.isValid(m.isPressed?[m.lastPress]:[c.pointer],c,Y())){if(p.transitionIntent===X){Z=!0;break}y({transitionIntentType:X.type}),p.transitionIntent=X,Z=!0;break}}Z||p.transitionIntent&&(y({transitionIntentType:null}),p.transitionIntent=null);let oe=!1;for(let N=0;N<Yl.length;N++){let X=Yl[N];if(X.tools.includes(B)&&se(X)){if(p.actionIntent===X){oe=!0;break}y({actionIntentType:X.type}),p.actionIntent=X,oe=!0;break}}oe||p.actionIntent&&(p.actionIntent=null,y({actionIntentType:null}));let U={};for(let N=0;N<wo.length;N++){let X=wo[N];X.trigger.type==="key"&&se(X)&&(U[X.trigger.key]=X.label)}y({validIntentKeys:U})}function V(){let B=c.pointer;if(c.lineBox=null,!B||M()||c.polygon.points.length!==2)return;let[Z,oe]=B,[U,N]=c.polygon.points[0],[X,te]=c.polygon.points[1],[Pe,_e,De,K]=Ew(c.polygon,B);if(!Pe)return;let ee=Z-Pe[0],ue=oe-Pe[1],pe=[U,N],fe=[X,te],Me=[fe[0]+ee,fe[1]+ue],Qe=[pe[0]+ee,pe[1]+ue];c.lineBox=[pe,fe,Me,Qe]}function ne(){let B=c.pointer;if(!B||!M()||c.slowState.noShape)return;let Z=c.selectedPoints[0],oe=B;if(c.slowState.snapEnabled&&!c.slowState.modifiers.Shift?(Zi(B,c,5),oe=Xa(B,c)):JE(c),c.line=[c.polygon.points[Z],oe],c.slowState.modifiers.Shift){let U=0;if(c.polygon.points.length>1){let ue=c.selectedPoints[0];ue===0?U=Math.atan2(c.polygon.points[1][1]-c.polygon.points[0][1],c.polygon.points[1][0]-c.polygon.points[0][0]):U=Math.atan2(c.polygon.points[ue-1][1]-c.polygon.points[ue][1],c.polygon.points[ue-1][0]-c.polygon.points[ue][0])}let N=B[0]-c.polygon.points[Z][0],X=B[1]-c.polygon.points[Z][1],te=Math.atan2(X,N),Pe=Math.PI/4,_e=Math.round((te-U)/Pe)*Pe+U,De=Ln(c.polygon.points[Z],B),K=Math.cos(_e)*De+c.polygon.points[Z][0],ee=Math.sin(_e)*De+c.polygon.points[Z][1];c.line[1]=[K,ee]}}function Y(){return c.slowState.modifiers}function de(B){let Z=B.commit([m.lastPress],c,Y());u.emit("polygons.end-transition",{transitionIntent:B.type,response:Z}),Z&&(Z.tool&&ae(Z.tool),Z.selectedPoints&&(c.selectedPoints=Z.selectedPoints,y({selectedPoints:Z.selectedPoints})),Z.points&&(c.polygon.points=Z.points,c.polygon.boundingBox=null,c.polygon.iedges=null,c.polygon.isBezier=null,c.transitionBoundingBox=null,w(c.polygon),y({closestPoint:null,selectedStamp:null})),(Z.isOpen===!0||Z.isOpen===!1)&&(c.isOpen=Z.isOpen,p.shouldUpdate=!0),R({isOpen:c.isOpen,points:c.polygon.points,selectedPoints:c.selectedPoints}),$e(c.slowState.currentTool)),y({transitionModifiers:null})}function se(B){if(!B.tools.includes(c.slowState.currentTool))return!1;let Z=[];return c.pointer&&Array.isArray(c.pointer)&&c.pointer.length>=2&&typeof c.pointer[0]=="number"&&typeof c.pointer[1]=="number"&&(Z=[c.pointer]),B.isValid(Z,c,Y())}function ve(B){B==="Delete"&&(B="Backspace");let Z=c.slowState.currentTool;for(let oe of wo)if(!(oe.trigger.type!=="key"||oe.trigger.key!==B)&&oe.tools.includes(Z)&&se(oe))return de(oe),!0;return!1}function M(){let B=c.polygon.points,Z=c.pointer;if(!c.isOpen||!B.length||c.selectedPoints.length!==1||!Z)return!1;let oe=c.selectedPoints[0],U=oe===0,N=oe===B.length-1;return U||N}let L={reset(){y({modifiers:{Alt:!1,Shift:!1,Meta:!1,proximity:wc}})},getForType(B){let Z={};if(!B)return Z;let oe=Na[B];return!oe||!oe.modifiers?Z:oe.modifiers},set(B){var Z;B!=="Shift"&&B!=="Alt"&&B!=="Meta"||y({modifiers:{...((Z=p.nextSlowState)==null?void 0:Z.modifiers)||c.slowState.modifiers,[B]:!0}})},unset(B){var Z;B!=="Shift"&&B!=="Alt"&&B!=="Meta"||y({modifiers:{...((Z=p.nextSlowState)==null?void 0:Z.modifiers)||c.slowState.modifiers,[B]:!1}})}},W={set(B){let Z=B?B.id==="square"||B.id==="rectangle":!1;y({selectedStamp:B,boxMode:Z})},clear(){W.set(null)},square(){W.set(aC)},triangle(){W.set(FL)},pentagon(){W.set(zL)},hexagon(){W.set($L)},circle(){W.set(DL)}},le={down(B){let Z=i[B]||B;if(Z==="Shift"||Z==="Alt"||Z==="Meta")return L.set(Z),!0;if(Z==="Control")return L.set("Meta"),!0;if(Z==="z"&&c.slowState.modifiers.Meta)return c.slowState.modifiers.Shift?_():T(),!0;if(!c.slowState.modifiers.Meta&&!c.slowState.modifiers.Alt&&!c.slowState.transitioning){if(!s)return;let oe=Z.toUpperCase();if(d[oe]){let U=d[oe];return ae(U),!0}}return ve(Z)},up(B){let Z=i[B]||B;if(Z==="Control"){L.unset("Meta");return}Z!=="Shift"&&Z!=="Alt"&&Z!=="Meta"||L.unset(Z)}};function we(B){var Z;c.scale=B,y({modifiers:{...((Z=p.nextSlowState)==null?void 0:Z.modifiers)||c.slowState.modifiers,proximity:B*wc}})}function je(){return wc*c.scale}let Re={set:B=>{p.renderFunc=B},start:(B,Z)=>{p.startTime=performance.now(),p.time=0,B&&(p.renderFunc=B),Z&&(Z(c.slowState),p.setStateFunc=Z),S(0)},stop:()=>{p.animationFrame&&(VL(p.animationFrame),p.animationFrame=0)},step:(B=16)=>{S(B)}};function be(B){if(!B||!Array.isArray(B)||B.length===0)return;let Z=B[0];if(!(!Z||!Z[0]&&Z[0]!==0||!Z[1]&&Z[1]!==0)&&!(Number.isNaN(Z[0])||Number.isNaN(Z[1]))){if(c.pointer=Z,c.slowState.transitioning)p.transitionIntent&&(p.transitionIntent.transition(B,c,Y()),u.emit("polygons.transition",{transitionIntent:p.transitionIntent.type}));else if(m.isPressed&&!m.noTransition&&m.lastPress&&c.pointer&&(!m.isClicking||Ln(m.lastPress,c.pointer)>10))if(clearTimeout(m.pressTimeout),m.isClicking=!1,p.transitionIntent){if(c.transitionOrigin=m.lastPress,y({transitioning:!0}),p.transitionIntent.start){let oe=p.transitionIntent.start([m.lastPress],c,Y());oe&&(oe.selectedPoints&&(c.selectedPoints=oe.selectedPoints,y({selectedPoints:oe.selectedPoints})),(oe.isOpen===!0||oe.isOpen===!1)&&(c.isOpen=oe.isOpen,p.shouldUpdate=!0),oe.points&&(c.polygon.points=oe.points,c.polygon.boundingBox=null,c.polygon.iedges=null,w(c.polygon),y({closestPoint:null})))}y({transitionModifiers:p.transitionIntent.modifiers||null}),u.emit("polygons.start-transition",{transitionIntent:p.transitionIntent.type}),p.transitionIntent.transition([m.lastPress],c,Y()),u.emit("polygons.transition",{transitionIntent:p.transitionIntent.type})}else m.noTransition=!0}}function Ie(){c.pointer=null,c.slowState.transitioning||(m.isPressed=!1,m.isClicking=!1,m.lastPress=null,y({transitionIntentType:null,actionIntentType:null}),p.transitionIntent=null,p.actionIntent=null)}function Ke(){m.isClicking=!0,m.isPressed=!0,m.lastPress=c.pointer,m.pressTimeout=setTimeout(()=>{m.isPressed&&(m.isClicking=!1)},250)}function ln(){c.slowState.transitioning?(y({transitioning:!1}),p.transitionIntent&&de(p.transitionIntent),p.transitionIntent=null,y({transitionIntentType:null})):m.isClicking&&(p.actionIntent&&de(p.actionIntent),p.actionIntent=null,y({actionIntentType:null})),m.isPressed=!1,m.isClicking=!1,m.lastPress=null,m.noTransition=!1,clearTimeout(m.pressTimeout)}function an(B){c.polygon.points=(B==null?void 0:B.points)||[],c.polygon.boundingBox=null,c.polygon.iedges=null,c.isOpen=(B==null?void 0:B.open)||!1,w(c.polygon),p.nextSlowState=null,p.undoStack=[],p.undoStackPointer=-1,c.lineBox=null,c.line=null,m.pressTimeout&&clearTimeout(m.pressTimeout),y({noShape:B===null,shapeId:(B==null?void 0:B.id)||null,transitioning:!1,actionIntentType:null,transitionIntentType:null,selectedPoints:[],hasClosestLine:!1,modifiers:{Alt:!1,Shift:!1,Meta:!1,proximity:c.slowState.modifiers.proximity},showBoundingBox:!1,currentModifiers:{},validIntentKeys:{},selectedStamp:null,closestPoint:null,pointerInsideShape:!1,boxMode:!1,fixedAspectRatio:n}),ae(r),C()}function xt(B){if(!B)return"";let Z=Na[B];return!Z||!Z.modifiers?Z.label||"":c.slowState.modifiers.Shift&&Z.modifiers.Shift?Z.modifiers.Shift:c.slowState.modifiers.Alt&&Z.modifiers.Alt?Z.modifiers.Alt:c.slowState.modifiers.Meta&&Z.modifiers.Meta?Z.modifiers.Meta:Z.label}function Ne(){y({fixedAspectRatio:!0})}function ye(){y({fixedAspectRatio:!1})}function ae(B){if(c.slowState.isToolSwitchingLocked||c.slowState.currentTool===B||!c.slowState.enabledTools.includes(B))return;let Z=c.slowState.lastCreationTool;if(Tw(B)){if(c.slowState.isToolSwitchingLocked)return;Z=B}c.slowState.transitioning&&(c.transitionPoints=null,c.transitionBoundingBox=null,c.transitionDraw=[],c.line=null,c.lineBox=null,y({transitioning:!1}));let oe=j(B),U=c.selectedPoints,N=c.isOpen,X=c.slowState.selectedStamp;switch(B){case"pointer":c.polygon.points.length>0&&!N&&U.length===0&&(U=c.polygon.points.map((te,Pe)=>Pe));break;case"pen":c.polygon.points.length===0?(U=[],N=!0):N&&U.length>1&&(U=[U[U.length-1]]);break;case"line":c.polygon.points.length===0?(U=[],N=!0):N?U.length>1&&(U=[U[U.length-1]]):(U=[c.polygon.points.length-1],N=!0);break;case"pencil":U=[],c.polygon.points.length===0&&(N=!0);break;case"box":U=c.polygon.points.map((te,Pe)=>Pe),N=!1,W.square();break;case"lineBox":U=[],c.polygon.points.length===0&&(N=!0);break;case"stamp":U=[],N=!1,X||W.square();break;case"hand":U=[];break;default:U=[];break}y({validIntentKeys:oe}),y({currentTool:B,selectedPoints:U,lastCreationTool:Z,boxMode:B==="box"}),c.selectedPoints=U,c.isOpen=N,$e(B),H()}function $e(B){let Z=B==="box"||B==="pointer"&&c.polygon.points.length>2&&c.selectedPoints.length===c.polygon.points.length&&!c.isOpen;y({showBoundingBox:Z})}function Mt(B){c.slowState.currentTool===B&&ae("pointer")}function un(B){c.slowState.currentTool===B?ae("pointer"):ae(B)}let Ht={undo:T,redo:_,get canUndo(){return p.undoStackPointer>-1},get canRedo(){return p.undoStackPointer<p.undoStack.length-1}},bt={setTool:ae,unsetTool:Mt,toggleTool:un,updateVisibility:$e,setCanDelete(B){y({canDelete:B})},setCanDeselect(B){lr(),y({canDeselect:B})},lockToolSwitching(){y({isToolSwitchingLocked:!0})},unlockToolSwitching(){y({isToolSwitchingLocked:!1})},toggleToolSwitching(){y({isToolSwitchingLocked:!c.slowState.isToolSwitchingLocked})},shortcuts:Object.fromEntries(Object.entries(d).map(([B,Z])=>[Z,B])),getValidIntents(B){let Z=B||c.slowState.currentTool;return{actions:Yl.filter(oe=>oe.tools.includes(Z)),transitions:da.filter(oe=>oe.tools.includes(Z)),keys:wo.filter(oe=>oe.tools.includes(Z)),all:j(Z),current:c.slowState.validIntentKeys}},getToolInfo(){return{name:c.slowState.currentTool,cursor:c.slowState.cursor,selectionCount:c.selectedPoints.length,pointCount:c.polygon.points.length,isOpen:c.isOpen}},smartSelect(){c.polygon.points.length!==0&&(c.isOpen?(c.selectedPoints=[c.polygon.points.length-1],y({selectedPoints:c.selectedPoints})):(c.selectedPoints=c.polygon.points.map((B,Z)=>Z),y({selectedPoints:c.selectedPoints})))},clearSelection(){c.selectedPoints=[],y({selectedPoints:[]})},autoSelect(){c.selectedPoints.length===c.polygon.points.length&&!c.isOpen?ae("pointer"):c.isOpen||c.selectedPoints.length>0?ae(c.slowState.lastCreationTool||"pen"):ae("pointer")}},ol={enabled:()=>c.slowState.snapEnabled,enable:()=>y({snapEnabled:!0}),disable:()=>y({snapEnabled:!1}),toggle:()=>y({snapEnabled:!c.slowState.snapEnabled}),pointsEnabled:()=>c.slowState.snapToPoints,enablePoints:()=>y({snapToPoints:!0}),disablePoints:()=>y({snapToPoints:!1}),togglePoints:()=>y({snapToPoints:!c.slowState.snapToPoints}),linesEnabled:()=>c.slowState.snapToLines,enableLines:()=>y({snapToLines:!0}),disableLines:()=>y({snapToLines:!1}),toggleLines:()=>y({snapToLines:!c.slowState.snapToLines}),intersectionsEnabled:()=>c.slowState.snapToIntersections,enableIntersections:()=>y({snapToIntersections:!0}),disableIntersections:()=>y({snapToIntersections:!1}),toggleIntersections:()=>y({snapToIntersections:!c.slowState.snapToIntersections}),gridEnabled:()=>c.slowState.snapToGrid,enableGrid:()=>y({snapToGrid:!0}),disableGrid:()=>y({snapToGrid:!1}),toggleGrid:()=>y({snapToGrid:!c.slowState.snapToGrid}),parallelEnabled:()=>c.slowState.snapToParallel,enableParallel:()=>y({snapToParallel:!0}),disableParallel:()=>y({snapToParallel:!1}),toggleParallel:()=>y({snapToParallel:!c.slowState.snapToParallel}),getThreshold:()=>c.snapThreshold*c.slowState.modifiers.proximity,setThreshold:B=>{c.snapThreshold=Math.max(5,Math.min(50,B))},isActive:()=>c.isSnapping,getSnapPoint:()=>c.snapPoint,getActiveGuides:()=>c.activeSnapGuides,getTargets:()=>c.snapTargets};function lr(){y({selectedPoints:c.polygon.points.map((B,Z)=>Z)})}function cs(B){y({bounds:B})}return ae(r),{state:c,setState:y,emitter:u,modifiers:L,stamps:W,history:Ht,key:le,setScale:we,clock:Re,pointer:be,blur:Ie,pointerDown:Ke,pointerUp:ln,setShape:an,label:xt,tools:bt,snap:ol,selectAllPoints:lr,setBounds:cs,lockAspectRatio:Ne,unlockAspectRatio:ye}}function uC(e){const t=Math.max(...e.map(s=>s[0])),n=Math.min(...e.map(s=>s[0])),r=Math.max(...e.map(s=>s[1])),i=Math.min(...e.map(s=>s[1]));for(const s of e)if(s[0]!==n&&s[0]!==t&&s[1]!==i&&s[1]!==r||s[0]<n||s[0]>t||s[1]<i||s[1]>r)return!1;return!0}function Pd(e){if(!e)return null;if(e.points.length>2){const t=Math.min(...e.points.map(s=>s[0])),n=Math.min(...e.points.map(s=>s[1])),r=Math.max(0,...e.points.map(s=>s[0])),i=Math.max(0,...e.points.map(s=>s[1]));return{x:t,y:n,width:r-t,height:i-n}}return null}function YL(e){return e.type==="SvgSelector"}function bw(e,t){if(YL(e)){const o=e.svgShape==="polyline";if(!e.points||e.points.length===0)return null;if(t){const{width:u,height:d}=t;return{type:"SvgSelector",value:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${u} ${d}" width="${u}" height="${d}"><${o?"polygon":"polyline"} points="${e.points.map(c=>c.join(",")).join(" ")}" /></svg>`}}return{type:"SvgSelector",value:`<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><path d='M${e.points.map(u=>u.join(",")).join(" ")}${o?" Z":""}' /></g></svg>`}}if(!e.spatial)return null;const{x:n,y:r,width:i,height:s}=e.spatial||{};return!i||!s?null:{type:"FragmentSelector",value:`xywh=${~~n},${~~r},${~~i},${~~s}`}}function sm(e,t){if(!e||!e.points.length)return null;if(uC(e.points)){const n=e.points.map(d=>d[0]),r=e.points.map(d=>d[1]),i=Math.min(...n),s=Math.min(...r),o=Math.max(...n)-i,u=Math.max(...r)-s;return bw({type:"BoxSelector",spatial:{x:i,y:s,width:o,height:u}},t)}return bw({type:"SvgSelector",points:e.points,svgShape:e.open?"polygon":"polyline"},t)}function Py(e){if(e.type==="polygon"&&!e.noBox&&e.points&&uC(e.points)){const n=Pd({points:e.points||[]});return Py({...e,type:"box",selector:n})}if(e.type==="polygon"||e.type==="draw")return{polygon:{points:e.points||[],open:e.open||!1},requestType:e.type,boundingBox:Pd({points:e.points||[]}),metadata:{},arguments:e.arguments||{},target:sm({points:e.points||[],open:!1},e.bounds)};const t=e.selector;if(t){const n=[[t.x,t.y],[t.x+t.width,t.y],[t.x+t.width,t.y+t.height],[t.x,t.y+t.height]];return{polygon:{points:n,open:!1},requestType:e.type,boundingBox:t,metadata:{},target:sm({points:n,open:!1},e.bounds),arguments:e.arguments||{}}}return{polygon:{points:[],open:!1},requestType:e.type,boundingBox:null,target:null,metadata:{},arguments:e.arguments||{}}}const XL={shapeId:null,noShape:!0,transitioning:!1,actionIntentType:null,transitionIntentType:null,selectedPoints:[],hasClosestLine:!1,lastCreationTool:null,modifiers:{Alt:!1,Shift:!1,Meta:!1,proximity:0},bounds:null,showBoundingBox:!1,currentModifiers:{},validIntentKeys:{},pointerInsideShape:!1,closestPoint:null,transitionModifiers:null,selectedStamp:null,bezierLines:[],boxMode:!1,fixedAspectRatio:!1,cursor:"",enabledTools:["pointer","pen","box","lineBox","stamp","hand","line","pencil"],canDelete:!0,canDeselect:!0,isToolSwitchingLocked:!1,currentTool:"box",snapEnabled:!1,snapToPoints:!1,snapToLines:!1,snapToIntersections:!1,snapToGrid:!1,snapToParallel:!1};function KL({events:e,enabledTools:t,keyboardShortcutMapping:n,keyboardShortcutsEnabled:r=!1,debug:i}){const s=us((u,d)=>{let h=null;const p=QL({emitter:e,keyboardShortcutsEnabled:r,keyboardShortcutMapping:n,enabledTools:t,customSetState:m=>{i&&console.log("partial state",m),u(w=>({polygonState:{...w.polygonState,...m}}))}},m=>{u(w=>w.tool.requestId?{polygon:{...m,id:w.tool.requestId}}:{polygon:{id:void 0,points:[],open:!0}}),e.emit("atlas.polygon-update",m)});return{mode:"explore",tool:{enabled:!1,requestId:null,canvasId:null},requestType:null,requests:{},history:p.history,polygon:null,validRequestIds:[],metadata:{},stableViewport:null,canvasRelativePositions:{},canvasViewports:{},polygons:p,polygonState:XL,setMetadata:(m,w)=>{const y=w||d().tool.requestId;y&&u(S=>({metadata:{...S.metadata,[y]:{...S.metadata[y]||{},...m}}}))},setToolCanvasId:m=>{u(w=>({tool:{...w.tool,canvasId:m}}))},switchTool:{pointer(){u({mode:"sketch"}),o.tools.setTool("pointer")},hand(){u({mode:"explore"}),o.tools.setTool("hand")},draw(){u({mode:"sketch"}),o.tools.setTool("pencil")},pen(){u({mode:"sketch"}),o.tools.setTool("pen")},line(){u({mode:"sketch"}),o.tools.setTool("line")},lineBox(){u({mode:"sketch"}),o.tools.setTool("lineBox")},box(){u({mode:"sketch"}),o.tools.setTool("box")},triangle(){u({mode:"sketch"}),o.tools.setTool("stamp"),o.stamps.triangle()},hexagon(){u({mode:"sketch"}),o.tools.setTool("stamp"),o.stamps.hexagon()},circle(){u({mode:"sketch"}),o.tools.setTool("stamp"),o.stamps.circle()},remove(){const m=d();m.tool.requestId&&(p.setShape({points:[],open:!0}),m.cancelRequest(m.tool.requestId))}},reset:()=>{const m=d();m.tool.requestId&&m.cancelRequest(m.tool.requestId)},setPolygonState:m=>u({polygonState:typeof m=="function"?m(d().polygonState):m}),getRequestId:()=>{const m=Math.random().toString(36).slice(2);return u(w=>({validRequestIds:[...w.validRequestIds,m]})),{requestId:m,clear:()=>{d().tool.requestId,u(w=>({tool:w.tool.requestId===m?{enabled:!1,requestId:null,canvasId:null}:w.tool,validRequestIds:w.validRequestIds.filter(y=>y!==m)}))}}},cancelRequest:m=>{const w=m||d().tool.requestId;w&&(u(y=>({mode:"explore",tool:y.tool.requestId===w?{enabled:!1,requestId:null,canvasId:null}:y.tool,validRequestIds:y.validRequestIds.filter(S=>S!==w)})),e.emit("atlas.request-cancelled",{id:w}))},requestAnnotation:async(m,w)=>{var x,k;const S={...d().requests,[w.requestId]:m},C=Py(m);i&&console.log("requestAnnotation",{response:C,request:m});try{const{points:T=[],open:_=!0}=C.polygon||{},{requestId:R,canvasId:O=null,toolId:F}=w;let z=F;const J=d(),j=J.validRequestIds.includes(R),H=C.requestType;return i&&console.log("setting points",{requestType:H,points:T,open:_}),!j||J.tool.enabled?null:(p.setShape({id:R,points:T,open:_}),H==="polygon"&&(z=z||"pen",p.tools.setTool("pen")),H==="draw"&&(z=z||"draw",p.tools.setTool("pencil")),H==="box"&&(z=z||"box",p.tools.setTool("box")),H==="target"?(z=z||"box",p.tools.setTool("box"),p.lockAspectRatio(),p.tools.lockToolSwitching(),p.tools.setCanDeselect(!1),p.tools.setCanDelete(!1)):(p.tools.unlockToolSwitching(),p.tools.setCanDeselect(!0),p.tools.setCanDelete(!0)),m.bounds&&p.setBounds(m.bounds),e.emit("atlas.annotation-request",{id:R}),u({polygon:{id:R,points:T,open:_},mode:"sketch",requestType:H,tool:{enabled:!0,requestId:R,canvasId:O},requests:S}),z?(k=(x=J.switchTool)[z])==null||k.call(x):T.length===0&&J.switchTool.box(),(typeof m.selectByDefault>"u"&&T.length&&H==="box"||m.selectByDefault)&&J.switchTool.pointer(),new Promise(V=>{const ne=de=>{de.id===R&&(u(se=>({mode:"explore",tool:{requestId:null,enabled:!1,canvasId:null},requests:Object.fromEntries(Object.entries(se.requests).filter(([ve])=>ve!==R))})),e.off("atlas.request-cancelled",ne),e.off("atlas.annotation-completed",Y),V(null))},Y=de=>{de.id===R&&(u(se=>({mode:"explore",tool:{requestId:null,enabled:!1,canvasId:null},requests:Object.fromEntries(Object.entries(se.requests).filter(([ve])=>ve!==R))})),e.off("atlas.annotation-completed",Y),e.off("atlas.request-cancelled",ne),V(de))};e.on("atlas.request-cancelled",ne),e.on("atlas.annotation-completed",Y)}))}catch(T){return console.error(T),null}},completeRequest:m=>{var k;const w=d().tool.requestId;if(typeof m=="string"&&m&&m!==w)return;const y=w?((k=d().requests[w])==null?void 0:k.arguments)||{}:{},S=w?d().metadata[w]||{}:{},C=d().polygonState.bounds,x=d().polygon;x&&(e.emit("atlas.annotation-completed",{id:x.id,polygon:x,requestType:d().requestType,target:sm(x,C),canvasId:d().tool.canvasId,boundingBox:Pd(x),metadata:S,arguments:{...y}}),p.setShape(null))},setAtlasRuntime:m=>{h=m,e.emit("atlas.ready",{runtime:m}),o.setScale(1/h._lastGoodScale),h.world.addLayoutSubscriber((w,y)=>{(w==="event-activation"||w==="zoom-to"||w==="go-home")&&h!=null&&h._lastGoodScale&&!Number.isNaN(h._lastGoodScale)&&o.setScale(1/h._lastGoodScale)})},clearAtlasRuntime:()=>{h=null,u({stableViewport:null})},setCanvasRelativePosition:(m,w)=>{u(y=>({canvasRelativePositions:{...y.canvasRelativePositions,[m]:w}}))},clearCanvasRelativePosition:m=>{u(w=>{const y={...w.canvasRelativePositions};return delete y[m],{canvasRelativePositions:y}})},changeMode:m=>{u({mode:m})},nudgeLeft:()=>{},nudgeRight:()=>{},nudgeUp:()=>{},nudgeDown:()=>{},zoomIn:()=>{var m;(m=h==null?void 0:h.world)==null||m.zoomIn()},zoomOut:()=>{var m;(m=h==null?void 0:h.world)==null||m.zoomOut()},goHome:()=>{var m;(m=h==null?void 0:h.world)==null||m.goHome()}}}),o=s.getState().polygons;return e.on("atlas.annotation-request",()=>{o.clock.start((u,d,h)=>{e.emit("atlas.polygon-render",{state:u,slowState:d,dt:h})},u=>{typeof u=="object"?s.setState({polygonState:u}):s.setState(d=>({polygonState:u(d.polygonState)}))})}),e.on("atlas.annotation-completed",()=>{o.clock.stop()}),e.on("atlas.request-cancelled",()=>{o.clock.stop()}),s}const Fa=b.createContext(null);function An(){return b.useContext(Fa)}const om={};function GL(e="atlas"){var t;return(t=om[e])==null?void 0:t.getState()}function Ey({children:e,name:t="atlas",existing:n,atlasStoreConfig:r}){const i=sL(),s=b.useContext(Fa),o=b.useMemo(()=>n||s||KL({events:i,...r||{}}),[i,n,s]),u=Te(o,d=>d.mode);return b.useEffect(()=>{const d=t;return d&&(om[d]=o),()=>{d&&delete om[d]}},[o,t]),E.jsx(Fa.Provider,{value:o,children:E.jsx(Qa.Provider,{value:u||"explore",children:e})})}function ZL(){return{default:{backgroundColor:"rgba(0,0,0,0)",borderWidth:"2px",borderColor:"rgba(252,0,98, .5)"},highlighted:{backgroundColor:"rgba(75, 103, 225, 0.4)",borderWidth:"1px",borderColor:"rgba(75,103,225,0.99)"},hidden:{borderWidth:"0px",borderColor:"rgba(0,0,0,0)",backgroundColor:"rgba(0,0,0,0)",hidden:!0}}}const cC=b.createContext(ZL());cC.displayName="AnnotationStyle";function JL(){return b.useContext(cC)}var e3=Object.create,dC=Object.defineProperty,t3=Object.getOwnPropertyDescriptor,n3=Object.getOwnPropertyNames,r3=Object.getPrototypeOf,i3=Object.prototype.hasOwnProperty,fC=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),s3=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(var i=n3(t),s=0,o=i.length,u;s<o;s++)u=i[s],!i3.call(e,u)&&u!==n&&dC(e,u,{get:(d=>t[d]).bind(null,u),enumerable:!(r=t3(t,u))||r.enumerable});return e},hC=(e,t,n)=>(n=e==null?{}:e3(r3(e)),s3(dC(n,"default",{value:e,enumerable:!0}),e));function o3(e,t,n,r=1){return new pC(e,t,n).subdivide(r)}function l3(e,t,n,r,i=1){return new u3(new Float64Array([e.x,e.y,t.x,t.y,n.x,n.y,r.x,r.y])).subdivide(i)}function a3(e){return e.x*e.x+e.y*e.y}function fa(e){let t=.67;return e/(1-t+(t**4+.25*e*e)**.25)}function Bo(e){let t=.39;return e*(1-t+Math.sqrt(t*t+.25*e*e))}var pC=class{constructor(e,t,n){rn(this,"start",void 0),rn(this,"control",void 0),rn(this,"end",void 0),this.start=e,this.control=t,this.end=n}eval(e){let t=1-e;return{x:this.start.x*t*t+2*this.control.x*t*e+this.end.x*e*e,y:this.start.y*t*t+2*this.control.y*t*e+this.end.y*e*e}}mapToBasic(){let{x:e,y:t}=this.start,{x:n,y:r}=this.control,{x:i,y:s}=this.end,o=2*n-e-i,u=2*r-t-s,d=(n-e)*o+(r-t)*u,h=(i-n)*o+(s-r)*u,c=(i-e)*u-(s-t)*o,p=d/c,m=h/c,w=Math.abs(c)/(Math.hypot(o,u)*Math.abs(m-p));return{x0:e,x2:i,scale:w,cross:c}}subdivide(e){let t=this.mapToBasic(),n=fa(t.x0),r=fa(t.x2),i=.5*Math.abs(r-n)*Math.sqrt(t.scale/e),s=Math.ceil(i),o=Bo(n),u=Bo(r),d=[0];for(let h=1;h<s;h++){let c=Bo(n+(r-n)*h/s),p=(c-o)/(u-o);d.push(p)}return d.push(1),d.map(h=>this.eval(h))}},u3=class gC{constructor(t){rn(this,"c",void 0),this.c=t}weightsum(t,n,r,i){let s=t*this.c[0]+n*this.c[2]+r*this.c[4]+i*this.c[6],o=t*this.c[1]+n*this.c[3]+r*this.c[5]+i*this.c[7];return{x:s,y:o}}eval(t){let n=1-t,r=n*n*n,i=3*n*n*t,s=3*n*t*t,o=t*t*t;return this.weightsum(r,i,s,o)}deriv(t){let n=1-t,r=-3*n*n,i=3*t*t,s=-6*t*n-r,o=6*t*n-i;return this.weightsum(r,s,o,i)}midpoint_quadbez(){let t=this.weightsum(-.25,.75,.75,-.25);return new pC({x:this.c[0],y:this.c[1]},t,{x:this.c[6],y:this.c[7]})}subsegment(t,n){let r=new Float64Array(8),i=this.eval(t),s=this.eval(n);r[0]=i.x,r[1]=i.y;let o=(n-t)/3,u=this.deriv(t);r[2]=i.x+o*u.x,r[3]=i.y+o*u.y;let d=this.deriv(n);return r[4]=s.x-o*d.x,r[5]=s.y-o*d.y,r[6]=s.x,r[7]=s.y,new gC(r)}subdivide(t){let n=.1*t,r=t-n,i=Math.sqrt(r),s=a3(this.weightsum(1,-3,3,-1)),o=Math.ceil((s/(432*n*n))**(1/6)),u=[],d=0;for(let y=0;y<o;y++){let S=y/o,C=(y+1)/o,x=this.subsegment(S,C).midpoint_quadbez(),k=x.mapToBasic(),T=fa(k.x0),_=fa(k.x2),R=Math.sqrt(k.scale),O=Math.abs(_-T)*R;if(Math.sign(k.x0)!=Math.sign(k.x2)){let F=i/R,z=i*Math.abs(_-T)/fa(F);O=Math.max(O,z)}u.push({quad:x,a0:T,a2:_,val:O}),d+=O}let h=.5*d/i,c=Math.ceil(h),p=[{x:this.c[0],y:this.c[1]}],m=0,w=0;for(let y=1;y<c;y++){let S=d*y/c;for(;m+u[w].val<S;)m+=u[w].val,w++;let C=u[w].a0,x=u[w].a2,k=Bo(C),T=Bo(x),_=C+(x-C)*(S-m)/u[w].val,R=Bo(_),O=(R-k)/(T-k);p.push(u[w].quad.eval(O))}return p.push({x:this.c[6],y:this.c[7]}),p}};function c3(e){let t={},n=e.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\s+/g," ").trim(),r=/([^{]+)\{([^}]+)\}/g,i;for(;(i=r.exec(n))!==null;){let s=i[1].trim(),o=i[2].trim(),u=s.match(/\.([a-zA-Z0-9_-]+)/);if(!u)continue;let d=u[1],h=o.split(";").filter(p=>p.trim()),c={};for(let p of h){let[m,w]=p.split(":").map(y=>y.trim());if(!(!m||!w))switch(m){case"background-color":c.backgroundColor=w;break;case"opacity":c.opacity=parseFloat(w);break;case"box-shadow":c.boxShadow=w;break;case"border-color":c.borderColor=w;break;case"border-width":c.borderWidth=w;break;case"border-style":c.borderStyle=w;break;case"outline-color":c.outlineColor=w;break;case"outline-width":c.outlineWidth=w;break;case"outline-offset":c.outlineOffset=w;break;case"outline-style":c.outlineStyle=w;break;case"border":c.border=w;break;case"outline":c.outline=w;break;case"background":c.background=w;break}}t[d]=c}return t}function Rw(e){let t={};return e&&(e.fill&&(t.backgroundColor=e.fill,e.fillOpacity),e.stroke&&(t.borderColor=e.stroke),e.strokeWidth&&(t.borderWidth=e.strokeWidth)),t}const Tp=new Map;function d3(e,t){if(Tp.has(e))return Tp.get(e);let n=c3(t);return Tp.set(e,Object.fromEntries(Object.entries(n).map(([r,i])=>[r,i]))),n}function bp(e,t,n={}){if(!e||!t)return Rw(n||{});let r=Rw(n||{}),i=Object.entries(t);for(let[s,o]of i){if(!o)continue;let u=d3(s,o),d=Object.entries(u);for(let[h,c]of d)h===e&&Object.assign(r,c)}return r}var f3=function(){function e(t,n){var r=[],i=!0,s=!1,o=void 0;try{for(var u=t[Symbol.iterator](),d;!(i=(d=u.next()).done)&&(r.push(d.value),!(n&&r.length===n));i=!0);}catch(h){s=!0,o=h}finally{try{!i&&u.return&&u.return()}finally{if(s)throw o}}return r}return function(t,n){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,n);throw TypeError("Invalid attempt to destructure non-iterable instance")}}(),ha=Math.PI*2,Rp=function(e,t,n,r,i,s,o){var u=e.x,d=e.y;u*=t,d*=n;var h=r*u-i*d,c=i*u+r*d;return{x:h+s,y:c+o}},h3=function(e,t){var n=t===1.5707963267948966?.551915024494:t===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(t/4),r=Math.cos(e),i=Math.sin(e),s=Math.cos(e+t),o=Math.sin(e+t);return[{x:r-i*n,y:i+r*n},{x:s+o*n,y:o-s*n},{x:s,y:o}]},Iw=function(e,t,n,r){var i=e*r-t*n<0?-1:1,s=e*n+t*r;return s>1&&(s=1),s<-1&&(s=-1),i*Math.acos(s)},p3=function(e,t,n,r,i,s,o,u,d,h,c,p){var m=i**2,w=s**2,y=c**2,S=p**2,C=m*w-m*S-w*y;C<0&&(C=0),C/=m*S+w*y,C=Math.sqrt(C)*(o===u?-1:1);var x=C*i/s*p,k=C*-s/i*c,T=h*x-d*k+(e+n)/2,_=d*x+h*k+(t+r)/2,R=(c-x)/i,O=(p-k)/s,F=(-c-x)/i,z=(-p-k)/s,J=Iw(1,0,R,O),j=Iw(R,O,F,z);return u===0&&j>0&&(j-=ha),u===1&&j<0&&(j+=ha),[T,_,J,j]},g3=function(e){var t=e.px,n=e.py,r=e.cx,i=e.cy,s=e.rx,o=e.ry,u=e.xAxisRotation,d=u===void 0?0:u,h=e.largeArcFlag,c=h===void 0?0:h,p=e.sweepFlag,m=p===void 0?0:p,w=[];if(s===0||o===0)return[];var y=Math.sin(d*ha/360),S=Math.cos(d*ha/360),C=S*(t-r)/2+y*(n-i)/2,x=-y*(t-r)/2+S*(n-i)/2;if(C===0&&x===0)return[];s=Math.abs(s),o=Math.abs(o);var k=C**2/s**2+x**2/o**2;k>1&&(s*=Math.sqrt(k),o*=Math.sqrt(k));var T=p3(t,n,r,i,s,o,c,m,y,S,C,x),_=f3(T,4),R=_[0],O=_[1],F=_[2],z=_[3],J=Math.abs(z)/(ha/4);Math.abs(1-J)<1e-7&&(J=1);var j=Math.max(Math.ceil(J),1);z/=j;for(var H=0;H<j;H++)w.push(h3(F,z)),F+=z;return w.map(function(V){var ne=Rp(V[0],s,o,S,y,R,O),Y=ne.x,de=ne.y,se=Rp(V[1],s,o,S,y,R,O),ve=se.x,M=se.y,L=Rp(V[2],s,o,S,y,R,O),W=L.x,le=L.y;return{x1:Y,y1:de,x2:ve,y2:M,x:W,y:le}})},m3=g3,y3=fC((e,t)=>{t.exports=i;var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},r=/([astvzqmhlc])([^astvzqmhlc]*)/gi;function i(u){var d=[];return u.replace(r,function(h,c,p){var m=c.toLowerCase();for(p=o(p),m=="m"&&p.length>2&&(d.push([c].concat(p.splice(0,2))),m="l",c=c=="m"?"l":"L");;){if(p.length==n[m])return p.unshift(c),d.push(p);if(p.length<n[m])throw Error("malformed path data");d.push([c].concat(p.splice(0,n[m])))}}),d}var s=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function o(u){var d=u.match(s);return d?d.map(Number):[]}}),v3=fC((e,t)=>{t.exports=n;function n(r){var i=0,s=0,o=0,u=0;return r.map(function(d){d=d.slice();var h=d[0],c=h.toUpperCase();if(h!=c)switch(d[0]=c,h){case"a":d[6]+=o,d[7]+=u;break;case"v":d[1]+=u;break;case"h":d[1]+=o;break;default:for(var p=1;p<d.length;)d[p++]+=o,d[p++]+=u}switch(c){case"Z":o=i,u=s;break;case"H":o=d[1];break;case"V":u=d[1];break;case"M":o=i=d[1],u=s=d[2];break;default:o=d[d.length-2],u=d[d.length-1]}return d})}}),x3=hC(y3()),w3=hC(v3());function S3(e){let t=(0,x3.default)(e),n=(0,w3.default)(t),r,i=0,s=0,o=0,u=0,d,h,c=0,p=0,m=[];for(let w=0;w<n.length;w++){let y=n[w],S=y[0];switch(S){case"M":i=y[1],s=y[2];break;case"H":y=["L",y[1],s];break;case"V":y=["L",i,y[1]];break;case"S":{let C=c,x=p;(r==="C"||r=="S")&&(C+=C-o,x+=x-u),y=["C",C,x,y[1],y[2],y[3],y[4]]}break;case"T":r==="Q"||r=="T"?(d=c*2-d,h=p*2-h):(d=c,h=p),y=["Q",d,h,y[1],y[2]];break;case"Q":d=y[1],h=y[2];break;case"A":{let C=m3({px:c,py:p,cx:y[6],cy:y[7],rx:y[1],ry:y[2],xAxisRotation:y[3],largeArcFlag:y[4],sweepFlag:y[5]});if(!C.length)continue;for(let[x,k]of C.entries())y=["C",k.x1,k.y1,k.x2,k.y2,k.x,k.y],x<C.length-1&&m.push(y);y=y}break;case"Z":y=["L",i,s];break}r=S,c=y[y.length-2],p=y[y.length-1],["C","Q","A"].indexOf(S)>-1?(o=y[y.length-4],u=y[y.length-3]):(o=c,u=p),m.push(y)}return m}const k3=/&?(xywh=)?(pixel:|percent:|pct:)?([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?)/,_w=/&?(t=)(npt:)?([0-9]+(\.[0-9]+)?)?(,([0-9]+(\.[0-9]+)?))?/,Aw=/^rgba\((\d+),(\d+),(\d+),([0-9.]+)\)$/;function $s(e,{domParser:t,svgPreprocessor:n,iiifRenderingHints:r,loadedStylesheets:i}={},{styleClass:s}={}){if(Array.isArray(e))return Kn(e.reduce((o,u)=>{let{selector:d,selectors:h,iiifRenderingHints:c}=$s(u,{domParser:t,svgPreprocessor:n,iiifRenderingHints:r},{styleClass:s});return d&&(o.selector?(!o.selector.temporal&&d.temporal&&(o.selector.temporal=d.temporal),!o.selector.spatial&&d.spatial&&(o.selector.spatial=d.spatial),!o.selector.svg&&d.svg&&(o.selector.svg=d.svg),!o.selector.svgShape&&d.svgShape&&(o.selector.svgShape=d.svgShape)):o.selector=d,o.selectors.push(...h)),c&&(o.iiifRenderingHints=o.iiifRenderingHints||{type:"ImageApiSelector"},Object.assign(o.iiifRenderingHints,c)),o},{selector:null,selectors:[],iiifRenderingHints:r}));if(!e)return Kn({selector:null,selectors:[],iiifRenderingHints:r});if(typeof e=="string"){let[o,u]=e.split("#");return u?$s({type:"FragmentSelector",value:u},{svgPreprocessor:n,iiifRenderingHints:r,domParser:t},{styleClass:s}):Kn({selector:null,selectors:[],iiifRenderingHints:r})}if(e.type){if(e.type==="PointSelector"&&(e.t||e.t===0)){let o={type:"TemporalSelector",temporal:{startTime:e.t}};return Kn({selector:o,selectors:[o],iiifRenderingHints:r})}if(e.type==="PointSelector"&&e.x&&e.y){let o={type:"PointSelector",spatial:{x:e.x,y:e.y}};return Kn({selector:o,selectors:[o],iiifRenderingHints:r})}}if(T3(e)){let o=[];if(e.region){let u=$s({type:"FragmentSelector",value:"xywh="+e.region},{domParser:t,svgPreprocessor:n,iiifRenderingHints:r},{styleClass:s});o.push(...u.selectors)}return Kn({selector:o[0],selectors:o,iiifRenderingHints:r?{...r,...e}:e})}if(e.type==="FragmentSelector"){let o=k3.exec(e.value);if(o){let d={type:"BoxSelector",spatial:{unit:o[2]==="percent:"||o[2]==="pct:"?"percent":"pixel",x:Number.parseFloat(o[3]),y:Number.parseFloat(o[4]),width:Number.parseFloat(o[5]),height:Number.parseFloat(o[6])},boxStyle:bp(s,i)},h=e.value.match(_w);return h&&(d={type:"TemporalBoxSelector",spatial:d.spatial,temporal:{startTime:h[3]?Number.parseFloat(h[3]):0,endTime:h[6]?Number.parseFloat(h[6]):void 0},boxStyle:bp(s,i)}),Kn({selector:d,selectors:[d],iiifRenderingHints:r})}let u=e.value.match(_w);if(u){let d={type:"TemporalSelector",temporal:{startTime:u[3]?Number.parseFloat(u[3]):0,endTime:u[6]?Number.parseFloat(u[6]):void 0}};return Kn({selector:d,selectors:[d],iiifRenderingHints:r})}return Kn({selector:null,selectors:[],iiifRenderingHints:r})}if(e.type==="SvgSelector"&&"value"in e){t||(typeof window<"u"?t=new window.DOMParser:console.warn("No DOMParser available, cannot parse SVG selector, `points`, `spatial` and `style` will be unavailable and the SVG will not be normalized."));let o=[],u,d,h=(n==null?void 0:n(e.value))??e.value,c;if(t){let m=t.parseFromString(e.value,"image/svg+xml").querySelector("svg");if(!m)return console.warn(`Illegal SVG selector: ${e.value}`),Kn({selector:null,selectors:[],iiifRenderingHints:r});let w=mC(m);w&&(o=w.points,c=w.shapeType,u=[Math.min(...o.map(y=>y[0])),Math.min(...o.map(y=>y[1])),Math.max(...o.map(y=>y[0])),Math.max(...o.map(y=>y[1]))],{style:d,svg:h}=C3(w.element)??{svg:h})}let p={type:"SvgSelector",svg:h,svgShape:c,style:d,boxStyle:bp(s,i,d),points:o.length?o:void 0,spatial:u?{unit:"pixel",x:u[0],y:u[1],width:u[2]-u[0],height:u[3]-u[1]}:void 0};return Kn({selector:p,selectors:[p],iiifRenderingHints:r})}return Kn({selector:null,selectors:[],iiifRenderingHints:r})}function P3(e){let t=e.map(r=>r[0]).reduce((r,i)=>(r[i]+=1,r),{C:0,Q:0,L:0,M:0}),n=new Set(e.map(r=>r[0]));if(t.C>0||t.Q>0)return"path";if(t.L>0&&(n.size===1||n.size===2&&n.has("M"))){if(t.L===4)return"rect";let r=e.slice(-1)[0];return e[0][0]==="M"&&r[0]==="L"&&r[1]==e[0][1]&&r[2]===e[0][2]||r[1]===0&&r[2]===0?"polygon":"polyline"}return"path"}function mC(e){var t;for(let n of Array.from(e.children))switch(n==null?void 0:n.tagName.toLowerCase()){case"g":{let r=mC(n);if(r)return r}continue;case"path":{let r=n.getAttribute("d");if(!r)continue;let i=S3(r);return{element:n,points:E3(i),shapeType:P3(i)}}case"circle":{let r=Number.parseFloat(n.getAttribute("cx")??"0"),i=Number.parseFloat(n.getAttribute("cy")??"0"),s=Number.parseFloat(n.getAttribute("r")??"0");if(!s)continue;let o=[];for(let u=0;u<=360;u+=12){let d=u*Math.PI/180;o.push([r+s*Math.cos(d),i+s*Math.sin(d)])}return{element:n,points:o,shapeType:"circle"}}case"ellipse":{let r=Number.parseFloat(n.getAttribute("cx")??"0"),i=Number.parseFloat(n.getAttribute("cy")??"0"),s=Number.parseFloat(n.getAttribute("rx")??"0"),o=Number.parseFloat(n.getAttribute("ry")??"0");if(!s&&!o)continue;let u=[];for(let d=0;d<=360;d+=12){let h=Math.tan(d/360*Math.PI),c=s*(1-h**2)/(1+h**2),p=o*2*h/(1+h**2);u.push([r+c,i+p])}return{element:n,points:u,shapeType:"ellipse"}}case"line":{let r=Number.parseFloat(n.getAttribute("x0")??"0"),i=Number.parseFloat(n.getAttribute("y0")??"0"),s=Number.parseFloat(n.getAttribute("x1")??"0"),o=Number.parseFloat(n.getAttribute("y1")??"0");if(r===s&&i===o)continue;return{element:n,points:[[r,i],[s,o]],shapeType:"polyline"}}case"polygon":case"polyline":{let r=((t=n.getAttribute("points"))==null?void 0:t.split(" ").map(s=>s.split(",").map(Number.parseFloat)))??[];if(!r.length)continue;let i="polyline";return n.tagName.toLowerCase()==="polygon"&&(r.push(r[0]),i="polygon"),{element:n,points:r,shapeType:i}}case"rect":{let r=Number.parseFloat(n.getAttribute("x")??"0"),i=Number.parseFloat(n.getAttribute("y")??"0"),s=Number.parseFloat(n.getAttribute("width")??"0"),o=Number.parseFloat(n.getAttribute("height")??"0");if(!s||!o)continue;return{element:n,points:[[r,i],[r+s,i],[r+s,i+o],[r,i+o],[r,i]],shapeType:"rect"}}default:continue}return null}function E3(e){let t=[];for(let n=0;n<e.length;n++){let r=t[t.length-1]??[0,0],i=e[n];switch(i[0]){case"M":case"L":t.push([i[1],i[2]]);continue;case"C":t.push(...l3({x:r[0],y:r[1]},{x:i[1],y:i[2]},{x:i[3],y:i[4]},{x:i[5],y:i[6]}).map(s=>[s.x,s.y]).slice(1));continue;case"Q":t.push(...o3({x:r[0],y:r[1]},{x:i[1],y:i[2]},{x:i[3],y:i[4]}).map(s=>[s.x,s.y]).slice(1));continue}}return t}function C3(e){let t={};if(e.hasAttribute("fill")?(t.fill=e.getAttribute("fill"),e.removeAttribute("fill")):e.style&&e.style.fill&&(t.fill=e.style.fill),t.fill){let r=Aw.exec(t.fill);r&&(t.fillOpacity=Number.parseFloat(r[4]),t.fill=`rgb(${r[1]}, ${r[2]}, ${r[3]})`)}if(e.hasAttribute("fill-opacity")?(t.fillOpacity=Number.parseFloat(e.getAttribute("fill-opacity")),e.removeAttribute("fill-opacity")):e.style&&e.style.fillOpacity&&(t.fillOpacity=Number.parseFloat(e.style.fillOpacity)),e.hasAttribute("stroke")?(t.stroke=e.getAttribute("stroke"),e.removeAttribute("stroke")):e.style&&e.style.stroke&&(t.stroke=e.style.stroke),t.stroke){let r=Aw.exec(t.stroke);r&&(t.strokeOpacity=Number.parseFloat(r[4]),t.stroke=`rgb(${r[1]}, ${r[2]}, ${r[3]})`)}e.hasAttribute("stroke-opacity")?(t.strokeOpacity=Number.parseFloat(e.getAttribute("stroke-opacity")),e.removeAttribute("stroke-opacity")):e.style&&e.style.strokeOpacity&&(t.strokeOpacity=Number.parseFloat(e.style.strokeOpacity)),e.hasAttribute("stroke-width")?(t.strokeWidth=e.getAttribute("stroke-width"),e.removeAttribute("stroke-width")):e.style&&e.style.strokeWidth&&(t.strokeWidth=e.style.strokeWidth),e.hasAttribute("stroke-dasharray")?(t.strokeDasharray=e.getAttribute("stroke-dasharray"),e.removeAttribute("stroke-dasharray")):e.style&&e.style.strokeDasharray&&(t.strokeDasharray=e.style.strokeDasharray);let n=e;for(;n.tagName.toLowerCase()!=="svg";)if(n=n.parentElement,n===null)throw Error("Could not find root SVG element");return{svg:n.outerHTML,style:Object.keys(t).length>0?t:void 0}}function T3(e){if(!e)return!1;let t=e.type||e["@type"];return t==="iiif:ImageApiSelector"||t==="ImageApiSelector"}function Kn(e){if(e.iiifRenderingHints){let t=e.iiifRenderingHints;if(t.rotation){let n=b3(`${t.rotation}`);if(n)if(e.selectors.length)for(let r of e.selectors)r.rotation=n;else e.selectors.push({type:"RotationSelector",rotation:n})}}else delete e.iiifRenderingHints;return e}function b3(e){let t=Number.parseFloat(e);return t&&e.startsWith("!")&&(t=360-t),t&&(t%=360),t===t&&t||0}function Jn(e,t={}){if(Array.isArray(e))return Jn(e[0]);if(typeof e=="string"){let[n,r]=e.split("#");return r?Jn({type:"SpecificResource",source:{id:n,type:t.typeMap&&t.typeMap[n]||t.defaultType||"Canvas"},selector:{type:"FragmentSelector",value:r}},t):{type:"SpecificResource",source:{id:n,type:t.typeMap&&t.typeMap[n]||t.defaultType||"Canvas"},selector:null,selectors:[]}}if(e.type==="Choice"||e.type==="List"||e.type==="Composite"||e.type==="Independents")return Jn(e.items[0],t);if(!e.type&&"source"in e&&(e.type="SpecificResource"),e.type==="SpecificResource"){e.source.type==="Canvas"&&e.source.partOf&&typeof e.source.partOf=="string"&&(e.source.partOf=[{id:e.source.partOf,type:"Manifest"}]);let n=e.styleClass||t.styleClass,r={selector:null,selectors:[]};if(typeof e.source=="string"&&e.source.includes("#")){let o=Jn(e.source,{...t,styleClass:n});e.source=o.source,r={selector:o.selector,selectors:o.selectors}}let{selector:i,selectors:s}=e.selector?$s(e.selector,t,{styleClass:n}):r;return{type:"SpecificResource",source:e.source,selector:i,selectors:s}}if(e.id){e.type==="Canvas"&&e.partOf&&typeof e.partOf=="string"&&(e.partOf=[{id:e.partOf,type:"Manifest"}]);let[n,r]=e.id.split("#");return r?Jn({type:"SpecificResource",source:{...e,id:n},selector:{type:"FragmentSelector",value:r}},t):{type:"SpecificResource",source:{...e,id:n},selector:null,selectors:[]}}return{type:"SpecificResource",source:e,selector:null,selectors:[]}}function yC(e={},t=[]){const{id:n,selector:r}=e,i=rl(),s=yn(),o=n||i.annotation,u=_n(h=>o?h.iiif.entities.Annotation[o]:void 0,[o]),d=_n(h=>u&&u.body?u.body.map(c=>c?c.type==="SpecificResource"?{...c,source:s.get(c)}:c?h.iiif.entities[c.type][c.id]:null:null).filter(Boolean):[],[u]);return b.useMemo(()=>{if(!u)return;const h={...u,body:d,target:Jn(u.target,{typeMap:s.getState().iiif.mapping})};return r?r(h):h},[u,r,d,...t])}function ut(e={},t=[]){const{id:n,selector:r}=e,i=rl(),s=n||i.canvas,o=_n(u=>s?u.iiif.entities.Canvas[s]:void 0,[s]);return b.useMemo(()=>{if(o)return r?r(o):o},[o,r,...t])}function R3(e=qa){return{addEventListener(t,n,r,i){if(t)return e.setMetaValue([t.id,"eventManager",n],s=>{let o=s||[];for(let u of o)if(u.callback===r)return o;return[...o,{callback:r,scope:i}]}),r},removeEventListener(t,n,r){t&&e.setMetaValue([t.id,"eventManager",n],i=>(i||[]).filter(s=>s.callback!==r))},getListenersAsProps(t,n){let r=typeof t=="string"?{id:t}:t;if(!r||!r.id)return{};let i=e.getResourceMeta(r.id,"eventManager"),s={};if(i&&r)for(let o of Object.keys(i))s[o]=u=>{let d=e.get(r);for(let{callback:h,scope:c}of i[o]||[])(!c||n&&c.indexOf(n)!==-1)&&h(u,d)};return s}}}function vC(e,t){const n=yn(),r=b.useMemo(()=>R3(n),[n]),i=_n(()=>e&&e.id?n.getResourceMeta(e.id,"eventManager"):null,[e]);return b.useMemo(()=>e?r.getListenersAsProps(e,t):{},[i,e,n,t])}function xC(e=qa){return{applyStyles(t,n,r){let i=typeof t=="string"?t:t.id;return e.setMetaValue([i,"styles",n],r)},getAppliedStyles(t){let n=typeof t=="string"?t:t.id;return e.getResourceMeta(n,"styles")}}}function Ed(e,t){const n=yn(),r=b.useMemo(()=>xC(n),[n]);return _n(()=>{if(!e)return null;const i=r.getAppliedStyles(e.id);return i?t?i[t]:i:void 0},[e,t])}const Cy=({id:e,style:t,className:n,interactive:r,targetId:i,ignoreTargetId:s})=>{const o=yC({id:e}),u=Ed(o,"atlas"),d=Ed(o,"html"),h=vC(o,["atlas"]),c=ut(),p=JL(),m=b.useMemo(()=>{var S;return kw(kw(t,u),(S=o==null?void 0:o.motivation)!=null&&S.includes("highlighting")?p.highlighted:p.default)},[t,u,p,o==null?void 0:o.motivation]),w=i||(c==null?void 0:c.id);return c&&o&&o.target&&o.target.selector&&(o.target.selector.type==="BoxSelector"||o.target.selector.type==="SvgSelector")&&o.target.source&&(s?!0:o.target.source.id===w||o.target.source===w)?E.jsx(rL,{id:o.id,isEditing:!0,region:o.target.selector.spatial,style:m,className:(d==null?void 0:d.className)||n,interactive:!!(d!=null&&d.href||r),href:(d==null?void 0:d.href)||null,title:(d==null?void 0:d.title)||null,hrefTarget:(d==null?void 0:d.target)||null,onClick:()=>{},...h}):null};function I3(e={},t=[]){const{id:n,selector:r}=e,i=rl(),s=n||i.annotationPage,o=_n(u=>s?u.iiif.entities.AnnotationPage[s]:void 0,[s]);return b.useMemo(()=>{if(o)return r?r(o):o},[o,...t])}const Cd=({className:e,page:t,targetId:n,ignoreTargetId:r})=>{var u;const i=I3({id:t.id})||t,s=Ed(i,"atlas"),o=Ed(i,"html");return _n(d=>i.id?d.iiif.entities.AnnotationPage[i.id]:null,[]),E.jsx(b.Fragment,{children:(u=i.items)==null?void 0:u.map(d=>E.jsx(Cy,{id:d.id,style:s,className:(o==null?void 0:o.className)||e,targetId:n,ignoreTargetId:r},d.id))})},wC=b.createContext(null),SC=b.createContext(null),kC=b.createContext(null);function _3(){const e=b.useContext(wC);if(!e)throw new Error("Ctx not found");return e}function A3(){const e=b.useContext(SC);if(!e)throw new Error("Ctx not found");return e}function O3(){const e=b.useContext(kC);if(!e)throw new Error("Ctx not found");return e}function PC({actions:e,state:t,children:n,currentTime:r,progress:i,element:s}){return E.jsx(kC.Provider,{value:{currentTime:r,progress:i,element:s},children:E.jsx(SC.Provider,{value:e,children:E.jsx(wC.Provider,{value:t,children:n})})})}function j3(e,t,n=[],r=!1,i=[]){if(i.length&&(t=t.filter(o=>i.indexOf(o)===-1)),!t||t.length===0)return;if(t.length===1)return t[0];if(!e)return t.indexOf("none")===-1?t[0]:"none";if(t.indexOf(e)!==-1)return e;let s=e.indexOf("-")===-1?null:e.slice(0,e.indexOf("-"));if(s&&t.indexOf(s)!==-1)return s;for(let o of n)if(t.indexOf(o)!==-1)return o;if(!r&&e){let o=t.map(d=>d.indexOf("-")===-1?null:d.slice(0,d.indexOf("-"))),u=o.indexOf(e);if(u!==-1)return t[u];for(let d of n){let h=d.indexOf("-")===-1?null:d.slice(0,d.indexOf("-")),c=h?t.indexOf(h):-1;if(c!==-1)return t[c]}}return t.indexOf("none")===-1?t.indexOf("@none")===-1?t[0]:"@none":"none"}function EC(e,t,n={}){let{strictFallback:r=!1,defaultText:i="",separator:s=`
`,fallbackLanguages:o=[],closest:u,skipLanguages:d}=n,h=Object.keys(e||{}),c=u?t:j3(t,h,o,r,d);if(!e)return i;if(typeof e=="string")return e;let p=c?e[c]:void 0;if(p&&c){if(typeof p=="string")return p;if(p.length===1&&p[0]===""){let m=n.skipLanguages||[];return EC(e,t,{...n,skipLanguages:[...m,c]})}return p.join(s)}return""}function M3(e,t={}){return EC(e,t.language||(typeof navigator<"u"?navigator.language:"en"),t)}function L3(e){return e.type==="SpecificResource"?[e.source,{selector:e.selector}]:[e,{selector:null}]}function N3(e=qa){function t(i){let s=i?typeof i=="string"?e.get(i):i:null;if(!s)return[];let o=e.get(s.items,{parent:s}),u=[];for(let d of o)u.push(...e.get(d.items,{parent:d}));return u}function n(i,s=[]){let o=Array.isArray(i)?i:t(i),u=[],d={items:[],type:"complex-choice"},h=[];for(let c of o){if(c.type!=="Annotation")throw Error("getPaintables() accept either a canvas or list of annotations");let p=Array.from(Array.isArray(c.body)?c.body:[c.body]);for(let m of p){let[w,{selector:y}]=L3(m),S=e.get(w),C=(S.type||"unknown").toLowerCase();if(C==="choice"){let x=e.get(S.items,{parent:S.id}),k=s.length?s.map(T=>x.find(_=>_.id===T)).filter(Boolean):[x[0]];k.length===0&&k.push(x[0]),d.items.push({type:"single-choice",items:x.map(T=>({id:T.id,label:T.label,selected:k.indexOf(T)!==-1})),label:w.label}),p.push(...k);continue}u.indexOf(C)===-1&&u.push(C),h.push({type:C,annotationId:c.id,annotation:c,resource:S,target:c.target,selector:y})}}return{types:u,items:h,choice:d.items.length<2?d.items[0]||null:d,allChoices:d.items.length?d:null}}function r(i){let{choice:s}=n(i);return s}return{getAllPaintingAnnotations:t,getPaintables:n,extractChoices:r}}function CC(){const e=Br(),t=ut();return b.useMemo(()=>{if(!e||!t||!e.start)return null;const n=Jn(e.start);return!n||n.source.id!==t.id||!n||!n.selector||n.selector.type!=="TemporalSelector"?null:n.selector.temporal},[e,t])}function Ow(e){return{isMuted:!1,playRequested:!1,isPlaying:!1,isFinished:!1,volume:100,duration:e}}function F3(e,t){switch(t.type){case"RESET":return t.state;case"FINISHED":return{...e,isFinished:!0,isPlaying:!1,playRequested:!1};case"PLAY_PAUSE":return{...e,isFinished:!1,isPlaying:!e.isPlaying};case"PLAY_REQUESTED":return{...e,isFinished:!1,playRequested:!0};case"PAUSE":return{...e,isPlaying:!1};case"PLAY":return{...e,isFinished:!1,playRequested:!1,isPlaying:!0};case"MUTE":return{...e,isMuted:!0};case"SET_VOLUME":return{...e,volume:t.volume,isMuted:t.volume===0};case"TOGGLE_MUTE":return{...e,isMuted:!e.isMuted};case"UNMUTE":return{...e,isMuted:!1}}return e}function gf(e){const t=Math.round(e);return`${Math.floor(t/60)}:${`${t%60}`.padStart(2,"0")}`}function Ty(e){const[t,n]=b.useReducer(F3,Ow(e.duration));b.useEffect(()=>{n({type:"RESET",state:Ow(e.duration)})},[e.duration]);const r=b.useRef(null),i=b.useRef(null),s=b.useRef(null),o=b.useRef(!1),u=b.useCallback(()=>{i.current&&r.current&&(i.current.innerHTML=gf(r.current.currentTime),s.current&&(s.current.style.width=`${r.current.currentTime/e.duration*100}%`),o.current!==r.current.muted&&(o.current=r.current.muted,n(r.current.muted?{type:"MUTE"}:{type:"UNMUTE"})))},[e.duration]),d=b.useCallback(()=>{r.current&&(n({type:"PLAY_REQUESTED"}),r.current.play().then(()=>{n({type:"PLAY"})}),u())},[u]),h=b.useCallback(()=>{r.current&&(r.current.duration>0&&r.current.paused?d():c())},[u]),c=b.useCallback(()=>{r.current&&(r.current.pause(),n({type:"PAUSE"}),u())},[u]),p=b.useCallback(()=>{r.current&&(r.current.muted=!r.current.muted,n(r.current.muted?{type:"MUTE"}:{type:"UNMUTE"}))},[]),m=b.useCallback(()=>{r.current&&(r.current.muted=!0,n({type:"MUTE"}))},[]),w=b.useCallback(()=>{r.current&&(r.current.muted=!1,n({type:"UNMUTE"}))},[]),y=b.useCallback(x=>{r.current&&(r.current.muted=!1,r.current.volume=x/100,n({type:"SET_VOLUME",volume:x}))},[]),S=b.useCallback(x=>{r.current&&(r.current.currentTime=Math.max(0,Math.min(x*e.duration,e.duration)),u())},[]),C=b.useCallback(x=>{if(r.current){const k=typeof x=="function"?x(r.current.currentTime):x;r.current.currentTime=Math.max(0,Math.min(k,e.duration)),u()}},[]);return b.useEffect(()=>{const x=setInterval(()=>{u()},350);return()=>clearInterval(x)},[u,e.duration]),b.useEffect(()=>{const x=()=>{n({type:"FINISHED"})},k=r.current;return k==null||k.addEventListener("ended",x),()=>k==null?void 0:k.removeEventListener("ended",x)},[]),[{element:r,currentTime:i,progress:s},t,{play:d,pause:c,playPause:h,mute:m,unmute:w,toggleMute:p,setVolume:y,setDurationPercent:S,setTime:C}]}const TC=b.createContext(()=>{}),bC=b.createContext(()=>{});function is(e,t,n,r,i=[]){const s=b.useContext(e==="portal"?bC:TC);b.useEffect(()=>(e!=="none"&&s(t,n,r),()=>{s(t,null)}),[t,e,s,...i])}function RC({media:e,startTime:t,children:n}){const[{element:r,currentTime:i,progress:s},o,u]=Ty({duration:e.duration}),d=t?`${e.url}#t=${t}`:e.url;return E.jsxs(PC,{state:o,actions:u,currentTime:i,progress:s,element:r,children:[E.jsx("audio",{ref:r,src:d}),n]},e.url)}function IC({media:e,mediaControlsDeps:t,audioCopmonent:n=RC,children:r}){const i=CC();return is("portal","audio",n,{media:e,startTime:i?i.startTime:null,children:r},[e,i,...t||[]]),null}const Ka=b.createContext(null);Ka.displayName="Strategy";function or(){const e=b.useContext(Ka);if(!e)throw new Error("useStrategy must be used within a StrategyProvider");return e}function _C({model:e}){return E.jsxs(E.Fragment,{children:[E.jsx("style",{children:`
            .model-container {
              position: absolute;
              top: 0;
              bottom: 0;
              left: 0;
              right: 0;
              background: #000;
              z-index: 13;
              display: flex;
              justify-content: center;
              pointer-events: visible;
            }
          `}),E.jsx("div",{className:"model-container",children:E.jsx("model-viewer",{"interaction-prompt":"none",style:{width:"100%",height:"100%"},"camera-controls":"","ar-status":"not-presenting",src:e.id})})]})}function AC({model:e,name:t}){return is("overlay",`model-${t}`,_C,{model:e},[e]),null}function z3(){const{strategy:e}=or();return e.type!=="3d-model"?null:E.jsx(AC,{model:e.model})}const by=b.createContext(null);by.displayName="Controls";function Gs(){const e=b.useContext(by);if(!e)throw new Error("useStrategy must be used within a StrategyProvider");return e}function $3(){const{strategy:e}=or(),{renderViewerControls:t,viewControlsDeps:n}=Gs(),r=ut(),i=r==null?void 0:r.accompanyingCanvas,s=r==null?void 0:r.placeholderCanvas;return E.jsxs(E.Fragment,{children:[e.type==="media"&&e.media.type==="Sound"&&i?E.jsx(Ko,{canvas:i.id,children:E.jsx(Ad,{renderViewerControls:t,viewControlsDeps:n})}):null,e.type==="media"&&e.media.type==="Sound"&&s&&!i?E.jsx(Ko,{canvas:s.id,children:E.jsx(Ad,{renderViewerControls:t,viewControlsDeps:n})}):null]})}function D3(){const t=yn().getStore();return b.useMemo(()=>n=>t.dispatch(n),[t])}function jw(e){return typeof e!="string"&&e&&e.bindToVault}function B3(){const e=yn(),t=b.useRef([]),n=D3(),r=b.useMemo(()=>`vault://annotation-page/${new Date().getTime()}/${Math.round(Math.random()*1e9).toString(16)}`,[]);b.useLayoutEffect(()=>{const u={id:r,type:"AnnotationPage",behavior:[],label:null,thumbnail:[],summary:null,requiredStatement:null,metadata:[],rights:null,provider:[],items:[],seeAlso:[],homepage:[],rendering:[],service:[]};n(Nc.importEntities({entities:{AnnotationPage:{[u.id]:u}}}))},[r]);const i=_n(u=>r&&u.iiif.entities.AnnotationPage[r]||null,[r]),s=b.useCallback((u,d)=>{if(r){if(jw(u)){const p=u;p.__vault||p.bindToVault(e),u=typeof p.source=="string"?p.source:p.source.id,t.current[u]=p}else typeof u!="string"&&(u=u.id);const h=e.get({id:r,type:"AnnotationPage"}),c=e.get({id:u,type:"Annotation"});h&&c&&(h.items.find(p=>p.id===c.id)||n(Nc.addReference({id:r,type:"AnnotationPage",key:"items",reference:{id:u,type:"Annotation"},index:d})))}},[r]),o=b.useCallback(u=>{r&&(jw(u)?u=typeof u.source=="string"?u.source:u.source.id:typeof u!="string"&&(u=u.id),t.current[u]&&t.current[u].beforeRemove(),e.get({id:r,type:"AnnotationPage"})&&n(Nc.removeReference({id:r,type:"AnnotationPage",key:"items",reference:{id:u,type:"Annotation"}})))},[r]);return[i,{addAnnotation:s,removeAnnotation:o}]}const OC=b.createContext(null);function U3(){const e=b.useContext(OC);return[e.fullPage,{addAnnotation:e.addAnnotation,removeAnnotation:e.removeAnnotation}]}function W3({children:e}){const[t,{addAnnotation:n,removeAnnotation:r}]=B3();return E.jsx(OC.Provider,{value:b.useMemo(()=>({fullPage:t,addAnnotation:n,removeAnnotation:r}),[t]),children:e})}function H3({children:e}){const{strategy:t}=or(),[n]=U3();return t.type!=="images"?null:E.jsxs(E.Fragment,{children:[n?E.jsx(Cd,{page:n}):null,t.annotations&&t.annotations.pages?t.annotations.pages.map(r=>E.jsx(Cd,{page:r},r.id)):null,e]})}const V3=(e,t=[])=>{const n=yn();b.useEffect(()=>{e(n)},[n,...t])},q3=at.createContext(new xy);function Q3(){return b.useContext(q3)}function mf(e,t,{canvasId:n,manifestId:r}={}){const i=yn(),s=Q3(),o=b.useMemo(()=>hM(i,{imageServiceLoader:s}),[i,s]),[u,d]=b.useState(),h=Br(r?{id:r}:void 0),c=ut(n?{id:n}:void 0),p=c||h,m=b.useRef(!1);if(b.useEffect(()=>(m.current=!1,()=>{m.current=!0}),[]),!p)throw new Error("Must be called under a manifest or canvas context.");return V3(w=>{o.getBestThumbnailAtSize(p,e,t).then(y=>{y.best&&!m.current&&d(y.best)})},[p]),u}function Ry({x:e=0,y:t=0}){const n=ut(),r=mf({maxWidth:256,maxHeight:256});return!n||!r||r.type!=="fixed"?null:E.jsx("world-object",{height:n.height,width:n.width,x:e,y:t,children:E.jsx("world-image",{uri:r.id,target:{x:0,y:0,width:n.width,height:n.height},display:r.width&&r.height?{width:r.width,height:r.height}:void 0,crop:void 0})})}function Y3({as:e}){const{strategy:t}=or(),{renderMediaControls:n,mediaControlsDeps:r}=Gs();return t.type!=="media"||t.media.type!=="Sound"?null:E.jsxs(IC,{media:t.media,mediaControlsDeps:r,audioCopmonent:e,children:[E.jsx(Ry,{}),n?n(t):null]},t.media.url)}const Iy=b.createContext(null);Iy.displayName="ComplexTimeline";function X3({children:e,store:t}){return E.jsx(Iy.Provider,{value:t,children:e})}function K3(e){const t=b.useContext(Iy);if(!t)throw new Error("useComplexTimeline must be used within a ComplexTimelineProvider");return Te(t,e)}function Mw({currentKeyFrameIndex:e,keyframes:t,targetTime:n,currentTime:r}){if(r<=n){const i=t.findIndex(u=>u.time>n);if(i===-1)return[e,[]];const s={},o=t.slice(e,i);for(const u of o)u.type==="enter"&&(s[u.id]=u),u.type==="exit"&&(s[u.id]?delete s[u.id]:s[u.id]=u);return[i,Object.values(s)]}return[e,[]]}function G3({complexTimeline:e,startTime:t=0}){const n=pf(),r={},i={progress:null,currentTime:null};let s=0,o=null,u=0;function d(){const S=w.getState().visibleElements,C=r,x=[],k=Object.keys(C);for(const T of k){const _=C[T],R=S[T];_&&R&&x.push(_)}return x}function h(){return Object.keys(r).map(S=>r[S])}function c(y){i.currentTime&&(i.currentTime.innerHTML=gf(y),i.progress&&(i.progress.style.width=`${y/e.duration*100}%`))}const p=(y=0)=>{const S=y-s,C=w.getState();if(C.isPlaying){const x=C.currentPrime;if(x){const R=r[x.id];R&&(R.paused?u+=S:u=(x.time+R.currentTime)*1e3)}else u+=S;const k=u/1e3;if(k>C.duration){w.getState().setTime(0),w.setState({isPlaying:!1}),m(),c(0);return}c(k);const[T,_]=Mw({currentTime:k,currentKeyFrameIndex:C.nextKeyframeIndex,keyframes:C.complexTimeline.keyframes,targetTime:k});_.length&&C.applyKeyframes(T,_)}s=y,o=requestAnimationFrame(p)},m=()=>{o&&cancelAnimationFrame(o)},w=us((y,S)=>({complexTimeline:e,elements:{},visibleElements:{},isBuffering:!1,bufferMap:{},isMuted:!1,playRequested:!1,isPlaying:!1,isFinished:!1,isReady:!1,volume:100,duration:e.duration,clockStartRequests:0,clockStartTime:0,primeTime:0,currentPrime:null,clockRunning:!1,nextKeyframeIndex:0,startClock:()=>{S().clockRunning||p(),y({clockRunning:!0,clockStartRequests:S().clockStartRequests+1})},applyKeyframes(C,x){const k=S(),T={...k.visibleElements};let _=k.currentPrime;for(const R of x)R.type==="enter"&&(T[R.id]=R,n.emit("complex-timeline.enter",{id:R.id})),R.type==="exit"&&(T[R.id]=null,n.emit("complex-timeline.exit",{id:R.id})),R.isPrime&&(_=R);y({nextKeyframeIndex:C,visibleElements:T,currentPrime:_})},stopClock:()=>{const C=S().clockStartRequests;if(C!==0){if(C===1){m(),y({clockRunning:!1,clockStartRequests:0});return}y({clockStartRequests:C-1})}},setElement:(C,x)=>{r[C]=x;const k=Object.keys(r),T=S().complexTimeline;T.items.filter(R=>R.type!=="Image"&&R.type!=="Text").every(R=>k.includes(R.annotationId))&&!S().isReady&&(n.emit("complex-timeline.ready",{complexTimeline:T}),y({isReady:!0}))},removeElement:C=>{delete r[C]},mute(){for(const C of h())C.muted=!0;y({isMuted:!0})},unmute(){for(const C of h())C.muted=!1;y({isMuted:!1})},play(){if(!S().isPlaying){for(const x of d())x.play();y({isPlaying:!0})}},pause(){if(S().isPlaying){for(const x of d())x.pause();y({isPlaying:!1})}},playPause(){const C=S();C.isPlaying?C.pause():C.play()},setDurationPercent(C){const k=S().duration*C;S().setTime(k)},setTime(C){const x=S();let k=u/1e3;const T=typeof C=="function"?C(k):C;let _=x.nextKeyframeIndex;if(k>T){y({visibleElements:{},currentPrime:null});const H=Object.keys(x.visibleElements);for(const V of H)n.emit("complex-timeline.exit",{id:V});k=0,_=0}const[R,O]=Mw({currentTime:k,currentKeyFrameIndex:_,keyframes:x.complexTimeline.keyframes,targetTime:T});x.applyKeyframes(R,O),u=T*1e3;const z=w.getState().visibleElements,J=r,j=Object.keys(z);for(const H of j){const V=z[H];if(V){const ne=J[H];ne&&(ne.currentTime=(u-V.time*1e3)/1e3)}}c(T)},setVolume(C){for(const x of h())x.volume=Math.min(1,Math.max(0,C/100));y({volume:C})},toggleMute(){const C=S();C.isMuted?(C.unmute(),y({isMuted:!1})):(C.mute(),y({isMuted:!0}))},clearProgressElement(){i.progress=null},setProgressElement(C){i.progress=C},setCurrentTimeElement(C){i.currentTime=C},clearCurrentTimeElement(){i.currentTime=null}}));return n.on("complex-timeline.enter",y=>{const S=w.getState(),C=y.id,x=r[C];x&&S.isPlaying&&x.play()}),n.on("complex-timeline.exit",y=>{w.getState();const S=y.id,C=r[S];C&&(C.currentTime=0,C.pause())}),w.getState().setTime(t),{store:w,emitter:n}}const jC=at.createContext(dM.store);jC.displayName="ImageServicesHelper";function _y(){return b.useContext(jC)}function Z3(e){const t=_y();return Te(t,({loaded:n})=>n[e])}function MC(){const e=_y();return Te(e,({loadServiceSync:t})=>t)}function J3(){const e=_y();return Te(e,({loaded:t})=>t)}const e4=at.createContext("en"),t4=at.createContext({}),n4=at.createContext(null);function r4(){return at.useContext(n4)}function LC(){return at.useContext(e4)}function i4(){return at.useContext(t4)}function Lw(e){return e.indexOf("-")!==-1?e.slice(0,e.indexOf("-")):e}function s4({as:e,language:t,children:n,viewingDirection:r,...i}){const s=LC();return b.useMemo(()=>Lw(s)===Lw(t),[s,t])?e?E.jsx(e,{...i,children:n}):E.jsx("span",{...i,children:n}):e?E.jsx(e,{...i,lang:t,dir:r,children:n}):E.jsx("span",{...i,lang:t,dir:r,children:n})}function o4(e,t,n){if(t.length===0)return;if(t.length===1)return t[0];if(t.indexOf(e)!==-1)return e;const r=e.indexOf("-")!==-1?e.slice(0,e.indexOf("-")):null;if(r&&t.indexOf(r)!==-1)return r;for(const i of n)if(t.indexOf(i)!==-1)return i;return t.indexOf("none")!==-1?"none":t.indexOf("@none")!==-1?"@none":t[0]}const l4=(e,t=[])=>{const n=LC();return b.useMemo(()=>{const r=e();return o4(n,r,[])},[n,...t])};function Ip(e,t,n,r){return t?n?n(e[t]||t,r||"none"):e[t]||t:""}function a4(e,t,n=`
`,r={}){const i=r4(),s=l4(()=>Object.keys(e||{}),[e]);return[b.useMemo(()=>{if(!e)return Ip(r,t,i)||"";if(typeof e=="string")return Ip(r,e,i);const o=s?e[s]:void 0;return o?typeof o=="string"?o:o.map(u=>Ip(r,u,i,s)).join(n):""},[s,t,e]),s]}function tr({as:e,defaultText:t,enableDangerouslySetInnerHTML:n,children:r,separator:i,...s}){const o=i4(),[u,d]=a4(r,t,i,o);return d?E.jsx(s4,{...s,as:e,language:d,title:n?void 0:u,dangerouslySetInnerHTML:n?{__html:u}:void 0,children:n?void 0:u}):e?E.jsx(e,{...s,children:u}):E.jsx("span",{...s,title:n?void 0:u,dangerouslySetInnerHTML:n?{__html:u}:void 0,children:n?void 0:u})}const Nw=e=>{var h,c,p,m,w;const t=e.format||"jpg",n=e.width/(((h=e.crop)==null?void 0:h.width)||e.tiles.width),r=e.tiles.imageService.sizes||[],i=e.enableThumbnail,s=e.enableSizes,o=b.useMemo(()=>{const y=e.tiles.imageService.id||e.tiles.imageService["@id"];return y!=null&&y.endsWith("/info.json")?y.slice(0,-1*10):y},[e.tiles.imageService.id,e.tiles.imageService["@id"]]),u=b.useMemo(()=>{const y=e.tiles.imageService.tiles||[];if(!y.length){const S=e.width,C=[1];let x=1;for(;2**x<S;)x=x*2,C.push(x);return(e.tiles.imageService.maxArea||e.tiles.imageService.maxWidth||e.tiles.imageService.maxHeight)&&la(2,e.tiles.imageService)?[{width:256,height:256,scaleFactors:C}]:la(2,e.tiles.imageService)?[{width:256,height:256,scaleFactors:C}]:[]}return y},[e.tiles.imageService,e.width]),d=b.useMemo(()=>{const y=e.tiles.imageService;return(y?y["@context"]?Array.isArray(y["@context"])?y["@context"]:[y["@context"]]:[]:[]).indexOf("http://iiif.io/api/image/3/context.json")!==-1},[e.tiles.imageService.id,e.tiles.imageService]);return E.jsx("world-object",{rotation:e.rotation,scale:n,height:((c=e.crop)==null?void 0:c.height)||e.tiles.height,width:((p=e.crop)==null?void 0:p.width)||e.tiles.width,x:e.x,y:e.y,onClick:e.onClick,children:E.jsxs("composite-image",{id:e.tiles.imageService.id,width:((m=e.crop)==null?void 0:m.width)||e.tiles.width,height:((w=e.crop)==null?void 0:w.height)||e.tiles.height,crop:e.crop,renderOptions:e.renderOptions,children:[i&&e.tiles.thumbnail?E.jsx("world-image",{priority:!0,uri:e.tiles.thumbnail.id,target:{width:e.tiles.width,height:e.tiles.height},display:{width:e.tiles.thumbnail.width,height:e.tiles.thumbnail.height},crop:e.crop}):null,s&&r.map((y,S)=>E.jsx("world-image",{uri:`${o}/full/${y.width},${d?y.height:""}/0/default.${t}`,target:{width:e.tiles.width,height:e.tiles.height},display:{width:y.width,height:y.height},crop:e.crop},S)),u.map(y=>(y.scaleFactors||[]).map(S=>E.jsx("tiled-image",{uri:e.tiles.imageService.id,display:{width:e.tiles.width,height:e.tiles.height},format:t,tile:y,scaleFactor:S,crop:e.crop,version3:d},`${e.tiles.imageService.id}-tile-${S}`)))]},e.tiles.imageService.id)},e.tiles.imageService.id)};function u4({resource:e,heading:t,note:n,extra:r}){var i,s;return r?E.jsx(ai,{target:{x:-1,y:-1,width:(i=r.target)==null?void 0:i.spatial.width,height:(s=r.target)==null?void 0:s.spatial.height},backgroundColor:"#333",relative:!0,children:E.jsx("div",{style:{display:"flex",alignContent:"center",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",background:"#444",color:"#BBB"},children:E.jsxs("div",{children:[E.jsx(tr,{children:t||"Not authorised"}),n&&E.jsx("p",{children:E.jsx(tr,{children:n})}),E.jsx("p",{children:e.id||e["@id"]||"unknown"})]})})}):null}function c4({image:e,thumbnail:t,crop:n,enableSizes:r,enableThumbnail:i,renderOptions:s,rotation:o}){var S,C;const u=uO(),d=rt(e.service),h=Z3(d),c=MC(),p=h==null?void 0:h.service;c(e.service,e);const m=p&&(h==null?void 0:h.status)==="done",w=((p==null?void 0:p.preferredFormats)||[])[0],y=t&&t.type==="fixed"&&t.id&&!t.id.includes("/full/full/")&&!t.id.includes("/max/")?t:void 0;if(m===!1)return null;if(!u){const x=e.service,k=x.width||e.width||0,T=x.height||e.height||0;let _=0,R=0,O=((S=e.target)==null?void 0:S.spatial.width)||k,F=((C=e.target)==null?void 0:C.spatial.height)||T;return(o===90||o===270)&&([O,F]=[F,O],F>O?R=-(F-O)/2:_=-(O-F)/2),E.jsx(Nw,{enableThumbnail:i,renderOptions:s,rotation:o,tiles:{id:x.id||x["@id"]||"unknown",height:T,width:k,imageService:x,thumbnail:y},enableSizes:r,x:_,y:R,format:w,width:O,height:F,crop:n})}return E.jsx(gO,{resource:e.service,errorComponent:u4,extra:e,children:x=>{var z,J;const k=x.width||e.width||0,T=x.height||e.height||0;let _=0,R=0,O=((z=e.target)==null?void 0:z.spatial.width)||k,F=((J=e.target)==null?void 0:J.spatial.height)||T;return(o===90||o===270)&&([O,F]=[F,O],F<O?(R=-(F-O)/2,_=(O-F)/2):(R=(F-O)/2,_=-(O-F)/2)),E.jsx(Nw,{enableThumbnail:i,renderOptions:s,tiles:{id:x.id||x["@id"]||"unknown",height:T,width:k,imageService:x,thumbnail:y},rotation:o,format:w,enableSizes:r,x:_,y:R,width:O,height:F,crop:n})}},e.id)}function Ay({id:e,image:t,thumbnail:n,isStatic:r,x:i=0,y:s=0,children:o,selector:u,onClick:d,enableSizes:h,enableAnnotations:c}){const p=b.useMemo(()=>{if(!(!u||u.spatial.x===0&&u.spatial.y===0))return u.spatial},[u]),m=b.useMemo(()=>{var _,R;const T=Array.isArray(t.annotation.body)?(_=t.annotation.body)==null?void 0:_[0]:t.annotation.body;if(T&&((R=T.selector)==null?void 0:R.type)==="ImageApiSelector")return Number(T.selector.rotation)},[t]),w=i+t.target.spatial.x,y=s+t.target.spatial.y;let S=t.target.spatial.width,C=t.target.spatial.height,x=t.target.spatial.width,k=t.target.spatial.height;return(m===90||m===270)&&([S,C]=[C,S],[x,k]=[k,x]),E.jsxs("world-object",{x:w,y,width:S,height:C,onClick:d,rotation:m,children:[t.service?E.jsxs(b.Fragment,{children:[E.jsx(c4,{image:t,thumbnail:n,crop:p,enableSizes:h,rotation:m}),o]},"service"):E.jsxs(b.Fragment,{children:[E.jsx("world-image",{onClick:d,uri:t.id,target:{x:-1,y:-1,width:x,height:k},display:x&&k?{width:x,height:k}:void 0,crop:p}),o]},"no-service"),c&&t.annotationPages?t.annotationPages.map(T=>E.jsx(Cd,{page:T,className:"image-service-annotation",ignoreTargetId:!0},T.id)):null]},e+(t.service?"server":"no-service"))}function d4(e){if(!e)return null;try{const t=new URL(e),n=t.hostname.replace(/^www\./,"");if(n==="youtu.be")return t.pathname.slice(1);if(n.endsWith("youtube.com")){if(t.pathname.startsWith("/embed/"))return t.pathname.split("/embed/")[1];if(t.searchParams.has("v"))return t.searchParams.get("v")}}catch{}return null}function NC({element:e,media:t,onPlay:n,onPause:r,onEnded:i}){const s=b.useRef(null),o=e,u=b.useMemo(()=>t.youTubeId??d4(t.url),[t.youTubeId,t.url]);if(!u)return null;const d=typeof window<"u"?`&origin=${encodeURIComponent(window.location.origin)}`:"",h=`https://www.youtube.com/embed/${u}?enablejsapi=1&controls=0&disablekb=1&modestbranding=1&rel=0&iv_load_policy=3&fs=0&playsinline=1&rel=0${d}`,c=b.useMemo(()=>t.annotationId??`yt-${u}`,[u,t.annotationId]);return b.useEffect(()=>{const p=o.current;if(!p)return;const m=S=>{if(S.source!==p.contentWindow||!(typeof S.origin=="string"&&(S.origin.indexOf("youtube.com")!==-1||S.origin.indexOf("youtube-nocookie.com")!==-1)))return;let x;try{x=typeof S.data=="string"?JSON.parse(S.data):S.data}catch{return}if(console.log("YouTube message received:",x),(x==null?void 0:x.event)==="onStateChange"){const k=x.info;k===1?n==null||n():k===2?r==null||r():k===0&&(i==null||i())}};window.addEventListener("message",m);const w=()=>{var S;(S=p.contentWindow)==null||S.postMessage(JSON.stringify({event:"listening",id:c}),"*")},y=setTimeout(w,100);return w(),()=>{clearTimeout(y),window.removeEventListener("message",m)}},[c,o,n,r,i]),E.jsxs("div",{className:"video-container",part:"video-container",children:[E.jsx("style",{children:`
          .video-container {
            position: absolute;
            inset: 0;
            background: #000;
            z-index: 13;
            display: flex;
            justify-content: center;
            pointer-events: auto; /* 'visible' n'est pas valide */
          }
          .video-yt {
            border: none;
            width: 100%;
            height: 100%;
            object-fit: contain;
          }
        `}),E.jsx("iframe",{id:c,className:"video-yt",ref:p=>{s.current=p,e&&(e.current=p)},title:"YouTube video player",src:h,allow:"autoplay; encrypted-media; picture-in-picture",loading:"lazy"})]})}function f4({media:e,mediaControlsDeps:t,children:n}){const[{element:r,currentTime:i,progress:s},o,u]=Ty({duration:e.duration});return is("overlay","video-element",NC,{element:r,media:e,playPause:u.playPause}),null}function FC({strategy:e,onClickPaintingAnnotation:t}){return E.jsx(E.Fragment,{children:e.items.map((n,r)=>{var i;return E.jsx(E.Fragment,{children:E.jsx(ai,{onClick:t?s=>{s.stopPropagation(),t(n.annotationId,n,s)}:void 0,target:((i=n.target)==null?void 0:i.spatial)||void 0,children:E.jsx("div",{"data-textual-content":!0,children:E.jsx(tr,{enableDangerouslySetInnerHTML:!0,children:n.text})})},r)})})})}function h4(e){let t=!0,n=0,r=100,i=!1,s=0;const o=(d,h=[])=>{var c;(c=e.contentWindow)==null||c.postMessage(JSON.stringify({event:"command",func:d,args:h}),"*")},u=()=>{if(!t){const d=performance.now();n+=(d-s)/1e3,s=d,requestAnimationFrame(u)}};return{play(){t=!1,s=performance.now(),o("playVideo"),requestAnimationFrame(u)},pause(){t=!0,o("pauseVideo")},get paused(){return t},get currentTime(){return n},set currentTime(d){n=Math.max(0,d),o("seekTo",[n,!0])},get muted(){return i},set muted(d){i=d,o(d?"mute":"unMute")},get volume(){return r},set volume(d){r=Math.max(0,Math.min(100,d)),o("setVolume",[r])}}}const p4=b.memo(function({item:t,visible:n,store:r}){const i=b.useRef(null);return b.useEffect(()=>{if(!i.current)return;const s=h4(i.current);r.getState().setElement(t.annotationId,s)},[t.annotationId,r]),E.jsxs("div",{style:{position:"absolute",inset:0,opacity:n?1:0,pointerEvents:n?"auto":"none",width:"100%",height:"100%"},children:[E.jsx(NC,{element:i,media:t,playPause:()=>{}}),E.jsx("button",{type:"button","aria-label":"Play/Pause",onClick:s=>{s.stopPropagation(),r.getState().playPause()},style:{position:"absolute",inset:0,background:"transparent",border:0,padding:0,margin:0,cursor:"pointer",zIndex:20}})]})},(e,t)=>{var n,r;return e.visible===t.visible&&((n=e.item)==null?void 0:n.annotationId)===((r=t.item)==null?void 0:r.annotationId)}),g4=p4;function m4({strategy:e,children:t}){const{store:n}=b.useMemo(()=>G3({complexTimeline:e}),[e]),r=Te(n,m=>m.isReady),i=Te(n,m=>m.visibleElements),s=b.useContext(Ya),o=(s==null?void 0:s.runtime)||null,u=b.useCallback(m=>{if(!o)return;const w=o.getScaleFactor(),y=m/w;o.setViewport({x:o.x+y,y:o.y})},[o]),[d,h]=b.useState(!1);b.useEffect(()=>{if(typeof window>"u")return;const m=window.matchMedia("(min-width: 1024px) and (hover: hover) and (pointer: fine)"),w=C=>{h(("matches"in C,C.matches))};w(m);const y=m.addEventListener?"addEventListener":"addListener",S=m.removeEventListener?"removeEventListener":"removeListener";return m[y]("change",w),()=>m[S]("change",w)},[]),b.useEffect(()=>{if(!d||!o)return;const m=setInterval(()=>{clearInterval(m),u(150)},200);return()=>clearInterval(m)},[d,o,u]);function c(m){return w=>{w&&n.getState().setElement(m,w)}}const p=b.useMemo(()=>e.items.some(m=>m.type==="Video"&&!!i[m.annotationId]),[e.items,i]);return b.useEffect(()=>{if(typeof document>"u")return;const m=document.getElementById("root");if(m){const w="has-video";return p?m.classList.add(w):m.classList.remove(w),()=>m.classList.remove(w)}},[p]),b.useLayoutEffect(()=>{if(r){const{startClock:m,stopClock:w}=n.getState();return m(),()=>{w()}}},[e,r]),is("portal","custom-controls",X3,{store:n,children:t},[r]),E.jsxs(E.Fragment,{children:[e.items.map(m=>m.type!=="Image"||!i[m.annotationId]?null:E.jsx(Ay,{image:m,id:m.annotationId},m.id)),e.items.map((m,w)=>m.type!=="Text"||!i[m.annotationId]?null:E.jsx(FC,{strategy:{type:"textual-content",items:[m]}},w)),e.items.map((m,w)=>{var C,x,k;if(m.type!=="Video")return null;const y=m.url||((k=(x=(C=m.annotation)==null?void 0:C.body)==null?void 0:x[0])==null?void 0:k.id)||"";if(/youtube\.com|youtu\.be/.test(y)){const T=!!i[m.annotationId];return E.jsx(ai,{target:m.target.spatial,children:E.jsx(g4,{store:n,item:m,visible:T})},w)}else return E.jsx(ai,{target:m.target.spatial,children:E.jsx("video",{ref:c(m.annotationId),src:m.url,style:{height:"100%",width:"100%",opacity:i[m.annotationId]?1:0}})},w)}),e.items.map((m,w)=>m.type!=="Sound"?null:E.jsx(ai,{children:E.jsx("audio",{ref:c(m.annotationId),src:m.url})},w)),e.highlights.map(({annotation:m})=>i[m.id]?E.jsx(Cy,{id:m.id,ignoreTargetId:!0,style:{outline:"3px solid red"},className:"image-service-annotation"},m.id):null)]})}function y4(){const{strategy:e}=or(),{renderComplexTimelineControls:t}=Gs();return e.type!=="complex-timeline"?null:E.jsx(m4,{strategy:e,children:t?t(e):null})}function zC({style:e}){const t=ut();return!t||!t.height||!t.width?null:E.jsx("box",{interactive:!1,target:{x:0,y:0,width:Number(t.width),height:Number(t.height)},style:e})}function v4({backgroundStyle:e,alwaysShowBackground:t}){const{strategy:n}=or();return n.type!=="empty"&&!t?null:E.jsx(zC,{style:e})}const yf=b.createContext(null);function Oy(){return b.useContext(yf)}function x4({isStatic:e=!1,enableSizes:t=!1,enableAnnotations:n=!0,onClickPaintingAnnotation:r,children:i}){const{strategy:s}=or(),{renderViewerControls:o,viewControlsDeps:u}=Gs(),d=ut(),h=Oy(),c=mf({maxWidth:256,maxHeight:256});return is(h&&s.type==="images"&&o?"overlay":"none",`canvas-portal-controls-${d==null?void 0:d.id}`,yf.Provider,o?{value:h||null,children:o(s)}:{},[d,h,s,...u||[]]),s.type!=="images"?null:E.jsxs(E.Fragment,{children:[s.images.map((p,m)=>E.jsx(Ay,{isStatic:e,image:p,id:p.id,thumbnail:m===0?c:void 0,selector:p.selector,enableSizes:t,enableAnnotations:n,onClick:r?w=>{r(p.annotationId,p,w)}:void 0},p.id+m)),i]})}function w4({onClickPaintingAnnotation:e,children:t}){const{strategy:n}=or(),{renderViewerControls:r,viewControlsDeps:i}=Gs(),s=Oy(),o=ut();return is(s&&n.type==="textual-content"&&r?"overlay":"none",`canvas-portal-controls-${o==null?void 0:o.id}`,yf.Provider,r?{value:s||null,children:r(n)}:{},[o,s,n,...i||[]]),n.type!=="textual-content"?null:E.jsxs(E.Fragment,{children:[E.jsx(FC,{strategy:n,onClickPaintingAnnotation:e}),t]})}function $C({element:e,media:t,startTime:n,playPause:r,poster:i}){const s="div",o=n?`${t.url}#t=${n}`:t.url;return E.jsxs(s,{className:"video-container",part:"video-container",onClick:r,children:[E.jsx("style",{children:`
            .video-container {
              position: absolute;
              top: 0;
              bottom: 0;
              left: 0;
              right: 0;
              background: #000;
              z-index: 13;
              display: flex;
              justify-content: center;
              pointer-events: visible;
            }
          `}),E.jsx("video",{poster:i,ref:e,src:o,style:{width:"100%",objectFit:"contain"}})]})}function DC({media:e,mediaControlsDeps:t,children:n,videoComponent:r=$C,captions:i}){const s=ut(),o=CC(),u=s&&s.placeholderCanvas&&s.placeholderCanvas.id||void 0,d=mf({},!1,{canvasId:u}),[{element:h,currentTime:c,progress:p},m,w]=Ty({duration:e.duration});return is("overlay","video-element",r,{element:h,media:e,playPause:w.playPause,poster:d==null?void 0:d.id,canvas:s,startTime:o?o.startTime:null,captions:i},[d]),is("portal","custom-controls",PC,{state:m,actions:w,currentTime:c,progress:p,element:h,children:n},[c,m,e,...t||[]]),null}function S4({as:e}){const{strategy:t}=or(),{renderMediaControls:n,mediaControlsDeps:r}=Gs();return t.type!=="media"||t.media.type!=="Video"?null:E.jsxs(DC,{captions:t.captions,media:t.media,mediaControlsDeps:r,videoComponent:e,children:[E.jsx(Ry,{}),n?n(t):null]},t.media.url)}function k4(){const{strategy:e}=or(),{renderMediaControls:t,mediaControlsDeps:n}=Gs();return e.type!=="media"||e.media.type!=="VideoYouTube"?null:E.jsxs(f4,{media:e.media,mediaControlsDeps:n,children:[E.jsx(Ry,{}),t?t(e):null]})}function P4(e){const t=An(),n=Te(t,s=>s.polygons),r=Te(t,s=>s.polygonState),i=Te(t,s=>s.polygon);return Hc("atlas.polygon-render",({state:s,slowState:o,dt:u})=>{e(s,o,u)}),{currentShape:i,state:r,helper:n}}const Zr=WL(),E4={shapeFill:"#ffffff33",shapeStroke:"#000",lineStroke:"#000",ghostLineStroke:"#0F0",activeLineStroke:"#4D7EEA",boundingBoxDottedStroke:"#0007",boundingBoxStroke:"#fffA",controlFill:"#fff"};function C4(e){const t={...E4,...e.theme||{}},n=b.useRef(),r=b.useRef(),i=b.useRef(),s=b.useRef(),o=b.useRef(),u=b.useRef(),d=b.useRef(),h=b.useRef(),c=b.useRef(),p=b.useRef(),[m,w]=b.useState(null),[y,S]=b.useState(!1),{helper:C,state:x,currentShape:k}=P4((j,H)=>{if(j.closestLineIndex,Zr.updateTransitionBoundingBox(i.current,j,H),Zr.updateBoundingBoxPolygon(n.current,j,H),Zr.updateBoundingBoxPolygon(r.current,j,H),Zr.updateTransitionShape(d.current,j,H),Zr.updateClosestLinePointTransform(o.current,j,H),Zr.updateSelectBox(s.current,j,H),Zr.updatePointLine(h.current,j,H),Zr.updateDrawPreview(u.current,j,H,3),Zr.updateLineBox(c.current,j),w(j.transitionDirection),S(j.transitionRotate),j.closestLineIndex!==-1&&p.current){const V=j.polygon,ne=V.points[j.closestLineIndex],Y=V.points[(j.closestLineIndex+1)%V.points.length];ne&&Y&&p.current.setAttribute("points",`${ne[0]},${ne[1]} ${Y[0]},${Y[1]}`)}});b.useEffect(()=>{const j=()=>{C.modifiers.reset()};return document.addEventListener("mouseleave",j),()=>{document.removeEventListener("mouseleave",j)}},[]);const T=E.jsxs(E.Fragment,{children:[E.jsxs("marker",{id:"dot",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"5",markerHeight:"5",children:[E.jsx("circle",{cx:"5",cy:"5",r:"5",fill:t.lineStroke,className:"marker"}),E.jsx("circle",{cx:"5",cy:"5",r:"3",fill:t.controlFill})]}),E.jsx("marker",{id:"newdot",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"5",markerHeight:"5",children:E.jsx("circle",{cx:"5",cy:"5",r:"5",fill:t.activeLineStroke,className:"marker"})}),E.jsxs("marker",{id:"selected",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"5",markerHeight:"5",children:[E.jsx("circle",{cx:"5",cy:"5",r:"5",fill:t.lineStroke}),E.jsx("circle",{cx:"5",cy:"5",r:"3",fill:t.activeLineStroke})]}),E.jsxs("marker",{id:"resizer",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"6",markerHeight:"6",children:[E.jsx("rect",{width:"10",height:"10",fill:t.lineStroke}),E.jsx("rect",{x:"1",y:"1",width:"8",height:"8",fill:t.controlFill})]})]}),_=k?k.open?"polyline":"polygon":null,R=!x.showBoundingBox&&x.closestPoint!==null&&x.actionIntentType==="select-point",O=x.actionIntentType==="add-open-point",F=x.transitionIntentType==="split-line",z=x.transitioning&&x.selectedStamp&&x.transitionIntentType==="stamp-shape",J=k&&_?E.jsxs(E.Fragment,{children:[E.jsx(_,{fill:(!x.transitioning||x.transitionIntentType==="select-multiple-points")&&!k.open?t.shapeFill:"none",strokeWidth:z||x.showBoundingBox&&x.boxMode||x.transitioning&&x.transitionIntentType==="split-line"||x.transitioning&&x.transitionIntentType==="move-point"?0:2,stroke:t.shapeStroke,points:k.points.map(j=>j.join(",")).join(" "),vectorEffect:"non-scaling-stroke",markerStart:x.showBoundingBox?void 0:x.boxMode?"url(#resizer)":"url(#dot)",markerMid:x.showBoundingBox?void 0:x.boxMode?"url(#resizer)":"url(#dot)",markerEnd:x.showBoundingBox?void 0:x.boxMode?"url(#resizer)":"url(#dot)",style:{pointerEvents:"none"},opacity:x.transitioning&&x.transitionIntentType==="move-shape"?0:1}),x.currentTool==="lineBox"&&x.actionIntentType==="close-line-box"?E.jsx("polygon",{fill:t.shapeFill,ref:c,stroke:t.lineStroke,strokeWidth:2,vectorEffect:"non-scaling-stroke"}):null,x.transitionIntentType==="draw-shape"&&x.transitioning?E.jsx("polyline",{ref:u,fill:"none",stroke:t.activeLineStroke,strokeWidth:2,vectorEffect:"non-scaling-stroke"}):null,!(x.transitioning&&x.transitionIntentType==="move-point")&&!(x.transitioning&&x.transitionIntentType==="stamp-shape")&&!x.showBoundingBox&&x.selectedPoints&&x.selectedPoints.length?E.jsx("polyline",{strokeWidth:2,vectorEffect:"non-scaling-stroke",stroke:"transparent",markerStart:"url(#selected)",markerMid:"url(#selected)",markerEnd:"url(#selected)",fill:"transparent",points:k.points.filter((j,H)=>{var V;return(V=x.selectedPoints)==null?void 0:V.includes(H)}).map(j=>j.join(",")).join(" "),opacity:x.transitioning&&x.transitionIntentType==="move-shape"?0:1}):null,R&&!x.transitioning&&x.closestPoint!==null&&k.points[x.closestPoint]?E.jsx("polyline",{strokeWidth:2,vectorEffect:"non-scaling-stroke",stroke:"transparent",markerStart:"url(#selected)",markerMid:"url(#selected)",markerEnd:"url(#selected)",fill:t.activeLineStroke,points:`${k.points[x.closestPoint][0]},${k.points[x.closestPoint][1]}`,opacity:x.transitioning&&x.transitionIntentType==="move-shape"?0:1}):null,!x.transitioning&&(x.actionIntentType==="add-open-point"||x.actionIntentType==="close-shape"||x.actionIntentType==="close-shape-line")?E.jsx("polyline",{stroke:t.activeLineStroke,ref:h,strokeWidth:x.actionIntentType==="add-open-point"?1:2,vectorEffect:"non-scaling-stroke"}):null,x.hasClosestLine&&!x.showBoundingBox&&!x.transitioning&&x.currentTool!=="box"&&x.transitionIntentType==="split-line"?E.jsx("g",{children:E.jsx("polyline",{ref:p,vectorEffect:"non-scaling-stroke",fill:"transparent",stroke:t.activeLineStroke,strokeWidth:3})}):null,x.hasClosestLine&&!x.showBoundingBox&&!x.transitioning&&x.currentTool!=="box"&&x.transitionIntentType==="split-line"?E.jsx("g",{ref:o,children:E.jsx("polyline",{markerStart:"url(#newdot)",points:"0,0 1,1",vectorEffect:"non-scaling-stroke",stroke:"transparent",fill:"transparent",strokeWidth:2})}):null,x.transitioning?E.jsx(_,{ref:d,fill:k.open?"none":t.shapeFill,stroke:x.transitionIntentType==="stamp-shape"?t.activeLineStroke:t.shapeStroke,vectorEffect:"non-scaling-stroke",strokeWidth:(k.open,2)}):null,x.transitioning&&x.transitionIntentType==="select-multiple-points"?E.jsx("rect",{ref:s,fill:"rgba(255, 255, 255, .3)",strokeWidth:1,stroke:"rgba(0,0,0,.2)",vectorEffect:"non-scaling-stroke"}):null,x.showBoundingBox&&!z?E.jsxs(E.Fragment,{children:[E.jsx("polygon",{ref:n,strokeWidth:2,stroke:t.boundingBoxStroke,fill:"none",markerStart:"url(#resizer)",markerMid:"url(#resizer)",markerEnd:"url(#resizer)",vectorEffect:"non-scaling-stroke"}),E.jsx("polygon",{ref:r,strokeWidth:2,stroke:t.boundingBoxDottedStroke,fill:"none",strokeDasharray:"4 4",markerStart:"url(#resizer)",markerMid:"url(#resizer)",markerEnd:"url(#resizer)",vectorEffect:"non-scaling-stroke"})]}):null]}):null;return{currentTool:C.state.slowState.currentTool,setCurrentTool:C.tools.setTool,helper:C,currentShape:k,state:x,isAddingPoint:O,isSplitting:F,isStamping:z,isHoveringPoint:R,transitionDirection:m,transitionRotate:y,defs:T,editor:J}}function T4(e){var S;const t=ky(),{image:n}=e,{helper:r,defs:i,editor:s,state:o,transitionDirection:u,isSplitting:d,transitionRotate:h,isHoveringPoint:c,isAddingPoint:p}=C4({image:e.image,theme:e.theme}),m=b.useCallback(C=>{C.button!==2&&r.pointer([[~~C.atlas.x,~~C.atlas.y]])},[r]),w=b.useCallback(C=>{C.button!==2&&r.pointerDown()},[r]),y=b.useCallback(C=>{C.button!==2&&r.pointerUp()},[r]);return b.useEffect(()=>{const C=x=>{r.key.up(x.key)};return document.addEventListener("keyup",C),()=>{document.removeEventListener("keyup",C)}},[r]),b.useEffect(()=>{const C=x=>{var k;x.target&&["INPUT","TEXTAREA"].includes(x.target.tagName)||(k=x.target)!=null&&k.isContentEditable||document.activeElement&&(document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement||document.activeElement.isContentEditable)||r.key.down(x.key)};return document.addEventListener("keydown",C),()=>{document.removeEventListener("keydown",C)}},[r]),b.useEffect(()=>{var x;const C=[];return u&&C.push(`atlas-cursor-${u}`),o.actionIntentType==="cut-line"&&((x=o.modifiers)!=null&&x.Shift)&&C.push("atlas-cursor-cut"),(c||o.transitionIntentType==="move-shape"||o.transitionIntentType==="move-point")&&C.push("atlas-cursor-move"),p&&C.push("atlas-cursor-crosshair"),d&&C.push("atlas-cursor-copy"),h&&C.push("atlas-cursor-rotate"),o.transitionIntentType==="draw-shape"&&C.push("atlas-cursor-draw"),t!=null&&t.canvas&&t.canvas.classList.add(...C),()=>{t!=null&&t.canvas&&t.canvas.classList.remove(...C)}},[t==null?void 0:t.canvas,p,c,d,(S=o.modifiers)==null?void 0:S.Shift,o.actionIntentType,o.transitionIntentType,u,h]),E.jsx("world-object",{height:n.height,width:n.width,onMouseMove:m,onMouseDown:w,onMouseUp:y,onMouseLeave:r.blur,children:E.jsx(ai,{relative:!0,interactive:!1,children:E.jsx("div",{className:"absolute top-0 right-0 left-0 bottom-0",children:E.jsxs("svg",{width:"100%",height:"100%",viewBox:`0 0 ${n.width} ${n.height}`,tabIndex:-1,children:[E.jsx("title",{children:"Annotation Editor"}),E.jsx("defs",{children:i}),s]})})})})}function vf(){return typeof window<"u"}function sl(e){return BC(e)?(e.nodeName||"").toLowerCase():"#document"}function zn(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Wr(e){var t;return(t=(BC(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function BC(e){return vf()?e instanceof Node||e instanceof zn(e).Node:!1}function kt(e){return vf()?e instanceof Element||e instanceof zn(e).Element:!1}function Pr(e){return vf()?e instanceof HTMLElement||e instanceof zn(e).HTMLElement:!1}function lm(e){return!vf()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof zn(e).ShadowRoot}const b4=new Set(["inline","contents"]);function Ga(e){const{overflow:t,overflowX:n,overflowY:r,display:i}=sr(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!b4.has(i)}const R4=new Set(["table","td","th"]);function I4(e){return R4.has(sl(e))}const _4=[":popover-open",":modal"];function xf(e){return _4.some(t=>{try{return e.matches(t)}catch{return!1}})}const A4=["transform","translate","scale","rotate","perspective"],O4=["transform","translate","scale","rotate","perspective","filter"],j4=["paint","layout","strict","content"];function jy(e){const t=wf(),n=kt(e)?sr(e):e;return A4.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||O4.some(r=>(n.willChange||"").includes(r))||j4.some(r=>(n.contain||"").includes(r))}function M4(e){let t=gi(e);for(;Pr(t)&&!ui(t);){if(jy(t))return t;if(xf(t))return null;t=gi(t)}return null}function wf(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const L4=new Set(["html","body","#document"]);function ui(e){return L4.has(sl(e))}function sr(e){return zn(e).getComputedStyle(e)}function Sf(e){return kt(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function gi(e){if(sl(e)==="html")return e;const t=e.assignedSlot||e.parentNode||lm(e)&&e.host||Wr(e);return lm(t)?t.host:t}function UC(e){const t=gi(e);return ui(t)?e.ownerDocument?e.ownerDocument.body:e.body:Pr(t)&&Ga(t)?t:UC(t)}function Ji(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const i=UC(e),s=i===((r=e.ownerDocument)==null?void 0:r.body),o=zn(i);if(s){const u=am(o);return t.concat(o,o.visualViewport||[],Ga(i)?i:[],u&&n?Ji(u):[])}return t.concat(i,Ji(i,[],n))}function am(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}const Td=Math.min,Ds=Math.max,bd=Math.round,Sc=Math.floor,$r=e=>({x:e,y:e}),N4={left:"right",right:"left",bottom:"top",top:"bottom"},F4={start:"end",end:"start"};function Fw(e,t,n){return Ds(e,Td(t,n))}function kf(e,t){return typeof e=="function"?e(t):e}function Qs(e){return e.split("-")[0]}function Pf(e){return e.split("-")[1]}function WC(e){return e==="x"?"y":"x"}function HC(e){return e==="y"?"height":"width"}const z4=new Set(["top","bottom"]);function Ui(e){return z4.has(Qs(e))?"y":"x"}function VC(e){return WC(Ui(e))}function $4(e,t,n){n===void 0&&(n=!1);const r=Pf(e),i=VC(e),s=HC(i);let o=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(o=Rd(o)),[o,Rd(o)]}function D4(e){const t=Rd(e);return[um(e),t,um(t)]}function um(e){return e.replace(/start|end/g,t=>F4[t])}const zw=["left","right"],$w=["right","left"],B4=["top","bottom"],U4=["bottom","top"];function W4(e,t,n){switch(e){case"top":case"bottom":return n?t?$w:zw:t?zw:$w;case"left":case"right":return t?B4:U4;default:return[]}}function H4(e,t,n,r){const i=Pf(e);let s=W4(Qs(e),n==="start",r);return i&&(s=s.map(o=>o+"-"+i),t&&(s=s.concat(s.map(um)))),s}function Rd(e){return e.replace(/left|right|bottom|top/g,t=>N4[t])}function V4(e){return{top:0,right:0,bottom:0,left:0,...e}}function q4(e){return typeof e!="number"?V4(e):{top:e,right:e,bottom:e,left:e}}function Id(e){const{x:t,y:n,width:r,height:i}=e;return{width:r,height:i,top:n,left:t,right:t+r,bottom:n+i,x:t,y:n}}function Dw(e,t){if(!e||!t)return!1;const n=t.getRootNode==null?void 0:t.getRootNode();if(e.contains(t))return!0;if(n&&lm(n)){let r=t;for(;r;){if(e===r)return!0;r=r.parentNode||r.host}}return!1}function Bl(e){return"composedPath"in e?e.composedPath()[0]:e.target}function _p(e,t){if(t==null)return!1;if("composedPath"in e)return e.composedPath().includes(t);const n=e;return n.target!=null&&t.contains(n.target)}function Q4(e){return e.matches("html,body")}function Bw(e){return(e==null?void 0:e.ownerDocument)||document}function Vc(e,t,n){return n===void 0&&(n=!0),e.filter(i=>{var s;return i.parentId===t&&(!n||((s=i.context)==null?void 0:s.open))}).flatMap(i=>[i,...Vc(e,i.id,n)])}function Y4(e){return"nativeEvent"in e}var X4=typeof document<"u",K4=function(){},cm=X4?b.useLayoutEffect:K4;const G4={...c1},Z4=G4.useInsertionEffect,J4=Z4||(e=>e());function So(e){const t=b.useRef(()=>{});return J4(()=>{t.current=e}),b.useCallback(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.current==null?void 0:t.current(...r)},[])}function Uw(e,t,n){let{reference:r,floating:i}=e;const s=Ui(t),o=VC(t),u=HC(o),d=Qs(t),h=s==="y",c=r.x+r.width/2-i.width/2,p=r.y+r.height/2-i.height/2,m=r[u]/2-i[u]/2;let w;switch(d){case"top":w={x:c,y:r.y-i.height};break;case"bottom":w={x:c,y:r.y+r.height};break;case"right":w={x:r.x+r.width,y:p};break;case"left":w={x:r.x-i.width,y:p};break;default:w={x:r.x,y:r.y}}switch(Pf(t)){case"start":w[o]-=m*(n&&h?-1:1);break;case"end":w[o]+=m*(n&&h?-1:1);break}return w}const eN=async(e,t,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:o}=n,u=s.filter(Boolean),d=await(o.isRTL==null?void 0:o.isRTL(t));let h=await o.getElementRects({reference:e,floating:t,strategy:i}),{x:c,y:p}=Uw(h,r,d),m=r,w={},y=0;for(let S=0;S<u.length;S++){const{name:C,fn:x}=u[S],{x:k,y:T,data:_,reset:R}=await x({x:c,y:p,initialPlacement:r,placement:m,strategy:i,middlewareData:w,rects:h,platform:o,elements:{reference:e,floating:t}});c=k??c,p=T??p,w={...w,[C]:{...w[C],..._}},R&&y<=50&&(y++,typeof R=="object"&&(R.placement&&(m=R.placement),R.rects&&(h=R.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:i}):R.rects),{x:c,y:p}=Uw(h,m,d)),S=-1)}return{x:c,y:p,placement:m,strategy:i,middlewareData:w}};async function qC(e,t){var n;t===void 0&&(t={});const{x:r,y:i,platform:s,rects:o,elements:u,strategy:d}=e,{boundary:h="clippingAncestors",rootBoundary:c="viewport",elementContext:p="floating",altBoundary:m=!1,padding:w=0}=kf(t,e),y=q4(w),C=u[m?p==="floating"?"reference":"floating":p],x=Id(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(C)))==null||n?C:C.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(u.floating)),boundary:h,rootBoundary:c,strategy:d})),k=p==="floating"?{x:r,y:i,width:o.floating.width,height:o.floating.height}:o.reference,T=await(s.getOffsetParent==null?void 0:s.getOffsetParent(u.floating)),_=await(s.isElement==null?void 0:s.isElement(T))?await(s.getScale==null?void 0:s.getScale(T))||{x:1,y:1}:{x:1,y:1},R=Id(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:u,rect:k,offsetParent:T,strategy:d}):k);return{top:(x.top-R.top+y.top)/_.y,bottom:(R.bottom-x.bottom+y.bottom)/_.y,left:(x.left-R.left+y.left)/_.x,right:(R.right-x.right+y.right)/_.x}}const tN=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:i,middlewareData:s,rects:o,initialPlacement:u,platform:d,elements:h}=t,{mainAxis:c=!0,crossAxis:p=!0,fallbackPlacements:m,fallbackStrategy:w="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:S=!0,...C}=kf(e,t);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const x=Qs(i),k=Ui(u),T=Qs(u)===u,_=await(d.isRTL==null?void 0:d.isRTL(h.floating)),R=m||(T||!S?[Rd(u)]:D4(u)),O=y!=="none";!m&&O&&R.push(...H4(u,S,y,_));const F=[u,...R],z=await qC(t,C),J=[];let j=((r=s.flip)==null?void 0:r.overflows)||[];if(c&&J.push(z[x]),p){const Y=$4(i,o,_);J.push(z[Y[0]],z[Y[1]])}if(j=[...j,{placement:i,overflows:J}],!J.every(Y=>Y<=0)){var H,V;const Y=(((H=s.flip)==null?void 0:H.index)||0)+1,de=F[Y];if(de&&(!(p==="alignment"?k!==Ui(de):!1)||j.every(M=>Ui(M.placement)===k?M.overflows[0]>0:!0)))return{data:{index:Y,overflows:j},reset:{placement:de}};let se=(V=j.filter(ve=>ve.overflows[0]<=0).sort((ve,M)=>ve.overflows[1]-M.overflows[1])[0])==null?void 0:V.placement;if(!se)switch(w){case"bestFit":{var ne;const ve=(ne=j.filter(M=>{if(O){const L=Ui(M.placement);return L===k||L==="y"}return!0}).map(M=>[M.placement,M.overflows.filter(L=>L>0).reduce((L,W)=>L+W,0)]).sort((M,L)=>M[1]-L[1])[0])==null?void 0:ne[0];ve&&(se=ve);break}case"initialPlacement":se=u;break}if(i!==se)return{reset:{placement:se}}}return{}}}},nN=new Set(["left","top"]);async function rN(e,t){const{placement:n,platform:r,elements:i}=e,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),o=Qs(n),u=Pf(n),d=Ui(n)==="y",h=nN.has(o)?-1:1,c=s&&d?-1:1,p=kf(t,e);let{mainAxis:m,crossAxis:w,alignmentAxis:y}=typeof p=="number"?{mainAxis:p,crossAxis:0,alignmentAxis:null}:{mainAxis:p.mainAxis||0,crossAxis:p.crossAxis||0,alignmentAxis:p.alignmentAxis};return u&&typeof y=="number"&&(w=u==="end"?y*-1:y),d?{x:w*c,y:m*h}:{x:m*h,y:w*c}}const iN=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:i,y:s,placement:o,middlewareData:u}=t,d=await rN(t,e);return o===((n=u.offset)==null?void 0:n.placement)&&(r=u.arrow)!=null&&r.alignmentOffset?{}:{x:i+d.x,y:s+d.y,data:{...d,placement:o}}}}},sN=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:i}=t,{mainAxis:s=!0,crossAxis:o=!1,limiter:u={fn:C=>{let{x,y:k}=C;return{x,y:k}}},...d}=kf(e,t),h={x:n,y:r},c=await qC(t,d),p=Ui(Qs(i)),m=WC(p);let w=h[m],y=h[p];if(s){const C=m==="y"?"top":"left",x=m==="y"?"bottom":"right",k=w+c[C],T=w-c[x];w=Fw(k,w,T)}if(o){const C=p==="y"?"top":"left",x=p==="y"?"bottom":"right",k=y+c[C],T=y-c[x];y=Fw(k,y,T)}const S=u.fn({...t,[m]:w,[p]:y});return{...S,data:{x:S.x-n,y:S.y-r,enabled:{[m]:s,[p]:o}}}}}};function QC(e){const t=sr(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const i=Pr(e),s=i?e.offsetWidth:n,o=i?e.offsetHeight:r,u=bd(n)!==s||bd(r)!==o;return u&&(n=s,r=o),{width:n,height:r,$:u}}function My(e){return kt(e)?e:e.contextElement}function Uo(e){const t=My(e);if(!Pr(t))return $r(1);const n=t.getBoundingClientRect(),{width:r,height:i,$:s}=QC(t);let o=(s?bd(n.width):n.width)/r,u=(s?bd(n.height):n.height)/i;return(!o||!Number.isFinite(o))&&(o=1),(!u||!Number.isFinite(u))&&(u=1),{x:o,y:u}}const oN=$r(0);function YC(e){const t=zn(e);return!wf()||!t.visualViewport?oN:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function lN(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==zn(e)?!1:t}function Ys(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const i=e.getBoundingClientRect(),s=My(e);let o=$r(1);t&&(r?kt(r)&&(o=Uo(r)):o=Uo(e));const u=lN(s,n,r)?YC(s):$r(0);let d=(i.left+u.x)/o.x,h=(i.top+u.y)/o.y,c=i.width/o.x,p=i.height/o.y;if(s){const m=zn(s),w=r&&kt(r)?zn(r):r;let y=m,S=am(y);for(;S&&r&&w!==y;){const C=Uo(S),x=S.getBoundingClientRect(),k=sr(S),T=x.left+(S.clientLeft+parseFloat(k.paddingLeft))*C.x,_=x.top+(S.clientTop+parseFloat(k.paddingTop))*C.y;d*=C.x,h*=C.y,c*=C.x,p*=C.y,d+=T,h+=_,y=zn(S),S=am(y)}}return Id({width:c,height:p,x:d,y:h})}function Ef(e,t){const n=Sf(e).scrollLeft;return t?t.left+n:Ys(Wr(e)).left+n}function XC(e,t){const n=e.getBoundingClientRect(),r=n.left+t.scrollLeft-Ef(e,n),i=n.top+t.scrollTop;return{x:r,y:i}}function aN(e){let{elements:t,rect:n,offsetParent:r,strategy:i}=e;const s=i==="fixed",o=Wr(r),u=t?xf(t.floating):!1;if(r===o||u&&s)return n;let d={scrollLeft:0,scrollTop:0},h=$r(1);const c=$r(0),p=Pr(r);if((p||!p&&!s)&&((sl(r)!=="body"||Ga(o))&&(d=Sf(r)),Pr(r))){const w=Ys(r);h=Uo(r),c.x=w.x+r.clientLeft,c.y=w.y+r.clientTop}const m=o&&!p&&!s?XC(o,d):$r(0);return{width:n.width*h.x,height:n.height*h.y,x:n.x*h.x-d.scrollLeft*h.x+c.x+m.x,y:n.y*h.y-d.scrollTop*h.y+c.y+m.y}}function uN(e){return Array.from(e.getClientRects())}function cN(e){const t=Wr(e),n=Sf(e),r=e.ownerDocument.body,i=Ds(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),s=Ds(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+Ef(e);const u=-n.scrollTop;return sr(r).direction==="rtl"&&(o+=Ds(t.clientWidth,r.clientWidth)-i),{width:i,height:s,x:o,y:u}}const Ww=25;function dN(e,t){const n=zn(e),r=Wr(e),i=n.visualViewport;let s=r.clientWidth,o=r.clientHeight,u=0,d=0;if(i){s=i.width,o=i.height;const c=wf();(!c||c&&t==="fixed")&&(u=i.offsetLeft,d=i.offsetTop)}const h=Ef(r);if(h<=0){const c=r.ownerDocument,p=c.body,m=getComputedStyle(p),w=c.compatMode==="CSS1Compat"&&parseFloat(m.marginLeft)+parseFloat(m.marginRight)||0,y=Math.abs(r.clientWidth-p.clientWidth-w);y<=Ww&&(s-=y)}else h<=Ww&&(s+=h);return{width:s,height:o,x:u,y:d}}const fN=new Set(["absolute","fixed"]);function hN(e,t){const n=Ys(e,!0,t==="fixed"),r=n.top+e.clientTop,i=n.left+e.clientLeft,s=Pr(e)?Uo(e):$r(1),o=e.clientWidth*s.x,u=e.clientHeight*s.y,d=i*s.x,h=r*s.y;return{width:o,height:u,x:d,y:h}}function Hw(e,t,n){let r;if(t==="viewport")r=dN(e,n);else if(t==="document")r=cN(Wr(e));else if(kt(t))r=hN(t,n);else{const i=YC(e);r={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return Id(r)}function KC(e,t){const n=gi(e);return n===t||!kt(n)||ui(n)?!1:sr(n).position==="fixed"||KC(n,t)}function pN(e,t){const n=t.get(e);if(n)return n;let r=Ji(e,[],!1).filter(u=>kt(u)&&sl(u)!=="body"),i=null;const s=sr(e).position==="fixed";let o=s?gi(e):e;for(;kt(o)&&!ui(o);){const u=sr(o),d=jy(o);!d&&u.position==="fixed"&&(i=null),(s?!d&&!i:!d&&u.position==="static"&&!!i&&fN.has(i.position)||Ga(o)&&!d&&KC(e,o))?r=r.filter(c=>c!==o):i=u,o=gi(o)}return t.set(e,r),r}function gN(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e;const o=[...n==="clippingAncestors"?xf(t)?[]:pN(t,this._c):[].concat(n),r],u=o[0],d=o.reduce((h,c)=>{const p=Hw(t,c,i);return h.top=Ds(p.top,h.top),h.right=Td(p.right,h.right),h.bottom=Td(p.bottom,h.bottom),h.left=Ds(p.left,h.left),h},Hw(t,u,i));return{width:d.right-d.left,height:d.bottom-d.top,x:d.left,y:d.top}}function mN(e){const{width:t,height:n}=QC(e);return{width:t,height:n}}function yN(e,t,n){const r=Pr(t),i=Wr(t),s=n==="fixed",o=Ys(e,!0,s,t);let u={scrollLeft:0,scrollTop:0};const d=$r(0);function h(){d.x=Ef(i)}if(r||!r&&!s)if((sl(t)!=="body"||Ga(i))&&(u=Sf(t)),r){const w=Ys(t,!0,s,t);d.x=w.x+t.clientLeft,d.y=w.y+t.clientTop}else i&&h();s&&!r&&i&&h();const c=i&&!r&&!s?XC(i,u):$r(0),p=o.left+u.scrollLeft-d.x-c.x,m=o.top+u.scrollTop-d.y-c.y;return{x:p,y:m,width:o.width,height:o.height}}function Ap(e){return sr(e).position==="static"}function Vw(e,t){if(!Pr(e)||sr(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Wr(e)===n&&(n=n.ownerDocument.body),n}function GC(e,t){const n=zn(e);if(xf(e))return n;if(!Pr(e)){let i=gi(e);for(;i&&!ui(i);){if(kt(i)&&!Ap(i))return i;i=gi(i)}return n}let r=Vw(e,t);for(;r&&I4(r)&&Ap(r);)r=Vw(r,t);return r&&ui(r)&&Ap(r)&&!jy(r)?n:r||M4(e)||n}const vN=async function(e){const t=this.getOffsetParent||GC,n=this.getDimensions,r=await n(e.floating);return{reference:yN(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function xN(e){return sr(e).direction==="rtl"}const wN={convertOffsetParentRelativeRectToViewportRelativeRect:aN,getDocumentElement:Wr,getClippingRect:gN,getOffsetParent:GC,getElementRects:vN,getClientRects:uN,getDimensions:mN,getScale:Uo,isElement:kt,isRTL:xN};function ZC(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function SN(e,t){let n=null,r;const i=Wr(e);function s(){var u;clearTimeout(r),(u=n)==null||u.disconnect(),n=null}function o(u,d){u===void 0&&(u=!1),d===void 0&&(d=1),s();const h=e.getBoundingClientRect(),{left:c,top:p,width:m,height:w}=h;if(u||t(),!m||!w)return;const y=Sc(p),S=Sc(i.clientWidth-(c+m)),C=Sc(i.clientHeight-(p+w)),x=Sc(c),T={rootMargin:-y+"px "+-S+"px "+-C+"px "+-x+"px",threshold:Ds(0,Td(1,d))||1};let _=!0;function R(O){const F=O[0].intersectionRatio;if(F!==d){if(!_)return o();F?o(!1,F):r=setTimeout(()=>{o(!1,1e-7)},1e3)}F===1&&!ZC(h,e.getBoundingClientRect())&&o(),_=!1}try{n=new IntersectionObserver(R,{...T,root:i.ownerDocument})}catch{n=new IntersectionObserver(R,T)}n.observe(e)}return o(!0),s}function kN(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:u=typeof IntersectionObserver=="function",animationFrame:d=!1}=r,h=My(e),c=i||s?[...h?Ji(h):[],...Ji(t)]:[];c.forEach(x=>{i&&x.addEventListener("scroll",n,{passive:!0}),s&&x.addEventListener("resize",n)});const p=h&&u?SN(h,n):null;let m=-1,w=null;o&&(w=new ResizeObserver(x=>{let[k]=x;k&&k.target===h&&w&&(w.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var T;(T=w)==null||T.observe(t)})),n()}),h&&!d&&w.observe(h),w.observe(t));let y,S=d?Ys(e):null;d&&C();function C(){const x=Ys(e);S&&!ZC(S,x)&&n(),S=x,y=requestAnimationFrame(C)}return n(),()=>{var x;c.forEach(k=>{i&&k.removeEventListener("scroll",n),s&&k.removeEventListener("resize",n)}),p==null||p(),(x=w)==null||x.disconnect(),w=null,d&&cancelAnimationFrame(y)}}const PN=iN,EN=sN,CN=tN,TN=(e,t,n)=>{const r=new Map,i={platform:wN,...n},s={...i.platform,_c:r};return eN(e,t,{...i,platform:s})};var bN=typeof document<"u",RN=function(){},qc=bN?b.useLayoutEffect:RN;function _d(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!_d(e[r],t[r]))return!1;return!0}if(i=Object.keys(e),n=i.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,i[r]))return!1;for(r=n;r--!==0;){const s=i[r];if(!(s==="_owner"&&e.$$typeof)&&!_d(e[s],t[s]))return!1}return!0}return e!==e&&t!==t}function JC(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function qw(e,t){const n=JC(e);return Math.round(t*n)/n}function Op(e){const t=b.useRef(e);return qc(()=>{t.current=e}),t}function IN(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:i,elements:{reference:s,floating:o}={},transform:u=!0,whileElementsMounted:d,open:h}=e,[c,p]=b.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[m,w]=b.useState(r);_d(m,r)||w(r);const[y,S]=b.useState(null),[C,x]=b.useState(null),k=b.useCallback(M=>{M!==O.current&&(O.current=M,S(M))},[]),T=b.useCallback(M=>{M!==F.current&&(F.current=M,x(M))},[]),_=s||y,R=o||C,O=b.useRef(null),F=b.useRef(null),z=b.useRef(c),J=d!=null,j=Op(d),H=Op(i),V=Op(h),ne=b.useCallback(()=>{if(!O.current||!F.current)return;const M={placement:t,strategy:n,middleware:m};H.current&&(M.platform=H.current),TN(O.current,F.current,M).then(L=>{const W={...L,isPositioned:V.current!==!1};Y.current&&!_d(z.current,W)&&(z.current=W,Wa.flushSync(()=>{p(W)}))})},[m,t,n,H,V]);qc(()=>{h===!1&&z.current.isPositioned&&(z.current.isPositioned=!1,p(M=>({...M,isPositioned:!1})))},[h]);const Y=b.useRef(!1);qc(()=>(Y.current=!0,()=>{Y.current=!1}),[]),qc(()=>{if(_&&(O.current=_),R&&(F.current=R),_&&R){if(j.current)return j.current(_,R,ne);ne()}},[_,R,ne,j,J]);const de=b.useMemo(()=>({reference:O,floating:F,setReference:k,setFloating:T}),[k,T]),se=b.useMemo(()=>({reference:_,floating:R}),[_,R]),ve=b.useMemo(()=>{const M={position:n,left:0,top:0};if(!se.floating)return M;const L=qw(se.floating,c.x),W=qw(se.floating,c.y);return u?{...M,transform:"translate("+L+"px, "+W+"px)",...JC(se.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:L,top:W}},[n,u,se.floating,c.x,c.y]);return b.useMemo(()=>({...c,update:ne,refs:de,elements:se,floatingStyles:ve}),[c,ne,de,se,ve])}const _N=(e,t)=>({...PN(e),options:[e,t]}),AN=(e,t)=>({...EN(e),options:[e,t]}),ON=(e,t)=>({...CN(e),options:[e,t]}),jN="data-floating-ui-focusable",Qw="active",Yw="selected",MN={...c1};let Xw=!1,LN=0;const Kw=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+LN++;function NN(){const[e,t]=b.useState(()=>Xw?Kw():void 0);return cm(()=>{e==null&&t(Kw())},[]),b.useEffect(()=>{Xw=!0},[]),e}const FN=MN.useId,zN=FN||NN;function $N(){const e=new Map;return{emit(t,n){var r;(r=e.get(t))==null||r.forEach(i=>i(n))},on(t,n){e.has(t)||e.set(t,new Set),e.get(t).add(n)},off(t,n){var r;(r=e.get(t))==null||r.delete(n)}}}const DN=b.createContext(null),BN=b.createContext(null),UN=()=>{var e;return((e=b.useContext(DN))==null?void 0:e.id)||null},eT=()=>b.useContext(BN);function WN(e){return"data-floating-ui-"+e}const HN={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},VN={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},Gw=e=>{var t,n;return{escapeKey:typeof e=="boolean"?e:(t=e==null?void 0:e.escapeKey)!=null?t:!1,outsidePress:typeof e=="boolean"?e:(n=e==null?void 0:e.outsidePress)!=null?n:!0}};function qN(e,t){t===void 0&&(t={});const{open:n,onOpenChange:r,elements:i,dataRef:s}=e,{enabled:o=!0,escapeKey:u=!0,outsidePress:d=!0,outsidePressEvent:h="pointerdown",referencePress:c=!1,referencePressEvent:p="pointerdown",ancestorScroll:m=!1,bubbles:w,capture:y}=t,S=eT(),C=So(typeof d=="function"?d:()=>!1),x=typeof d=="function"?C:d,k=b.useRef(!1),{escapeKey:T,outsidePress:_}=Gw(w),{escapeKey:R,outsidePress:O}=Gw(y),F=b.useRef(!1),z=So(Y=>{var de;if(!n||!o||!u||Y.key!=="Escape"||F.current)return;const se=(de=s.current.floatingContext)==null?void 0:de.nodeId,ve=S?Vc(S.nodesRef.current,se):[];if(!T&&(Y.stopPropagation(),ve.length>0)){let M=!0;if(ve.forEach(L=>{var W;if((W=L.context)!=null&&W.open&&!L.context.dataRef.current.__escapeKeyBubbles){M=!1;return}}),!M)return}r(!1,Y4(Y)?Y.nativeEvent:Y,"escape-key")}),J=So(Y=>{var de;const se=()=>{var ve;z(Y),(ve=Bl(Y))==null||ve.removeEventListener("keydown",se)};(de=Bl(Y))==null||de.addEventListener("keydown",se)}),j=So(Y=>{var de;const se=s.current.insideReactTree;s.current.insideReactTree=!1;const ve=k.current;if(k.current=!1,h==="click"&&ve||se||typeof x=="function"&&!x(Y))return;const M=Bl(Y),L="["+WN("inert")+"]",W=Bw(i.floating).querySelectorAll(L);let le=kt(M)?M:null;for(;le&&!ui(le);){const be=gi(le);if(ui(be)||!kt(be))break;le=be}if(W.length&&kt(M)&&!Q4(M)&&!Dw(M,i.floating)&&Array.from(W).every(be=>!Dw(le,be)))return;if(Pr(M)&&ne){const be=ui(M),Ie=sr(M),Ke=/auto|scroll/,ln=be||Ke.test(Ie.overflowX),an=be||Ke.test(Ie.overflowY),xt=ln&&M.clientWidth>0&&M.scrollWidth>M.clientWidth,Ne=an&&M.clientHeight>0&&M.scrollHeight>M.clientHeight,ye=Ie.direction==="rtl",ae=Ne&&(ye?Y.offsetX<=M.offsetWidth-M.clientWidth:Y.offsetX>M.clientWidth),$e=xt&&Y.offsetY>M.clientHeight;if(ae||$e)return}const we=(de=s.current.floatingContext)==null?void 0:de.nodeId,je=S&&Vc(S.nodesRef.current,we).some(be=>{var Ie;return _p(Y,(Ie=be.context)==null?void 0:Ie.elements.floating)});if(_p(Y,i.floating)||_p(Y,i.domReference)||je)return;const Re=S?Vc(S.nodesRef.current,we):[];if(Re.length>0){let be=!0;if(Re.forEach(Ie=>{var Ke;if((Ke=Ie.context)!=null&&Ke.open&&!Ie.context.dataRef.current.__outsidePressBubbles){be=!1;return}}),!be)return}r(!1,Y,"outside-press")}),H=So(Y=>{var de;const se=()=>{var ve;j(Y),(ve=Bl(Y))==null||ve.removeEventListener(h,se)};(de=Bl(Y))==null||de.addEventListener(h,se)});b.useEffect(()=>{if(!n||!o)return;s.current.__escapeKeyBubbles=T,s.current.__outsidePressBubbles=_;let Y=-1;function de(W){r(!1,W,"ancestor-scroll")}function se(){window.clearTimeout(Y),F.current=!0}function ve(){Y=window.setTimeout(()=>{F.current=!1},wf()?5:0)}const M=Bw(i.floating);u&&(M.addEventListener("keydown",R?J:z,R),M.addEventListener("compositionstart",se),M.addEventListener("compositionend",ve)),x&&M.addEventListener(h,O?H:j,O);let L=[];return m&&(kt(i.domReference)&&(L=Ji(i.domReference)),kt(i.floating)&&(L=L.concat(Ji(i.floating))),!kt(i.reference)&&i.reference&&i.reference.contextElement&&(L=L.concat(Ji(i.reference.contextElement)))),L=L.filter(W=>{var le;return W!==((le=M.defaultView)==null?void 0:le.visualViewport)}),L.forEach(W=>{W.addEventListener("scroll",de,{passive:!0})}),()=>{u&&(M.removeEventListener("keydown",R?J:z,R),M.removeEventListener("compositionstart",se),M.removeEventListener("compositionend",ve)),x&&M.removeEventListener(h,O?H:j,O),L.forEach(W=>{W.removeEventListener("scroll",de)}),window.clearTimeout(Y)}},[s,i,u,x,h,n,r,m,o,T,_,z,R,J,j,O,H]),b.useEffect(()=>{s.current.insideReactTree=!1},[s,x,h]);const V=b.useMemo(()=>({onKeyDown:z,...c&&{[HN[p]]:Y=>{r(!1,Y.nativeEvent,"reference-press")},...p!=="click"&&{onClick(Y){r(!1,Y.nativeEvent,"reference-press")}}}}),[z,r,c,p]),ne=b.useMemo(()=>({onKeyDown:z,onMouseDown(){k.current=!0},onMouseUp(){k.current=!0},[VN[h]]:()=>{s.current.insideReactTree=!0}}),[z,h,s]);return b.useMemo(()=>o?{reference:V,floating:ne}:{},[o,V,ne])}function QN(e){const{open:t=!1,onOpenChange:n,elements:r}=e,i=zN(),s=b.useRef({}),[o]=b.useState(()=>$N()),u=UN()!=null,[d,h]=b.useState(r.reference),c=So((w,y,S)=>{s.current.openEvent=w?y:void 0,o.emit("openchange",{open:w,event:y,reason:S,nested:u}),n==null||n(w,y,S)}),p=b.useMemo(()=>({setPositionReference:h}),[]),m=b.useMemo(()=>({reference:d||r.reference||null,floating:r.floating||null,domReference:r.reference}),[d,r.reference,r.floating]);return b.useMemo(()=>({dataRef:s,open:t,onOpenChange:c,elements:m,events:o,floatingId:i,refs:p}),[t,c,m,o,i,p])}function YN(e){e===void 0&&(e={});const{nodeId:t}=e,n=QN({...e,elements:{reference:null,floating:null,...e.elements}}),r=e.rootContext||n,i=r.elements,[s,o]=b.useState(null),[u,d]=b.useState(null),c=(i==null?void 0:i.domReference)||s,p=b.useRef(null),m=eT();cm(()=>{c&&(p.current=c)},[c]);const w=IN({...e,elements:{...i,...u&&{reference:u}}}),y=b.useCallback(T=>{const _=kt(T)?{getBoundingClientRect:()=>T.getBoundingClientRect(),getClientRects:()=>T.getClientRects(),contextElement:T}:T;d(_),w.refs.setReference(_)},[w.refs]),S=b.useCallback(T=>{(kt(T)||T===null)&&(p.current=T,o(T)),(kt(w.refs.reference.current)||w.refs.reference.current===null||T!==null&&!kt(T))&&w.refs.setReference(T)},[w.refs]),C=b.useMemo(()=>({...w.refs,setReference:S,setPositionReference:y,domReference:p}),[w.refs,S,y]),x=b.useMemo(()=>({...w.elements,domReference:c}),[w.elements,c]),k=b.useMemo(()=>({...w,...r,refs:C,elements:x,nodeId:t}),[w,C,x,t,r]);return cm(()=>{r.dataRef.current.floatingContext=k;const T=m==null?void 0:m.nodesRef.current.find(_=>_.id===t);T&&(T.context=k)}),b.useMemo(()=>({...w,context:k,refs:C,elements:x}),[w,C,x,k])}function jp(e,t,n){const r=new Map,i=n==="item";let s=e;if(i&&e){const{[Qw]:o,[Yw]:u,...d}=e;s=d}return{...n==="floating"&&{tabIndex:-1,[jN]:""},...s,...t.map(o=>{const u=o?o[n]:null;return typeof u=="function"?e?u(e):null:u}).concat(e).reduce((o,u)=>(u&&Object.entries(u).forEach(d=>{let[h,c]=d;if(!(i&&[Qw,Yw].includes(h)))if(h.indexOf("on")===0){if(r.has(h)||r.set(h,[]),typeof c=="function"){var p;(p=r.get(h))==null||p.push(c),o[h]=function(){for(var m,w=arguments.length,y=new Array(w),S=0;S<w;S++)y[S]=arguments[S];return(m=r.get(h))==null?void 0:m.map(C=>C(...y)).find(C=>C!==void 0)}}}else o[h]=c}),o),{})}}function XN(e){e===void 0&&(e=[]);const t=e.map(u=>u==null?void 0:u.reference),n=e.map(u=>u==null?void 0:u.floating),r=e.map(u=>u==null?void 0:u.item),i=b.useCallback(u=>jp(u,e,"reference"),t),s=b.useCallback(u=>jp(u,e,"floating"),n),o=b.useCallback(u=>jp(u,e,"item"),r);return b.useMemo(()=>({getReferenceProps:i,getFloatingProps:s,getItemProps:o}),[i,s,o])}const KN=pf(),Cf=b.createContext({emitter:KN});Cf.displayName="Events";function tT(){return at.useContext(Cf).emitter}const Ly=at.createContext({});function nT(){const e=b.useContext(Ly),t=Object.keys(e),n={};for(const r of t)e[r].Provider&&(n[r]={value:b.useContext(e[r]),Provider:e[r].Provider});return n}function GN(e){const t=Object.keys(e);let n=e.children;for(const r of t){if(r==="children")continue;const{value:i,Provider:s}=e[r];n=E.jsx(s,{value:i,children:n})}return n}function rT(){return{VaultContext:b.useContext(Zd),ResourceContext:b.useContext(ay),SimpleViewerReactContext:b.useContext(nf),VisibleCanvasReactContext:b.useContext(Jd),AuthRContext:b.useContext(Ha),SearchReactContext:b.useContext(il),ReactEventContext:b.useContext(Cf),ContextBridgeReactContext:b.useContext(Ly),StrategyReactContext:b.useContext(Ka),AtlasStoreReactContext:b.useContext(Fa)}}function iT(e){return E.jsx(hy,{vault:e.bridge.VaultContext.vault||void 0,resources:e.bridge.ResourceContext,children:E.jsx(Jd.Provider,{value:e.bridge.VisibleCanvasReactContext,children:E.jsx(nf.Provider,{value:e.bridge.SimpleViewerReactContext,children:E.jsx(Cf.Provider,{value:e.bridge.ReactEventContext,children:E.jsx(Fa.Provider,{value:e.bridge.AtlasStoreReactContext,children:E.jsx(Ha.Provider,{value:e.bridge.AuthRContext,children:E.jsx(il.Provider,{value:e.bridge.SearchReactContext,children:E.jsx(Ly.Provider,{value:e.bridge.ContextBridgeReactContext,children:E.jsx(Ka.Provider,{value:e.bridge.StrategyReactContext,children:e.custom?E.jsx(GN,{...e.custom,children:e.children}):e.children})})})})})})})})})}function sT({annotation:e,target:t,children:n,dismissable:r,isOpen:i,onOpenChange:s,placement:o}){const u=rT(),d=nT(),{refs:h,floatingStyles:c,context:p}=YN({open:i,onOpenChange:s,nodeId:e.id,placement:o||"bottom",middleware:[_N(10),AN(),ON({mainAxis:!0})],whileElementsMounted:kN}),m=qN(p),{getReferenceProps:w,getFloatingProps:y}=XN([r?m:null].filter(S=>S!==null));return E.jsxs(ai,{relative:!0,target:t,interactive:!1,children:[E.jsx("div",{ref:h.setReference,...w(),style:{position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none"}}),Wa.createPortal(E.jsx(iT,{bridge:u,custom:d,children:E.jsx("div",{ref:h.setFloating,style:c,...y(),children:n})}),document.getElementById("atlas-floating-ui"))]})}const ZN=tO()(e=>({isMenuOpen:!1,menuPosition:{x:0,y:0},setMenuPosition(t){e({menuPosition:t})},toggle(t){e(n=>({isMenuOpen:!n.isMenuOpen,menuPosition:t}))},open(t){e({isMenuOpen:!0,menuPosition:t})},setIsMenuOpen(t){e(typeof t=="function"?n=>({isMenuOpen:t(n.isMenuOpen)}):{isMenuOpen:t})},close(){e({isMenuOpen:!1})}}));function oT(e,t,n){const{isMenuOpen:r,setIsMenuOpen:i,close:s,open:o,menuPosition:u,setMenuPosition:d,toggle:h}=ZN(),c=b.useCallback(w=>{n&&(w.preventDefault(),w.stopPropagation(),h(w.atlas))},[h,n]);return[E.jsx(E.Fragment,{children:n&&r&&E.jsx(sT,{dismissable:!0,placement:"bottom-start",isOpen:r,onOpenChange:i,annotation:{id:e},target:{x:u.x,y:u.y,height:1,width:1},children:r&&n({canvasId:t,position:u,close:()=>i(!1)})})}),{onContextMenu:c},{open:o,close:s,toggle:h,isMenuOpen:r,setIsMenuOpen:i,menuPosition:u,setMenuPosition:d}]}function JN(){const e=An();return Te(e,t=>t.tool.requestId&&t.requests[t.tool.requestId]||null)}function e5({theme:e,renderContextMenu:t,children:n}){const r=An(),i=ut(),s=Te(r,R=>R.polygon),o=Te(r,R=>R.polygonState.currentTool),u=Te(r,R=>R.mode),d=Te(r,R=>R.changeMode),h=Te(r,R=>R.polygonState.transitioning),{enabled:c,requestId:p}=Te(r,R=>R.tool),m=b.useMemo(()=>Pd(s),[s]),w=JN(),[y,S]=oT("editing-annotation",i==null?void 0:i.id,t),C=(w==null?void 0:w.annotationPopup)||n||E.jsx(t5,{}),x=(w==null?void 0:w.svgTheme)||e,k=()=>{d("sketch")};if(!c||!i||!p||!s)return null;const T=m&&s.id&&!h&&(o==="pointer"||o==="hand"||!s.open)?E.jsx(sT,{annotation:s,target:m,children:C}):null,_="shape";return u==="explore"?E.jsxs(E.Fragment,{children:[E.jsx(_,{id:`shape-${s.id}`,points:s.points,open:s.open,onClick:k,relativeStyle:!0,target:{x:0,y:0,width:i.width,height:i.height},style:{":hover":{backgroundColor:"rgba(0,0,0,0.2)"},backgroundColor:"rgba(0,0,0,0)",borderWidth:"4px",borderColor:"rgba(255, 255, 255, .4)"},...S}),E.jsx(_,{id:`shape-${s.id}`,points:s.points,open:s.open,onClick:k,relativeStyle:!0,target:{x:0,y:0,width:i.width,height:i.height},style:{backgroundColor:"rgba(0,0,0,0)",borderWidth:"2px",borderColor:"rgba(0, 0, 0, .4)"}}),T]}):E.jsxs(E.Fragment,{children:[t?E.jsx(_,{id:`shape-${s.id}`,points:s.points,open:s.open,target:{x:0,y:0,width:i.width,height:i.height},...S}):null,E.jsx(T4,{image:i,theme:x}),T,y]})}function t5(){const e=An(),t=Te(e,o=>o.changeMode),n=Te(e,o=>o.mode),r=Te(e,o=>o.completeRequest),i=Te(e,o=>o.tool),s=()=>{b.startTransition(()=>{r()})};return i.enabled?E.jsxs("div",{className:"svg-tools-container animate-fadeIn",children:[n!=="sketch"&&E.jsx("button",{className:"svg-tools-button",onClick:()=>{t("sketch")},children:"Edit"}),E.jsx("button",{className:"svg-tools-button",onClick:s,children:"Save"})]}):null}function lT(e,t){const{selector:n,source:r}=Jn(t);if(r.id!==e.id)return[null,r];const i={spatial:{x:0,y:0,width:Number(e.width),height:Number(e.height)}};return[n?n.type==="TemporalSelector"?{type:"TemporalBoxSelector",temporal:n.temporal,spatial:i.spatial}:n:null,r]}const n5={makeChoice:()=>{}},Mp={type:"unknown"},Bt=e=>({type:"unknown",reason:e,annotations:{pages:[]}}),r5=(e,t)=>({type:"empty",width:e,height:t,annotations:{pages:[]},image:null,images:[]});function i5(e,t){var r;const n=(r=e==null?void 0:e.iiif)==null?void 0:r.meta[t];return n?n.annotationPageManager:null}function s5(e,t){return _n(n=>{const r=[];if(!e)return r;const i=Object.keys(n.iiif.entities.AnnotationPage);for(const s of i)if(!t||t.indexOf(s)!==-1){const o=i5(n,s);o&&o.views&&o.views[e]&&r.push(s)}return r},[e,t])}function o5({canvas:e,manifest:t,all:n,canvases:r}){const i=[];if(t)for(const s of t.annotations)i.indexOf(s.id)===-1&&i.push(s.id);if(n){if(r&&r.length)for(const s of r)for(const o of s.annotations)i.indexOf(o.id)===-1&&i.push(o.id)}else if(e)for(const s of e.annotations)i.indexOf(s.id)===-1&&i.push(s.id);return i}function l5(e,t){var r;const n=(r=e==null?void 0:e.iiif)==null?void 0:r.meta[t];return n?n.annotationPageManager:null}function Ny(e,t={}){const n=yn(),r=Br(),i=ut(),s=py(),o=b.useMemo(()=>o5({all:t.all,manifest:r,canvas:i,canvases:s}),[t.all,i,s,r]),u=s5(e,t.all?void 0:o),d=b.useCallback(c=>{e&&n.setMetaValue([c,"annotationPageManager","views"],p=>p&&!p[e]?p:{...p||{},[e]:!1})},[e,n]),h=b.useCallback((c,p={})=>{if(!e)return;const m=n.getState(),w=[];if(p!=null&&p.deselectOthers){const y=Object.keys(m.iiif.entities.AnnotationPage);for(const S of y){const C=l5(m,S);C&&C.views&&C.views[e]&&w.push(S)}}for(const y of w)d(y);n.setMetaValue([c,"annotationPageManager","views"],y=>y&&y[e]?y:{...y||{},[e]:!0})},[e,d,n]);return{availablePageIds:o,enabledPageIds:u,setPageEnabled:h,setPageDisabled:d}}function a5(e,t){return _n((n,r)=>r.get(e.map(i=>({id:i,type:t}))),[e,t])}const u5=us((e,t)=>({loaded:{},setLoaded:(n,r="done")=>{e(i=>({loaded:{...i.loaded,[n]:r}}))}})),c5=pf();c5.on("loaded",e=>{u5.getState().setLoaded(e.imageServiceId)});function d5(){const e=MC(),t=J3();return[b.useCallback((r,{height:i,width:s})=>r&&e(r,{height:i,width:s},!0),[e]),t]}function f5(e={}){const t=yC(),n=ut(e.canvasId?{id:e.canvasId}:void 0);return _n((r,i)=>{if(!n)return[];if(t&&e.enableSingleAnnotation)return[t];const s=i.get(n.items),o=[];for(const u of s)o.push(...i.get(u.items));return o},[n])}function h5(e,t=[]){const n=yn(),r=b.useMemo(()=>N3(n),[]),i=f5({enableSingleAnnotation:e==null?void 0:e.enableSingleAnnotation}),[s,o]=b.useState((e==null?void 0:e.defaultChoices)||[]),u=b.useMemo(()=>r.getPaintables(i,s),[n,i,s,...t]),h={makeChoice:b.useCallback((c,{deselectOthers:p=!0,deselect:m=!1}={})=>{u.choice&&o(w=>{if(m){const S=w.filter(C=>C!==c);if(S.length===0){const C=u.items[0].resource.id;return C?[C]:[]}return S}if(p)return[c];const y=[...w];if(y.length===0&&u.items.length){const S=u.items[0].resource.id;S&&y.push(S)}return w.indexOf(c)!==-1?w:[...w,c]})},[u.choice])};return[u,h]}const p5=["model/gltf-binary"];function g5(e,t){const n=t.items[0],r=n.resource;return r.format?p5.indexOf(r.format)===-1?Bt(`3D format: ${r.format} is unsupported`):{type:"3d-model",model:r,annotationId:n.annotationId,annotation:n.annotation}:Bt("Unknown format")}function aT(e,t){const n=t.items,r=n[0];if(n.length===0||!r)return Bt("No audio");if(!e.duration)return Bt("No duration on canvas");if(n.length>1)return Bt("Only one audio source supported");const i=r.resource;return i?("format"in i||(i.format="audio/mpeg"),{type:"media",media:{annotationId:r.annotationId,annotation:r.annotation,duration:e.duration,url:i.id,type:"Sound",target:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}},format:i.format,selector:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}}},annotations:{pages:[]}}):Bt("Unknown audio")}function uT(e,t,n){var i;const r=[];for(const s of t.items){const o=s.resource&&s.resource.type==="SpecificResource"?s.resource.source:s.resource;if(!o.id)return Bt("No resource Identifier");let u;if(o.service){const S=vy(o);S[0]&&(u=n(S[0],e))}const d={type:"BoxSelector",spatial:{x:0,y:0,width:Number(e.width),height:Number(e.height)}},[h,c]=lT(e,s.target),p=((i=e.id)==null?void 0:i.split("?")[0])||"";if(!(c.id===e.id||decodeURIComponent(c.id||"")===(e.id||"")||c.id===p||decodeURIComponent(c.id||"")===p))continue;s.resource.width&&s.resource.height&&(s.resource.width,s.resource.height);let m=s.resource.type==="SpecificResource"?Jn(s.resource):null;if(s.selector){const S=Jn({type:"SpecificResource",source:s.resource,selector:s.selector});S&&(m=S)}const w=m&&m.selector&&(m.selector.type==="BoxSelector"||m.selector.type==="TemporalBoxSelector")?{type:"BoxSelector",spatial:{x:m.selector.spatial.x,y:m.selector.spatial.y,width:m.selector.spatial.width,height:m.selector.spatial.height}}:void 0;u&&!u.id&&(u.id=u["@id"]);const y={id:o.id,type:"Image",annotationId:s.annotationId,annotation:s.annotation,width:Number(h||w?o.width:e.width),height:Number(h||w?o.height:e.height),service:u,sizes:u&&u.sizes?u.sizes:o.width&&o.height?[{width:o.width,height:o.height}]:[],target:h&&h.type!=="PointSelector"?h:d,selector:w||{type:"BoxSelector",spatial:{x:0,y:0,width:Number(e.width),height:Number(e.height)}},annotationPages:s.resource.annotations||[]};r.push(y)}return{type:"images",image:r[0],images:r,choice:t.choice}}function cT(e,t={},n){const r=e.language||n||"none";switch(e.type){case"TextualBody":{typeof e.value<"u"&&(t[r]=[e.value]);break}case"List":case"Composite":case"Choice":e.items&&e.items.forEach(i=>cT(i,t,r))}return t}function dT(e,t){const n=[];return t.items.forEach(r=>{if(r.resource){const[i]=lT(e,r.target);n.push({type:"Text",annotationId:r.annotationId,annotation:r.annotation,text:cT(r.resource),target:i})}}),{type:"textual-content",items:n}}const m5=/^.*(?:(?:youtu\.be\/|v\/|vi\/|u\/\w\/|embed\/|shorts\/)|(?:(?:watch)?\?vi?=|&vi?=))([^#&?]*).*/;function fT(e,t,n){var w;const r=t.items.filter(y=>y.type==="video"),i=r[0];let s=!1;if(e.duration||(s=!0),r.length>1||!i)return Bt("Only one video source supported");const o=(w=r[0])==null?void 0:w.resource,u=!!(o.service||[]).find(y=>(y.profile||"").includes("youtube.com"));if(!u&&s)return Bt("Video does not have duration");if(!o)return Bt("Unknown video");if((!o.format||o.format==="text/html")&&!u)return Bt("Video does not have format");let d=[];const h=n.get(e.annotations||[]);for(const y of h){const S=n.get(y.items||[]);for(const C of S)if((C.motivation?Array.isArray(C.motivation||"")?C.motivation:[C.motivation]:[]).includes("supplementing")){const k=n.get(C.body||[]);for(const T of k){const _=T;if(_.type==="Choice")for(const R of _.items){const O=n.get(R);O.format==="text/vtt"&&d.push({id:O.id,type:"Text",format:"text/vtt",label:O.label,language:O.language})}else _.format==="text/vtt"&&d.push({id:_.id,type:"Text",format:"text/vtt",label:_.label,language:_.language})}}}const c={annotationId:i.annotationId,annotation:i.annotation,duration:e.duration,url:o.id,type:"Video",target:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}},format:o.format,selector:{type:"TemporalSelector",temporal:{startTime:0,endTime:e.duration}}},p=Jn(i.target);p.selector&&p.selector.type==="TemporalBoxSelector"&&(c.target=p.selector);const{selector:m}=$s(i.selector);if(m===null){const y=c.target.temporal.startTime,C=(c.target.temporal.endTime||e.duration)-y;c.selector={type:"TemporalSelector",temporal:{startTime:0,endTime:C}}}else m.type==="TemporalSelector"&&(c.selector=m);if(u){c.type="VideoYouTube";const y=o.id.match(m5);if(!y[1])return Bt("Video is not known youtube video");c.youTubeId=y[1]}return{type:"media",media:c,annotations:{pages:[]},captions:d}}function y5(e,t,n,r){var c,p,m,w,y,S,C,x,k,T,_,R,O,F,z,J;const i={type:"complex-timeline",items:[],keyframes:[],highlights:[],duration:e.duration||0},s={type:"complex-choice",items:[]},o=r.get(e.annotations);function u(j){j.choice&&(j.choice.type==="complex-choice"?s.items.push(...j.choice.items):s.items.push(j.choice))}for(const j of t.items){if(j.type==="image"){const H=uT(e,{choice:null,items:[j]},n);if(H.type==="images"){u(H),i.items.push(H.image);const V={id:H.image.annotationId,type:"enter",resourceType:"image",time:((p=(c=H.image.target)==null?void 0:c.temporal)==null?void 0:p.startTime)||0};i.keyframes.push(V);const ne={id:H.image.annotationId,type:"exit",resourceType:"image",time:((w=(m=H.image.target)==null?void 0:m.temporal)==null?void 0:w.endTime)||e.duration||0};i.keyframes.push(ne)}}if(j.type==="textualbody"){const H=dT(e,{items:[j]});if(H.type==="textual-content"){u(H);const V=H.items[0];i.items.push(V);const ne=V.target,Y={id:V.annotationId,type:"enter",resourceType:"text",time:((y=ne.temporal)==null?void 0:y.startTime)||0};i.keyframes.push(Y);const de={id:V.annotationId,type:"exit",resourceType:"text",time:((S=ne.temporal)==null?void 0:S.endTime)||e.duration||0};i.keyframes.push(de)}}if(j.type==="video"){const H=fT(e,{items:[j]},r);if(H.type==="media"){u(H);const V=H.media;i.items.push(V);const ne={id:V.annotationId,type:"enter",resourceType:"video",time:((x=(C=V.target)==null?void 0:C.temporal)==null?void 0:x.startTime)||0};i.keyframes.push(ne);const Y={id:V.annotationId,type:"exit",resourceType:"video",time:((T=(k=V.target)==null?void 0:k.temporal)==null?void 0:T.endTime)||e.duration||0};i.keyframes.push(Y)}}if(j.type==="audio"||j.type==="sound"){const H=aT(e,{items:[j]});if(H.type==="media"){u(H);const V=H.media;i.items.push(V);const ne={id:V.annotationId,type:"enter",resourceType:"audio",time:((R=(_=V.target)==null?void 0:_.temporal)==null?void 0:R.startTime)||0};i.keyframes.push(ne);const Y={id:V.annotationId,type:"exit",resourceType:"audio",time:((F=(O=V.target)==null?void 0:O.temporal)==null?void 0:F.endTime)||e.duration||0};i.keyframes.push(Y)}}}for(const j of o)for(const H of j.items){const V=r.get(H),ne=Jn(V.target,{typeMap:(z=r.getState)==null?void 0:z.call(r).iiif.mapping});if((J=ne.selector)!=null&&J.temporal){const Y={id:V.id,type:"enter",resourceType:"highlight",time:ne.selector.temporal.startTime||0};i.keyframes.push(Y);const de={id:V.id,type:"exit",resourceType:"highlight",time:ne.selector.temporal.endTime||e.duration||0};i.keyframes.push(de)}i.highlights.push({annotation:V,target:ne})}i.keyframes.sort((j,H)=>j.time-H.time);let d=[];const h=[];for(const j of i.keyframes){if(j.resourceType==="image"||j.resourceType==="text"||j.resourceType==="highlight"){h.push(j);continue}if(j.type==="enter"){d.length===0&&(j.isPrime=!0),d.push(j),h.push(j);continue}if(j.type==="exit"&&(h.push(j),d=d.filter(H=>H.id!==j.id),d.length!==0)){const H=d[0],V={id:H.id,type:"change",isPrime:!0,resourceType:H.resourceType,time:j.time};h.push(V)}}return i.keyframes=h,s.items.length&&(i.choice=s),i}const kc={},hT={get(e){return e},setMetaValue([e,t,n],r){const i=hT.getResourceMeta(e,t),s=i?i[n]:void 0,o=typeof r=="function"?r(s):r;kc[e]={...kc[e]||{},[t]:{...(kc[e]||{})[t]||{},[n]:o}}},getResourceMeta:(e,t)=>{const n=kc[e];if(n)return t?n[t]:n},async load(e){const t=typeof e=="string"?e:e.id;return fetch(t).then(n=>n.json())},requestStatus(e){}};function v5({canvas:e,paintables:t,supports:n,loadImageService:r,vault:i=hT}){if(!e)return Mp;if(t.types.length===0)return n.indexOf("empty")!==-1?r5(e.width,e.height):Mp;if(t.types.length!==1)if(t.types.length===2&&t.types.indexOf("text")!==-1)t.types=t.types.filter(o=>o!=="text");else return n.indexOf("complex-timeline")===-1?Bt("Complex timeline not supported"):y5(e,t,r,i);const s=t.types[0];return s==="image"?n.indexOf("images")===-1?Bt("Image not supported"):uT(e,t,r):s==="Model"||s==="model"?n.indexOf("3d-model")===-1?Bt("3D not supported"):g5(e,t):s==="textualbody"?n.indexOf("textual-content")===-1?Bt("Textual content not supported"):dT(e,t):s==="sound"||s==="audio"?n.indexOf("media")===-1?Bt("Media not supported"):aT(e,t):s==="video"?n.indexOf("media")===-1?Bt("Media not supported"):fT(e,t,i):Mp}function x5(e){const t=Br(),n=ut(),r=yn(),i=tT(),s=(e==null?void 0:e.emitter)||i,[o,u]=d5(),{enabledPageIds:d}=Ny((e==null?void 0:e.annotationPageManagerId)||(t==null?void 0:t.id)||(n==null?void 0:n.id),{all:!1}),h=a5(d,"AnnotationPage"),c=(e==null?void 0:e.strategies)||["empty","images","media","textual-content","complex-timeline"],[p,m]=h5(e,[u]);b.useEffect(()=>{const y=S=>{m.makeChoice(S.choiceId,{deselectOthers:S.deselectOthers,deselect:S.deselect})};return s.on("make-choice",y),()=>{s.off("make-choice",y)}},[]);const w=b.useMemo(()=>v5({canvas:n,paintables:p,supports:c,loadImageService:o,vault:r}),[n,p,r,m.makeChoice]);return b.useEffect(()=>{const y=p.allChoices,S={canvasId:n==null?void 0:n.id,manifestId:t==null?void 0:t.id};y&&s.emit("choice-change",{choice:y,partOf:S})},[n==null?void 0:n.id,p.allChoices]),b.useMemo(()=>w.type==="unknown"?[w,n5]:[{...w,annotations:{pages:h}},m],[w,h])}function w5({strategies:e,registerActions:t,defaultChoices:n,onChoiceChange:r,mediaControlsDeps:i,renderMediaControls:s,renderViewerControls:o,viewControlsDeps:u,renderComplexTimelineControls:d,complexTimelineControlsDeps:h,throwOnUnknown:c,children:p}){const m=ut(),w=yn(),y=b.useMemo(()=>xC(w),[w]),[S,C]=x5({strategies:e||["images"],defaultChoices:n==null?void 0:n.map(({id:_})=>_)}),x="choice"in S?S.choice:void 0;if(b.useEffect(()=>{t&&t(C)},[S.annotations]),b.useEffect(()=>{r&&r(x)},[x]),b.useEffect(()=>{if(n)for(const _ of n)typeof _.opacity<"u"&&y.applyStyles({id:_.id},"atlas",{opacity:_.opacity})},[n]),S.type==="unknown"&&c)throw new Error(S.reason||"Unknown strategy");const k=b.useMemo(()=>({renderMediaControls:s,mediaControlsDeps:i||[],renderViewerControls:o,viewControlsDeps:u||[],renderComplexTimelineControls:d,complexTimelineControlsDeps:h||[]}),[i,s,o,u,d,h]),T=b.useMemo(()=>({strategy:S,actions:C,choices:"choice"in S?S.choice:[]}),[S,m]);return E.jsx(by.Provider,{value:k,children:E.jsx(Ka.Provider,{value:T,children:p})})}const pT=b.createContext(()=>{});function S5(e){const t=ut(),n=b.useContext(pT);b.useEffect(()=>t&&t.id?(n(t.id,e),()=>n(t.id,-1)):()=>{},[t,e])}function k5({x:e=0,y:t=0,keepCanvasScale:n=!0,renderContextMenu:r,children:i}){const{strategy:s}=or(),o=ut(),u=An(),d=vC(o,["deep-zoom"]),h=Te(u,S=>S.setCanvasRelativePosition),c=Te(u,S=>S.clearCanvasRelativePosition),[p,m]=oT(`context-menu/${o==null?void 0:o.id}`,o==null?void 0:o.id,r),w=b.useMemo(()=>n?1:Math.max(1,...s.type==="images"?s.images.map(S=>{var C;return(S.width||0)/((C=S.target)==null?void 0:C.spatial.width)}):[]),[n,s]);b.useEffect(()=>{if(o)return h(o.id,{x:e,y:t,width:o.width,height:o.height}),()=>{c(o.id)}},[e,t,o,c,h]),b.useEffect(()=>{o&&u.getState().reset()},[u,o]),S5(w);const y=s.type==="images"?s.images.length:0;return o?E.jsxs("world-object",{height:o.height,width:o.width,scale:w,x:e,y:t,...m,...d,children:[p,i]},`${o.id}/${s.type}/${y}`):null}function Ad({x:e,y:t,onChoiceChange:n,registerActions:r,defaultChoices:i,isStatic:s,renderViewerControls:o,renderMediaControls:u,renderComplexTimelineControls:d,complexTimelineControlsDeps:h,viewControlsDeps:c,mediaControlsDeps:p,strategies:m,throwOnUnknown:w,backgroundStyle:y,alwaysShowBackground:S,keepCanvasScale:C=!1,enableSizes:x=!1,enableYouTube:k=!0,onClickPaintingAnnotation:T,components:_={},children:R,annotationPopup:O,svgTheme:F,renderContextMenu:z,renderAnnotationContextMenu:J}){return E.jsxs(w5,{throwOnUnknown:w,onChoiceChange:n,registerActions:r,strategies:m,defaultChoices:i,mediaControlsDeps:p,renderMediaControls:u,renderViewerControls:o,renderComplexTimelineControls:d,complexTimelineControlsDeps:h,viewControlsDeps:c,children:[E.jsxs(k5,{keepCanvasScale:C,x:e,y:t,renderContextMenu:z,children:[E.jsx(v4,{alwaysShowBackground:S,backgroundStyle:y}),E.jsx(y4,{}),E.jsx(w4,{}),E.jsx(x4,{isStatic:s,enableSizes:x,onClickPaintingAnnotation:T}),E.jsx(H3,{}),E.jsx(z3,{}),E.jsx(Y3,{as:_.Audio}),E.jsx(S4,{as:_.Video}),k?E.jsx(k4,{}):null,E.jsx(e5,{theme:F,renderContextMenu:J,children:O}),R]}),E.jsx($3,{})]})}function P5(e){const t=ut();return!t||!t.placeholderCanvas?null:E.jsx(Ko,{canvas:t.placeholderCanvas.id,children:E.jsx(Ad,{renderViewerControls:e.renderViewerControls})})}const E5=b.createContext(null),Lp={didCatch:!1,error:null};class C5 extends b.Component{constructor(t){super(t),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=Lp}static getDerivedStateFromError(t){return{didCatch:!0,error:t}}resetErrorBoundary(){const{error:t}=this.state;if(t!==null){for(var n,r,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];(n=(r=this.props).onReset)===null||n===void 0||n.call(r,{args:s,reason:"imperative-api"}),this.setState(Lp)}}componentDidCatch(t,n){var r,i;(r=(i=this.props).onError)===null||r===void 0||r.call(i,t,n)}componentDidUpdate(t,n){const{didCatch:r}=this.state,{resetKeys:i}=this.props;if(r&&n.error!==null&&T5(t.resetKeys,i)){var s,o;(s=(o=this.props).onReset)===null||s===void 0||s.call(o,{next:i,prev:t.resetKeys,reason:"keys"}),this.setState(Lp)}}render(){const{children:t,fallbackRender:n,FallbackComponent:r,fallback:i}=this.props,{didCatch:s,error:o}=this.state;let u=t;if(s){const d={error:o,resetErrorBoundary:this.resetErrorBoundary};if(typeof n=="function")u=n(d);else if(r)u=b.createElement(r,d);else if(i!==void 0)u=i;else throw o}return b.createElement(E5.Provider,{value:{didCatch:s,error:o,resetErrorBoundary:this.resetErrorBoundary}},u)}}function T5(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e.length!==t.length||e.some((n,r)=>!Object.is(n,t[r]))}function b5(e,t=2e3){const{currentSequenceIndex:n,sequence:r,items:i}=rf(),s=ut(),o=b.useMemo(()=>{const d=r[n]||[];return d.length===0&&s?[{id:s.id,type:"Canvas"}]:d.map(h=>i[h])},[r,n,s,i]),u=An();b.useEffect(()=>{const h=setInterval(()=>{if(e&&t!==-1){const c={x:e.x,y:e.y,width:e.width,height:e.height},p=u.getState().canvasRelativePositions,m={};for(const w of o){const y=p[w.id];if(y){const S=y.x,C=y.y,x=y.width,k=y.height,T={x:Math.max(S,c.x),y:Math.max(C,c.y),width:Math.min(S+x,c.x+c.width)-Math.max(S,c.x),height:Math.min(C+k,c.y+c.height)-Math.max(C,c.y)};T.width<=0||T.height<=0||(m[w.id]={x:T.x-y.x,y:T.y-y.y,width:T.width,height:T.height}),u.setState({canvasViewports:m})}}}},t);return()=>{clearTimeout(h)}},[o,e,u,t])}function R5({width:e,style:t,height:n,error:r,resetErrorBoundary:i}){return E.jsxs("div",{style:{width:e,height:n,minHeight:500,...t||{},background:"#f9f9f9"},children:[E.jsx("h3",{children:"Error occurred"}),E.jsx("p",{children:r.message}),E.jsx("button",{type:"button",onClick:i,children:"Reset"})]})}function I5(e){const t=An();return E.jsx(Ey,{name:e.name,existing:t,children:E.jsx(_5,{...e})})}function _5({name:e,children:t,errorFallback:n,outerContainerProps:r={},worldScale:i,updateViewportTimeout:s,...o}){const u=An(),d=Te(u,V=>V.mode),h=Te(u,V=>V.setAtlasRuntime),[c,p]=b.useState(),m=nT(),w=rT(),y=n||R5,[S,C]=b.useState({}),x=Object.entries(S),[k,T]=b.useState({}),_=Object.entries(k),[R,O]=b.useState({}),F=b.useMemo(()=>i||Math.max(...Object.values(R)),[R]),z=b.useMemo(()=>({maxOverZoom:F||1,...o.runtimeOptions||{}}),[F,o.runtimeOptions]);b5(c==null?void 0:c.runtime,s);const J=b.useCallback((V,ne)=>{O(Y=>{if(ne===-1){const{[V]:de,...se}=Y;return se}return{...Y,[V]:ne}})},[]),j=b.useCallback((V,ne,Y)=>{C(({[V]:de,...se})=>ne?{...se,[V]:{element:ne,props:Y}}:se)},[]),H=b.useCallback((V,ne,Y)=>{T(({[V]:de,...se})=>ne?{...se,[V]:{element:ne,props:Y}}:se)},[]);return E.jsxs(C5,{resetKeys:[],fallbackRender:V=>E.jsx(y,{...o,...V}),children:[E.jsx(KM,{...o,mode:d,containerProps:{style:{position:"relative"},...o.containerProps||{}},htmlChildren:E.jsx(E.Fragment,{children:x.map(([V,{element:ne,props:Y}])=>E.jsx(at.Fragment,{children:E.jsx(ne,{...Y||{}})},V))}),onCreated:V=>{p(V),h(V.runtime),o.onCreated&&o.onCreated(V)},runtimeOptions:z,children:E.jsx(Ey,{name:e,existing:u,children:E.jsx(yf.Provider,{value:c,children:E.jsx(pT.Provider,{value:J,children:E.jsx(TC.Provider,{value:j,children:E.jsx(bC.Provider,{value:H,children:E.jsx(iT,{bridge:w,custom:m,children:E.jsx(W3,{children:t})})})})})})})}),E.jsx("div",{children:_.map(([V,{element:ne,props:Y}])=>E.jsx(at.Fragment,{children:E.jsx(ne,{...Y||{}})},V))}),E.jsx("div",{id:"atlas-floating-ui",style:{position:"relative",zIndex:999999}})]})}const A5=b.forwardRef(function(t,n){const r=Br(),i=py(),s=rf(),{ViewerControls:o,MediaControls:u,ComplexTimelineControls:d}=t.components||{};if(b.useImperativeHandle(n,()=>s,[s]),!r)return E.jsx("div",{});let h=0;const c=r.viewingDirection==="top-to-bottom",p=r.viewingDirection==="bottom-to-top";r.viewingDirection;const m=r.viewingDirection==="right-to-left",y=r.behavior.includes("continuous")?0:t.spacing||0,S=p||m,C=b.useMemo(()=>S?[...i].reverse():i,[i,S]);return E.jsxs(E.Fragment,{children:[t.header,E.jsx(Wt.Viewer,{height:t.height,mode:t.mode,renderPreset:t.renderPreset,runtimeOptions:t.runtimeOptions,updateViewportTimeout:t.updateViewportTimeout,children:C.map((x,k)=>{let T=0,_=0;return c?(T=h,h+=x.width+y):(_=h,h+=x.height+y),E.jsx(Ko,{canvas:x.id,children:E.jsx(Wt.RenderCanvas,{strategies:["3d-model","media","images","empty","textual-content","complex-timeline"],renderViewerControls:k===0&&o?()=>E.jsx(o,{}):void 0,renderMediaControls:k===0&&u?()=>E.jsx(u,{}):void 0,annotationPopup:t.annotationPopup,renderContextMenu:t.renderContextMenu,keepCanvasScale:t.keepCanvasScale,renderComplexTimelineControls:k===0&&d?()=>E.jsx(d,{}):void 0,renderAnnotationContextMenu:t.renderAnnotationContextMenu,x:T,y:_,svgTheme:t.svgTheme,...t.canvasProps||{},children:t.annotations},x.id)},x.id)})},t.reuseAtlas?"":s.currentSequenceIndex),t.children]})}),Wt=b.forwardRef(function({children:t,height:n,annotations:r,canvasProps:i,spacing:s,header:o,components:u,mode:d,reuseAtlas:h,renderPreset:c,runtimeOptions:p,annotationPopup:m,name:w,svgTheme:y,updateViewportTimeout:S,renderContextMenu:C,keepCanvasScale:x,renderAnnotationContextMenu:k,...T},_){const R=gy();return E.jsx(Ey,{name:w,children:E.jsx(hy,{vault:R,children:E.jsx(PO,{...T,children:E.jsx(A5,{ref:_,height:n,components:u,spacing:s,canvasProps:i,annotations:r,header:o,mode:d,reuseAtlas:h,renderPreset:c,runtimeOptions:p,annotationPopup:m,svgTheme:y,updateViewportTimeout:S,renderContextMenu:C,keepCanvasScale:x,renderAnnotationContextMenu:k,children:t})})})})});Wt.RenderImage=Ay;Wt.RenderCanvas=Ad;Wt.RenderAnnotationPage=Cd;Wt.RenderAnnotation=Cy;Wt.Viewer=I5;Wt.CanvasBackground=zC;Wt.Audio=IC;Wt.Video=DC;Wt.Model=AC;Wt.AudioHTML=RC;Wt.VideoHTML=$C;Wt.ModelHTML=_C;Wt.PlaceholderCanvas=P5;Wt.getAtlasStoreByName=GL;function O5(){const e=ut(),t=Va();if(!t.hasSearch)return null;const n=e?t.resources.filter(r=>r.on.split("#")[0]===e.id).map(r=>{const i=$s(r.on);return{annotation:r,target:i}}):[];return E.jsx(E.Fragment,{children:n.map(r=>{var i,s;return(i=r.target.selector)!=null&&i.spatial?E.jsx("box",{onClick:()=>t.highlightResult(r.annotation["@id"]),target:(s=r.target.selector)==null?void 0:s.spatial,style:{background:t.highlight&&t.highlight["@id"]===r.annotation["@id"]?"rgba(19, 224, 0, 0.5)":"rgba(255, 0, 0, 0.5)"}},r.annotation["@id"]):null})})}function j5({metadata:e=[],config:t,labelWidth:n=16,showEmptyMessage:r=!0,allowHtml:i,emptyFallback:s,classes:o={},emptyMessage:u="No metadata available",emptyValueFallback:d="No value",emptyLabelFallback:h="",separator:c,tableFooter:p,tableHeader:m}){const w=b.useMemo(()=>{const S=(t||[]).reduce((x,k)=>[...x,...k.keys],[]),C={};for(const x of e){const k=x&&x.label?Object.values(x.label):[];for(const T of k)if(T&&T.length&&(S.indexOf(`metadata.${T[0]}`)!==-1||S.length===0)&&x){const _=`metadata.${T[0]}`;C[_]=C[_]?C[_]:[],C[_].push(x);break}}return C},[t,e]);return Object.keys(w).length===0&&r?E.jsx(E.Fragment,{children:s})||E.jsx("div",{className:o.empty,children:u}):t&&t.length?E.jsxs("table",{className:o.container,children:[m,E.jsx("tbody",{children:t.map((S,C)=>{const x=[];for(const k of S.keys)for(const T of w[k]||[])x.push(E.jsx(tr,{enableDangerouslySetInnerHTML:i,defaultText:d,separator:c,children:T.value},C+"__"+k));return x.length===0?null:E.jsxs("tr",{className:o.row,children:[E.jsx("td",{className:o.label,style:n?{minWidth:n}:{},children:E.jsx(tr,{enableDangerouslySetInnerHTML:i,separator:c,defaultText:h,children:S.label})}),E.jsx("td",{className:o.value,children:x})]},C)})}),p]}):E.jsxs("table",{className:o.container,children:[m,E.jsx("tbody",{children:e&&e.length?e.map((S,C)=>S?E.jsxs("tr",{className:o.row,children:[E.jsx("td",{className:o.label,style:n?{minWidth:n}:{},children:E.jsx(tr,{enableDangerouslySetInnerHTML:i,defaultText:d,separator:c,children:S.label})}),E.jsx("td",{className:o.value,children:E.jsx(tr,{enableDangerouslySetInnerHTML:i,defaultText:d,separator:c,children:S.value})})]},C):null):null}),p]})}function M5(e){const t=Br(),n=ut(),r=BP(),i=b.useMemo(()=>{const s=(t==null?void 0:t.metadata)||[],o=(n==null?void 0:n.metadata)||[],u=(r==null?void 0:r.metadata)||[];return[...s,...o,...u]},[t,n,r]);return E.jsx(j5,{metadata:i,...e})}function L5(){const{authItems:e,currentAuth:t,login:n}=dO();if(t===-1)return null;const r=e[t];return!r||!r.service||r.isLoggedIn?null:E.jsxs("div",{children:[E.jsxs("div",{children:[E.jsx("h2",{children:"Current Auth"}),E.jsx("p",{children:r.id}),E.jsx("h3",{children:E.jsx(tr,{children:r.service.label})}),E.jsx("button",{onClick:()=>n(),children:"Login"})]}),E.jsx("pre",{children:JSON.stringify(r,null,2)})]})}function N5(){return Va().hasAutocomplete?E.jsx(F5,{}):null}function F5(){const{results:e,loading:t,error:n,errorMessage:r,search:i}=xO(),{search:s}=Va();let o="border border-gray-300 rounded-md p-2";t&&(o+=" bg-gray-100 transition-background duration-200");const u=d=>{d.preventDefault(),s({q:e[0].match})};return E.jsxs("form",{onSubmit:u,children:[E.jsx("input",{className:o,type:"text",onChange:d=>i(d.target.value),placeholder:"Search","aria-label":"Search"}),n&&E.jsx("div",{children:r}),E.jsx("ul",{children:e.map(d=>E.jsx("li",{onClick:()=>{s({q:d.match})},children:d.match},d.url))})]})}function z5(){const{resources:e,highlight:t,highlightResult:n,hasSearch:r}=Va(),{setCurrentCanvasId:i}=rf();return r?E.jsx("div",{children:e.map(s=>{$s(s.on);const o=s.on.split("#")[0];return E.jsxs("div",{style:{background:t===s?"#ddd":""},children:[s==null?void 0:s.resource.chars,E.jsx("button",{onClick:()=>{n(s["@id"]),i(o)},children:"Go to canvas"})]},s["@id"])})}):null}function $5({canvasId:e}={}){const t=GM(),n=py(),r=b.useMemo(()=>e?[e]:t?[t.id]:n.map(h=>h.id),[e,t,n]),[i,s]=b.useState({}),o=tT();b.useEffect(()=>{const h=c=>{const p=c.partOf.canvasId;p&&s(m=>({...m,[p]:c.choice}))};return o.on("choice-change",h),()=>{o.off("choice-change",h)}},[]);const u=b.useMemo(()=>{const h=[];for(const c of r){const p=i[c];p&&h.push({canvasId:c,choice:p})}return h},[r,i]),d=b.useMemo(()=>({makeChoice:(h,c)=>{o.emit("make-choice",{choiceId:h,...c})}}),[o]);return{choices:u,actions:d}}function D5(){const{choices:e,actions:t}=$5();return e.length===0?null:E.jsxs("div",{children:[E.jsx("h2",{children:"Choices"}),E.jsx("ul",{children:e.map(({canvasId:n,choice:r},i)=>E.jsxs("li",{children:[n,r.items.map(s=>E.jsxs("div",{children:[E.jsx(tr,{children:s.label}),E.jsx("ul",{children:s.items.map(o=>E.jsxs("li",{className:"p-2 flex gap-2",children:[E.jsx(tr,{children:o.label}),E.jsx("button",{className:o.selected?"bg-green-500 hover:bg-green-700 text-white text-sm py-1 px-3 rounded-full":"bg-gray-500 hover:bg-gray-700 text-white text-sm py-1 px-3 rounded-full",onClick:()=>{t.makeChoice(o.id,{deselectOthers:!0})},children:"Choose"})]}))})]}))]},i))})]})}var gT={exports:{}};(()=>{var e={296:(i,s,o)=>{var u=/^\s+|\s+$/g,d=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,c=/^0o[0-7]+$/i,p=parseInt,m=typeof o.g=="object"&&o.g&&o.g.Object===Object&&o.g,w=typeof self=="object"&&self&&self.Object===Object&&self,y=m||w||Function("return this")(),S=Object.prototype.toString,C=Math.max,x=Math.min,k=function(){return y.Date.now()};function T(R){var O=typeof R;return!!R&&(O=="object"||O=="function")}function _(R){if(typeof R=="number")return R;if(function(z){return typeof z=="symbol"||function(J){return!!J&&typeof J=="object"}(z)&&S.call(z)=="[object Symbol]"}(R))return NaN;if(T(R)){var O=typeof R.valueOf=="function"?R.valueOf():R;R=T(O)?O+"":O}if(typeof R!="string")return R===0?R:+R;R=R.replace(u,"");var F=h.test(R);return F||c.test(R)?p(R.slice(2),F?2:8):d.test(R)?NaN:+R}i.exports=function(R,O,F){var z,J,j,H,V,ne,Y=0,de=!1,se=!1,ve=!0;if(typeof R!="function")throw new TypeError("Expected a function");function M(je){var Re=z,be=J;return z=J=void 0,Y=je,H=R.apply(be,Re)}function L(je){var Re=je-ne;return ne===void 0||Re>=O||Re<0||se&&je-Y>=j}function W(){var je=k();if(L(je))return le(je);V=setTimeout(W,function(Re){var be=O-(Re-ne);return se?x(be,j-(Re-Y)):be}(je))}function le(je){return V=void 0,ve&&z?M(je):(z=J=void 0,H)}function we(){var je=k(),Re=L(je);if(z=arguments,J=this,ne=je,Re){if(V===void 0)return function(be){return Y=be,V=setTimeout(W,O),de?M(be):H}(ne);if(se)return V=setTimeout(W,O),M(ne)}return V===void 0&&(V=setTimeout(W,O)),H}return O=_(O)||0,T(F)&&(de=!!F.leading,j=(se="maxWait"in F)?C(_(F.maxWait)||0,O):j,ve="trailing"in F?!!F.trailing:ve),we.cancel=function(){V!==void 0&&clearTimeout(V),Y=0,z=ne=J=V=void 0},we.flush=function(){return V===void 0?H:le(k())},we}},96:(i,s,o)=>{var u="Expected a function",d=NaN,h="[object Symbol]",c=/^\s+|\s+$/g,p=/^[-+]0x[0-9a-f]+$/i,m=/^0b[01]+$/i,w=/^0o[0-7]+$/i,y=parseInt,S=typeof o.g=="object"&&o.g&&o.g.Object===Object&&o.g,C=typeof self=="object"&&self&&self.Object===Object&&self,x=S||C||Function("return this")(),k=Object.prototype.toString,T=Math.max,_=Math.min,R=function(){return x.Date.now()};function O(z){var J=typeof z;return!!z&&(J=="object"||J=="function")}function F(z){if(typeof z=="number")return z;if(function(H){return typeof H=="symbol"||function(V){return!!V&&typeof V=="object"}(H)&&k.call(H)==h}(z))return d;if(O(z)){var J=typeof z.valueOf=="function"?z.valueOf():z;z=O(J)?J+"":J}if(typeof z!="string")return z===0?z:+z;z=z.replace(c,"");var j=m.test(z);return j||w.test(z)?y(z.slice(2),j?2:8):p.test(z)?d:+z}i.exports=function(z,J,j){var H=!0,V=!0;if(typeof z!="function")throw new TypeError(u);return O(j)&&(H="leading"in j?!!j.leading:H,V="trailing"in j?!!j.trailing:V),function(ne,Y,de){var se,ve,M,L,W,le,we=0,je=!1,Re=!1,be=!0;if(typeof ne!="function")throw new TypeError(u);function Ie(Ne){var ye=se,ae=ve;return se=ve=void 0,we=Ne,L=ne.apply(ae,ye)}function Ke(Ne){var ye=Ne-le;return le===void 0||ye>=Y||ye<0||Re&&Ne-we>=M}function ln(){var Ne=R();if(Ke(Ne))return an(Ne);W=setTimeout(ln,function(ye){var ae=Y-(ye-le);return Re?_(ae,M-(ye-we)):ae}(Ne))}function an(Ne){return W=void 0,be&&se?Ie(Ne):(se=ve=void 0,L)}function xt(){var Ne=R(),ye=Ke(Ne);if(se=arguments,ve=this,le=Ne,ye){if(W===void 0)return function(ae){return we=ae,W=setTimeout(ln,Y),je?Ie(ae):L}(le);if(Re)return W=setTimeout(ln,Y),Ie(le)}return W===void 0&&(W=setTimeout(ln,Y)),L}return Y=F(Y)||0,O(de)&&(je=!!de.leading,M=(Re="maxWait"in de)?T(F(de.maxWait)||0,Y):M,be="trailing"in de?!!de.trailing:be),xt.cancel=function(){W!==void 0&&clearTimeout(W),we=0,se=le=ve=W=void 0},xt.flush=function(){return W===void 0?L:an(R())},xt}(z,J,{leading:H,maxWait:J,trailing:V})}},703:(i,s,o)=>{var u=o(414);function d(){}function h(){}h.resetWarningCache=d,i.exports=function(){function c(w,y,S,C,x,k){if(k!==u){var T=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw T.name="Invariant Violation",T}}function p(){return c}c.isRequired=c;var m={array:c,bigint:c,bool:c,func:c,number:c,object:c,string:c,symbol:c,any:c,arrayOf:p,element:c,elementType:c,instanceOf:p,node:c,objectOf:p,oneOf:p,oneOfType:p,shape:p,exact:p,checkPropTypes:h,resetWarningCache:d};return m.PropTypes=m,m}},697:(i,s,o)=>{i.exports=o(703)()},414:i=>{i.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},t={};function n(i){var s=t[i];if(s!==void 0)return s.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}n.n=i=>{var s=i&&i.__esModule?()=>i.default:()=>i;return n.d(s,{a:s}),s},n.d=(i,s)=>{for(var o in s)n.o(s,o)&&!n.o(i,o)&&Object.defineProperty(i,o,{enumerable:!0,get:s[o]})},n.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),n.o=(i,s)=>Object.prototype.hasOwnProperty.call(i,s),n.r=i=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(i,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(i,"__esModule",{value:!0})};var r={};(()=>{n.r(r),n.d(r,{LazyLoadComponent:()=>ye,LazyLoadImage:()=>oe,trackWindowScroll:()=>L});const i=b;var s=n.n(i),o=n(697);function u(){return typeof window<"u"&&"IntersectionObserver"in window&&"isIntersecting"in window.IntersectionObserverEntry.prototype}function d(U){return d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},d(U)}function h(U,N){var X=Object.keys(U);if(Object.getOwnPropertySymbols){var te=Object.getOwnPropertySymbols(U);N&&(te=te.filter(function(Pe){return Object.getOwnPropertyDescriptor(U,Pe).enumerable})),X.push.apply(X,te)}return X}function c(U,N,X){return(N=m(N))in U?Object.defineProperty(U,N,{value:X,enumerable:!0,configurable:!0,writable:!0}):U[N]=X,U}function p(U,N){for(var X=0;X<N.length;X++){var te=N[X];te.enumerable=te.enumerable||!1,te.configurable=!0,"value"in te&&(te.writable=!0),Object.defineProperty(U,m(te.key),te)}}function m(U){var N=function(X,te){if(d(X)!=="object"||X===null)return X;var Pe=X[Symbol.toPrimitive];if(Pe!==void 0){var _e=Pe.call(X,"string");if(d(_e)!=="object")return _e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(X)}(U);return d(N)==="symbol"?N:String(N)}function w(U,N){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(X,te){return X.__proto__=te,X},w(U,N)}function y(U){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(N){return N.__proto__||Object.getPrototypeOf(N)},y(U)}var S=function(U){U.forEach(function(N){N.isIntersecting&&N.target.onVisible()})},C={},x=function(U){(function(K,ee){if(typeof ee!="function"&&ee!==null)throw new TypeError("Super expression must either be null or a function");K.prototype=Object.create(ee&&ee.prototype,{constructor:{value:K,writable:!0,configurable:!0}}),Object.defineProperty(K,"prototype",{writable:!1}),ee&&w(K,ee)})(De,U);var N,X,te,Pe,_e=(te=De,Pe=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var K,ee=y(te);if(Pe){var ue=y(this).constructor;K=Reflect.construct(ee,arguments,ue)}else K=ee.apply(this,arguments);return function(pe,fe){if(fe&&(d(fe)==="object"||typeof fe=="function"))return fe;if(fe!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Me){if(Me===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Me}(pe)}(this,K)});function De(K){var ee;if(function(pe,fe){if(!(pe instanceof fe))throw new TypeError("Cannot call a class as a function")}(this,De),(ee=_e.call(this,K)).supportsObserver=!K.scrollPosition&&K.useIntersectionObserver&&u(),ee.supportsObserver){var ue=K.threshold;ee.observer=function(pe){return C[pe]=C[pe]||new IntersectionObserver(S,{rootMargin:pe+"px"}),C[pe]}(ue)}return ee}return N=De,X=[{key:"componentDidMount",value:function(){this.placeholder&&this.observer&&(this.placeholder.onVisible=this.props.onVisible,this.observer.observe(this.placeholder)),this.supportsObserver||this.updateVisibility()}},{key:"componentWillUnmount",value:function(){this.observer&&this.placeholder&&this.observer.unobserve(this.placeholder)}},{key:"componentDidUpdate",value:function(){this.supportsObserver||this.updateVisibility()}},{key:"getPlaceholderBoundingBox",value:function(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.scrollPosition,ee=this.placeholder.getBoundingClientRect(),ue=this.placeholder.style,pe=parseInt(ue.getPropertyValue("margin-left"),10)||0,fe=parseInt(ue.getPropertyValue("margin-top"),10)||0;return{bottom:K.y+ee.bottom+fe,left:K.x+ee.left+pe,right:K.x+ee.right+pe,top:K.y+ee.top+fe}}},{key:"isPlaceholderInViewport",value:function(){if(typeof window>"u"||!this.placeholder)return!1;var K=this.props,ee=K.scrollPosition,ue=K.threshold,pe=this.getPlaceholderBoundingBox(ee),fe=ee.y+window.innerHeight,Me=ee.x,Qe=ee.x+window.innerWidth,Je=ee.y;return Je-ue<=pe.bottom&&fe+ue>=pe.top&&Me-ue<=pe.right&&Qe+ue>=pe.left}},{key:"updateVisibility",value:function(){this.isPlaceholderInViewport()&&this.props.onVisible()}},{key:"render",value:function(){var K=this,ee=this.props,ue=ee.className,pe=ee.height,fe=ee.placeholder,Me=ee.style,Qe=ee.width;if(fe&&typeof fe.type!="function")return s().cloneElement(fe,{ref:function(Ye){return K.placeholder=Ye}});var Je=function(Ye){for(var Rt=1;Rt<arguments.length;Rt++){var mt=arguments[Rt]!=null?arguments[Rt]:{};Rt%2?h(Object(mt),!0).forEach(function(Lt){c(Ye,Lt,mt[Lt])}):Object.getOwnPropertyDescriptors?Object.defineProperties(Ye,Object.getOwnPropertyDescriptors(mt)):h(Object(mt)).forEach(function(Lt){Object.defineProperty(Ye,Lt,Object.getOwnPropertyDescriptor(mt,Lt))})}return Ye}({display:"inline-block"},Me);return Qe!==void 0&&(Je.width=Qe),pe!==void 0&&(Je.height=pe),s().createElement("span",{className:ue,ref:function(Ye){return K.placeholder=Ye},style:Je},fe)}}],X&&p(N.prototype,X),Object.defineProperty(N,"prototype",{writable:!1}),De}(s().Component);x.propTypes={onVisible:o.PropTypes.func.isRequired,className:o.PropTypes.string,height:o.PropTypes.oneOfType([o.PropTypes.number,o.PropTypes.string]),placeholder:o.PropTypes.element,threshold:o.PropTypes.number,useIntersectionObserver:o.PropTypes.bool,scrollPosition:o.PropTypes.shape({x:o.PropTypes.number.isRequired,y:o.PropTypes.number.isRequired}),width:o.PropTypes.oneOfType([o.PropTypes.number,o.PropTypes.string])},x.defaultProps={className:"",placeholder:null,threshold:100,useIntersectionObserver:!0};const k=x;var T=n(296),_=n.n(T),R=n(96),O=n.n(R),F=function(U){var N=getComputedStyle(U,null);return N.getPropertyValue("overflow")+N.getPropertyValue("overflow-y")+N.getPropertyValue("overflow-x")};const z=function(U){if(!(U instanceof HTMLElement))return window;for(var N=U;N&&N instanceof HTMLElement;){if(/(scroll|auto)/.test(F(N)))return N;N=N.parentNode}return window};function J(U){return J=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},J(U)}var j=["delayMethod","delayTime"];function H(){return H=Object.assign?Object.assign.bind():function(U){for(var N=1;N<arguments.length;N++){var X=arguments[N];for(var te in X)Object.prototype.hasOwnProperty.call(X,te)&&(U[te]=X[te])}return U},H.apply(this,arguments)}function V(U,N){for(var X=0;X<N.length;X++){var te=N[X];te.enumerable=te.enumerable||!1,te.configurable=!0,"value"in te&&(te.writable=!0),Object.defineProperty(U,(Pe=function(_e,De){if(J(_e)!=="object"||_e===null)return _e;var K=_e[Symbol.toPrimitive];if(K!==void 0){var ee=K.call(_e,"string");if(J(ee)!=="object")return ee;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_e)}(te.key),J(Pe)==="symbol"?Pe:String(Pe)),te)}var Pe}function ne(U,N){return ne=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(X,te){return X.__proto__=te,X},ne(U,N)}function Y(U,N){if(N&&(J(N)==="object"||typeof N=="function"))return N;if(N!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return de(U)}function de(U){if(U===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U}function se(U){return se=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(N){return N.__proto__||Object.getPrototypeOf(N)},se(U)}var ve=function(){return typeof window>"u"?0:window.scrollX||window.pageXOffset},M=function(){return typeof window>"u"?0:window.scrollY||window.pageYOffset};const L=function(U){var N=function(X){(function(ue,pe){if(typeof pe!="function"&&pe!==null)throw new TypeError("Super expression must either be null or a function");ue.prototype=Object.create(pe&&pe.prototype,{constructor:{value:ue,writable:!0,configurable:!0}}),Object.defineProperty(ue,"prototype",{writable:!1}),pe&&ne(ue,pe)})(ee,X);var te,Pe,_e,De,K=(_e=ee,De=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var ue,pe=se(_e);if(De){var fe=se(this).constructor;ue=Reflect.construct(pe,arguments,fe)}else ue=pe.apply(this,arguments);return Y(this,ue)});function ee(ue){var pe;if(function(Me,Qe){if(!(Me instanceof Qe))throw new TypeError("Cannot call a class as a function")}(this,ee),(pe=K.call(this,ue)).useIntersectionObserver=ue.useIntersectionObserver&&u(),pe.useIntersectionObserver)return Y(pe);var fe=pe.onChangeScroll.bind(de(pe));return ue.delayMethod==="debounce"?pe.delayedScroll=_()(fe,ue.delayTime):ue.delayMethod==="throttle"&&(pe.delayedScroll=O()(fe,ue.delayTime)),pe.state={scrollPosition:{x:ve(),y:M()}},pe.baseComponentRef=s().createRef(),pe}return te=ee,(Pe=[{key:"componentDidMount",value:function(){this.addListeners()}},{key:"componentWillUnmount",value:function(){this.removeListeners()}},{key:"componentDidUpdate",value:function(){typeof window>"u"||this.useIntersectionObserver||z(this.baseComponentRef.current)!==this.scrollElement&&(this.removeListeners(),this.addListeners())}},{key:"addListeners",value:function(){typeof window>"u"||this.useIntersectionObserver||(this.scrollElement=z(this.baseComponentRef.current),this.scrollElement.addEventListener("scroll",this.delayedScroll,{passive:!0}),window.addEventListener("resize",this.delayedScroll,{passive:!0}),this.scrollElement!==window&&window.addEventListener("scroll",this.delayedScroll,{passive:!0}))}},{key:"removeListeners",value:function(){typeof window>"u"||this.useIntersectionObserver||(this.scrollElement.removeEventListener("scroll",this.delayedScroll),window.removeEventListener("resize",this.delayedScroll),this.scrollElement!==window&&window.removeEventListener("scroll",this.delayedScroll))}},{key:"onChangeScroll",value:function(){this.useIntersectionObserver||this.setState({scrollPosition:{x:ve(),y:M()}})}},{key:"render",value:function(){var ue=this.props,pe=(ue.delayMethod,ue.delayTime,function(Me,Qe){if(Me==null)return{};var Je,Ye,Rt=function(Lt,Hr){if(Lt==null)return{};var Er,Zs,Js={},ll=Object.keys(Lt);for(Zs=0;Zs<ll.length;Zs++)Er=ll[Zs],Hr.indexOf(Er)>=0||(Js[Er]=Lt[Er]);return Js}(Me,Qe);if(Object.getOwnPropertySymbols){var mt=Object.getOwnPropertySymbols(Me);for(Ye=0;Ye<mt.length;Ye++)Je=mt[Ye],Qe.indexOf(Je)>=0||Object.prototype.propertyIsEnumerable.call(Me,Je)&&(Rt[Je]=Me[Je])}return Rt}(ue,j)),fe=this.useIntersectionObserver?null:this.state.scrollPosition;return s().createElement(U,H({forwardRef:this.baseComponentRef,scrollPosition:fe},pe))}}])&&V(te.prototype,Pe),Object.defineProperty(te,"prototype",{writable:!1}),ee}(s().Component);return N.propTypes={delayMethod:o.PropTypes.oneOf(["debounce","throttle"]),delayTime:o.PropTypes.number,useIntersectionObserver:o.PropTypes.bool},N.defaultProps={delayMethod:"throttle",delayTime:300,useIntersectionObserver:!0},N};function W(U){return W=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},W(U)}function le(U,N){for(var X=0;X<N.length;X++){var te=N[X];te.enumerable=te.enumerable||!1,te.configurable=!0,"value"in te&&(te.writable=!0),Object.defineProperty(U,(Pe=function(_e,De){if(W(_e)!=="object"||_e===null)return _e;var K=_e[Symbol.toPrimitive];if(K!==void 0){var ee=K.call(_e,"string");if(W(ee)!=="object")return ee;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_e)}(te.key),W(Pe)==="symbol"?Pe:String(Pe)),te)}var Pe}function we(U,N){return we=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(X,te){return X.__proto__=te,X},we(U,N)}function je(U){return je=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(N){return N.__proto__||Object.getPrototypeOf(N)},je(U)}var Re=function(U){(function(K,ee){if(typeof ee!="function"&&ee!==null)throw new TypeError("Super expression must either be null or a function");K.prototype=Object.create(ee&&ee.prototype,{constructor:{value:K,writable:!0,configurable:!0}}),Object.defineProperty(K,"prototype",{writable:!1}),ee&&we(K,ee)})(De,U);var N,X,te,Pe,_e=(te=De,Pe=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var K,ee=je(te);if(Pe){var ue=je(this).constructor;K=Reflect.construct(ee,arguments,ue)}else K=ee.apply(this,arguments);return function(pe,fe){if(fe&&(W(fe)==="object"||typeof fe=="function"))return fe;if(fe!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Me){if(Me===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Me}(pe)}(this,K)});function De(K){return function(ee,ue){if(!(ee instanceof ue))throw new TypeError("Cannot call a class as a function")}(this,De),_e.call(this,K)}return N=De,(X=[{key:"render",value:function(){return s().createElement(k,this.props)}}])&&le(N.prototype,X),Object.defineProperty(N,"prototype",{writable:!1}),De}(s().Component);const be=L(Re);function Ie(U){return Ie=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},Ie(U)}function Ke(U,N){for(var X=0;X<N.length;X++){var te=N[X];te.enumerable=te.enumerable||!1,te.configurable=!0,"value"in te&&(te.writable=!0),Object.defineProperty(U,(Pe=function(_e,De){if(Ie(_e)!=="object"||_e===null)return _e;var K=_e[Symbol.toPrimitive];if(K!==void 0){var ee=K.call(_e,"string");if(Ie(ee)!=="object")return ee;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(_e)}(te.key),Ie(Pe)==="symbol"?Pe:String(Pe)),te)}var Pe}function ln(U,N){return ln=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(X,te){return X.__proto__=te,X},ln(U,N)}function an(U){if(U===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return U}function xt(U){return xt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(N){return N.__proto__||Object.getPrototypeOf(N)},xt(U)}var Ne=function(U){(function(K,ee){if(typeof ee!="function"&&ee!==null)throw new TypeError("Super expression must either be null or a function");K.prototype=Object.create(ee&&ee.prototype,{constructor:{value:K,writable:!0,configurable:!0}}),Object.defineProperty(K,"prototype",{writable:!1}),ee&&ln(K,ee)})(De,U);var N,X,te,Pe,_e=(te=De,Pe=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var K,ee=xt(te);if(Pe){var ue=xt(this).constructor;K=Reflect.construct(ee,arguments,ue)}else K=ee.apply(this,arguments);return function(pe,fe){if(fe&&(Ie(fe)==="object"||typeof fe=="function"))return fe;if(fe!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return an(pe)}(this,K)});function De(K){var ee;(function(Qe,Je){if(!(Qe instanceof Je))throw new TypeError("Cannot call a class as a function")})(this,De),ee=_e.call(this,K);var ue=K.afterLoad,pe=K.beforeLoad,fe=K.scrollPosition,Me=K.visibleByDefault;return ee.state={visible:Me},Me&&(pe(),ue()),ee.onVisible=ee.onVisible.bind(an(ee)),ee.isScrollTracked=!!(fe&&Number.isFinite(fe.x)&&fe.x>=0&&Number.isFinite(fe.y)&&fe.y>=0),ee}return N=De,(X=[{key:"componentDidUpdate",value:function(K,ee){ee.visible!==this.state.visible&&this.props.afterLoad()}},{key:"onVisible",value:function(){this.props.beforeLoad(),this.setState({visible:!0})}},{key:"render",value:function(){if(this.state.visible)return this.props.children;var K=this.props,ee=K.className,ue=K.delayMethod,pe=K.delayTime,fe=K.height,Me=K.placeholder,Qe=K.scrollPosition,Je=K.style,Ye=K.threshold,Rt=K.useIntersectionObserver,mt=K.width;return this.isScrollTracked||Rt&&u()?s().createElement(k,{className:ee,height:fe,onVisible:this.onVisible,placeholder:Me,scrollPosition:Qe,style:Je,threshold:Ye,useIntersectionObserver:Rt,width:mt}):s().createElement(be,{className:ee,delayMethod:ue,delayTime:pe,height:fe,onVisible:this.onVisible,placeholder:Me,style:Je,threshold:Ye,width:mt})}}])&&Ke(N.prototype,X),Object.defineProperty(N,"prototype",{writable:!1}),De}(s().Component);Ne.propTypes={afterLoad:o.PropTypes.func,beforeLoad:o.PropTypes.func,useIntersectionObserver:o.PropTypes.bool,visibleByDefault:o.PropTypes.bool},Ne.defaultProps={afterLoad:function(){return{}},beforeLoad:function(){return{}},useIntersectionObserver:!0,visibleByDefault:!1};const ye=Ne;function ae(U){return ae=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(N){return typeof N}:function(N){return N&&typeof Symbol=="function"&&N.constructor===Symbol&&N!==Symbol.prototype?"symbol":typeof N},ae(U)}var $e=["afterLoad","beforeLoad","delayMethod","delayTime","effect","placeholder","placeholderSrc","scrollPosition","threshold","useIntersectionObserver","visibleByDefault","wrapperClassName","wrapperProps"];function Mt(U,N){var X=Object.keys(U);if(Object.getOwnPropertySymbols){var te=Object.getOwnPropertySymbols(U);N&&(te=te.filter(function(Pe){return Object.getOwnPropertyDescriptor(U,Pe).enumerable})),X.push.apply(X,te)}return X}function un(U){for(var N=1;N<arguments.length;N++){var X=arguments[N]!=null?arguments[N]:{};N%2?Mt(Object(X),!0).forEach(function(te){Ht(U,te,X[te])}):Object.getOwnPropertyDescriptors?Object.defineProperties(U,Object.getOwnPropertyDescriptors(X)):Mt(Object(X)).forEach(function(te){Object.defineProperty(U,te,Object.getOwnPropertyDescriptor(X,te))})}return U}function Ht(U,N,X){return(N=lr(N))in U?Object.defineProperty(U,N,{value:X,enumerable:!0,configurable:!0,writable:!0}):U[N]=X,U}function bt(){return bt=Object.assign?Object.assign.bind():function(U){for(var N=1;N<arguments.length;N++){var X=arguments[N];for(var te in X)Object.prototype.hasOwnProperty.call(X,te)&&(U[te]=X[te])}return U},bt.apply(this,arguments)}function ol(U,N){for(var X=0;X<N.length;X++){var te=N[X];te.enumerable=te.enumerable||!1,te.configurable=!0,"value"in te&&(te.writable=!0),Object.defineProperty(U,lr(te.key),te)}}function lr(U){var N=function(X,te){if(ae(X)!=="object"||X===null)return X;var Pe=X[Symbol.toPrimitive];if(Pe!==void 0){var _e=Pe.call(X,"string");if(ae(_e)!=="object")return _e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(X)}(U);return ae(N)==="symbol"?N:String(N)}function cs(U,N){return cs=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(X,te){return X.__proto__=te,X},cs(U,N)}function B(U){return B=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(N){return N.__proto__||Object.getPrototypeOf(N)},B(U)}var Z=function(U){(function(K,ee){if(typeof ee!="function"&&ee!==null)throw new TypeError("Super expression must either be null or a function");K.prototype=Object.create(ee&&ee.prototype,{constructor:{value:K,writable:!0,configurable:!0}}),Object.defineProperty(K,"prototype",{writable:!1}),ee&&cs(K,ee)})(De,U);var N,X,te,Pe,_e=(te=De,Pe=function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}(),function(){var K,ee=B(te);if(Pe){var ue=B(this).constructor;K=Reflect.construct(ee,arguments,ue)}else K=ee.apply(this,arguments);return function(pe,fe){if(fe&&(ae(fe)==="object"||typeof fe=="function"))return fe;if(fe!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(Me){if(Me===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Me}(pe)}(this,K)});function De(K){var ee;return function(ue,pe){if(!(ue instanceof pe))throw new TypeError("Cannot call a class as a function")}(this,De),(ee=_e.call(this,K)).state={loaded:!1},ee}return N=De,(X=[{key:"onImageLoad",value:function(){var K=this;return this.state.loaded?null:function(ee){K.props.onLoad(ee),K.props.afterLoad(),K.setState({loaded:!0})}}},{key:"getImg",value:function(){var K=this.props,ee=(K.afterLoad,K.beforeLoad,K.delayMethod,K.delayTime,K.effect,K.placeholder,K.placeholderSrc,K.scrollPosition,K.threshold,K.useIntersectionObserver,K.visibleByDefault,K.wrapperClassName,K.wrapperProps,function(ue,pe){if(ue==null)return{};var fe,Me,Qe=function(Ye,Rt){if(Ye==null)return{};var mt,Lt,Hr={},Er=Object.keys(Ye);for(Lt=0;Lt<Er.length;Lt++)mt=Er[Lt],Rt.indexOf(mt)>=0||(Hr[mt]=Ye[mt]);return Hr}(ue,pe);if(Object.getOwnPropertySymbols){var Je=Object.getOwnPropertySymbols(ue);for(Me=0;Me<Je.length;Me++)fe=Je[Me],pe.indexOf(fe)>=0||Object.prototype.propertyIsEnumerable.call(ue,fe)&&(Qe[fe]=ue[fe])}return Qe}(K,$e));return s().createElement("img",bt({},ee,{onLoad:this.onImageLoad()}))}},{key:"getLazyLoadImage",value:function(){var K=this.props,ee=K.beforeLoad,ue=K.className,pe=K.delayMethod,fe=K.delayTime,Me=K.height,Qe=K.placeholder,Je=K.scrollPosition,Ye=K.style,Rt=K.threshold,mt=K.useIntersectionObserver,Lt=K.visibleByDefault,Hr=K.width;return s().createElement(ye,{beforeLoad:ee,className:ue,delayMethod:pe,delayTime:fe,height:Me,placeholder:Qe,scrollPosition:Je,style:Ye,threshold:Rt,useIntersectionObserver:mt,visibleByDefault:Lt,width:Hr},this.getImg())}},{key:"getWrappedLazyLoadImage",value:function(K){var ee=this.props,ue=ee.effect,pe=ee.height,fe=ee.placeholderSrc,Me=ee.width,Qe=ee.wrapperClassName,Je=ee.wrapperProps,Ye=this.state.loaded,Rt=Ye?" lazy-load-image-loaded":"",mt=Ye||!fe?{}:{backgroundImage:"url(".concat(fe,")"),backgroundSize:"100% 100%"};return s().createElement("span",bt({className:Qe+" lazy-load-image-background "+ue+Rt,style:un(un({},mt),{},{color:"transparent",display:"inline-block",height:pe,width:Me})},Je),K)}},{key:"render",value:function(){var K=this.props,ee=K.effect,ue=K.placeholderSrc,pe=K.visibleByDefault,fe=K.wrapperClassName,Me=K.wrapperProps,Qe=this.getLazyLoadImage();return(ee||ue)&&!pe||fe||Me?this.getWrappedLazyLoadImage(Qe):Qe}}])&&ol(N.prototype,X),Object.defineProperty(N,"prototype",{writable:!1}),De}(s().Component);Z.propTypes={onLoad:o.PropTypes.func,afterLoad:o.PropTypes.func,beforeLoad:o.PropTypes.func,delayMethod:o.PropTypes.string,delayTime:o.PropTypes.number,effect:o.PropTypes.string,placeholderSrc:o.PropTypes.string,threshold:o.PropTypes.number,useIntersectionObserver:o.PropTypes.bool,visibleByDefault:o.PropTypes.bool,wrapperClassName:o.PropTypes.string,wrapperProps:o.PropTypes.object},Z.defaultProps={onLoad:function(){},afterLoad:function(){return{}},beforeLoad:function(){return{}},delayMethod:"throttle",delayTime:300,effect:"",placeholderSrc:null,threshold:100,useIntersectionObserver:!0,visibleByDefault:!1,wrapperClassName:""};const oe=Z})(),gT.exports=r})();var mT=gT.exports;const yT=Jo(mT),B5=Od({__proto__:null,default:yT},[mT]),{LazyLoadComponent:U5}=B5||yT;function W5(e){const{size:t,visible:n,classes:r,canvasId:i,figure:s}=e,o=(t==null?void 0:t.width)||128,u=(t==null?void 0:t.height)||(t==null?void 0:t.width)||128,d=E.jsx(H5,{...e}),h=E.jsx(U5,{threshold:300,style:{height:u,width:o},visibleByDefault:n,children:i?E.jsx(Ko,{canvas:i,children:d}):d});return s?E.jsx("figure",{className:r==null?void 0:r.figure,children:h}):h}function H5({fallback:e,size:t,classes:n,showLabel:r,alt:i,dereference:s=!1}){const o=ut(),u=(t==null?void 0:t.width)||128,d=(t==null?void 0:t.height)||(t==null?void 0:t.width)||128,h=i||M3(o==null?void 0:o.label)||"",c=mf({width:u,height:d,allowUnsafe:!0},s);return!c||c.type!=="fixed"?E.jsx(E.Fragment,{children:e}):E.jsxs(E.Fragment,{children:[E.jsx("div",{className:n==null?void 0:n.imageWrapper,children:E.jsx("img",{className:n==null?void 0:n.img,src:c.id,alt:h})}),r?E.jsx(tr,{as:"figcaption",className:n==null?void 0:n.label,children:o==null?void 0:o.label}):null]})}function V5({scrollBehaviour:e,dereference:t,flat:n,size:r,classes:i={},showLabel:s,figure:o,fallback:u}){var S,C,x,k,T,_;const d=b.useRef(null),{items:h,sequence:c,currentSequenceIndex:p,setSequenceIndex:m}=rf(),w={row:((S=i.selected)==null?void 0:S.row)||i.row,item:((C=i.selected)==null?void 0:C.item)||i.item,figure:((x=i.selected)==null?void 0:x.figure)||i.figure,img:((k=i.selected)==null?void 0:k.img)||i.img,label:((T=i.selected)==null?void 0:T.label)||i.label,imageWrapper:((_=i.selected)==null?void 0:_.imageWrapper)||i.imageWrapper};b.useLayoutEffect(()=>{if(!d.current)return;const R=d.current.querySelector("[data-selected=true]");R&&R.scrollIntoView({behavior:e||"instant",block:"nearest",inline:"center"})},[p]);const y=[];for(const R of c){const O=[],F=c[p]===R;for(const z of R){const J=h[z];O.push(E.jsx("div",{className:F?w.item:i.item,children:E.jsx(W5,{classes:F?w:i,canvasId:J.id,size:r,dereference:t,showLabel:s,figure:o,placeholder:E.jsx("div",{style:{height:128,width:128}}),fallback:u})},z))}if(n){y.push(O);continue}y.push(E.jsx("div",{onClick:z=>{m(c.indexOf(R))},"data-selected":F,className:F?w.row:i.row,children:O},R.join("-")))}return E.jsx("div",{ref:d,className:i.container,children:y})}function q5(){const e=An(),t=Te(e,s=>s.completeRequest),n=Te(e,s=>s.polygonState.currentTool),r=Te(e,s=>s.polygonState.selectedStamp),i=Te(e,s=>s.switchTool);return{completeRequest:t,currentTool:n,selectedStamp:r,switchTool:i}}const Q5={draw:!0,polygon:!0,line:!0,lineBox:!0,box:!0,triangle:!0,hexagon:!0,circle:!0,delete:!0,pen:!0};function Y5({showShapes:e=!0,enabled:t=Q5,classNames:n={},icons:r={}}){const{currentTool:i,switchTool:s,selectedStamp:o}=q5();return E.jsxs(E.Fragment,{children:[i,E.jsx("button",{className:n.button,onClick:s.pointer,"data-active":i==="pointer",children:r.PointerIcon||"Pointer"}),E.jsx("button",{className:n.button,onClick:s.hand,"data-active":i==="hand",children:r.HandIcon||"Hand"}),e?E.jsxs(E.Fragment,{children:[t.box&&E.jsx("button",{className:n.button,onClick:s.box,"data-active":i==="box",children:r.BoxIcon||"Box"}),t.pen&&E.jsx("button",{className:n.button,onClick:s.pen,"data-active":i==="pen",children:r.PenIcon||"Pen"}),t.draw&&E.jsx("button",{className:n.button,onClick:s.draw,"data-active":i==="pencil",children:r.DrawIcon||"Draw"}),t.line&&E.jsx("button",{className:n.button,onClick:s.line,"data-active":i==="line",children:r.LineIcon||"Line"}),t.lineBox&&E.jsx("button",{className:n.button,onClick:s.lineBox,"data-active":i==="lineBox",children:r.LineBoxIcon||"LineBox"}),t.triangle&&E.jsx("button",{className:n.button,onClick:s.triangle,"data-active":i==="stamp"&&(o==null?void 0:o.id)==="triangle",children:r.TriangleIcon||"Triangle"}),t.hexagon&&E.jsx("button",{className:n.button,onClick:s.hexagon,"data-active":i==="stamp"&&(o==null?void 0:o.id)==="hexagon",children:r.HexagonIcon||"Hexagon"}),t.circle&&E.jsx("button",{className:n.button,"data-active":i==="stamp"&&(o==null?void 0:o.id)==="circle",onClick:s.circle,children:r.CircleIcon||"Circle"})]}):null,t.delete&&E.jsx("button",{className:n.button,onClick:s.remove,children:r.DeleteForeverIcon||"Delete"})]})}function X5(){const{progress:e,currentTime:t}=O3(),{duration:n,isMuted:r,volume:i,isPlaying:s,playRequested:o}=_3(),{play:u,pause:d,setVolume:h,toggleMute:c,setDurationPercent:p}=A3();return E.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[E.jsx("button",{disabled:o,onClick:()=>{s?d():u()},children:s||o?"pause":"play"}),E.jsx("div",{ref:t,style:{padding:"0 20px"},children:"0:00"}),E.jsxs("div",{style:{flex:" 1 1 0px",height:"6px",display:"flex",position:"relative",padding:"15px 0"},onClick:m=>{const{left:w,width:y}=m.currentTarget.getBoundingClientRect(),S=(m.pageX-w)/y;p(S)},children:[E.jsx("div",{style:{height:"6px",pointerEvents:"none",position:"absolute",top:"13px",left:"0",right:0,borderRadius:"3px",transition:"width 200ms",background:"#f9f9f9"}}),n?E.jsx("div",{style:{position:"absolute",top:"13px",left:"0",height:"6px",borderRadius:"3px",background:"cornflowerblue",width:"100%",pointerEvents:"none"},ref:e}):null]}),E.jsx("div",{style:{padding:"0 20px"},children:gf(n)}),E.jsxs("div",{style:{display:"flex"},children:[E.jsx("input",{type:"range",id:"audio-slider",role:"slider",disabled:r,min:"0",max:"100",value:i,onChange:m=>h(Number(m.currentTarget.value))}),E.jsx("button",{onClick:()=>c(),children:r?"Mute":"Unmute"})]})]})}function K5(){const e=ut(),t=Oy(),n=Ny(e==null?void 0:e.id),r=n.enabledPageIds.length!==0,i=()=>{r?n.availablePageIds.map(s=>n.setPageDisabled(s)):n.availablePageIds.map(s=>n.setPageEnabled(s,{deselectOthers:!1}))};return E.jsxs("div",{style:{display:"flex",alignItems:"center",position:"absolute",top:20,right:20,zIndex:12},children:[E.jsx("button",{onClick:()=>t==null?void 0:t.runtime.world.zoomOut(),children:"Zoom Out"}),E.jsx("button",{onClick:()=>t==null?void 0:t.runtime.world.zoomIn(),children:"Zoom in"}),E.jsx("button",{onClick:()=>t==null?void 0:t.runtime.world.goHome(),children:"Home"}),n.availablePageIds.length?E.jsx("button",{onClick:i,children:r?"Disable annotations":"Enable annotations"}):null]})}function vT(){const e=An(),t=Te(e,r=>r.completeRequest),n=Te(e,r=>r.cancelRequest);return b.useMemo(()=>({saveAnnotation:()=>{b.startTransition(()=>{t()})},cancelRequest:n}),[t,n])}function G5(){const e=An();return Te(e,t=>{var n;return t.tool.requestId?((n=t.requests[t.tool.requestId])==null?void 0:n.arguments)||{}:{}})}function xT({requestId:e}={}){const t=An(),n=Te(t,u=>u.metadata),r=Te(t,u=>u.tool.requestId),i=e||r,s=Te(t,u=>u.setMetadata),o=b.useCallback(u=>s(u,i||void 0),[s,i]);return[i?n[i]||{}:{},o]}function Z5(e){const t=An(),n=Te(t,r=>r.tool.requestId);Hc("polygons.start-transition",r=>{var i;e.requestId&&n!==e.requestId||(i=e==null?void 0:e.onStart)==null||i.call(e,r.transitionIntent)},[n,e.requestId]),Hc("polygons.end-transition",r=>{var i;e.requestId&&n!==e.requestId||(i=e==null?void 0:e.onEnd)==null||i.call(e,r.transitionIntent,r.response)},[n,e.requestId]),Hc("polygons.transition",r=>{var i;e.requestId&&n!==e.requestId||(i=e==null?void 0:e.onTransition)==null||i.call(e,r.transitionIntent)},[n,e.requestId])}function J5(e){const[t,n]=b.useState(0),r=An(),i=Te(r,R=>R.tool.enabled),s=Te(r,R=>R.tool.requestId),o=Te(r,R=>R.getRequestId),u=Te(r,R=>R.requestAnnotation),d=Te(r,R=>R.completeRequest),h=Te(r,R=>R.cancelRequest),c=b.useRef(e==null?void 0:e.onSuccess);c.current=e==null?void 0:e.onSuccess;const[p,m]=b.useState(!1),[w,y]=b.useState(null),[S,C]=b.useState(null),x=i&&s!==S,k=i&&s===S,T=b.useCallback(async(R,O)=>{if(S){const F=c.current;m(!0);const z=await u(R,{...O,requestId:S});if(z)return F==null||F(z),n(j=>j+1),m(!1),y(z),z;const J={id:S,cancelled:!0,...Py(R)};return F==null||F(J),y(J),n(j=>j+1),m(!1),J}return null},[u,S]),_=b.useCallback(()=>{y(null),m(!1)},[]);return b.useEffect(()=>{const R=o();return C(R.requestId),()=>{R.clear()}},[t]),{id:t,busy:x,isPending:p,isActive:k,requestId:S,requestAnnotation:T,cancelRequest:()=>S?h(S):void 0,completeRequest:()=>S?d(S):void 0,reset:_,data:w}}function eF(){const{play:e,pause:t,setVolume:n,toggleMute:r,setDurationPercent:i,duration:s,isMuted:o,volume:u,isPlaying:d,isReady:h,playRequested:c,setProgressElement:p,setCurrentTimeElement:m,clearProgressElement:w,clearCurrentTimeElement:y}=K3(x=>x),S=b.useRef(null),C=b.useRef(null);return b.useLayoutEffect(()=>(S.current&&p(S.current),C.current&&m(C.current),()=>{w(),y()}),[h]),E.jsxs("div",{className:"controls",style:{display:"flex",alignItems:"center",opacity:h?1:.5},children:[E.jsx("button",{disabled:c,onClick:()=>{d?t():e()},children:d||c?"pause":"play"}),E.jsx("div",{ref:C,style:{padding:"0 20px"},children:"0:00"}),E.jsxs("div",{style:{flex:" 1 1 0px",height:"6px",display:"flex",position:"relative",padding:"15px 0"},onClick:x=>{const{left:k,width:T}=x.currentTarget.getBoundingClientRect(),_=(x.pageX-k)/T;i(_)},children:[E.jsx("div",{style:{height:"6px",pointerEvents:"none",position:"absolute",top:"13px",left:"0",right:0,borderRadius:"3px",transition:"width 200ms",background:"#f9f9f9"}}),s?E.jsx("div",{style:{position:"absolute",top:"13px",left:"0",height:"6px",borderRadius:"3px",background:"cornflowerblue",width:"100%",pointerEvents:"none"},ref:S}):null]}),E.jsx("div",{style:{padding:"0 20px"},children:gf(s)}),E.jsxs("div",{style:{display:"flex"},children:[E.jsx("input",{type:"range",id:"audio-slider",role:"slider",disabled:o,min:"0",max:"100",value:u,onChange:x=>n(Number(x.currentTarget.value))}),E.jsx("button",{onClick:()=>r(),children:o?"Mute":"Unmute"})]})]})}const tF={maxOverZoom:5};function nF(){const e=ut(),t=Ny(e==null?void 0:e.id),n=yn();return!e||t.enabledPageIds.length===0?null:E.jsx(E.Fragment,{children:t.enabledPageIds.map(r=>E.jsx(Wt.RenderAnnotationPage,{page:n.get(r)},r))})}function rF(){const e=Br();return e?E.jsx(tr,{as:"h2",className:"text-2xl my-3",children:e.label}):E.jsx("div",{children:"Loading.."})}const iF=document.getElementById("root"),sF={MediaControls:X5,ViewerControls:K5,ComplexTimelineControls:eF},oF=()=>{const[e,t]=b.useState(()=>T0.parse(window.location.hash.slice(1))),[n,r]=b.useState(!1),{manifest:i,range:s,canvas:o}=e,u=b.useRef(null),[d,h]=b.useState(!0);b.useEffect(()=>{const m=()=>{t(T0.parse(window.location.hash.slice(1)))};return window.addEventListener("hashchange",m),()=>window.removeEventListener("hashchange",m)});const[c,p]=b.useState({id:"example",points:[],open:!0});return E.jsxs(E.Fragment,{children:[E.jsx("style",{children:`
            [data-textual-content="true"] {
              background: #fff;
              font-size: 1.2em;
              font-family: system-ui, sans-serif;
              padding: 1em;
              margin-top: 1em;
            }
            * { box-sizing: border-box; }
            .atlas-container { background: #000; }

            body { padding: 0.5em }
        `}),E.jsxs(Wt,{ref:u,spacing:20,height:800,header:E.jsx(rF,{}),reuseAtlas:!0,mode:n?"sketch":"explore",pagingEnabled:d,runtimeOptions:tF,manifest:i||"https://gist.githubusercontent.com/stephenwf/57cc5024144c53d48cc3c07cc522eb94/raw/a87a5d9a8f949bfb11cebd4f011a204abe8a932b/manifest.json",annotationPopup:E.jsx(aF,{}),startCanvas:o,components:sF,annotations:E.jsxs(E.Fragment,{children:[E.jsx(nF,{}),E.jsx(O5,{})]}),renderAnnotationContextMenu:()=>E.jsx("div",{children:"This is indeed an annotation"}),renderContextMenu:({position:m})=>E.jsx(lF,{position:m}),children:[E.jsx(L5,{}),E.jsx(uF,{}),E.jsxs("div",{className:"actions hide flex gap-2 my-4",children:[E.jsx("button",{className:"p-2 bg-blue-500 text-white hover:bg-blue-400",onClick:()=>h(m=>!m),children:"toggle paging"}),E.jsx("button",{className:"p-2 bg-blue-500 text-white hover:bg-blue-400",onClick:()=>{var m;return(m=u.current)==null?void 0:m.previousCanvas()},children:"prev"}),E.jsx("button",{className:"p-2 bg-blue-500 text-white hover:bg-blue-400",onClick:()=>{var m;return(m=u.current)==null?void 0:m.nextCanvas()},children:"next"})]}),E.jsx(D5,{}),E.jsx(V5,{classes:{container:"actions hide flex gap-1 overflow-x-auto",row:"flex gap-2 border border-gray-200 flex-none p-2 m-2",img:"max-h-[128px] max-w-[128px] object-contain h-full w-full",selected:{row:"flex gap-2 border border-blue-400 flex-none p-2 m-2 bg-blue-100"}},fallback:E.jsx("div",{className:"flex items-center justify-center w-32 h-32 bg-gray-200 text-gray-400 select-none",children:"No thumb"})}),E.jsx(N5,{}),E.jsx(z5,{}),E.jsx(M5,{allowHtml:!0,classes:{container:"m-4",row:"border-b border-gray-200",label:"font-bold p-2 text-slate-600",value:"text-sm p-2 text-slate-800",empty:"text-gray-400"}})]},`${i}-${s}-${o}`)]})};function lF({position:e}){const{strategy:t}=or();return E.jsxs("div",{className:"bg-white p-3 rounded drop-shadow-xl",children:[t.type,"x: ",~~e.x,", y: ",~~e.y]})}function aF(){const{saveAnnotation:e}=vT(),[t,n]=xT(),{customData:r}=G5();return E.jsxs("div",{className:"bg-white rounded drop-shadow-md p-4",children:[E.jsxs("h3",{children:["Annotation editing demo (arg: ",r,")"]}),E.jsx("input",{className:"p-2 border border-gray-300 rounded",type:"text",placeholder:"Add a value...",value:t.body,onChange:i=>n({body:i.target.value})}),E.jsx("button",{className:"p-2 bg-blue-500 text-white hover:bg-blue-400 data-[active=true]:bg-blue-700",onClick:e,children:"Save"})]})}function uF(){const e=ut(),{requestAnnotation:t,isPending:n}=J5({onSuccess:i=>{console.log("annotation created!",i)}}),r=e?{x:0,y:0,width:e.width,height:e.height}:null;return n?E.jsx(Y5,{classNames:{button:"p-2 bg-blue-500 text-white hover:bg-blue-400 data-[active=true]:bg-blue-700"}}):E.jsxs("div",{className:"actions hide flex flex-row gap-2",children:[E.jsx("button",{className:"p-2 bg-blue-500 text-white hover:bg-blue-400",onClick:()=>t({type:"box",bounds:r,arguments:{customData:"Box"}}),children:"Create box"}),E.jsx("button",{className:"p-2 bg-blue-500 text-white hover:bg-blue-400",onClick:()=>t({type:"polygon",arguments:{customData:"Polygon"}}),children:"Create polygon"}),E.jsx("button",{className:"p-2 bg-blue-500 text-white hover:bg-blue-400",onClick:()=>t({type:"draw",arguments:{customData:"Polygon"}}),children:"Draw"}),E.jsx("button",{className:"p-2 bg-blue-500 text-white hover:bg-blue-400",onClick:()=>t({type:"target",selector:{x:100,y:100,width:130,height:200},arguments:{customData:"Polygon"},annotationPopup:E.jsx(cF,{})}),children:"Aspect ratio box"}),E.jsx("button",{className:"p-2 bg-blue-500 text-white hover:bg-blue-400",onClick:()=>t({type:"box",annotationPopup:E.jsx(dF,{}),svgTheme:{shapeFill:"#4E80EE99",shapeStroke:"#4E80EE",boundingBoxDottedStroke:"#4E80EE",boundingBoxStroke:"none",activeLineStroke:"#4E80EE",lineStroke:"#4E80EE"}}),children:"Comment"}),E.jsx("button",{className:"p-2 bg-blue-500 text-white hover:bg-blue-400",onClick:()=>t({type:"polygon",points:[[282,630],[337,579],[915,1158],[878,1260],[806,1211]]}),children:"Edit existing"}),E.jsx("button",{className:"p-2 bg-blue-500 text-white hover:bg-blue-400",onClick:()=>t({type:"polygon",points:[[250,960],[250,1251],[695,1251],[695,960]]}),children:"Edit existing (box)"})]})}function cF(){return Z5({onStart:e=>console.log("start",e),onEnd:e=>console.log("end",e),onTransition:e=>console.log("transition",e)}),null}function dF(){const{saveAnnotation:e,cancelRequest:t}=vT(),[n,r]=xT();return E.jsxs("div",{className:"bg-white rounded drop-shadow-md p-4 w-96",children:[E.jsx("h3",{className:"text-lg font-bold mb-2",children:"Write a comment"}),E.jsx("textarea",{className:"p-2 border border-gray-300 rounded w-full mb-2",rows:4,placeholder:"Write a comment",value:n.comment,onChange:i=>r({comment:i.target.value})}),E.jsxs("div",{className:"flex gap-2 justify-end",children:[E.jsx("button",{className:"px-2 py-1 rounded bg-blue-500 text-white hover:bg-blue-400 data-[active=true]:bg-blue-700",onClick:()=>t(),children:"Cancel"}),E.jsx("button",{className:"px-2 py-1 rounded bg-blue-500 text-white hover:bg-blue-400 data-[active=true]:bg-blue-700",onClick:e,children:"Save comment"})]})]})}const fF=ly(iF);fF.render(E.jsx(oF,{}));
