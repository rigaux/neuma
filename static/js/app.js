function Wd(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(t,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();function Jl(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ep={exports:{}},cc={},tp={exports:{}},ht={};var km;function P1(){if(km)return ht;km=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),c=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),m=Symbol.for("react.suspense"),y=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),v=Symbol.iterator;function E(B){return B===null||typeof B!="object"?null:(B=v&&B[v]||B["@@iterator"],typeof B=="function"?B:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},P=Object.assign,k={};function R(B,re,Re){this.props=B,this.context=re,this.refs=k,this.updater=Re||T}R.prototype.isReactComponent={},R.prototype.setState=function(B,re){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,re,"setState")},R.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function _(){}_.prototype=R.prototype;function M(B,re,Re){this.props=B,this.context=re,this.refs=k,this.updater=Re||T}var L=M.prototype=new _;L.constructor=M,P(L,R.prototype),L.isPureReactComponent=!0;var $=Array.isArray,F=Object.prototype.hasOwnProperty,H={current:null},se={key:!0,ref:!0,__self:!0,__source:!0};function oe(B,re,Re){var je,Le={},De=null,Je=null;if(re!=null)for(je in re.ref!==void 0&&(Je=re.ref),re.key!==void 0&&(De=""+re.key),re)F.call(re,je)&&!se.hasOwnProperty(je)&&(Le[je]=re[je]);var it=arguments.length-2;if(it===1)Le.children=Re;else if(1<it){for(var ut=Array(it),mt=0;mt<it;mt++)ut[mt]=arguments[mt+2];Le.children=ut}if(B&&B.defaultProps)for(je in it=B.defaultProps,it)Le[je]===void 0&&(Le[je]=it[je]);return{$$typeof:t,type:B,key:De,ref:Je,props:Le,_owner:H.current}}function me(B,re){return{$$typeof:t,type:B.type,key:re,ref:B.ref,props:B.props,_owner:B._owner}}function K(B){return typeof B=="object"&&B!==null&&B.$$typeof===t}function ge(B){var re={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(Re){return re[Re]})}var de=/\/+/g;function we(B,re){return typeof B=="object"&&B!==null&&B.key!=null?ge(""+B.key):re.toString(36)}function le(B,re,Re,je,Le){var De=typeof B;(De==="undefined"||De==="boolean")&&(B=null);var Je=!1;if(B===null)Je=!0;else switch(De){case"string":case"number":Je=!0;break;case"object":switch(B.$$typeof){case t:case e:Je=!0}}if(Je)return Je=B,Le=Le(Je),B=je===""?"."+we(Je,0):je,$(Le)?(Re="",B!=null&&(Re=B.replace(de,"$&/")+"/"),le(Le,re,Re,"",function(mt){return mt})):Le!=null&&(K(Le)&&(Le=me(Le,Re+(!Le.key||Je&&Je.key===Le.key?"":(""+Le.key).replace(de,"$&/")+"/")+B)),re.push(Le)),1;if(Je=0,je=je===""?".":je+":",$(B))for(var it=0;it<B.length;it++){De=B[it];var ut=je+we(De,it);Je+=le(De,re,Re,ut,Le)}else if(ut=E(B),typeof ut=="function")for(B=ut.call(B),it=0;!(De=B.next()).done;)De=De.value,ut=je+we(De,it++),Je+=le(De,re,Re,ut,Le);else if(De==="object")throw re=String(B),Error("Objects are not valid as a React child (found: "+(re==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":re)+"). If you meant to render a collection of children, use an array instead.");return Je}function Ie(B,re,Re){if(B==null)return B;var je=[],Le=0;return le(B,je,"","",function(De){return re.call(Re,De,Le++)}),je}function Se(B){if(B._status===-1){var re=B._result;re=re(),re.then(function(Re){(B._status===0||B._status===-1)&&(B._status=1,B._result=Re)},function(Re){(B._status===0||B._status===-1)&&(B._status=2,B._result=Re)}),B._status===-1&&(B._status=0,B._result=re)}if(B._status===1)return B._result.default;throw B._result}var Te={current:null},D={transition:null},U={ReactCurrentDispatcher:Te,ReactCurrentBatchConfig:D,ReactCurrentOwner:H};function Q(){throw Error("act(...) is not supported in production builds of React.")}return ht.Children={map:Ie,forEach:function(B,re,Re){Ie(B,function(){re.apply(this,arguments)},Re)},count:function(B){var re=0;return Ie(B,function(){re++}),re},toArray:function(B){return Ie(B,function(re){return re})||[]},only:function(B){if(!K(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},ht.Component=R,ht.Fragment=n,ht.Profiler=s,ht.PureComponent=M,ht.StrictMode=r,ht.Suspense=m,ht.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U,ht.act=Q,ht.cloneElement=function(B,re,Re){if(B==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+B+".");var je=P({},B.props),Le=B.key,De=B.ref,Je=B._owner;if(re!=null){if(re.ref!==void 0&&(De=re.ref,Je=H.current),re.key!==void 0&&(Le=""+re.key),B.type&&B.type.defaultProps)var it=B.type.defaultProps;for(ut in re)F.call(re,ut)&&!se.hasOwnProperty(ut)&&(je[ut]=re[ut]===void 0&&it!==void 0?it[ut]:re[ut])}var ut=arguments.length-2;if(ut===1)je.children=Re;else if(1<ut){it=Array(ut);for(var mt=0;mt<ut;mt++)it[mt]=arguments[mt+2];je.children=it}return{$$typeof:t,type:B.type,key:Le,ref:De,props:je,_owner:Je}},ht.createContext=function(B){return B={$$typeof:c,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},B.Provider={$$typeof:a,_context:B},B.Consumer=B},ht.createElement=oe,ht.createFactory=function(B){var re=oe.bind(null,B);return re.type=B,re},ht.createRef=function(){return{current:null}},ht.forwardRef=function(B){return{$$typeof:d,render:B}},ht.isValidElement=K,ht.lazy=function(B){return{$$typeof:h,_payload:{_status:-1,_result:B},_init:Se}},ht.memo=function(B,re){return{$$typeof:y,type:B,compare:re===void 0?null:re}},ht.startTransition=function(B){var re=D.transition;D.transition={};try{B()}finally{D.transition=re}},ht.unstable_act=Q,ht.useCallback=function(B,re){return Te.current.useCallback(B,re)},ht.useContext=function(B){return Te.current.useContext(B)},ht.useDebugValue=function(){},ht.useDeferredValue=function(B){return Te.current.useDeferredValue(B)},ht.useEffect=function(B,re){return Te.current.useEffect(B,re)},ht.useId=function(){return Te.current.useId()},ht.useImperativeHandle=function(B,re,Re){return Te.current.useImperativeHandle(B,re,Re)},ht.useInsertionEffect=function(B,re){return Te.current.useInsertionEffect(B,re)},ht.useLayoutEffect=function(B,re){return Te.current.useLayoutEffect(B,re)},ht.useMemo=function(B,re){return Te.current.useMemo(B,re)},ht.useReducer=function(B,re,Re){return Te.current.useReducer(B,re,Re)},ht.useRef=function(B){return Te.current.useRef(B)},ht.useState=function(B){return Te.current.useState(B)},ht.useSyncExternalStore=function(B,re,Re){return Te.current.useSyncExternalStore(B,re,Re)},ht.useTransition=function(){return Te.current.useTransition()},ht.version="18.3.1",ht}var Cm;function ea(){return Cm||(Cm=1,tp.exports=P1()),tp.exports}var Tm;function E1(){if(Tm)return cc;Tm=1;var t=ea(),e=Symbol.for("react.element"),n=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function c(d,m,y){var h,v={},E=null,T=null;y!==void 0&&(E=""+y),m.key!==void 0&&(E=""+m.key),m.ref!==void 0&&(T=m.ref);for(h in m)r.call(m,h)&&!a.hasOwnProperty(h)&&(v[h]=m[h]);if(d&&d.defaultProps)for(h in m=d.defaultProps,m)v[h]===void 0&&(v[h]=m[h]);return{$$typeof:e,type:d,key:E,ref:T,props:v,_owner:s.current}}return cc.Fragment=n,cc.jsx=c,cc.jsxs=c,cc}var bm;function k1(){return bm||(bm=1,ep.exports=E1()),ep.exports}var I=k1(),O=ea();const Xt=Jl(O),uv=Wd({__proto__:null,default:Xt},[O]);var sd={},np={exports:{}},Nr={},rp={exports:{}},ip={};var Rm;function C1(){return Rm||(Rm=1,(function(t){function e(D,U){var Q=D.length;D.push(U);e:for(;0<Q;){var B=Q-1>>>1,re=D[B];if(0<s(re,U))D[B]=U,D[Q]=re,Q=B;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var U=D[0],Q=D.pop();if(Q!==U){D[0]=Q;e:for(var B=0,re=D.length,Re=re>>>1;B<Re;){var je=2*(B+1)-1,Le=D[je],De=je+1,Je=D[De];if(0>s(Le,Q))De<re&&0>s(Je,Le)?(D[B]=Je,D[De]=Q,B=De):(D[B]=Le,D[je]=Q,B=je);else if(De<re&&0>s(Je,Q))D[B]=Je,D[De]=Q,B=De;else break e}}return U}function s(D,U){var Q=D.sortIndex-U.sortIndex;return Q!==0?Q:D.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var c=Date,d=c.now();t.unstable_now=function(){return c.now()-d}}var m=[],y=[],h=1,v=null,E=3,T=!1,P=!1,k=!1,R=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function L(D){for(var U=n(y);U!==null;){if(U.callback===null)r(y);else if(U.startTime<=D)r(y),U.sortIndex=U.expirationTime,e(m,U);else break;U=n(y)}}function $(D){if(k=!1,L(D),!P)if(n(m)!==null)P=!0,Se(F);else{var U=n(y);U!==null&&Te($,U.startTime-D)}}function F(D,U){P=!1,k&&(k=!1,_(oe),oe=-1),T=!0;var Q=E;try{for(L(U),v=n(m);v!==null&&(!(v.expirationTime>U)||D&&!ge());){var B=v.callback;if(typeof B=="function"){v.callback=null,E=v.priorityLevel;var re=B(v.expirationTime<=U);U=t.unstable_now(),typeof re=="function"?v.callback=re:v===n(m)&&r(m),L(U)}else r(m);v=n(m)}if(v!==null)var Re=!0;else{var je=n(y);je!==null&&Te($,je.startTime-U),Re=!1}return Re}finally{v=null,E=Q,T=!1}}var H=!1,se=null,oe=-1,me=5,K=-1;function ge(){return!(t.unstable_now()-K<me)}function de(){if(se!==null){var D=t.unstable_now();K=D;var U=!0;try{U=se(!0,D)}finally{U?we():(H=!1,se=null)}}else H=!1}var we;if(typeof M=="function")we=function(){M(de)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,Ie=le.port2;le.port1.onmessage=de,we=function(){Ie.postMessage(null)}}else we=function(){R(de,0)};function Se(D){se=D,H||(H=!0,we())}function Te(D,U){oe=R(function(){D(t.unstable_now())},U)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){P||T||(P=!0,Se(F))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):me=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return E},t.unstable_getFirstCallbackNode=function(){return n(m)},t.unstable_next=function(D){switch(E){case 1:case 2:case 3:var U=3;break;default:U=E}var Q=E;E=U;try{return D()}finally{E=Q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,U){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var Q=E;E=D;try{return U()}finally{E=Q}},t.unstable_scheduleCallback=function(D,U,Q){var B=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?B+Q:B):Q=B,D){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=Q+re,D={id:h++,callback:U,priorityLevel:D,startTime:Q,expirationTime:re,sortIndex:-1},Q>B?(D.sortIndex=Q,e(y,D),n(m)===null&&D===n(y)&&(k?(_(oe),oe=-1):k=!0,Te($,Q-B))):(D.sortIndex=re,e(m,D),P||T||(P=!0,Se(F))),D},t.unstable_shouldYield=ge,t.unstable_wrapCallback=function(D){var U=E;return function(){var Q=E;E=U;try{return D.apply(this,arguments)}finally{E=Q}}}})(ip)),ip}var _m;function T1(){return _m||(_m=1,rp.exports=C1()),rp.exports}var Im;function b1(){if(Im)return Nr;Im=1;var t=ea(),e=T1();function n(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,f=1;f<arguments.length;f++)o+="&args[]="+encodeURIComponent(arguments[f]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function a(i,o){c(i,o),c(i+"Capture",o)}function c(i,o){for(s[i]=o,i=0;i<o.length;i++)r.add(o[i])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),m=Object.prototype.hasOwnProperty,y=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},v={};function E(i){return m.call(v,i)?!0:m.call(h,i)?!1:y.test(i)?v[i]=!0:(h[i]=!0,!1)}function T(i,o,f,g){if(f!==null&&f.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return g?!1:f!==null?!f.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function P(i,o,f,g){if(o===null||typeof o>"u"||T(i,o,f,g))return!0;if(g)return!1;if(f!==null)switch(f.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function k(i,o,f,g,w,C,A){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=g,this.attributeNamespace=w,this.mustUseProperty=f,this.propertyName=i,this.type=o,this.sanitizeURL=C,this.removeEmptyString=A}var R={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){R[i]=new k(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];R[o]=new k(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){R[i]=new k(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){R[i]=new k(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){R[i]=new k(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){R[i]=new k(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){R[i]=new k(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){R[i]=new k(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){R[i]=new k(i,5,!1,i.toLowerCase(),null,!1,!1)});var _=/[\-:]([a-z])/g;function M(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(_,M);R[o]=new k(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(_,M);R[o]=new k(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(_,M);R[o]=new k(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){R[i]=new k(i,1,!1,i.toLowerCase(),null,!1,!1)}),R.xlinkHref=new k("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){R[i]=new k(i,1,!1,i.toLowerCase(),null,!0,!0)});function L(i,o,f,g){var w=R.hasOwnProperty(o)?R[o]:null;(w!==null?w.type!==0:g||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(P(o,f,w,g)&&(f=null),g||w===null?E(o)&&(f===null?i.removeAttribute(o):i.setAttribute(o,""+f)):w.mustUseProperty?i[w.propertyName]=f===null?w.type===3?!1:"":f:(o=w.attributeName,g=w.attributeNamespace,f===null?i.removeAttribute(o):(w=w.type,f=w===3||w===4&&f===!0?"":""+f,g?i.setAttributeNS(g,o,f):i.setAttribute(o,f))))}var $=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,F=Symbol.for("react.element"),H=Symbol.for("react.portal"),se=Symbol.for("react.fragment"),oe=Symbol.for("react.strict_mode"),me=Symbol.for("react.profiler"),K=Symbol.for("react.provider"),ge=Symbol.for("react.context"),de=Symbol.for("react.forward_ref"),we=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),Ie=Symbol.for("react.memo"),Se=Symbol.for("react.lazy"),Te=Symbol.for("react.offscreen"),D=Symbol.iterator;function U(i){return i===null||typeof i!="object"?null:(i=D&&i[D]||i["@@iterator"],typeof i=="function"?i:null)}var Q=Object.assign,B;function re(i){if(B===void 0)try{throw Error()}catch(f){var o=f.stack.trim().match(/\n( *(at )?)/);B=o&&o[1]||""}return`
`+B+i}var Re=!1;function je(i,o){if(!i||Re)return"";Re=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(ne){var g=ne}Reflect.construct(i,[],o)}else{try{o.call()}catch(ne){g=ne}i.call(o.prototype)}else{try{throw Error()}catch(ne){g=ne}i()}}catch(ne){if(ne&&g&&typeof ne.stack=="string"){for(var w=ne.stack.split(`
`),C=g.stack.split(`
`),A=w.length-1,z=C.length-1;1<=A&&0<=z&&w[A]!==C[z];)z--;for(;1<=A&&0<=z;A--,z--)if(w[A]!==C[z]){if(A!==1||z!==1)do if(A--,z--,0>z||w[A]!==C[z]){var V=`
`+w[A].replace(" at new "," at ");return i.displayName&&V.includes("<anonymous>")&&(V=V.replace("<anonymous>",i.displayName)),V}while(1<=A&&0<=z);break}}}finally{Re=!1,Error.prepareStackTrace=f}return(i=i?i.displayName||i.name:"")?re(i):""}function Le(i){switch(i.tag){case 5:return re(i.type);case 16:return re("Lazy");case 13:return re("Suspense");case 19:return re("SuspenseList");case 0:case 2:case 15:return i=je(i.type,!1),i;case 11:return i=je(i.type.render,!1),i;case 1:return i=je(i.type,!0),i;default:return""}}function De(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case se:return"Fragment";case H:return"Portal";case me:return"Profiler";case oe:return"StrictMode";case we:return"Suspense";case le:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case ge:return(i.displayName||"Context")+".Consumer";case K:return(i._context.displayName||"Context")+".Provider";case de:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Ie:return o=i.displayName||null,o!==null?o:De(i.type)||"Memo";case Se:o=i._payload,i=i._init;try{return De(i(o))}catch{}}return null}function Je(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return De(o);case 8:return o===oe?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function it(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function ut(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function mt(i){var o=ut(i)?"checked":"value",f=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),g=""+i[o];if(!i.hasOwnProperty(o)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var w=f.get,C=f.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return w.call(this)},set:function(A){g=""+A,C.call(this,A)}}),Object.defineProperty(i,o,{enumerable:f.enumerable}),{getValue:function(){return g},setValue:function(A){g=""+A},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function ot(i){i._valueTracker||(i._valueTracker=mt(i))}function ze(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var f=o.getValue(),g="";return i&&(g=ut(i)?i.checked?"true":"false":i.value),i=g,i!==f?(o.setValue(i),!0):!1}function be(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function ct(i,o){var f=o.checked;return Q({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:f??i._wrapperState.initialChecked})}function An(i,o){var f=o.defaultValue==null?"":o.defaultValue,g=o.checked!=null?o.checked:o.defaultChecked;f=it(o.value!=null?o.value:f),i._wrapperState={initialChecked:g,initialValue:f,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function fr(i,o){o=o.checked,o!=null&&L(i,"checked",o,!1)}function Mn(i,o){fr(i,o);var f=it(o.value),g=o.type;if(f!=null)g==="number"?(f===0&&i.value===""||i.value!=f)&&(i.value=""+f):i.value!==""+f&&(i.value=""+f);else if(g==="submit"||g==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?as(i,o.type,f):o.hasOwnProperty("defaultValue")&&as(i,o.type,it(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function En(i,o,f){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var g=o.type;if(!(g!=="submit"&&g!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,f||o===i.value||(i.value=o),i.defaultValue=o}f=i.name,f!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,f!==""&&(i.name=f)}function as(i,o,f){(o!=="number"||be(i.ownerDocument)!==i)&&(f==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+f&&(i.defaultValue=""+f))}var Vn=Array.isArray;function br(i,o,f,g){if(i=i.options,o){o={};for(var w=0;w<f.length;w++)o["$"+f[w]]=!0;for(f=0;f<i.length;f++)w=o.hasOwnProperty("$"+i[f].value),i[f].selected!==w&&(i[f].selected=w),w&&g&&(i[f].defaultSelected=!0)}else{for(f=""+it(f),o=null,w=0;w<i.length;w++){if(i[w].value===f){i[w].selected=!0,g&&(i[w].defaultSelected=!0);return}o!==null||i[w].disabled||(o=i[w])}o!==null&&(o.selected=!0)}}function Z(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(n(91));return Q({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function fe(i,o){var f=o.value;if(f==null){if(f=o.children,o=o.defaultValue,f!=null){if(o!=null)throw Error(n(92));if(Vn(f)){if(1<f.length)throw Error(n(93));f=f[0]}o=f}o==null&&(o=""),f=o}i._wrapperState={initialValue:it(f)}}function ke(i,o){var f=it(o.value),g=it(o.defaultValue);f!=null&&(f=""+f,f!==i.value&&(i.value=f),o.defaultValue==null&&i.defaultValue!==f&&(i.defaultValue=f)),g!=null&&(i.defaultValue=""+g)}function G(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function W(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ae(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?W(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var he,Xe=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,f,g,w){MSApp.execUnsafeLocalFunction(function(){return i(o,f,g,w)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(he=he||document.createElement("div"),he.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=he.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function Ze(i,o){if(o){var f=i.firstChild;if(f&&f===i.lastChild&&f.nodeType===3){f.nodeValue=o;return}}i.textContent=o}var at={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ue=["Webkit","ms","Moz","O"];Object.keys(at).forEach(function(i){ue.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),at[o]=at[i]})});function pe(i,o,f){return o==null||typeof o=="boolean"||o===""?"":f||typeof o!="number"||o===0||at.hasOwnProperty(i)&&at[i]?(""+o).trim():o+"px"}function Oe(i,o){i=i.style;for(var f in o)if(o.hasOwnProperty(f)){var g=f.indexOf("--")===0,w=pe(f,o[f],g);f==="float"&&(f="cssFloat"),g?i.setProperty(f,w):i[f]=w}}var Ne=Q({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ae(i,o){if(o){if(Ne[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(n(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(n(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(n(61))}if(o.style!=null&&typeof o.style!="object")throw Error(n(62))}}function tt(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var St=null;function bt(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Pt=null,Dt=null,Rt=null;function sn(i){if(i=kl(i)){if(typeof Pt!="function")throw Error(n(280));var o=i.stateNode;o&&(o=vn(o),Pt(i.stateNode,i.type,o))}}function Yr(i){Dt?Rt?Rt.push(i):Rt=[i]:Dt=i}function Fr(){if(Dt){var i=Dt,o=Rt;if(Rt=Dt=null,sn(i),o)for(i=0;i<o.length;i++)sn(o[i])}}function us(i,o){return i(o)}function cs(){}var fs=!1;function mu(i,o,f){if(fs)return i(o,f);fs=!0;try{return us(i,o,f)}finally{fs=!1,(Dt!==null||Rt!==null)&&(cs(),Fr())}}function ol(i,o){var f=i.stateNode;if(f===null)return null;var g=vn(f);if(g===null)return null;f=g[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(g=!g.disabled)||(i=i.type,g=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!g;break e;default:i=!1}if(i)return null;if(f&&typeof f!="function")throw Error(n(231,o,typeof f));return f}var yu=!1;if(d)try{var ll={};Object.defineProperty(ll,"passive",{get:function(){yu=!0}}),window.addEventListener("test",ll,ll),window.removeEventListener("test",ll,ll)}catch{yu=!1}function Yc(i,o,f,g,w,C,A,z,V){var ne=Array.prototype.slice.call(arguments,3);try{o.apply(f,ne)}catch(ve){this.onError(ve)}}var ds=!1,ra=null,ia=!1,eo=null,mh={onError:function(i){ds=!0,ra=i}};function yh(i,o,f,g,w,C,A,z,V){ds=!1,ra=null,Yc.apply(mh,arguments)}function vh(i,o,f,g,w,C,A,z,V){if(yh.apply(this,arguments),ds){if(ds){var ne=ra;ds=!1,ra=null}else throw Error(n(198));ia||(ia=!0,eo=ne)}}function hs(i){var o=i,f=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(f=o.return),i=o.return;while(i)}return o.tag===3?f:null}function Kc(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function Gc(i){if(hs(i)!==i)throw Error(n(188))}function xh(i){var o=i.alternate;if(!o){if(o=hs(i),o===null)throw Error(n(188));return o!==i?null:i}for(var f=i,g=o;;){var w=f.return;if(w===null)break;var C=w.alternate;if(C===null){if(g=w.return,g!==null){f=g;continue}break}if(w.child===C.child){for(C=w.child;C;){if(C===f)return Gc(w),i;if(C===g)return Gc(w),o;C=C.sibling}throw Error(n(188))}if(f.return!==g.return)f=w,g=C;else{for(var A=!1,z=w.child;z;){if(z===f){A=!0,f=w,g=C;break}if(z===g){A=!0,g=w,f=C;break}z=z.sibling}if(!A){for(z=C.child;z;){if(z===f){A=!0,f=C,g=w;break}if(z===g){A=!0,g=C,f=w;break}z=z.sibling}if(!A)throw Error(n(189))}}if(f.alternate!==g)throw Error(n(190))}if(f.tag!==3)throw Error(n(188));return f.stateNode.current===f?i:o}function Zc(i){return i=xh(i),i!==null?Jc(i):null}function Jc(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=Jc(i);if(o!==null)return o;i=i.sibling}return null}var ef=e.unstable_scheduleCallback,tf=e.unstable_cancelCallback,wh=e.unstable_shouldYield,Sh=e.unstable_requestPaint,Yt=e.unstable_now,vu=e.unstable_getCurrentPriorityLevel,ps=e.unstable_ImmediatePriority,sa=e.unstable_UserBlockingPriority,to=e.unstable_NormalPriority,Ph=e.unstable_LowPriority,oa=e.unstable_IdlePriority,hi=null,kn=null;function Lt(i){if(kn&&typeof kn.onCommitFiberRoot=="function")try{kn.onCommitFiberRoot(hi,i,void 0,(i.current.flags&128)===128)}catch{}}var ft=Math.clz32?Math.clz32:nr,Mi=Math.log,jn=Math.LN2;function nr(i){return i>>>=0,i===0?32:31-(Mi(i)/jn|0)|0}var Kr=64,pi=4194304;function gn(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function gs(i,o){var f=i.pendingLanes;if(f===0)return 0;var g=0,w=i.suspendedLanes,C=i.pingedLanes,A=f&268435455;if(A!==0){var z=A&~w;z!==0?g=gn(z):(C&=A,C!==0&&(g=gn(C)))}else A=f&~w,A!==0?g=gn(A):C!==0&&(g=gn(C));if(g===0)return 0;if(o!==0&&o!==g&&(o&w)===0&&(w=g&-g,C=o&-o,w>=C||w===16&&(C&4194240)!==0))return o;if((g&4)!==0&&(g|=f&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=g;0<o;)f=31-ft(o),w=1<<f,g|=i[f],o&=~w;return g}function nf(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function rf(i,o){for(var f=i.suspendedLanes,g=i.pingedLanes,w=i.expirationTimes,C=i.pendingLanes;0<C;){var A=31-ft(C),z=1<<A,V=w[A];V===-1?((z&f)===0||(z&g)!==0)&&(w[A]=nf(z,o)):V<=o&&(i.expiredLanes|=z),C&=~z}}function no(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function xu(){var i=Kr;return Kr<<=1,(Kr&4194240)===0&&(Kr=64),i}function dr(i){for(var o=[],f=0;31>f;f++)o.push(i);return o}function al(i,o,f){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-ft(o),i[o]=f}function Eh(i,o){var f=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var g=i.eventTimes;for(i=i.expirationTimes;0<f;){var w=31-ft(f),C=1<<w;o[w]=0,g[w]=-1,i[w]=-1,f&=~C}}function wu(i,o){var f=i.entangledLanes|=o;for(i=i.entanglements;f;){var g=31-ft(f),w=1<<g;w&o|i[g]&o&&(i[g]|=o),f&=~w}}var yt=0;function ul(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var ro,io,sf,of,la,aa=!1,so=[],Rr=null,ji=null,Gr=null,dt=new Map,oo=new Map,Zr=[],lf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function af(i,o){switch(i){case"focusin":case"focusout":Rr=null;break;case"dragenter":case"dragleave":ji=null;break;case"mouseover":case"mouseout":Gr=null;break;case"pointerover":case"pointerout":dt.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":oo.delete(o.pointerId)}}function cl(i,o,f,g,w,C){return i===null||i.nativeEvent!==C?(i={blockedOn:o,domEventName:f,eventSystemFlags:g,nativeEvent:C,targetContainers:[w]},o!==null&&(o=kl(o),o!==null&&io(o)),i):(i.eventSystemFlags|=g,o=i.targetContainers,w!==null&&o.indexOf(w)===-1&&o.push(w),i)}function mn(i,o,f,g,w){switch(o){case"focusin":return Rr=cl(Rr,i,o,f,g,w),!0;case"dragenter":return ji=cl(ji,i,o,f,g,w),!0;case"mouseover":return Gr=cl(Gr,i,o,f,g,w),!0;case"pointerover":var C=w.pointerId;return dt.set(C,cl(dt.get(C)||null,i,o,f,g,w)),!0;case"gotpointercapture":return C=w.pointerId,oo.set(C,cl(oo.get(C)||null,i,o,f,g,w)),!0}return!1}function ua(i){var o=Hi(i.target);if(o!==null){var f=hs(o);if(f!==null){if(o=f.tag,o===13){if(o=Kc(f),o!==null){i.blockedOn=o,la(i.priority,function(){sf(f)});return}}else if(o===3&&f.stateNode.current.memoizedState.isDehydrated){i.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}i.blockedOn=null}function ca(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var f=ha(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(f===null){f=i.nativeEvent;var g=new f.constructor(f.type,f);St=g,f.target.dispatchEvent(g),St=null}else return o=kl(f),o!==null&&io(o),i.blockedOn=f,!1;o.shift()}return!0}function fa(i,o,f){ca(i)&&f.delete(o)}function kh(){aa=!1,Rr!==null&&ca(Rr)&&(Rr=null),ji!==null&&ca(ji)&&(ji=null),Gr!==null&&ca(Gr)&&(Gr=null),dt.forEach(fa),oo.forEach(fa)}function Li(i,o){i.blockedOn===o&&(i.blockedOn=null,aa||(aa=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,kh)))}function rr(i){function o(w){return Li(w,i)}if(0<so.length){Li(so[0],i);for(var f=1;f<so.length;f++){var g=so[f];g.blockedOn===i&&(g.blockedOn=null)}}for(Rr!==null&&Li(Rr,i),ji!==null&&Li(ji,i),Gr!==null&&Li(Gr,i),dt.forEach(o),oo.forEach(o),f=0;f<Zr.length;f++)g=Zr[f],g.blockedOn===i&&(g.blockedOn=null);for(;0<Zr.length&&(f=Zr[0],f.blockedOn===null);)ua(f),f.blockedOn===null&&Zr.shift()}var lo=$.ReactCurrentBatchConfig,da=!0;function Dr(i,o,f,g){var w=yt,C=lo.transition;lo.transition=null;try{yt=1,ao(i,o,f,g)}finally{yt=w,lo.transition=C}}function gi(i,o,f,g){var w=yt,C=lo.transition;lo.transition=null;try{yt=4,ao(i,o,f,g)}finally{yt=w,lo.transition=C}}function ao(i,o,f,g){if(da){var w=ha(i,o,f,g);if(w===null)_a(i,o,g,uo,f),af(i,g);else if(mn(w,i,o,f,g))g.stopPropagation();else if(af(i,g),o&4&&-1<lf.indexOf(i)){for(;w!==null;){var C=kl(w);if(C!==null&&ro(C),C=ha(i,o,f,g),C===null&&_a(i,o,g,uo,f),C===w)break;w=C}w!==null&&g.stopPropagation()}else _a(i,o,g,null,f)}}var uo=null;function ha(i,o,f,g){if(uo=null,i=bt(g),i=Hi(i),i!==null)if(o=hs(i),o===null)i=null;else if(f=o.tag,f===13){if(i=Kc(o),i!==null)return i;i=null}else if(f===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return uo=i,null}function uf(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(vu()){case ps:return 1;case sa:return 4;case to:case Ph:return 16;case oa:return 536870912;default:return 16}default:return 16}}var Cn=null,Ni=null,mi=null;function fl(){if(mi)return mi;var i,o=Ni,f=o.length,g,w="value"in Cn?Cn.value:Cn.textContent,C=w.length;for(i=0;i<f&&o[i]===w[i];i++);var A=f-i;for(g=1;g<=A&&o[f-g]===w[C-g];g++);return mi=w.slice(i,1<g?1-g:void 0)}function ms(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function qn(){return!0}function hr(){return!1}function on(i){function o(f,g,w,C,A){this._reactName=f,this._targetInst=w,this.type=g,this.nativeEvent=C,this.target=A,this.currentTarget=null;for(var z in i)i.hasOwnProperty(z)&&(f=i[z],this[z]=f?f(C):C[z]);return this.isDefaultPrevented=(C.defaultPrevented!=null?C.defaultPrevented:C.returnValue===!1)?qn:hr,this.isPropagationStopped=hr,this}return Q(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=qn)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=qn)},persist:function(){},isPersistent:qn}),o}var ir={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Br=on(ir),$r=Q({},ir,{view:0,detail:0}),cf=on($r),dl,hl,Tn,Qn=Q({},$r,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vs,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Tn&&(Tn&&i.type==="mousemove"?(dl=i.screenX-Tn.screenX,hl=i.screenY-Tn.screenY):hl=dl=0,Tn=i),dl)},movementY:function(i){return"movementY"in i?i.movementY:hl}}),Nt=on(Qn),pl=Q({},Qn,{dataTransfer:0}),Ur=on(pl),ff=Q({},$r,{relatedTarget:0}),pa=on(ff),Su=Q({},ir,{animationName:0,elapsedTime:0,pseudoElement:0}),Pu=on(Su),df=Q({},ir,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),ga=on(df),hf=Q({},ir,{data:0}),ys=on(hf),Eu={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ch={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ma={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Th(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=ma[i])?!!o[i]:!1}function vs(){return Th}var ya=Q({},$r,{key:function(i){if(i.key){var o=Eu[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=ms(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Ch[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vs,charCode:function(i){return i.type==="keypress"?ms(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?ms(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),pf=on(ya),gf=Q({},Qn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xs=on(gf),mf=Q({},$r,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vs}),va=on(mf),xa=Q({},ir,{propertyName:0,elapsedTime:0,pseudoElement:0}),co=on(xa),ku=Q({},Qn,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Cu=on(ku),yf=[9,13,27,32],gl=d&&"CompositionEvent"in window,ws=null;d&&"documentMode"in document&&(ws=document.documentMode);var fo=d&&"TextEvent"in window&&!ws,pr=d&&(!gl||ws&&8<ws&&11>=ws),zi=" ",wa=!1;function Tu(i,o){switch(i){case"keyup":return yf.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wr(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var gr=!1;function bu(i,o){switch(i){case"compositionend":return Wr(o);case"keypress":return o.which!==32?null:(wa=!0,zi);case"textInput":return i=o.data,i===zi&&wa?null:i;default:return null}}function vf(i,o){if(gr)return i==="compositionend"||!gl&&Tu(i,o)?(i=fl(),mi=Ni=Cn=null,gr=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return pr&&o.locale!=="ko"?null:o.data;default:return null}}var yi={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function vi(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!yi[i.type]:o==="textarea"}function ml(i,o,f,g){Yr(g),o=Ia(o,"onChange"),0<o.length&&(f=new Br("onChange","change",null,f,g),i.push({event:f,listeners:o}))}var ho=null,Fi=null;function xf(i){Fu(i,0)}function Di(i){var o=an(i);if(ze(o))return i}function _r(i,o){if(i==="change")return o}var po=!1;if(d){var Bi;if(d){var Ir="oninput"in document;if(!Ir){var Sa=document.createElement("div");Sa.setAttribute("oninput","return;"),Ir=typeof Sa.oninput=="function"}Bi=Ir}else Bi=!1;po=Bi&&(!document.documentMode||9<document.documentMode)}function Ss(){ho&&(ho.detachEvent("onpropertychange",Ru),Fi=ho=null)}function Ru(i){if(i.propertyName==="value"&&Di(Fi)){var o=[];ml(o,Fi,i,bt(i)),mu(xf,o)}}function _u(i,o,f){i==="focusin"?(Ss(),ho=o,Fi=f,ho.attachEvent("onpropertychange",Ru)):i==="focusout"&&Ss()}function Ht(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Di(Fi)}function Pa(i,o){if(i==="click")return Di(o)}function Iu(i,o){if(i==="input"||i==="change")return Di(o)}function Ou(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var sr=typeof Object.is=="function"?Object.is:Ou;function Ps(i,o){if(sr(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var f=Object.keys(i),g=Object.keys(o);if(f.length!==g.length)return!1;for(g=0;g<f.length;g++){var w=f[g];if(!m.call(o,w)||!sr(i[w],o[w]))return!1}return!0}function $i(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Bt(i,o){var f=$i(i);i=0;for(var g;f;){if(f.nodeType===3){if(g=i+f.textContent.length,i<=o&&g>=o)return{node:f,offset:o-i};i=g}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=$i(f)}}function Jt(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Jt(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function ln(){for(var i=window,o=be();o instanceof i.HTMLIFrameElement;){try{var f=typeof o.contentWindow.location.href=="string"}catch{f=!1}if(f)i=o.contentWindow;else break;o=be(i.document)}return o}function go(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function yl(i){var o=ln(),f=i.focusedElem,g=i.selectionRange;if(o!==f&&f&&f.ownerDocument&&Jt(f.ownerDocument.documentElement,f)){if(g!==null&&go(f)){if(o=g.start,i=g.end,i===void 0&&(i=o),"selectionStart"in f)f.selectionStart=o,f.selectionEnd=Math.min(i,f.value.length);else if(i=(o=f.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var w=f.textContent.length,C=Math.min(g.start,w);g=g.end===void 0?C:Math.min(g.end,w),!i.extend&&C>g&&(w=g,g=C,C=w),w=Bt(f,C);var A=Bt(f,g);w&&A&&(i.rangeCount!==1||i.anchorNode!==w.node||i.anchorOffset!==w.offset||i.focusNode!==A.node||i.focusOffset!==A.offset)&&(o=o.createRange(),o.setStart(w.node,w.offset),i.removeAllRanges(),C>g?(i.addRange(o),i.extend(A.node,A.offset)):(o.setEnd(A.node,A.offset),i.addRange(o)))}}for(o=[],i=f;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof f.focus=="function"&&f.focus(),f=0;f<o.length;f++)i=o[f],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var vl=d&&"documentMode"in document&&11>=document.documentMode,mo=null,yn=null,Es=null,xl=!1;function Ea(i,o,f){var g=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;xl||mo==null||mo!==be(g)||(g=mo,"selectionStart"in g&&go(g)?g={start:g.selectionStart,end:g.selectionEnd}:(g=(g.ownerDocument&&g.ownerDocument.defaultView||window).getSelection(),g={anchorNode:g.anchorNode,anchorOffset:g.anchorOffset,focusNode:g.focusNode,focusOffset:g.focusOffset}),Es&&Ps(Es,g)||(Es=g,g=Ia(yn,"onSelect"),0<g.length&&(o=new Br("onSelect","select",null,o,f),i.push({event:o,listeners:g}),o.target=mo)))}function mr(i,o){var f={};return f[i.toLowerCase()]=o.toLowerCase(),f["Webkit"+i]="webkit"+o,f["Moz"+i]="moz"+o,f}var bn={animationend:mr("Animation","AnimationEnd"),animationiteration:mr("Animation","AnimationIteration"),animationstart:mr("Animation","AnimationStart"),transitionend:mr("Transition","TransitionEnd")},ks={},ka={};d&&(ka=document.createElement("div").style,"AnimationEvent"in window||(delete bn.animationend.animation,delete bn.animationiteration.animation,delete bn.animationstart.animation),"TransitionEvent"in window||delete bn.transitionend.transition);function yo(i){if(ks[i])return ks[i];if(!bn[i])return i;var o=bn[i],f;for(f in o)if(o.hasOwnProperty(f)&&f in ka)return ks[i]=o[f];return i}var Au=yo("animationend"),Mu=yo("animationiteration"),ju=yo("animationstart"),Lu=yo("transitionend"),Nu=new Map,zu="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function xi(i,o){Nu.set(i,o),a(o,[i])}for(var Ca=0;Ca<zu.length;Ca++){var Cs=zu[Ca],wf=Cs.toLowerCase(),Ta=Cs[0].toUpperCase()+Cs.slice(1);xi(wf,"on"+Ta)}xi(Au,"onAnimationEnd"),xi(Mu,"onAnimationIteration"),xi(ju,"onAnimationStart"),xi("dblclick","onDoubleClick"),xi("focusin","onFocus"),xi("focusout","onBlur"),xi(Lu,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ui="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sf=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ui));function ba(i,o,f){var g=i.type||"unknown-event";i.currentTarget=f,vh(g,o,void 0,i),i.currentTarget=null}function Fu(i,o){o=(o&4)!==0;for(var f=0;f<i.length;f++){var g=i[f],w=g.event;g=g.listeners;e:{var C=void 0;if(o)for(var A=g.length-1;0<=A;A--){var z=g[A],V=z.instance,ne=z.currentTarget;if(z=z.listener,V!==C&&w.isPropagationStopped())break e;ba(w,z,ne),C=V}else for(A=0;A<g.length;A++){if(z=g[A],V=z.instance,ne=z.currentTarget,z=z.listener,V!==C&&w.isPropagationStopped())break e;ba(w,z,ne),C=V}}}if(ia)throw i=eo,ia=!1,eo=null,i}function Ot(i,o){var f=o[Aa];f===void 0&&(f=o[Aa]=new Set);var g=i+"__bubble";f.has(g)||(Du(o,i,2,!1),f.add(g))}function Ra(i,o,f){var g=0;o&&(g|=4),Du(f,i,g,o)}var wl="_reactListening"+Math.random().toString(36).slice(2);function Ts(i){if(!i[wl]){i[wl]=!0,r.forEach(function(f){f!=="selectionchange"&&(Sf.has(f)||Ra(f,!1,i),Ra(f,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[wl]||(o[wl]=!0,Ra("selectionchange",!1,o))}}function Du(i,o,f,g){switch(uf(o)){case 1:var w=Dr;break;case 4:w=gi;break;default:w=ao}f=w.bind(null,o,f,i),w=void 0,!yu||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(w=!0),g?w!==void 0?i.addEventListener(o,f,{capture:!0,passive:w}):i.addEventListener(o,f,!0):w!==void 0?i.addEventListener(o,f,{passive:w}):i.addEventListener(o,f,!1)}function _a(i,o,f,g,w){var C=g;if((o&1)===0&&(o&2)===0&&g!==null)e:for(;;){if(g===null)return;var A=g.tag;if(A===3||A===4){var z=g.stateNode.containerInfo;if(z===w||z.nodeType===8&&z.parentNode===w)break;if(A===4)for(A=g.return;A!==null;){var V=A.tag;if((V===3||V===4)&&(V=A.stateNode.containerInfo,V===w||V.nodeType===8&&V.parentNode===w))return;A=A.return}for(;z!==null;){if(A=Hi(z),A===null)return;if(V=A.tag,V===5||V===6){g=C=A;continue e}z=z.parentNode}}g=g.return}mu(function(){var ne=C,ve=bt(f),xe=[];e:{var ye=Nu.get(i);if(ye!==void 0){var Fe=Br,Ue=i;switch(i){case"keypress":if(ms(f)===0)break e;case"keydown":case"keyup":Fe=pf;break;case"focusin":Ue="focus",Fe=pa;break;case"focusout":Ue="blur",Fe=pa;break;case"beforeblur":case"afterblur":Fe=pa;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Fe=Nt;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Fe=Ur;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Fe=va;break;case Au:case Mu:case ju:Fe=Pu;break;case Lu:Fe=co;break;case"scroll":Fe=cf;break;case"wheel":Fe=Cu;break;case"copy":case"cut":case"paste":Fe=ga;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Fe=xs}var We=(o&4)!==0,dn=!We&&i==="scroll",J=We?ye!==null?ye+"Capture":null:ye;We=[];for(var q=ne,ee;q!==null;){ee=q;var Ee=ee.stateNode;if(ee.tag===5&&Ee!==null&&(ee=Ee,J!==null&&(Ee=ol(q,J),Ee!=null&&We.push(vo(q,Ee,ee)))),dn)break;q=q.return}0<We.length&&(ye=new Fe(ye,Ue,null,f,ve),xe.push({event:ye,listeners:We}))}}if((o&7)===0){e:{if(ye=i==="mouseover"||i==="pointerover",Fe=i==="mouseout"||i==="pointerout",ye&&f!==St&&(Ue=f.relatedTarget||f.fromElement)&&(Hi(Ue)||Ue[ei]))break e;if((Fe||ye)&&(ye=ve.window===ve?ve:(ye=ve.ownerDocument)?ye.defaultView||ye.parentWindow:window,Fe?(Ue=f.relatedTarget||f.toElement,Fe=ne,Ue=Ue?Hi(Ue):null,Ue!==null&&(dn=hs(Ue),Ue!==dn||Ue.tag!==5&&Ue.tag!==6)&&(Ue=null)):(Fe=null,Ue=ne),Fe!==Ue)){if(We=Nt,Ee="onMouseLeave",J="onMouseEnter",q="mouse",(i==="pointerout"||i==="pointerover")&&(We=xs,Ee="onPointerLeave",J="onPointerEnter",q="pointer"),dn=Fe==null?ye:an(Fe),ee=Ue==null?ye:an(Ue),ye=new We(Ee,q+"leave",Fe,f,ve),ye.target=dn,ye.relatedTarget=ee,Ee=null,Hi(ve)===ne&&(We=new We(J,q+"enter",Ue,f,ve),We.target=ee,We.relatedTarget=dn,Ee=We),dn=Ee,Fe&&Ue)t:{for(We=Fe,J=Ue,q=0,ee=We;ee;ee=bs(ee))q++;for(ee=0,Ee=J;Ee;Ee=bs(Ee))ee++;for(;0<q-ee;)We=bs(We),q--;for(;0<ee-q;)J=bs(J),ee--;for(;q--;){if(We===J||J!==null&&We===J.alternate)break t;We=bs(We),J=bs(J)}We=null}else We=null;Fe!==null&&Pf(xe,ye,Fe,We,!1),Ue!==null&&dn!==null&&Pf(xe,dn,Ue,We,!0)}}e:{if(ye=ne?an(ne):window,Fe=ye.nodeName&&ye.nodeName.toLowerCase(),Fe==="select"||Fe==="input"&&ye.type==="file")var Ve=_r;else if(vi(ye))if(po)Ve=Iu;else{Ve=Ht;var Ke=_u}else(Fe=ye.nodeName)&&Fe.toLowerCase()==="input"&&(ye.type==="checkbox"||ye.type==="radio")&&(Ve=Pa);if(Ve&&(Ve=Ve(i,ne))){ml(xe,Ve,f,ve);break e}Ke&&Ke(i,ye,ne),i==="focusout"&&(Ke=ye._wrapperState)&&Ke.controlled&&ye.type==="number"&&as(ye,"number",ye.value)}switch(Ke=ne?an(ne):window,i){case"focusin":(vi(Ke)||Ke.contentEditable==="true")&&(mo=Ke,yn=ne,Es=null);break;case"focusout":Es=yn=mo=null;break;case"mousedown":xl=!0;break;case"contextmenu":case"mouseup":case"dragend":xl=!1,Ea(xe,f,ve);break;case"selectionchange":if(vl)break;case"keydown":case"keyup":Ea(xe,f,ve)}var Ge;if(gl)e:{switch(i){case"compositionstart":var et="onCompositionStart";break e;case"compositionend":et="onCompositionEnd";break e;case"compositionupdate":et="onCompositionUpdate";break e}et=void 0}else gr?Tu(i,f)&&(et="onCompositionEnd"):i==="keydown"&&f.keyCode===229&&(et="onCompositionStart");et&&(pr&&f.locale!=="ko"&&(gr||et!=="onCompositionStart"?et==="onCompositionEnd"&&gr&&(Ge=fl()):(Cn=ve,Ni="value"in Cn?Cn.value:Cn.textContent,gr=!0)),Ke=Ia(ne,et),0<Ke.length&&(et=new ys(et,i,null,f,ve),xe.push({event:et,listeners:Ke}),Ge?et.data=Ge:(Ge=Wr(f),Ge!==null&&(et.data=Ge)))),(Ge=fo?bu(i,f):vf(i,f))&&(ne=Ia(ne,"onBeforeInput"),0<ne.length&&(ve=new ys("onBeforeInput","beforeinput",null,f,ve),xe.push({event:ve,listeners:ne}),ve.data=Ge))}Fu(xe,o)})}function vo(i,o,f){return{instance:i,listener:o,currentTarget:f}}function Ia(i,o){for(var f=o+"Capture",g=[];i!==null;){var w=i,C=w.stateNode;w.tag===5&&C!==null&&(w=C,C=ol(i,f),C!=null&&g.unshift(vo(i,C,w)),C=ol(i,o),C!=null&&g.push(vo(i,C,w))),i=i.return}return g}function bs(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Pf(i,o,f,g,w){for(var C=o._reactName,A=[];f!==null&&f!==g;){var z=f,V=z.alternate,ne=z.stateNode;if(V!==null&&V===g)break;z.tag===5&&ne!==null&&(z=ne,w?(V=ol(f,C),V!=null&&A.unshift(vo(f,V,z))):w||(V=ol(f,C),V!=null&&A.push(vo(f,V,z)))),f=f.return}A.length!==0&&i.push({event:o,listeners:A})}var bh=/\r\n?/g,Ef=/\u0000|\uFFFD/g;function Bu(i){return(typeof i=="string"?i:""+i).replace(bh,`
`).replace(Ef,"")}function Sl(i,o,f){if(o=Bu(o),Bu(i)!==o&&f)throw Error(n(425))}function Rs(){}var $u=null,Uu=null;function Wu(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var yr=typeof setTimeout=="function"?setTimeout:void 0,Hu=typeof clearTimeout=="function"?clearTimeout:void 0,Pl=typeof Promise=="function"?Promise:void 0,kf=typeof queueMicrotask=="function"?queueMicrotask:typeof Pl<"u"?function(i){return Pl.resolve(null).then(i).catch(Cf)}:yr;function Cf(i){setTimeout(function(){throw i})}function Oa(i,o){var f=o,g=0;do{var w=f.nextSibling;if(i.removeChild(f),w&&w.nodeType===8)if(f=w.data,f==="/$"){if(g===0){i.removeChild(w),rr(o);return}g--}else f!=="$"&&f!=="$?"&&f!=="$!"||g++;f=w}while(f);rr(o)}function Jr(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function _s(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var f=i.data;if(f==="$"||f==="$!"||f==="$?"){if(o===0)return i;o--}else f==="/$"&&o++}i=i.previousSibling}return null}var Wi=Math.random().toString(36).slice(2),Or="__reactFiber$"+Wi,El="__reactProps$"+Wi,ei="__reactContainer$"+Wi,Aa="__reactEvents$"+Wi,Tf="__reactListeners$"+Wi,bf="__reactHandles$"+Wi;function Hi(i){var o=i[Or];if(o)return o;for(var f=i.parentNode;f;){if(o=f[ei]||f[Or]){if(f=o.alternate,o.child!==null||f!==null&&f.child!==null)for(i=_s(i);i!==null;){if(f=i[Or])return f;i=_s(i)}return o}i=f,f=i.parentNode}return null}function kl(i){return i=i[Or]||i[ei],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function an(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(n(33))}function vn(i){return i[El]||null}var Ma=[],Is=-1;function wi(i){return{current:i}}function At(i){0>Is||(i.current=Ma[Is],Ma[Is]=null,Is--)}function _t(i,o){Is++,Ma[Is]=i.current,i.current=o}var ti={},Rn=wi(ti),Ln=wi(!1),Vi=ti;function Os(i,o){var f=i.type.contextTypes;if(!f)return ti;var g=i.stateNode;if(g&&g.__reactInternalMemoizedUnmaskedChildContext===o)return g.__reactInternalMemoizedMaskedChildContext;var w={},C;for(C in f)w[C]=o[C];return g&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=w),w}function Nn(i){return i=i.childContextTypes,i!=null}function xo(){At(Ln),At(Rn)}function Vu(i,o,f){if(Rn.current!==ti)throw Error(n(168));_t(Rn,o),_t(Ln,f)}function ja(i,o,f){var g=i.stateNode;if(o=o.childContextTypes,typeof g.getChildContext!="function")return f;g=g.getChildContext();for(var w in g)if(!(w in o))throw Error(n(108,Je(i)||"Unknown",w));return Q({},f,g)}function As(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||ti,Vi=Rn.current,_t(Rn,i),_t(Ln,Ln.current),!0}function Rf(i,o,f){var g=i.stateNode;if(!g)throw Error(n(169));f?(i=ja(i,o,Vi),g.__reactInternalMemoizedMergedChildContext=i,At(Ln),At(Rn),_t(Rn,i)):At(Ln),_t(Ln,f)}var ni=null,wo=!1,La=!1;function Cl(i){ni===null?ni=[i]:ni.push(i)}function Si(i){wo=!0,Cl(i)}function qi(){if(!La&&ni!==null){La=!0;var i=0,o=yt;try{var f=ni;for(yt=1;i<f.length;i++){var g=f[i];do g=g(!0);while(g!==null)}ni=null,wo=!1}catch(w){throw ni!==null&&(ni=ni.slice(i+1)),ef(ps,qi),w}finally{yt=o,La=!1}}return null}var Xn=[],Ms=0,Qi=null,Xi=0,Yn=[],Kn=0,Yi=null,vr=1,$t="";function js(i,o){Xn[Ms++]=Xi,Xn[Ms++]=Qi,Qi=i,Xi=o}function _f(i,o,f){Yn[Kn++]=vr,Yn[Kn++]=$t,Yn[Kn++]=Yi,Yi=i;var g=vr;i=$t;var w=32-ft(g)-1;g&=~(1<<w),f+=1;var C=32-ft(o)+w;if(30<C){var A=w-w%5;C=(g&(1<<A)-1).toString(32),g>>=A,w-=A,vr=1<<32-ft(o)+w|f<<w|g,$t=C+i}else vr=1<<C|f<<w|g,$t=i}function So(i){i.return!==null&&(js(i,1),_f(i,1,0))}function xn(i){for(;i===Qi;)Qi=Xn[--Ms],Xn[Ms]=null,Xi=Xn[--Ms],Xn[Ms]=null;for(;i===Yi;)Yi=Yn[--Kn],Yn[Kn]=null,$t=Yn[--Kn],Yn[Kn]=null,vr=Yn[--Kn],Yn[Kn]=null}var xr=null,Ce=null,Et=!1,wr=null;function qu(i,o){var f=ui(5,null,null,0);f.elementType="DELETED",f.stateNode=o,f.return=i,o=i.deletions,o===null?(i.deletions=[f],i.flags|=16):o.push(f)}function If(i,o){switch(i.tag){case 5:var f=i.type;return o=o.nodeType!==1||f.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,xr=i,Ce=Jr(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,xr=i,Ce=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(f=Yi!==null?{id:vr,overflow:$t}:null,i.memoizedState={dehydrated:o,treeContext:f,retryLane:1073741824},f=ui(18,null,null,0),f.stateNode=o,f.return=i,i.child=f,xr=i,Ce=null,!0):!1;default:return!1}}function Ls(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Po(i){if(Et){var o=Ce;if(o){var f=o;if(!If(i,o)){if(Ls(i))throw Error(n(418));o=Jr(f.nextSibling);var g=xr;o&&If(i,o)?qu(g,f):(i.flags=i.flags&-4097|2,Et=!1,xr=i)}}else{if(Ls(i))throw Error(n(418));i.flags=i.flags&-4097|2,Et=!1,xr=i}}}function Na(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;xr=i}function Tl(i){if(i!==xr)return!1;if(!Et)return Na(i),Et=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!Wu(i.type,i.memoizedProps)),o&&(o=Ce)){if(Ls(i))throw Qu(),Error(n(418));for(;o;)qu(i,o),o=Jr(o.nextSibling)}if(Na(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(n(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var f=i.data;if(f==="/$"){if(o===0){Ce=Jr(i.nextSibling);break e}o--}else f!=="$"&&f!=="$!"&&f!=="$?"||o++}i=i.nextSibling}Ce=null}}else Ce=xr?Jr(i.stateNode.nextSibling):null;return!0}function Qu(){for(var i=Ce;i;)i=Jr(i.nextSibling)}function Ns(){Ce=xr=null,Et=!1}function bl(i){wr===null?wr=[i]:wr.push(i)}var Xu=$.ReactCurrentBatchConfig;function Kt(i,o,f){if(i=f.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(f._owner){if(f=f._owner,f){if(f.tag!==1)throw Error(n(309));var g=f.stateNode}if(!g)throw Error(n(147,i));var w=g,C=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===C?o.ref:(o=function(A){var z=w.refs;A===null?delete z[C]:z[C]=A},o._stringRef=C,o)}if(typeof i!="string")throw Error(n(284));if(!f._owner)throw Error(n(290,i))}return i}function or(i,o){throw i=Object.prototype.toString.call(o),Error(n(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function Hr(i){var o=i._init;return o(i._payload)}function za(i){function o(J,q){if(i){var ee=J.deletions;ee===null?(J.deletions=[q],J.flags|=16):ee.push(q)}}function f(J,q){if(!i)return null;for(;q!==null;)o(J,q),q=q.sibling;return null}function g(J,q){for(J=new Map;q!==null;)q.key!==null?J.set(q.key,q):J.set(q.index,q),q=q.sibling;return J}function w(J,q){return J=Uo(J,q),J.index=0,J.sibling=null,J}function C(J,q,ee){return J.index=ee,i?(ee=J.alternate,ee!==null?(ee=ee.index,ee<q?(J.flags|=2,q):ee):(J.flags|=2,q)):(J.flags|=1048576,q)}function A(J){return i&&J.alternate===null&&(J.flags|=2),J}function z(J,q,ee,Ee){return q===null||q.tag!==6?(q=Xh(ee,J.mode,Ee),q.return=J,q):(q=w(q,ee),q.return=J,q)}function V(J,q,ee,Ee){var Ve=ee.type;return Ve===se?ve(J,q,ee.props.children,Ee,ee.key):q!==null&&(q.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===Se&&Hr(Ve)===q.type)?(Ee=w(q,ee.props),Ee.ref=Kt(J,q,ee),Ee.return=J,Ee):(Ee=Gf(ee.type,ee.key,ee.props,null,J.mode,Ee),Ee.ref=Kt(J,q,ee),Ee.return=J,Ee)}function ne(J,q,ee,Ee){return q===null||q.tag!==4||q.stateNode.containerInfo!==ee.containerInfo||q.stateNode.implementation!==ee.implementation?(q=Yh(ee,J.mode,Ee),q.return=J,q):(q=w(q,ee.children||[]),q.return=J,q)}function ve(J,q,ee,Ee,Ve){return q===null||q.tag!==7?(q=Fl(ee,J.mode,Ee,Ve),q.return=J,q):(q=w(q,ee),q.return=J,q)}function xe(J,q,ee){if(typeof q=="string"&&q!==""||typeof q=="number")return q=Xh(""+q,J.mode,ee),q.return=J,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case F:return ee=Gf(q.type,q.key,q.props,null,J.mode,ee),ee.ref=Kt(J,null,q),ee.return=J,ee;case H:return q=Yh(q,J.mode,ee),q.return=J,q;case Se:var Ee=q._init;return xe(J,Ee(q._payload),ee)}if(Vn(q)||U(q))return q=Fl(q,J.mode,ee,null),q.return=J,q;or(J,q)}return null}function ye(J,q,ee,Ee){var Ve=q!==null?q.key:null;if(typeof ee=="string"&&ee!==""||typeof ee=="number")return Ve!==null?null:z(J,q,""+ee,Ee);if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case F:return ee.key===Ve?V(J,q,ee,Ee):null;case H:return ee.key===Ve?ne(J,q,ee,Ee):null;case Se:return Ve=ee._init,ye(J,q,Ve(ee._payload),Ee)}if(Vn(ee)||U(ee))return Ve!==null?null:ve(J,q,ee,Ee,null);or(J,ee)}return null}function Fe(J,q,ee,Ee,Ve){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number")return J=J.get(ee)||null,z(q,J,""+Ee,Ve);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case F:return J=J.get(Ee.key===null?ee:Ee.key)||null,V(q,J,Ee,Ve);case H:return J=J.get(Ee.key===null?ee:Ee.key)||null,ne(q,J,Ee,Ve);case Se:var Ke=Ee._init;return Fe(J,q,ee,Ke(Ee._payload),Ve)}if(Vn(Ee)||U(Ee))return J=J.get(ee)||null,ve(q,J,Ee,Ve,null);or(q,Ee)}return null}function Ue(J,q,ee,Ee){for(var Ve=null,Ke=null,Ge=q,et=q=0,Un=null;Ge!==null&&et<ee.length;et++){Ge.index>et?(Un=Ge,Ge=null):Un=Ge.sibling;var wt=ye(J,Ge,ee[et],Ee);if(wt===null){Ge===null&&(Ge=Un);break}i&&Ge&&wt.alternate===null&&o(J,Ge),q=C(wt,q,et),Ke===null?Ve=wt:Ke.sibling=wt,Ke=wt,Ge=Un}if(et===ee.length)return f(J,Ge),Et&&js(J,et),Ve;if(Ge===null){for(;et<ee.length;et++)Ge=xe(J,ee[et],Ee),Ge!==null&&(q=C(Ge,q,et),Ke===null?Ve=Ge:Ke.sibling=Ge,Ke=Ge);return Et&&js(J,et),Ve}for(Ge=g(J,Ge);et<ee.length;et++)Un=Fe(Ge,J,et,ee[et],Ee),Un!==null&&(i&&Un.alternate!==null&&Ge.delete(Un.key===null?et:Un.key),q=C(Un,q,et),Ke===null?Ve=Un:Ke.sibling=Un,Ke=Un);return i&&Ge.forEach(function(Wo){return o(J,Wo)}),Et&&js(J,et),Ve}function We(J,q,ee,Ee){var Ve=U(ee);if(typeof Ve!="function")throw Error(n(150));if(ee=Ve.call(ee),ee==null)throw Error(n(151));for(var Ke=Ve=null,Ge=q,et=q=0,Un=null,wt=ee.next();Ge!==null&&!wt.done;et++,wt=ee.next()){Ge.index>et?(Un=Ge,Ge=null):Un=Ge.sibling;var Wo=ye(J,Ge,wt.value,Ee);if(Wo===null){Ge===null&&(Ge=Un);break}i&&Ge&&Wo.alternate===null&&o(J,Ge),q=C(Wo,q,et),Ke===null?Ve=Wo:Ke.sibling=Wo,Ke=Wo,Ge=Un}if(wt.done)return f(J,Ge),Et&&js(J,et),Ve;if(Ge===null){for(;!wt.done;et++,wt=ee.next())wt=xe(J,wt.value,Ee),wt!==null&&(q=C(wt,q,et),Ke===null?Ve=wt:Ke.sibling=wt,Ke=wt);return Et&&js(J,et),Ve}for(Ge=g(J,Ge);!wt.done;et++,wt=ee.next())wt=Fe(Ge,J,et,wt.value,Ee),wt!==null&&(i&&wt.alternate!==null&&Ge.delete(wt.key===null?et:wt.key),q=C(wt,q,et),Ke===null?Ve=wt:Ke.sibling=wt,Ke=wt);return i&&Ge.forEach(function(S1){return o(J,S1)}),Et&&js(J,et),Ve}function dn(J,q,ee,Ee){if(typeof ee=="object"&&ee!==null&&ee.type===se&&ee.key===null&&(ee=ee.props.children),typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case F:e:{for(var Ve=ee.key,Ke=q;Ke!==null;){if(Ke.key===Ve){if(Ve=ee.type,Ve===se){if(Ke.tag===7){f(J,Ke.sibling),q=w(Ke,ee.props.children),q.return=J,J=q;break e}}else if(Ke.elementType===Ve||typeof Ve=="object"&&Ve!==null&&Ve.$$typeof===Se&&Hr(Ve)===Ke.type){f(J,Ke.sibling),q=w(Ke,ee.props),q.ref=Kt(J,Ke,ee),q.return=J,J=q;break e}f(J,Ke);break}else o(J,Ke);Ke=Ke.sibling}ee.type===se?(q=Fl(ee.props.children,J.mode,Ee,ee.key),q.return=J,J=q):(Ee=Gf(ee.type,ee.key,ee.props,null,J.mode,Ee),Ee.ref=Kt(J,q,ee),Ee.return=J,J=Ee)}return A(J);case H:e:{for(Ke=ee.key;q!==null;){if(q.key===Ke)if(q.tag===4&&q.stateNode.containerInfo===ee.containerInfo&&q.stateNode.implementation===ee.implementation){f(J,q.sibling),q=w(q,ee.children||[]),q.return=J,J=q;break e}else{f(J,q);break}else o(J,q);q=q.sibling}q=Yh(ee,J.mode,Ee),q.return=J,J=q}return A(J);case Se:return Ke=ee._init,dn(J,q,Ke(ee._payload),Ee)}if(Vn(ee))return Ue(J,q,ee,Ee);if(U(ee))return We(J,q,ee,Ee);or(J,ee)}return typeof ee=="string"&&ee!==""||typeof ee=="number"?(ee=""+ee,q!==null&&q.tag===6?(f(J,q.sibling),q=w(q,ee),q.return=J,J=q):(f(J,q),q=Xh(ee,J.mode,Ee),q.return=J,J=q),A(J)):f(J,q)}return dn}var zs=za(!0),Ar=za(!1),Rl=wi(null),Sr=null,Eo=null,Fa=null;function Da(){Fa=Eo=Sr=null}function Ba(i){var o=Rl.current;At(Rl),i._currentValue=o}function $a(i,o,f){for(;i!==null;){var g=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,g!==null&&(g.childLanes|=o)):g!==null&&(g.childLanes&o)!==o&&(g.childLanes|=o),i===f)break;i=i.return}}function Pi(i,o){Sr=i,Fa=Eo=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(b=!0),i.firstContext=null)}function Gn(i){var o=i._currentValue;if(Fa!==i)if(i={context:i,memoizedValue:o,next:null},Eo===null){if(Sr===null)throw Error(n(308));Eo=i,Sr.dependencies={lanes:0,firstContext:i}}else Eo=Eo.next=i;return o}var ri=null;function ko(i){ri===null?ri=[i]:ri.push(i)}function _l(i,o,f,g){var w=o.interleaved;return w===null?(f.next=f,ko(o)):(f.next=w.next,w.next=f),o.interleaved=f,Pr(i,g)}function Pr(i,o){i.lanes|=o;var f=i.alternate;for(f!==null&&(f.lanes|=o),f=i,i=i.return;i!==null;)i.childLanes|=o,f=i.alternate,f!==null&&(f.childLanes|=o),f=i,i=i.return;return f.tag===3?f.stateNode:null}var ii=!1;function Il(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ua(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function si(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function oi(i,o,f){var g=i.updateQueue;if(g===null)return null;if(g=g.shared,(xt&2)!==0){var w=g.pending;return w===null?o.next=o:(o.next=w.next,w.next=o),g.pending=o,Pr(i,f)}return w=g.interleaved,w===null?(o.next=o,ko(g)):(o.next=w.next,w.next=o),g.interleaved=o,Pr(i,f)}function Wa(i,o,f){if(o=o.updateQueue,o!==null&&(o=o.shared,(f&4194240)!==0)){var g=o.lanes;g&=i.pendingLanes,f|=g,o.lanes=f,wu(i,f)}}function Ol(i,o){var f=i.updateQueue,g=i.alternate;if(g!==null&&(g=g.updateQueue,f===g)){var w=null,C=null;if(f=f.firstBaseUpdate,f!==null){do{var A={eventTime:f.eventTime,lane:f.lane,tag:f.tag,payload:f.payload,callback:f.callback,next:null};C===null?w=C=A:C=C.next=A,f=f.next}while(f!==null);C===null?w=C=o:C=C.next=o}else w=C=o;f={baseState:g.baseState,firstBaseUpdate:w,lastBaseUpdate:C,shared:g.shared,effects:g.effects},i.updateQueue=f;return}i=f.lastBaseUpdate,i===null?f.firstBaseUpdate=o:i.next=o,f.lastBaseUpdate=o}function Co(i,o,f,g){var w=i.updateQueue;ii=!1;var C=w.firstBaseUpdate,A=w.lastBaseUpdate,z=w.shared.pending;if(z!==null){w.shared.pending=null;var V=z,ne=V.next;V.next=null,A===null?C=ne:A.next=ne,A=V;var ve=i.alternate;ve!==null&&(ve=ve.updateQueue,z=ve.lastBaseUpdate,z!==A&&(z===null?ve.firstBaseUpdate=ne:z.next=ne,ve.lastBaseUpdate=V))}if(C!==null){var xe=w.baseState;A=0,ve=ne=V=null,z=C;do{var ye=z.lane,Fe=z.eventTime;if((g&ye)===ye){ve!==null&&(ve=ve.next={eventTime:Fe,lane:0,tag:z.tag,payload:z.payload,callback:z.callback,next:null});e:{var Ue=i,We=z;switch(ye=o,Fe=f,We.tag){case 1:if(Ue=We.payload,typeof Ue=="function"){xe=Ue.call(Fe,xe,ye);break e}xe=Ue;break e;case 3:Ue.flags=Ue.flags&-65537|128;case 0:if(Ue=We.payload,ye=typeof Ue=="function"?Ue.call(Fe,xe,ye):Ue,ye==null)break e;xe=Q({},xe,ye);break e;case 2:ii=!0}}z.callback!==null&&z.lane!==0&&(i.flags|=64,ye=w.effects,ye===null?w.effects=[z]:ye.push(z))}else Fe={eventTime:Fe,lane:ye,tag:z.tag,payload:z.payload,callback:z.callback,next:null},ve===null?(ne=ve=Fe,V=xe):ve=ve.next=Fe,A|=ye;if(z=z.next,z===null){if(z=w.shared.pending,z===null)break;ye=z,z=ye.next,ye.next=null,w.lastBaseUpdate=ye,w.shared.pending=null}}while(!0);if(ve===null&&(V=xe),w.baseState=V,w.firstBaseUpdate=ne,w.lastBaseUpdate=ve,o=w.shared.interleaved,o!==null){w=o;do A|=w.lane,w=w.next;while(w!==o)}else C===null&&(w.shared.lanes=0);jl|=A,i.lanes=A,i.memoizedState=xe}}function qt(i,o,f){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var g=i[o],w=g.callback;if(w!==null){if(g.callback=null,g=f,typeof w!="function")throw Error(n(191,w));w.call(g)}}}var st={},It=wi(st),Ut=wi(st),Gt=wi(st);function un(i){if(i===st)throw Error(n(174));return i}function Ki(i,o){switch(_t(Gt,o),_t(Ut,i),_t(It,st),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:ae(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=ae(o,i)}At(It),_t(It,o)}function Wt(){At(It),At(Ut),At(Gt)}function To(i){un(Gt.current);var o=un(It.current),f=ae(o,i.type);o!==f&&(_t(Ut,i),_t(It,f))}function Ei(i){Ut.current===i&&(At(It),At(Ut))}var Mt=wi(0);function bo(i){for(var o=i;o!==null;){if(o.tag===13){var f=o.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||f.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Fs=[];function zn(){for(var i=0;i<Fs.length;i++)Fs[i]._workInProgressVersionPrimary=null;Fs.length=0}var Ro=$.ReactCurrentDispatcher,Al=$.ReactCurrentBatchConfig,Zn=0,Ct=null,Qt=null,en=null,Vr=!1,Gi=!1,Mr=0,Ha=0;function tn(){throw Error(n(321))}function Ml(i,o){if(o===null)return!1;for(var f=0;f<o.length&&f<i.length;f++)if(!sr(i[f],o[f]))return!1;return!0}function _o(i,o,f,g,w,C){if(Zn=C,Ct=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Ro.current=i===null||i.memoizedState===null?_h:es,i=f(g,w),Gi){C=0;do{if(Gi=!1,Mr=0,25<=C)throw Error(n(301));C+=1,en=Qt=null,o.updateQueue=null,Ro.current=Ya,i=f(g,w)}while(Gi)}if(Ro.current=Mo,o=Qt!==null&&Qt.next!==null,Zn=0,en=Qt=Ct=null,Vr=!1,o)throw Error(n(300));return i}function Io(){var i=Mr!==0;return Mr=0,i}function zt(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return en===null?Ct.memoizedState=en=i:en=en.next=i,en}function cn(){if(Qt===null){var i=Ct.alternate;i=i!==null?i.memoizedState:null}else i=Qt.next;var o=en===null?Ct.memoizedState:en.next;if(o!==null)en=o,Qt=i;else{if(i===null)throw Error(n(310));Qt=i,i={memoizedState:Qt.memoizedState,baseState:Qt.baseState,baseQueue:Qt.baseQueue,queue:Qt.queue,next:null},en===null?Ct.memoizedState=en=i:en=en.next=i}return en}function Fn(i,o){return typeof o=="function"?o(i):o}function Dn(i){var o=cn(),f=o.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=i;var g=Qt,w=g.baseQueue,C=f.pending;if(C!==null){if(w!==null){var A=w.next;w.next=C.next,C.next=A}g.baseQueue=w=C,f.pending=null}if(w!==null){C=w.next,g=g.baseState;var z=A=null,V=null,ne=C;do{var ve=ne.lane;if((Zn&ve)===ve)V!==null&&(V=V.next={lane:0,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),g=ne.hasEagerState?ne.eagerState:i(g,ne.action);else{var xe={lane:ve,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null};V===null?(z=V=xe,A=g):V=V.next=xe,Ct.lanes|=ve,jl|=ve}ne=ne.next}while(ne!==null&&ne!==C);V===null?A=g:V.next=z,sr(g,o.memoizedState)||(b=!0),o.memoizedState=g,o.baseState=A,o.baseQueue=V,f.lastRenderedState=g}if(i=f.interleaved,i!==null){w=i;do C=w.lane,Ct.lanes|=C,jl|=C,w=w.next;while(w!==i)}else w===null&&(f.lanes=0);return[o.memoizedState,f.dispatch]}function Va(i){var o=cn(),f=o.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=i;var g=f.dispatch,w=f.pending,C=o.memoizedState;if(w!==null){f.pending=null;var A=w=w.next;do C=i(C,A.action),A=A.next;while(A!==w);sr(C,o.memoizedState)||(b=!0),o.memoizedState=C,o.baseQueue===null&&(o.baseState=C),f.lastRenderedState=C}return[C,g]}function qa(){}function Qa(i,o){var f=Ct,g=cn(),w=o(),C=!sr(g.memoizedState,w);if(C&&(g.memoizedState=w,b=!0),g=g.queue,Zu(Yu.bind(null,f,g,i),[i]),g.getSnapshot!==o||C||en!==null&&en.memoizedState.tag&1){if(f.flags|=2048,Oo(9,ki.bind(null,f,g,w,o),void 0,null),$n===null)throw Error(n(349));(Zn&30)!==0||Of(f,o,w)}return w}function Of(i,o,f){i.flags|=16384,i={getSnapshot:o,value:f},o=Ct.updateQueue,o===null?(o={lastEffect:null,stores:null},Ct.updateQueue=o,o.stores=[i]):(f=o.stores,f===null?o.stores=[i]:f.push(i))}function ki(i,o,f,g){o.value=f,o.getSnapshot=g,Ku(o)&&Xa(i)}function Yu(i,o,f){return f(function(){Ku(o)&&Xa(i)})}function Ku(i){var o=i.getSnapshot;i=i.value;try{var f=o();return!sr(i,f)}catch{return!0}}function Xa(i){var o=Pr(i,1);o!==null&&Ri(o,i,1,-1)}function Zi(i){var o=zt();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fn,lastRenderedState:i},o.queue=i,i=i.dispatch=zf.bind(null,Ct,i),[o.memoizedState,i]}function Oo(i,o,f,g){return i={tag:i,create:o,destroy:f,deps:g,next:null},o=Ct.updateQueue,o===null?(o={lastEffect:null,stores:null},Ct.updateQueue=o,o.lastEffect=i.next=i):(f=o.lastEffect,f===null?o.lastEffect=i.next=i:(g=f.next,f.next=i,i.next=g,o.lastEffect=i)),i}function Gu(){return cn().memoizedState}function Ao(i,o,f,g){var w=zt();Ct.flags|=i,w.memoizedState=Oo(1|o,f,void 0,g===void 0?null:g)}function Ds(i,o,f,g){var w=cn();g=g===void 0?null:g;var C=void 0;if(Qt!==null){var A=Qt.memoizedState;if(C=A.destroy,g!==null&&Ml(g,A.deps)){w.memoizedState=Oo(o,f,C,g);return}}Ct.flags|=i,w.memoizedState=Oo(1|o,f,C,g)}function Af(i,o){return Ao(8390656,8,i,o)}function Zu(i,o){return Ds(2048,8,i,o)}function Ju(i,o){return Ds(4,2,i,o)}function ec(i,o){return Ds(4,4,i,o)}function Ji(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Mf(i,o,f){return f=f!=null?f.concat([i]):null,Ds(4,4,Ji.bind(null,o,i),f)}function Ci(){}function tc(i,o){var f=cn();o=o===void 0?null:o;var g=f.memoizedState;return g!==null&&o!==null&&Ml(o,g[1])?g[0]:(f.memoizedState=[i,o],i)}function Ft(i,o){var f=cn();o=o===void 0?null:o;var g=f.memoizedState;return g!==null&&o!==null&&Ml(o,g[1])?g[0]:(i=i(),f.memoizedState=[i,o],i)}function jf(i,o,f){return(Zn&21)===0?(i.baseState&&(i.baseState=!1,b=!0),i.memoizedState=f):(sr(f,o)||(f=xu(),Ct.lanes|=f,jl|=f,i.baseState=!0),o)}function Lf(i,o){var f=yt;yt=f!==0&&4>f?f:4,i(!0);var g=Al.transition;Al.transition={};try{i(!1),o()}finally{yt=f,Al.transition=g}}function Nf(){return cn().memoizedState}function Rh(i,o,f){var g=Bo(i);if(f={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null},nc(i))Ff(o,f);else if(f=_l(i,o,f,g),f!==null){var w=kr();Ri(f,i,g,w),Er(f,o,g)}}function zf(i,o,f){var g=Bo(i),w={lane:g,action:f,hasEagerState:!1,eagerState:null,next:null};if(nc(i))Ff(o,w);else{var C=i.alternate;if(i.lanes===0&&(C===null||C.lanes===0)&&(C=o.lastRenderedReducer,C!==null))try{var A=o.lastRenderedState,z=C(A,f);if(w.hasEagerState=!0,w.eagerState=z,sr(z,A)){var V=o.interleaved;V===null?(w.next=w,ko(o)):(w.next=V.next,V.next=w),o.interleaved=w;return}}catch{}finally{}f=_l(i,o,w,g),f!==null&&(w=kr(),Ri(f,i,g,w),Er(f,o,g))}}function nc(i){var o=i.alternate;return i===Ct||o!==null&&o===Ct}function Ff(i,o){Gi=Vr=!0;var f=i.pending;f===null?o.next=o:(o.next=f.next,f.next=o),i.pending=o}function Er(i,o,f){if((f&4194240)!==0){var g=o.lanes;g&=i.pendingLanes,f|=g,o.lanes=f,wu(i,f)}}var Mo={readContext:Gn,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useInsertionEffect:tn,useLayoutEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useMutableSource:tn,useSyncExternalStore:tn,useId:tn,unstable_isNewReconciler:!1},_h={readContext:Gn,useCallback:function(i,o){return zt().memoizedState=[i,o===void 0?null:o],i},useContext:Gn,useEffect:Af,useImperativeHandle:function(i,o,f){return f=f!=null?f.concat([i]):null,Ao(4194308,4,Ji.bind(null,o,i),f)},useLayoutEffect:function(i,o){return Ao(4194308,4,i,o)},useInsertionEffect:function(i,o){return Ao(4,2,i,o)},useMemo:function(i,o){var f=zt();return o=o===void 0?null:o,i=i(),f.memoizedState=[i,o],i},useReducer:function(i,o,f){var g=zt();return o=f!==void 0?f(o):o,g.memoizedState=g.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},g.queue=i,i=i.dispatch=Rh.bind(null,Ct,i),[g.memoizedState,i]},useRef:function(i){var o=zt();return i={current:i},o.memoizedState=i},useState:Zi,useDebugValue:Ci,useDeferredValue:function(i){return zt().memoizedState=i},useTransition:function(){var i=Zi(!1),o=i[0];return i=Lf.bind(null,i[1]),zt().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,f){var g=Ct,w=zt();if(Et){if(f===void 0)throw Error(n(407));f=f()}else{if(f=o(),$n===null)throw Error(n(349));(Zn&30)!==0||Of(g,o,f)}w.memoizedState=f;var C={value:f,getSnapshot:o};return w.queue=C,Af(Yu.bind(null,g,C,i),[i]),g.flags|=2048,Oo(9,ki.bind(null,g,C,f,o),void 0,null),f},useId:function(){var i=zt(),o=$n.identifierPrefix;if(Et){var f=$t,g=vr;f=(g&~(1<<32-ft(g)-1)).toString(32)+f,o=":"+o+"R"+f,f=Mr++,0<f&&(o+="H"+f.toString(32)),o+=":"}else f=Ha++,o=":"+o+"r"+f.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},es={readContext:Gn,useCallback:tc,useContext:Gn,useEffect:Zu,useImperativeHandle:Mf,useInsertionEffect:Ju,useLayoutEffect:ec,useMemo:Ft,useReducer:Dn,useRef:Gu,useState:function(){return Dn(Fn)},useDebugValue:Ci,useDeferredValue:function(i){var o=cn();return jf(o,Qt.memoizedState,i)},useTransition:function(){var i=Dn(Fn)[0],o=cn().memoizedState;return[i,o]},useMutableSource:qa,useSyncExternalStore:Qa,useId:Nf,unstable_isNewReconciler:!1},Ya={readContext:Gn,useCallback:tc,useContext:Gn,useEffect:Zu,useImperativeHandle:Mf,useInsertionEffect:Ju,useLayoutEffect:ec,useMemo:Ft,useReducer:Va,useRef:Gu,useState:function(){return Va(Fn)},useDebugValue:Ci,useDeferredValue:function(i){var o=cn();return Qt===null?o.memoizedState=i:jf(o,Qt.memoizedState,i)},useTransition:function(){var i=Va(Fn)[0],o=cn().memoizedState;return[i,o]},useMutableSource:qa,useSyncExternalStore:Qa,useId:Nf,unstable_isNewReconciler:!1};function _n(i,o){if(i&&i.defaultProps){o=Q({},o),i=i.defaultProps;for(var f in i)o[f]===void 0&&(o[f]=i[f]);return o}return o}function jo(i,o,f,g){o=i.memoizedState,f=f(g,o),f=f==null?o:Q({},o,f),i.memoizedState=f,i.lanes===0&&(i.updateQueue.baseState=f)}var Lo={isMounted:function(i){return(i=i._reactInternals)?hs(i)===i:!1},enqueueSetState:function(i,o,f){i=i._reactInternals;var g=kr(),w=Bo(i),C=si(g,w);C.payload=o,f!=null&&(C.callback=f),o=oi(i,C,w),o!==null&&(Ri(o,i,w,g),Wa(o,i,w))},enqueueReplaceState:function(i,o,f){i=i._reactInternals;var g=kr(),w=Bo(i),C=si(g,w);C.tag=1,C.payload=o,f!=null&&(C.callback=f),o=oi(i,C,w),o!==null&&(Ri(o,i,w,g),Wa(o,i,w))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var f=kr(),g=Bo(i),w=si(f,g);w.tag=2,o!=null&&(w.callback=o),o=oi(i,w,g),o!==null&&(Ri(o,i,g,f),Wa(o,i,g))}};function Ka(i,o,f,g,w,C,A){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(g,C,A):o.prototype&&o.prototype.isPureReactComponent?!Ps(f,g)||!Ps(w,C):!0}function Df(i,o,f){var g=!1,w=ti,C=o.contextType;return typeof C=="object"&&C!==null?C=Gn(C):(w=Nn(o)?Vi:Rn.current,g=o.contextTypes,C=(g=g!=null)?Os(i,w):ti),o=new o(f,C),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Lo,i.stateNode=o,o._reactInternals=i,g&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=w,i.__reactInternalMemoizedMaskedChildContext=C),o}function rc(i,o,f,g){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(f,g),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(f,g),o.state!==i&&Lo.enqueueReplaceState(o,o.state,null)}function Ga(i,o,f,g){var w=i.stateNode;w.props=f,w.state=i.memoizedState,w.refs={},Il(i);var C=o.contextType;typeof C=="object"&&C!==null?w.context=Gn(C):(C=Nn(o)?Vi:Rn.current,w.context=Os(i,C)),w.state=i.memoizedState,C=o.getDerivedStateFromProps,typeof C=="function"&&(jo(i,o,C,f),w.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(o=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),o!==w.state&&Lo.enqueueReplaceState(w,w.state,null),Co(i,f,w,g),w.state=i.memoizedState),typeof w.componentDidMount=="function"&&(i.flags|=4194308)}function Bs(i,o){try{var f="",g=o;do f+=Le(g),g=g.return;while(g);var w=f}catch(C){w=`
Error generating stack: `+C.message+`
`+C.stack}return{value:i,source:o,stack:w,digest:null}}function Za(i,o,f){return{value:i,source:null,stack:f??null,digest:o??null}}function No(i,o){try{console.error(o.value)}catch(f){setTimeout(function(){throw f})}}var Ih=typeof WeakMap=="function"?WeakMap:Map;function Bf(i,o,f){f=si(-1,f),f.tag=3,f.payload={element:null};var g=o.value;return f.callback=function(){Vf||(Vf=!0,Bh=g),No(i,o)},f}function l(i,o,f){f=si(-1,f),f.tag=3;var g=i.type.getDerivedStateFromError;if(typeof g=="function"){var w=o.value;f.payload=function(){return g(w)},f.callback=function(){No(i,o)}}var C=i.stateNode;return C!==null&&typeof C.componentDidCatch=="function"&&(f.callback=function(){No(i,o),typeof g!="function"&&(Fo===null?Fo=new Set([this]):Fo.add(this));var A=o.stack;this.componentDidCatch(o.value,{componentStack:A!==null?A:""})}),f}function u(i,o,f){var g=i.pingCache;if(g===null){g=i.pingCache=new Ih;var w=new Set;g.set(o,w)}else w=g.get(o),w===void 0&&(w=new Set,g.set(o,w));w.has(f)||(w.add(f),i=c1.bind(null,i,o,f),o.then(i,i))}function p(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function x(i,o,f,g,w){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,f.flags|=131072,f.flags&=-52805,f.tag===1&&(f.alternate===null?f.tag=17:(o=si(-1,1),o.tag=2,oi(f,o,1))),f.lanes|=1),i):(i.flags|=65536,i.lanes=w,i)}var S=$.ReactCurrentOwner,b=!1;function j(i,o,f,g){o.child=i===null?Ar(o,null,f,g):zs(o,i.child,f,g)}function X(i,o,f,g,w){f=f.render;var C=o.ref;return Pi(o,w),g=_o(i,o,f,g,C,w),f=Io(),i!==null&&!b?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~w,Bn(i,o,w)):(Et&&f&&So(o),o.flags|=1,j(i,o,g,w),o.child)}function ie(i,o,f,g,w){if(i===null){var C=f.type;return typeof C=="function"&&!Qh(C)&&C.defaultProps===void 0&&f.compare===null&&f.defaultProps===void 0?(o.tag=15,o.type=C,Pe(i,o,C,g,w)):(i=Gf(f.type,null,g,o,o.mode,w),i.ref=o.ref,i.return=o,o.child=i)}if(C=i.child,(i.lanes&w)===0){var A=C.memoizedProps;if(f=f.compare,f=f!==null?f:Ps,f(A,g)&&i.ref===o.ref)return Bn(i,o,w)}return o.flags|=1,i=Uo(C,g),i.ref=o.ref,i.return=o,o.child=i}function Pe(i,o,f,g,w){if(i!==null){var C=i.memoizedProps;if(Ps(C,g)&&i.ref===o.ref)if(b=!1,o.pendingProps=g=C,(i.lanes&w)!==0)(i.flags&131072)!==0&&(b=!0);else return o.lanes=i.lanes,Bn(i,o,w)}return _e(i,o,f,g,w)}function Be(i,o,f){var g=o.pendingProps,w=g.children,C=i!==null?i.memoizedState:null;if(g.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},_t(eu,qr),qr|=f;else{if((f&1073741824)===0)return i=C!==null?C.baseLanes|f:f,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,_t(eu,qr),qr|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},g=C!==null?C.baseLanes:f,_t(eu,qr),qr|=g}else C!==null?(g=C.baseLanes|f,o.memoizedState=null):g=f,_t(eu,qr),qr|=g;return j(i,o,w,f),o.child}function nt(i,o){var f=o.ref;(i===null&&f!==null||i!==null&&i.ref!==f)&&(o.flags|=512,o.flags|=2097152)}function _e(i,o,f,g,w){var C=Nn(f)?Vi:Rn.current;return C=Os(o,C),Pi(o,w),f=_o(i,o,f,g,C,w),g=Io(),i!==null&&!b?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~w,Bn(i,o,w)):(Et&&g&&So(o),o.flags|=1,j(i,o,f,w),o.child)}function jt(i,o,f,g,w){if(Nn(f)){var C=!0;As(o)}else C=!1;if(Pi(o,w),o.stateNode===null)pt(i,o),Df(o,f,g),Ga(o,f,g,w),g=!0;else if(i===null){var A=o.stateNode,z=o.memoizedProps;A.props=z;var V=A.context,ne=f.contextType;typeof ne=="object"&&ne!==null?ne=Gn(ne):(ne=Nn(f)?Vi:Rn.current,ne=Os(o,ne));var ve=f.getDerivedStateFromProps,xe=typeof ve=="function"||typeof A.getSnapshotBeforeUpdate=="function";xe||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(z!==g||V!==ne)&&rc(o,A,g,ne),ii=!1;var ye=o.memoizedState;A.state=ye,Co(o,g,A,w),V=o.memoizedState,z!==g||ye!==V||Ln.current||ii?(typeof ve=="function"&&(jo(o,f,ve,g),V=o.memoizedState),(z=ii||Ka(o,f,z,g,ye,V,ne))?(xe||typeof A.UNSAFE_componentWillMount!="function"&&typeof A.componentWillMount!="function"||(typeof A.componentWillMount=="function"&&A.componentWillMount(),typeof A.UNSAFE_componentWillMount=="function"&&A.UNSAFE_componentWillMount()),typeof A.componentDidMount=="function"&&(o.flags|=4194308)):(typeof A.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=g,o.memoizedState=V),A.props=g,A.state=V,A.context=ne,g=z):(typeof A.componentDidMount=="function"&&(o.flags|=4194308),g=!1)}else{A=o.stateNode,Ua(i,o),z=o.memoizedProps,ne=o.type===o.elementType?z:_n(o.type,z),A.props=ne,xe=o.pendingProps,ye=A.context,V=f.contextType,typeof V=="object"&&V!==null?V=Gn(V):(V=Nn(f)?Vi:Rn.current,V=Os(o,V));var Fe=f.getDerivedStateFromProps;(ve=typeof Fe=="function"||typeof A.getSnapshotBeforeUpdate=="function")||typeof A.UNSAFE_componentWillReceiveProps!="function"&&typeof A.componentWillReceiveProps!="function"||(z!==xe||ye!==V)&&rc(o,A,g,V),ii=!1,ye=o.memoizedState,A.state=ye,Co(o,g,A,w);var Ue=o.memoizedState;z!==xe||ye!==Ue||Ln.current||ii?(typeof Fe=="function"&&(jo(o,f,Fe,g),Ue=o.memoizedState),(ne=ii||Ka(o,f,ne,g,ye,Ue,V)||!1)?(ve||typeof A.UNSAFE_componentWillUpdate!="function"&&typeof A.componentWillUpdate!="function"||(typeof A.componentWillUpdate=="function"&&A.componentWillUpdate(g,Ue,V),typeof A.UNSAFE_componentWillUpdate=="function"&&A.UNSAFE_componentWillUpdate(g,Ue,V)),typeof A.componentDidUpdate=="function"&&(o.flags|=4),typeof A.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof A.componentDidUpdate!="function"||z===i.memoizedProps&&ye===i.memoizedState||(o.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||z===i.memoizedProps&&ye===i.memoizedState||(o.flags|=1024),o.memoizedProps=g,o.memoizedState=Ue),A.props=g,A.state=Ue,A.context=V,g=ne):(typeof A.componentDidUpdate!="function"||z===i.memoizedProps&&ye===i.memoizedState||(o.flags|=4),typeof A.getSnapshotBeforeUpdate!="function"||z===i.memoizedProps&&ye===i.memoizedState||(o.flags|=1024),g=!1)}return kt(i,o,f,g,C,w)}function kt(i,o,f,g,w,C){nt(i,o);var A=(o.flags&128)!==0;if(!g&&!A)return w&&Rf(o,f,!1),Bn(i,o,C);g=o.stateNode,S.current=o;var z=A&&typeof f.getDerivedStateFromError!="function"?null:g.render();return o.flags|=1,i!==null&&A?(o.child=zs(o,i.child,null,C),o.child=zs(o,null,z,C)):j(i,o,z,C),o.memoizedState=g.state,w&&Rf(o,f,!0),o.child}function Jn(i){var o=i.stateNode;o.pendingContext?Vu(i,o.pendingContext,o.pendingContext!==o.context):o.context&&Vu(i,o.context,!1),Ki(i,o.containerInfo)}function li(i,o,f,g,w){return Ns(),bl(w),o.flags|=256,j(i,o,f,g),o.child}var te={dehydrated:null,treeContext:null,retryLane:0};function Y(i){return{baseLanes:i,cachePool:null,transitions:null}}function ce(i,o,f){var g=o.pendingProps,w=Mt.current,C=!1,A=(o.flags&128)!==0,z;if((z=A)||(z=i!==null&&i.memoizedState===null?!1:(w&2)!==0),z?(C=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(w|=1),_t(Mt,w&1),i===null)return Po(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(A=g.children,i=g.fallback,C?(g=o.mode,C=o.child,A={mode:"hidden",children:A},(g&1)===0&&C!==null?(C.childLanes=0,C.pendingProps=A):C=Zf(A,g,0,null),i=Fl(i,g,f,null),C.return=o,i.return=o,C.sibling=i,o.child=C,o.child.memoizedState=Y(f),o.memoizedState=te,i):Me(o,A));if(w=i.memoizedState,w!==null&&(z=w.dehydrated,z!==null))return lt(i,o,A,g,z,w,f);if(C){C=g.fallback,A=o.mode,w=i.child,z=w.sibling;var V={mode:"hidden",children:g.children};return(A&1)===0&&o.child!==w?(g=o.child,g.childLanes=0,g.pendingProps=V,o.deletions=null):(g=Uo(w,V),g.subtreeFlags=w.subtreeFlags&14680064),z!==null?C=Uo(z,C):(C=Fl(C,A,f,null),C.flags|=2),C.return=o,g.return=o,g.sibling=C,o.child=g,g=C,C=o.child,A=i.child.memoizedState,A=A===null?Y(f):{baseLanes:A.baseLanes|f,cachePool:null,transitions:A.transitions},C.memoizedState=A,C.childLanes=i.childLanes&~f,o.memoizedState=te,g}return C=i.child,i=C.sibling,g=Uo(C,{mode:"visible",children:g.children}),(o.mode&1)===0&&(g.lanes=f),g.return=o,g.sibling=null,i!==null&&(f=o.deletions,f===null?(o.deletions=[i],o.flags|=16):f.push(i)),o.child=g,o.memoizedState=null,g}function Me(i,o){return o=Zf({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function Qe(i,o,f,g){return g!==null&&bl(g),zs(o,i.child,null,f),i=Me(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function lt(i,o,f,g,w,C,A){if(f)return o.flags&256?(o.flags&=-257,g=Za(Error(n(422))),Qe(i,o,A,g)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(C=g.fallback,w=o.mode,g=Zf({mode:"visible",children:g.children},w,0,null),C=Fl(C,w,A,null),C.flags|=2,g.return=o,C.return=o,g.sibling=C,o.child=g,(o.mode&1)!==0&&zs(o,i.child,null,A),o.child.memoizedState=Y(A),o.memoizedState=te,C);if((o.mode&1)===0)return Qe(i,o,A,null);if(w.data==="$!"){if(g=w.nextSibling&&w.nextSibling.dataset,g)var z=g.dgst;return g=z,C=Error(n(419)),g=Za(C,g,void 0),Qe(i,o,A,g)}if(z=(A&i.childLanes)!==0,b||z){if(g=$n,g!==null){switch(A&-A){case 4:w=2;break;case 16:w=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:w=32;break;case 536870912:w=268435456;break;default:w=0}w=(w&(g.suspendedLanes|A))!==0?0:w,w!==0&&w!==C.retryLane&&(C.retryLane=w,Pr(i,w),Ri(g,i,w,-1))}return qh(),g=Za(Error(n(421))),Qe(i,o,A,g)}return w.data==="$?"?(o.flags|=128,o.child=i.child,o=f1.bind(null,i),w._reactRetry=o,null):(i=C.treeContext,Ce=Jr(w.nextSibling),xr=o,Et=!0,wr=null,i!==null&&(Yn[Kn++]=vr,Yn[Kn++]=$t,Yn[Kn++]=Yi,vr=i.id,$t=i.overflow,Yi=o),o=Me(o,g.children),o.flags|=4096,o)}function rt(i,o,f){i.lanes|=o;var g=i.alternate;g!==null&&(g.lanes|=o),$a(i.return,o,f)}function gt(i,o,f,g,w){var C=i.memoizedState;C===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:g,tail:f,tailMode:w}:(C.isBackwards=o,C.rendering=null,C.renderingStartTime=0,C.last=g,C.tail=f,C.tailMode=w)}function fn(i,o,f){var g=o.pendingProps,w=g.revealOrder,C=g.tail;if(j(i,o,g.children,f),g=Mt.current,(g&2)!==0)g=g&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&rt(i,f,o);else if(i.tag===19)rt(i,f,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}g&=1}if(_t(Mt,g),(o.mode&1)===0)o.memoizedState=null;else switch(w){case"forwards":for(f=o.child,w=null;f!==null;)i=f.alternate,i!==null&&bo(i)===null&&(w=f),f=f.sibling;f=w,f===null?(w=o.child,o.child=null):(w=f.sibling,f.sibling=null),gt(o,!1,w,f,C);break;case"backwards":for(f=null,w=o.child,o.child=null;w!==null;){if(i=w.alternate,i!==null&&bo(i)===null){o.child=w;break}i=w.sibling,w.sibling=f,f=w,w=i}gt(o,!0,f,null,C);break;case"together":gt(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function pt(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function Bn(i,o,f){if(i!==null&&(o.dependencies=i.dependencies),jl|=o.lanes,(f&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(n(153));if(o.child!==null){for(i=o.child,f=Uo(i,i.pendingProps),o.child=f,f.return=o;i.sibling!==null;)i=i.sibling,f=f.sibling=Uo(i,i.pendingProps),f.return=o;f.sibling=null}return o.child}function Oh(i,o,f){switch(o.tag){case 3:Jn(o),Ns();break;case 5:To(o);break;case 1:Nn(o.type)&&As(o);break;case 4:Ki(o,o.stateNode.containerInfo);break;case 10:var g=o.type._context,w=o.memoizedProps.value;_t(Rl,g._currentValue),g._currentValue=w;break;case 13:if(g=o.memoizedState,g!==null)return g.dehydrated!==null?(_t(Mt,Mt.current&1),o.flags|=128,null):(f&o.child.childLanes)!==0?ce(i,o,f):(_t(Mt,Mt.current&1),i=Bn(i,o,f),i!==null?i.sibling:null);_t(Mt,Mt.current&1);break;case 19:if(g=(f&o.childLanes)!==0,(i.flags&128)!==0){if(g)return fn(i,o,f);o.flags|=128}if(w=o.memoizedState,w!==null&&(w.rendering=null,w.tail=null,w.lastEffect=null),_t(Mt,Mt.current),g)break;return null;case 22:case 23:return o.lanes=0,Be(i,o,f)}return Bn(i,o,f)}var Yg,Ah,Kg,Gg;Yg=function(i,o){for(var f=o.child;f!==null;){if(f.tag===5||f.tag===6)i.appendChild(f.stateNode);else if(f.tag!==4&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===o)break;for(;f.sibling===null;){if(f.return===null||f.return===o)return;f=f.return}f.sibling.return=f.return,f=f.sibling}},Ah=function(){},Kg=function(i,o,f,g){var w=i.memoizedProps;if(w!==g){i=o.stateNode,un(It.current);var C=null;switch(f){case"input":w=ct(i,w),g=ct(i,g),C=[];break;case"select":w=Q({},w,{value:void 0}),g=Q({},g,{value:void 0}),C=[];break;case"textarea":w=Z(i,w),g=Z(i,g),C=[];break;default:typeof w.onClick!="function"&&typeof g.onClick=="function"&&(i.onclick=Rs)}Ae(f,g);var A;f=null;for(ne in w)if(!g.hasOwnProperty(ne)&&w.hasOwnProperty(ne)&&w[ne]!=null)if(ne==="style"){var z=w[ne];for(A in z)z.hasOwnProperty(A)&&(f||(f={}),f[A]="")}else ne!=="dangerouslySetInnerHTML"&&ne!=="children"&&ne!=="suppressContentEditableWarning"&&ne!=="suppressHydrationWarning"&&ne!=="autoFocus"&&(s.hasOwnProperty(ne)?C||(C=[]):(C=C||[]).push(ne,null));for(ne in g){var V=g[ne];if(z=w?.[ne],g.hasOwnProperty(ne)&&V!==z&&(V!=null||z!=null))if(ne==="style")if(z){for(A in z)!z.hasOwnProperty(A)||V&&V.hasOwnProperty(A)||(f||(f={}),f[A]="");for(A in V)V.hasOwnProperty(A)&&z[A]!==V[A]&&(f||(f={}),f[A]=V[A])}else f||(C||(C=[]),C.push(ne,f)),f=V;else ne==="dangerouslySetInnerHTML"?(V=V?V.__html:void 0,z=z?z.__html:void 0,V!=null&&z!==V&&(C=C||[]).push(ne,V)):ne==="children"?typeof V!="string"&&typeof V!="number"||(C=C||[]).push(ne,""+V):ne!=="suppressContentEditableWarning"&&ne!=="suppressHydrationWarning"&&(s.hasOwnProperty(ne)?(V!=null&&ne==="onScroll"&&Ot("scroll",i),C||z===V||(C=[])):(C=C||[]).push(ne,V))}f&&(C=C||[]).push("style",f);var ne=C;(o.updateQueue=ne)&&(o.flags|=4)}},Gg=function(i,o,f,g){f!==g&&(o.flags|=4)};function ic(i,o){if(!Et)switch(i.tailMode){case"hidden":o=i.tail;for(var f=null;o!==null;)o.alternate!==null&&(f=o),o=o.sibling;f===null?i.tail=null:f.sibling=null;break;case"collapsed":f=i.tail;for(var g=null;f!==null;)f.alternate!==null&&(g=f),f=f.sibling;g===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:g.sibling=null}}function lr(i){var o=i.alternate!==null&&i.alternate.child===i.child,f=0,g=0;if(o)for(var w=i.child;w!==null;)f|=w.lanes|w.childLanes,g|=w.subtreeFlags&14680064,g|=w.flags&14680064,w.return=i,w=w.sibling;else for(w=i.child;w!==null;)f|=w.lanes|w.childLanes,g|=w.subtreeFlags,g|=w.flags,w.return=i,w=w.sibling;return i.subtreeFlags|=g,i.childLanes=f,o}function e1(i,o,f){var g=o.pendingProps;switch(xn(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return lr(o),null;case 1:return Nn(o.type)&&xo(),lr(o),null;case 3:return g=o.stateNode,Wt(),At(Ln),At(Rn),zn(),g.pendingContext&&(g.context=g.pendingContext,g.pendingContext=null),(i===null||i.child===null)&&(Tl(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,wr!==null&&(Wh(wr),wr=null))),Ah(i,o),lr(o),null;case 5:Ei(o);var w=un(Gt.current);if(f=o.type,i!==null&&o.stateNode!=null)Kg(i,o,f,g,w),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!g){if(o.stateNode===null)throw Error(n(166));return lr(o),null}if(i=un(It.current),Tl(o)){g=o.stateNode,f=o.type;var C=o.memoizedProps;switch(g[Or]=o,g[El]=C,i=(o.mode&1)!==0,f){case"dialog":Ot("cancel",g),Ot("close",g);break;case"iframe":case"object":case"embed":Ot("load",g);break;case"video":case"audio":for(w=0;w<Ui.length;w++)Ot(Ui[w],g);break;case"source":Ot("error",g);break;case"img":case"image":case"link":Ot("error",g),Ot("load",g);break;case"details":Ot("toggle",g);break;case"input":An(g,C),Ot("invalid",g);break;case"select":g._wrapperState={wasMultiple:!!C.multiple},Ot("invalid",g);break;case"textarea":fe(g,C),Ot("invalid",g)}Ae(f,C),w=null;for(var A in C)if(C.hasOwnProperty(A)){var z=C[A];A==="children"?typeof z=="string"?g.textContent!==z&&(C.suppressHydrationWarning!==!0&&Sl(g.textContent,z,i),w=["children",z]):typeof z=="number"&&g.textContent!==""+z&&(C.suppressHydrationWarning!==!0&&Sl(g.textContent,z,i),w=["children",""+z]):s.hasOwnProperty(A)&&z!=null&&A==="onScroll"&&Ot("scroll",g)}switch(f){case"input":ot(g),En(g,C,!0);break;case"textarea":ot(g),G(g);break;case"select":case"option":break;default:typeof C.onClick=="function"&&(g.onclick=Rs)}g=w,o.updateQueue=g,g!==null&&(o.flags|=4)}else{A=w.nodeType===9?w:w.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=W(f)),i==="http://www.w3.org/1999/xhtml"?f==="script"?(i=A.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof g.is=="string"?i=A.createElement(f,{is:g.is}):(i=A.createElement(f),f==="select"&&(A=i,g.multiple?A.multiple=!0:g.size&&(A.size=g.size))):i=A.createElementNS(i,f),i[Or]=o,i[El]=g,Yg(i,o,!1,!1),o.stateNode=i;e:{switch(A=tt(f,g),f){case"dialog":Ot("cancel",i),Ot("close",i),w=g;break;case"iframe":case"object":case"embed":Ot("load",i),w=g;break;case"video":case"audio":for(w=0;w<Ui.length;w++)Ot(Ui[w],i);w=g;break;case"source":Ot("error",i),w=g;break;case"img":case"image":case"link":Ot("error",i),Ot("load",i),w=g;break;case"details":Ot("toggle",i),w=g;break;case"input":An(i,g),w=ct(i,g),Ot("invalid",i);break;case"option":w=g;break;case"select":i._wrapperState={wasMultiple:!!g.multiple},w=Q({},g,{value:void 0}),Ot("invalid",i);break;case"textarea":fe(i,g),w=Z(i,g),Ot("invalid",i);break;default:w=g}Ae(f,w),z=w;for(C in z)if(z.hasOwnProperty(C)){var V=z[C];C==="style"?Oe(i,V):C==="dangerouslySetInnerHTML"?(V=V?V.__html:void 0,V!=null&&Xe(i,V)):C==="children"?typeof V=="string"?(f!=="textarea"||V!=="")&&Ze(i,V):typeof V=="number"&&Ze(i,""+V):C!=="suppressContentEditableWarning"&&C!=="suppressHydrationWarning"&&C!=="autoFocus"&&(s.hasOwnProperty(C)?V!=null&&C==="onScroll"&&Ot("scroll",i):V!=null&&L(i,C,V,A))}switch(f){case"input":ot(i),En(i,g,!1);break;case"textarea":ot(i),G(i);break;case"option":g.value!=null&&i.setAttribute("value",""+it(g.value));break;case"select":i.multiple=!!g.multiple,C=g.value,C!=null?br(i,!!g.multiple,C,!1):g.defaultValue!=null&&br(i,!!g.multiple,g.defaultValue,!0);break;default:typeof w.onClick=="function"&&(i.onclick=Rs)}switch(f){case"button":case"input":case"select":case"textarea":g=!!g.autoFocus;break e;case"img":g=!0;break e;default:g=!1}}g&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return lr(o),null;case 6:if(i&&o.stateNode!=null)Gg(i,o,i.memoizedProps,g);else{if(typeof g!="string"&&o.stateNode===null)throw Error(n(166));if(f=un(Gt.current),un(It.current),Tl(o)){if(g=o.stateNode,f=o.memoizedProps,g[Or]=o,(C=g.nodeValue!==f)&&(i=xr,i!==null))switch(i.tag){case 3:Sl(g.nodeValue,f,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Sl(g.nodeValue,f,(i.mode&1)!==0)}C&&(o.flags|=4)}else g=(f.nodeType===9?f:f.ownerDocument).createTextNode(g),g[Or]=o,o.stateNode=g}return lr(o),null;case 13:if(At(Mt),g=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(Et&&Ce!==null&&(o.mode&1)!==0&&(o.flags&128)===0)Qu(),Ns(),o.flags|=98560,C=!1;else if(C=Tl(o),g!==null&&g.dehydrated!==null){if(i===null){if(!C)throw Error(n(318));if(C=o.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(n(317));C[Or]=o}else Ns(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;lr(o),C=!1}else wr!==null&&(Wh(wr),wr=null),C=!0;if(!C)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=f,o):(g=g!==null,g!==(i!==null&&i.memoizedState!==null)&&g&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(Mt.current&1)!==0?In===0&&(In=3):qh())),o.updateQueue!==null&&(o.flags|=4),lr(o),null);case 4:return Wt(),Ah(i,o),i===null&&Ts(o.stateNode.containerInfo),lr(o),null;case 10:return Ba(o.type._context),lr(o),null;case 17:return Nn(o.type)&&xo(),lr(o),null;case 19:if(At(Mt),C=o.memoizedState,C===null)return lr(o),null;if(g=(o.flags&128)!==0,A=C.rendering,A===null)if(g)ic(C,!1);else{if(In!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(A=bo(i),A!==null){for(o.flags|=128,ic(C,!1),g=A.updateQueue,g!==null&&(o.updateQueue=g,o.flags|=4),o.subtreeFlags=0,g=f,f=o.child;f!==null;)C=f,i=g,C.flags&=14680066,A=C.alternate,A===null?(C.childLanes=0,C.lanes=i,C.child=null,C.subtreeFlags=0,C.memoizedProps=null,C.memoizedState=null,C.updateQueue=null,C.dependencies=null,C.stateNode=null):(C.childLanes=A.childLanes,C.lanes=A.lanes,C.child=A.child,C.subtreeFlags=0,C.deletions=null,C.memoizedProps=A.memoizedProps,C.memoizedState=A.memoizedState,C.updateQueue=A.updateQueue,C.type=A.type,i=A.dependencies,C.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),f=f.sibling;return _t(Mt,Mt.current&1|2),o.child}i=i.sibling}C.tail!==null&&Yt()>tu&&(o.flags|=128,g=!0,ic(C,!1),o.lanes=4194304)}else{if(!g)if(i=bo(A),i!==null){if(o.flags|=128,g=!0,f=i.updateQueue,f!==null&&(o.updateQueue=f,o.flags|=4),ic(C,!0),C.tail===null&&C.tailMode==="hidden"&&!A.alternate&&!Et)return lr(o),null}else 2*Yt()-C.renderingStartTime>tu&&f!==1073741824&&(o.flags|=128,g=!0,ic(C,!1),o.lanes=4194304);C.isBackwards?(A.sibling=o.child,o.child=A):(f=C.last,f!==null?f.sibling=A:o.child=A,C.last=A)}return C.tail!==null?(o=C.tail,C.rendering=o,C.tail=o.sibling,C.renderingStartTime=Yt(),o.sibling=null,f=Mt.current,_t(Mt,g?f&1|2:f&1),o):(lr(o),null);case 22:case 23:return Vh(),g=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==g&&(o.flags|=8192),g&&(o.mode&1)!==0?(qr&1073741824)!==0&&(lr(o),o.subtreeFlags&6&&(o.flags|=8192)):lr(o),null;case 24:return null;case 25:return null}throw Error(n(156,o.tag))}function t1(i,o){switch(xn(o),o.tag){case 1:return Nn(o.type)&&xo(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return Wt(),At(Ln),At(Rn),zn(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return Ei(o),null;case 13:if(At(Mt),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(n(340));Ns()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return At(Mt),null;case 4:return Wt(),null;case 10:return Ba(o.type._context),null;case 22:case 23:return Vh(),null;case 24:return null;default:return null}}var $f=!1,ar=!1,n1=typeof WeakSet=="function"?WeakSet:Set,$e=null;function Ja(i,o){var f=i.ref;if(f!==null)if(typeof f=="function")try{f(null)}catch(g){nn(i,o,g)}else f.current=null}function Mh(i,o,f){try{f()}catch(g){nn(i,o,g)}}var Zg=!1;function r1(i,o){if($u=da,i=ln(),go(i)){if("selectionStart"in i)var f={start:i.selectionStart,end:i.selectionEnd};else e:{f=(f=i.ownerDocument)&&f.defaultView||window;var g=f.getSelection&&f.getSelection();if(g&&g.rangeCount!==0){f=g.anchorNode;var w=g.anchorOffset,C=g.focusNode;g=g.focusOffset;try{f.nodeType,C.nodeType}catch{f=null;break e}var A=0,z=-1,V=-1,ne=0,ve=0,xe=i,ye=null;t:for(;;){for(var Fe;xe!==f||w!==0&&xe.nodeType!==3||(z=A+w),xe!==C||g!==0&&xe.nodeType!==3||(V=A+g),xe.nodeType===3&&(A+=xe.nodeValue.length),(Fe=xe.firstChild)!==null;)ye=xe,xe=Fe;for(;;){if(xe===i)break t;if(ye===f&&++ne===w&&(z=A),ye===C&&++ve===g&&(V=A),(Fe=xe.nextSibling)!==null)break;xe=ye,ye=xe.parentNode}xe=Fe}f=z===-1||V===-1?null:{start:z,end:V}}else f=null}f=f||{start:0,end:0}}else f=null;for(Uu={focusedElem:i,selectionRange:f},da=!1,$e=o;$e!==null;)if(o=$e,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,$e=i;else for(;$e!==null;){o=$e;try{var Ue=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(Ue!==null){var We=Ue.memoizedProps,dn=Ue.memoizedState,J=o.stateNode,q=J.getSnapshotBeforeUpdate(o.elementType===o.type?We:_n(o.type,We),dn);J.__reactInternalSnapshotBeforeUpdate=q}break;case 3:var ee=o.stateNode.containerInfo;ee.nodeType===1?ee.textContent="":ee.nodeType===9&&ee.documentElement&&ee.removeChild(ee.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(n(163))}}catch(Ee){nn(o,o.return,Ee)}if(i=o.sibling,i!==null){i.return=o.return,$e=i;break}$e=o.return}return Ue=Zg,Zg=!1,Ue}function sc(i,o,f){var g=o.updateQueue;if(g=g!==null?g.lastEffect:null,g!==null){var w=g=g.next;do{if((w.tag&i)===i){var C=w.destroy;w.destroy=void 0,C!==void 0&&Mh(o,f,C)}w=w.next}while(w!==g)}}function Uf(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var f=o=o.next;do{if((f.tag&i)===i){var g=f.create;f.destroy=g()}f=f.next}while(f!==o)}}function jh(i){var o=i.ref;if(o!==null){var f=i.stateNode;switch(i.tag){case 5:i=f;break;default:i=f}typeof o=="function"?o(i):o.current=i}}function Jg(i){var o=i.alternate;o!==null&&(i.alternate=null,Jg(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[Or],delete o[El],delete o[Aa],delete o[Tf],delete o[bf])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function em(i){return i.tag===5||i.tag===3||i.tag===4}function tm(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||em(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function Lh(i,o,f){var g=i.tag;if(g===5||g===6)i=i.stateNode,o?f.nodeType===8?f.parentNode.insertBefore(i,o):f.insertBefore(i,o):(f.nodeType===8?(o=f.parentNode,o.insertBefore(i,f)):(o=f,o.appendChild(i)),f=f._reactRootContainer,f!=null||o.onclick!==null||(o.onclick=Rs));else if(g!==4&&(i=i.child,i!==null))for(Lh(i,o,f),i=i.sibling;i!==null;)Lh(i,o,f),i=i.sibling}function Nh(i,o,f){var g=i.tag;if(g===5||g===6)i=i.stateNode,o?f.insertBefore(i,o):f.appendChild(i);else if(g!==4&&(i=i.child,i!==null))for(Nh(i,o,f),i=i.sibling;i!==null;)Nh(i,o,f),i=i.sibling}var er=null,Ti=!1;function zo(i,o,f){for(f=f.child;f!==null;)nm(i,o,f),f=f.sibling}function nm(i,o,f){if(kn&&typeof kn.onCommitFiberUnmount=="function")try{kn.onCommitFiberUnmount(hi,f)}catch{}switch(f.tag){case 5:ar||Ja(f,o);case 6:var g=er,w=Ti;er=null,zo(i,o,f),er=g,Ti=w,er!==null&&(Ti?(i=er,f=f.stateNode,i.nodeType===8?i.parentNode.removeChild(f):i.removeChild(f)):er.removeChild(f.stateNode));break;case 18:er!==null&&(Ti?(i=er,f=f.stateNode,i.nodeType===8?Oa(i.parentNode,f):i.nodeType===1&&Oa(i,f),rr(i)):Oa(er,f.stateNode));break;case 4:g=er,w=Ti,er=f.stateNode.containerInfo,Ti=!0,zo(i,o,f),er=g,Ti=w;break;case 0:case 11:case 14:case 15:if(!ar&&(g=f.updateQueue,g!==null&&(g=g.lastEffect,g!==null))){w=g=g.next;do{var C=w,A=C.destroy;C=C.tag,A!==void 0&&((C&2)!==0||(C&4)!==0)&&Mh(f,o,A),w=w.next}while(w!==g)}zo(i,o,f);break;case 1:if(!ar&&(Ja(f,o),g=f.stateNode,typeof g.componentWillUnmount=="function"))try{g.props=f.memoizedProps,g.state=f.memoizedState,g.componentWillUnmount()}catch(z){nn(f,o,z)}zo(i,o,f);break;case 21:zo(i,o,f);break;case 22:f.mode&1?(ar=(g=ar)||f.memoizedState!==null,zo(i,o,f),ar=g):zo(i,o,f);break;default:zo(i,o,f)}}function rm(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var f=i.stateNode;f===null&&(f=i.stateNode=new n1),o.forEach(function(g){var w=d1.bind(null,i,g);f.has(g)||(f.add(g),g.then(w,w))})}}function bi(i,o){var f=o.deletions;if(f!==null)for(var g=0;g<f.length;g++){var w=f[g];try{var C=i,A=o,z=A;e:for(;z!==null;){switch(z.tag){case 5:er=z.stateNode,Ti=!1;break e;case 3:er=z.stateNode.containerInfo,Ti=!0;break e;case 4:er=z.stateNode.containerInfo,Ti=!0;break e}z=z.return}if(er===null)throw Error(n(160));nm(C,A,w),er=null,Ti=!1;var V=w.alternate;V!==null&&(V.return=null),w.return=null}catch(ne){nn(w,o,ne)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)im(o,i),o=o.sibling}function im(i,o){var f=i.alternate,g=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(bi(o,i),ts(i),g&4){try{sc(3,i,i.return),Uf(3,i)}catch(We){nn(i,i.return,We)}try{sc(5,i,i.return)}catch(We){nn(i,i.return,We)}}break;case 1:bi(o,i),ts(i),g&512&&f!==null&&Ja(f,f.return);break;case 5:if(bi(o,i),ts(i),g&512&&f!==null&&Ja(f,f.return),i.flags&32){var w=i.stateNode;try{Ze(w,"")}catch(We){nn(i,i.return,We)}}if(g&4&&(w=i.stateNode,w!=null)){var C=i.memoizedProps,A=f!==null?f.memoizedProps:C,z=i.type,V=i.updateQueue;if(i.updateQueue=null,V!==null)try{z==="input"&&C.type==="radio"&&C.name!=null&&fr(w,C),tt(z,A);var ne=tt(z,C);for(A=0;A<V.length;A+=2){var ve=V[A],xe=V[A+1];ve==="style"?Oe(w,xe):ve==="dangerouslySetInnerHTML"?Xe(w,xe):ve==="children"?Ze(w,xe):L(w,ve,xe,ne)}switch(z){case"input":Mn(w,C);break;case"textarea":ke(w,C);break;case"select":var ye=w._wrapperState.wasMultiple;w._wrapperState.wasMultiple=!!C.multiple;var Fe=C.value;Fe!=null?br(w,!!C.multiple,Fe,!1):ye!==!!C.multiple&&(C.defaultValue!=null?br(w,!!C.multiple,C.defaultValue,!0):br(w,!!C.multiple,C.multiple?[]:"",!1))}w[El]=C}catch(We){nn(i,i.return,We)}}break;case 6:if(bi(o,i),ts(i),g&4){if(i.stateNode===null)throw Error(n(162));w=i.stateNode,C=i.memoizedProps;try{w.nodeValue=C}catch(We){nn(i,i.return,We)}}break;case 3:if(bi(o,i),ts(i),g&4&&f!==null&&f.memoizedState.isDehydrated)try{rr(o.containerInfo)}catch(We){nn(i,i.return,We)}break;case 4:bi(o,i),ts(i);break;case 13:bi(o,i),ts(i),w=i.child,w.flags&8192&&(C=w.memoizedState!==null,w.stateNode.isHidden=C,!C||w.alternate!==null&&w.alternate.memoizedState!==null||(Dh=Yt())),g&4&&rm(i);break;case 22:if(ve=f!==null&&f.memoizedState!==null,i.mode&1?(ar=(ne=ar)||ve,bi(o,i),ar=ne):bi(o,i),ts(i),g&8192){if(ne=i.memoizedState!==null,(i.stateNode.isHidden=ne)&&!ve&&(i.mode&1)!==0)for($e=i,ve=i.child;ve!==null;){for(xe=$e=ve;$e!==null;){switch(ye=$e,Fe=ye.child,ye.tag){case 0:case 11:case 14:case 15:sc(4,ye,ye.return);break;case 1:Ja(ye,ye.return);var Ue=ye.stateNode;if(typeof Ue.componentWillUnmount=="function"){g=ye,f=ye.return;try{o=g,Ue.props=o.memoizedProps,Ue.state=o.memoizedState,Ue.componentWillUnmount()}catch(We){nn(g,f,We)}}break;case 5:Ja(ye,ye.return);break;case 22:if(ye.memoizedState!==null){lm(xe);continue}}Fe!==null?(Fe.return=ye,$e=Fe):lm(xe)}ve=ve.sibling}e:for(ve=null,xe=i;;){if(xe.tag===5){if(ve===null){ve=xe;try{w=xe.stateNode,ne?(C=w.style,typeof C.setProperty=="function"?C.setProperty("display","none","important"):C.display="none"):(z=xe.stateNode,V=xe.memoizedProps.style,A=V!=null&&V.hasOwnProperty("display")?V.display:null,z.style.display=pe("display",A))}catch(We){nn(i,i.return,We)}}}else if(xe.tag===6){if(ve===null)try{xe.stateNode.nodeValue=ne?"":xe.memoizedProps}catch(We){nn(i,i.return,We)}}else if((xe.tag!==22&&xe.tag!==23||xe.memoizedState===null||xe===i)&&xe.child!==null){xe.child.return=xe,xe=xe.child;continue}if(xe===i)break e;for(;xe.sibling===null;){if(xe.return===null||xe.return===i)break e;ve===xe&&(ve=null),xe=xe.return}ve===xe&&(ve=null),xe.sibling.return=xe.return,xe=xe.sibling}}break;case 19:bi(o,i),ts(i),g&4&&rm(i);break;case 21:break;default:bi(o,i),ts(i)}}function ts(i){var o=i.flags;if(o&2){try{e:{for(var f=i.return;f!==null;){if(em(f)){var g=f;break e}f=f.return}throw Error(n(160))}switch(g.tag){case 5:var w=g.stateNode;g.flags&32&&(Ze(w,""),g.flags&=-33);var C=tm(i);Nh(i,C,w);break;case 3:case 4:var A=g.stateNode.containerInfo,z=tm(i);Lh(i,z,A);break;default:throw Error(n(161))}}catch(V){nn(i,i.return,V)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function i1(i,o,f){$e=i,sm(i)}function sm(i,o,f){for(var g=(i.mode&1)!==0;$e!==null;){var w=$e,C=w.child;if(w.tag===22&&g){var A=w.memoizedState!==null||$f;if(!A){var z=w.alternate,V=z!==null&&z.memoizedState!==null||ar;z=$f;var ne=ar;if($f=A,(ar=V)&&!ne)for($e=w;$e!==null;)A=$e,V=A.child,A.tag===22&&A.memoizedState!==null?am(w):V!==null?(V.return=A,$e=V):am(w);for(;C!==null;)$e=C,sm(C),C=C.sibling;$e=w,$f=z,ar=ne}om(i)}else(w.subtreeFlags&8772)!==0&&C!==null?(C.return=w,$e=C):om(i)}}function om(i){for(;$e!==null;){var o=$e;if((o.flags&8772)!==0){var f=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:ar||Uf(5,o);break;case 1:var g=o.stateNode;if(o.flags&4&&!ar)if(f===null)g.componentDidMount();else{var w=o.elementType===o.type?f.memoizedProps:_n(o.type,f.memoizedProps);g.componentDidUpdate(w,f.memoizedState,g.__reactInternalSnapshotBeforeUpdate)}var C=o.updateQueue;C!==null&&qt(o,C,g);break;case 3:var A=o.updateQueue;if(A!==null){if(f=null,o.child!==null)switch(o.child.tag){case 5:f=o.child.stateNode;break;case 1:f=o.child.stateNode}qt(o,A,f)}break;case 5:var z=o.stateNode;if(f===null&&o.flags&4){f=z;var V=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":V.autoFocus&&f.focus();break;case"img":V.src&&(f.src=V.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var ne=o.alternate;if(ne!==null){var ve=ne.memoizedState;if(ve!==null){var xe=ve.dehydrated;xe!==null&&rr(xe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(n(163))}ar||o.flags&512&&jh(o)}catch(ye){nn(o,o.return,ye)}}if(o===i){$e=null;break}if(f=o.sibling,f!==null){f.return=o.return,$e=f;break}$e=o.return}}function lm(i){for(;$e!==null;){var o=$e;if(o===i){$e=null;break}var f=o.sibling;if(f!==null){f.return=o.return,$e=f;break}$e=o.return}}function am(i){for(;$e!==null;){var o=$e;try{switch(o.tag){case 0:case 11:case 15:var f=o.return;try{Uf(4,o)}catch(V){nn(o,f,V)}break;case 1:var g=o.stateNode;if(typeof g.componentDidMount=="function"){var w=o.return;try{g.componentDidMount()}catch(V){nn(o,w,V)}}var C=o.return;try{jh(o)}catch(V){nn(o,C,V)}break;case 5:var A=o.return;try{jh(o)}catch(V){nn(o,A,V)}}}catch(V){nn(o,o.return,V)}if(o===i){$e=null;break}var z=o.sibling;if(z!==null){z.return=o.return,$e=z;break}$e=o.return}}var s1=Math.ceil,Wf=$.ReactCurrentDispatcher,zh=$.ReactCurrentOwner,ai=$.ReactCurrentBatchConfig,xt=0,$n=null,wn=null,tr=0,qr=0,eu=wi(0),In=0,oc=null,jl=0,Hf=0,Fh=0,lc=null,jr=null,Dh=0,tu=1/0,$s=null,Vf=!1,Bh=null,Fo=null,qf=!1,Do=null,Qf=0,ac=0,$h=null,Xf=-1,Yf=0;function kr(){return(xt&6)!==0?Yt():Xf!==-1?Xf:Xf=Yt()}function Bo(i){return(i.mode&1)===0?1:(xt&2)!==0&&tr!==0?tr&-tr:Xu.transition!==null?(Yf===0&&(Yf=xu()),Yf):(i=yt,i!==0||(i=window.event,i=i===void 0?16:uf(i.type)),i)}function Ri(i,o,f,g){if(50<ac)throw ac=0,$h=null,Error(n(185));al(i,f,g),((xt&2)===0||i!==$n)&&(i===$n&&((xt&2)===0&&(Hf|=f),In===4&&$o(i,tr)),Lr(i,g),f===1&&xt===0&&(o.mode&1)===0&&(tu=Yt()+500,wo&&qi()))}function Lr(i,o){var f=i.callbackNode;rf(i,o);var g=gs(i,i===$n?tr:0);if(g===0)f!==null&&tf(f),i.callbackNode=null,i.callbackPriority=0;else if(o=g&-g,i.callbackPriority!==o){if(f!=null&&tf(f),o===1)i.tag===0?Si(cm.bind(null,i)):Cl(cm.bind(null,i)),kf(function(){(xt&6)===0&&qi()}),f=null;else{switch(ul(g)){case 1:f=ps;break;case 4:f=sa;break;case 16:f=to;break;case 536870912:f=oa;break;default:f=to}f=vm(f,um.bind(null,i))}i.callbackPriority=o,i.callbackNode=f}}function um(i,o){if(Xf=-1,Yf=0,(xt&6)!==0)throw Error(n(327));var f=i.callbackNode;if(nu()&&i.callbackNode!==f)return null;var g=gs(i,i===$n?tr:0);if(g===0)return null;if((g&30)!==0||(g&i.expiredLanes)!==0||o)o=Kf(i,g);else{o=g;var w=xt;xt|=2;var C=dm();($n!==i||tr!==o)&&($s=null,tu=Yt()+500,Nl(i,o));do try{a1();break}catch(z){fm(i,z)}while(!0);Da(),Wf.current=C,xt=w,wn!==null?o=0:($n=null,tr=0,o=In)}if(o!==0){if(o===2&&(w=no(i),w!==0&&(g=w,o=Uh(i,w))),o===1)throw f=oc,Nl(i,0),$o(i,g),Lr(i,Yt()),f;if(o===6)$o(i,g);else{if(w=i.current.alternate,(g&30)===0&&!o1(w)&&(o=Kf(i,g),o===2&&(C=no(i),C!==0&&(g=C,o=Uh(i,C))),o===1))throw f=oc,Nl(i,0),$o(i,g),Lr(i,Yt()),f;switch(i.finishedWork=w,i.finishedLanes=g,o){case 0:case 1:throw Error(n(345));case 2:zl(i,jr,$s);break;case 3:if($o(i,g),(g&130023424)===g&&(o=Dh+500-Yt(),10<o)){if(gs(i,0)!==0)break;if(w=i.suspendedLanes,(w&g)!==g){kr(),i.pingedLanes|=i.suspendedLanes&w;break}i.timeoutHandle=yr(zl.bind(null,i,jr,$s),o);break}zl(i,jr,$s);break;case 4:if($o(i,g),(g&4194240)===g)break;for(o=i.eventTimes,w=-1;0<g;){var A=31-ft(g);C=1<<A,A=o[A],A>w&&(w=A),g&=~C}if(g=w,g=Yt()-g,g=(120>g?120:480>g?480:1080>g?1080:1920>g?1920:3e3>g?3e3:4320>g?4320:1960*s1(g/1960))-g,10<g){i.timeoutHandle=yr(zl.bind(null,i,jr,$s),g);break}zl(i,jr,$s);break;case 5:zl(i,jr,$s);break;default:throw Error(n(329))}}}return Lr(i,Yt()),i.callbackNode===f?um.bind(null,i):null}function Uh(i,o){var f=lc;return i.current.memoizedState.isDehydrated&&(Nl(i,o).flags|=256),i=Kf(i,o),i!==2&&(o=jr,jr=f,o!==null&&Wh(o)),i}function Wh(i){jr===null?jr=i:jr.push.apply(jr,i)}function o1(i){for(var o=i;;){if(o.flags&16384){var f=o.updateQueue;if(f!==null&&(f=f.stores,f!==null))for(var g=0;g<f.length;g++){var w=f[g],C=w.getSnapshot;w=w.value;try{if(!sr(C(),w))return!1}catch{return!1}}}if(f=o.child,o.subtreeFlags&16384&&f!==null)f.return=o,o=f;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function $o(i,o){for(o&=~Fh,o&=~Hf,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var f=31-ft(o),g=1<<f;i[f]=-1,o&=~g}}function cm(i){if((xt&6)!==0)throw Error(n(327));nu();var o=gs(i,0);if((o&1)===0)return Lr(i,Yt()),null;var f=Kf(i,o);if(i.tag!==0&&f===2){var g=no(i);g!==0&&(o=g,f=Uh(i,g))}if(f===1)throw f=oc,Nl(i,0),$o(i,o),Lr(i,Yt()),f;if(f===6)throw Error(n(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,zl(i,jr,$s),Lr(i,Yt()),null}function Hh(i,o){var f=xt;xt|=1;try{return i(o)}finally{xt=f,xt===0&&(tu=Yt()+500,wo&&qi())}}function Ll(i){Do!==null&&Do.tag===0&&(xt&6)===0&&nu();var o=xt;xt|=1;var f=ai.transition,g=yt;try{if(ai.transition=null,yt=1,i)return i()}finally{yt=g,ai.transition=f,xt=o,(xt&6)===0&&qi()}}function Vh(){qr=eu.current,At(eu)}function Nl(i,o){i.finishedWork=null,i.finishedLanes=0;var f=i.timeoutHandle;if(f!==-1&&(i.timeoutHandle=-1,Hu(f)),wn!==null)for(f=wn.return;f!==null;){var g=f;switch(xn(g),g.tag){case 1:g=g.type.childContextTypes,g!=null&&xo();break;case 3:Wt(),At(Ln),At(Rn),zn();break;case 5:Ei(g);break;case 4:Wt();break;case 13:At(Mt);break;case 19:At(Mt);break;case 10:Ba(g.type._context);break;case 22:case 23:Vh()}f=f.return}if($n=i,wn=i=Uo(i.current,null),tr=qr=o,In=0,oc=null,Fh=Hf=jl=0,jr=lc=null,ri!==null){for(o=0;o<ri.length;o++)if(f=ri[o],g=f.interleaved,g!==null){f.interleaved=null;var w=g.next,C=f.pending;if(C!==null){var A=C.next;C.next=w,g.next=A}f.pending=g}ri=null}return i}function fm(i,o){do{var f=wn;try{if(Da(),Ro.current=Mo,Vr){for(var g=Ct.memoizedState;g!==null;){var w=g.queue;w!==null&&(w.pending=null),g=g.next}Vr=!1}if(Zn=0,en=Qt=Ct=null,Gi=!1,Mr=0,zh.current=null,f===null||f.return===null){In=1,oc=o,wn=null;break}e:{var C=i,A=f.return,z=f,V=o;if(o=tr,z.flags|=32768,V!==null&&typeof V=="object"&&typeof V.then=="function"){var ne=V,ve=z,xe=ve.tag;if((ve.mode&1)===0&&(xe===0||xe===11||xe===15)){var ye=ve.alternate;ye?(ve.updateQueue=ye.updateQueue,ve.memoizedState=ye.memoizedState,ve.lanes=ye.lanes):(ve.updateQueue=null,ve.memoizedState=null)}var Fe=p(A);if(Fe!==null){Fe.flags&=-257,x(Fe,A,z,C,o),Fe.mode&1&&u(C,ne,o),o=Fe,V=ne;var Ue=o.updateQueue;if(Ue===null){var We=new Set;We.add(V),o.updateQueue=We}else Ue.add(V);break e}else{if((o&1)===0){u(C,ne,o),qh();break e}V=Error(n(426))}}else if(Et&&z.mode&1){var dn=p(A);if(dn!==null){(dn.flags&65536)===0&&(dn.flags|=256),x(dn,A,z,C,o),bl(Bs(V,z));break e}}C=V=Bs(V,z),In!==4&&(In=2),lc===null?lc=[C]:lc.push(C),C=A;do{switch(C.tag){case 3:C.flags|=65536,o&=-o,C.lanes|=o;var J=Bf(C,V,o);Ol(C,J);break e;case 1:z=V;var q=C.type,ee=C.stateNode;if((C.flags&128)===0&&(typeof q.getDerivedStateFromError=="function"||ee!==null&&typeof ee.componentDidCatch=="function"&&(Fo===null||!Fo.has(ee)))){C.flags|=65536,o&=-o,C.lanes|=o;var Ee=l(C,z,o);Ol(C,Ee);break e}}C=C.return}while(C!==null)}pm(f)}catch(Ve){o=Ve,wn===f&&f!==null&&(wn=f=f.return);continue}break}while(!0)}function dm(){var i=Wf.current;return Wf.current=Mo,i===null?Mo:i}function qh(){(In===0||In===3||In===2)&&(In=4),$n===null||(jl&268435455)===0&&(Hf&268435455)===0||$o($n,tr)}function Kf(i,o){var f=xt;xt|=2;var g=dm();($n!==i||tr!==o)&&($s=null,Nl(i,o));do try{l1();break}catch(w){fm(i,w)}while(!0);if(Da(),xt=f,Wf.current=g,wn!==null)throw Error(n(261));return $n=null,tr=0,In}function l1(){for(;wn!==null;)hm(wn)}function a1(){for(;wn!==null&&!wh();)hm(wn)}function hm(i){var o=ym(i.alternate,i,qr);i.memoizedProps=i.pendingProps,o===null?pm(i):wn=o,zh.current=null}function pm(i){var o=i;do{var f=o.alternate;if(i=o.return,(o.flags&32768)===0){if(f=e1(f,o,qr),f!==null){wn=f;return}}else{if(f=t1(f,o),f!==null){f.flags&=32767,wn=f;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{In=6,wn=null;return}}if(o=o.sibling,o!==null){wn=o;return}wn=o=i}while(o!==null);In===0&&(In=5)}function zl(i,o,f){var g=yt,w=ai.transition;try{ai.transition=null,yt=1,u1(i,o,f,g)}finally{ai.transition=w,yt=g}return null}function u1(i,o,f,g){do nu();while(Do!==null);if((xt&6)!==0)throw Error(n(327));f=i.finishedWork;var w=i.finishedLanes;if(f===null)return null;if(i.finishedWork=null,i.finishedLanes=0,f===i.current)throw Error(n(177));i.callbackNode=null,i.callbackPriority=0;var C=f.lanes|f.childLanes;if(Eh(i,C),i===$n&&(wn=$n=null,tr=0),(f.subtreeFlags&2064)===0&&(f.flags&2064)===0||qf||(qf=!0,vm(to,function(){return nu(),null})),C=(f.flags&15990)!==0,(f.subtreeFlags&15990)!==0||C){C=ai.transition,ai.transition=null;var A=yt;yt=1;var z=xt;xt|=4,zh.current=null,r1(i,f),im(f,i),yl(Uu),da=!!$u,Uu=$u=null,i.current=f,i1(f),Sh(),xt=z,yt=A,ai.transition=C}else i.current=f;if(qf&&(qf=!1,Do=i,Qf=w),C=i.pendingLanes,C===0&&(Fo=null),Lt(f.stateNode),Lr(i,Yt()),o!==null)for(g=i.onRecoverableError,f=0;f<o.length;f++)w=o[f],g(w.value,{componentStack:w.stack,digest:w.digest});if(Vf)throw Vf=!1,i=Bh,Bh=null,i;return(Qf&1)!==0&&i.tag!==0&&nu(),C=i.pendingLanes,(C&1)!==0?i===$h?ac++:(ac=0,$h=i):ac=0,qi(),null}function nu(){if(Do!==null){var i=ul(Qf),o=ai.transition,f=yt;try{if(ai.transition=null,yt=16>i?16:i,Do===null)var g=!1;else{if(i=Do,Do=null,Qf=0,(xt&6)!==0)throw Error(n(331));var w=xt;for(xt|=4,$e=i.current;$e!==null;){var C=$e,A=C.child;if(($e.flags&16)!==0){var z=C.deletions;if(z!==null){for(var V=0;V<z.length;V++){var ne=z[V];for($e=ne;$e!==null;){var ve=$e;switch(ve.tag){case 0:case 11:case 15:sc(8,ve,C)}var xe=ve.child;if(xe!==null)xe.return=ve,$e=xe;else for(;$e!==null;){ve=$e;var ye=ve.sibling,Fe=ve.return;if(Jg(ve),ve===ne){$e=null;break}if(ye!==null){ye.return=Fe,$e=ye;break}$e=Fe}}}var Ue=C.alternate;if(Ue!==null){var We=Ue.child;if(We!==null){Ue.child=null;do{var dn=We.sibling;We.sibling=null,We=dn}while(We!==null)}}$e=C}}if((C.subtreeFlags&2064)!==0&&A!==null)A.return=C,$e=A;else e:for(;$e!==null;){if(C=$e,(C.flags&2048)!==0)switch(C.tag){case 0:case 11:case 15:sc(9,C,C.return)}var J=C.sibling;if(J!==null){J.return=C.return,$e=J;break e}$e=C.return}}var q=i.current;for($e=q;$e!==null;){A=$e;var ee=A.child;if((A.subtreeFlags&2064)!==0&&ee!==null)ee.return=A,$e=ee;else e:for(A=q;$e!==null;){if(z=$e,(z.flags&2048)!==0)try{switch(z.tag){case 0:case 11:case 15:Uf(9,z)}}catch(Ve){nn(z,z.return,Ve)}if(z===A){$e=null;break e}var Ee=z.sibling;if(Ee!==null){Ee.return=z.return,$e=Ee;break e}$e=z.return}}if(xt=w,qi(),kn&&typeof kn.onPostCommitFiberRoot=="function")try{kn.onPostCommitFiberRoot(hi,i)}catch{}g=!0}return g}finally{yt=f,ai.transition=o}}return!1}function gm(i,o,f){o=Bs(f,o),o=Bf(i,o,1),i=oi(i,o,1),o=kr(),i!==null&&(al(i,1,o),Lr(i,o))}function nn(i,o,f){if(i.tag===3)gm(i,i,f);else for(;o!==null;){if(o.tag===3){gm(o,i,f);break}else if(o.tag===1){var g=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof g.componentDidCatch=="function"&&(Fo===null||!Fo.has(g))){i=Bs(f,i),i=l(o,i,1),o=oi(o,i,1),i=kr(),o!==null&&(al(o,1,i),Lr(o,i));break}}o=o.return}}function c1(i,o,f){var g=i.pingCache;g!==null&&g.delete(o),o=kr(),i.pingedLanes|=i.suspendedLanes&f,$n===i&&(tr&f)===f&&(In===4||In===3&&(tr&130023424)===tr&&500>Yt()-Dh?Nl(i,0):Fh|=f),Lr(i,o)}function mm(i,o){o===0&&((i.mode&1)===0?o=1:(o=pi,pi<<=1,(pi&130023424)===0&&(pi=4194304)));var f=kr();i=Pr(i,o),i!==null&&(al(i,o,f),Lr(i,f))}function f1(i){var o=i.memoizedState,f=0;o!==null&&(f=o.retryLane),mm(i,f)}function d1(i,o){var f=0;switch(i.tag){case 13:var g=i.stateNode,w=i.memoizedState;w!==null&&(f=w.retryLane);break;case 19:g=i.stateNode;break;default:throw Error(n(314))}g!==null&&g.delete(o),mm(i,f)}var ym;ym=function(i,o,f){if(i!==null)if(i.memoizedProps!==o.pendingProps||Ln.current)b=!0;else{if((i.lanes&f)===0&&(o.flags&128)===0)return b=!1,Oh(i,o,f);b=(i.flags&131072)!==0}else b=!1,Et&&(o.flags&1048576)!==0&&_f(o,Xi,o.index);switch(o.lanes=0,o.tag){case 2:var g=o.type;pt(i,o),i=o.pendingProps;var w=Os(o,Rn.current);Pi(o,f),w=_o(null,o,g,i,w,f);var C=Io();return o.flags|=1,typeof w=="object"&&w!==null&&typeof w.render=="function"&&w.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Nn(g)?(C=!0,As(o)):C=!1,o.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,Il(o),w.updater=Lo,o.stateNode=w,w._reactInternals=o,Ga(o,g,i,f),o=kt(null,o,g,!0,C,f)):(o.tag=0,Et&&C&&So(o),j(null,o,w,f),o=o.child),o;case 16:g=o.elementType;e:{switch(pt(i,o),i=o.pendingProps,w=g._init,g=w(g._payload),o.type=g,w=o.tag=p1(g),i=_n(g,i),w){case 0:o=_e(null,o,g,i,f);break e;case 1:o=jt(null,o,g,i,f);break e;case 11:o=X(null,o,g,i,f);break e;case 14:o=ie(null,o,g,_n(g.type,i),f);break e}throw Error(n(306,g,""))}return o;case 0:return g=o.type,w=o.pendingProps,w=o.elementType===g?w:_n(g,w),_e(i,o,g,w,f);case 1:return g=o.type,w=o.pendingProps,w=o.elementType===g?w:_n(g,w),jt(i,o,g,w,f);case 3:e:{if(Jn(o),i===null)throw Error(n(387));g=o.pendingProps,C=o.memoizedState,w=C.element,Ua(i,o),Co(o,g,null,f);var A=o.memoizedState;if(g=A.element,C.isDehydrated)if(C={element:g,isDehydrated:!1,cache:A.cache,pendingSuspenseBoundaries:A.pendingSuspenseBoundaries,transitions:A.transitions},o.updateQueue.baseState=C,o.memoizedState=C,o.flags&256){w=Bs(Error(n(423)),o),o=li(i,o,g,f,w);break e}else if(g!==w){w=Bs(Error(n(424)),o),o=li(i,o,g,f,w);break e}else for(Ce=Jr(o.stateNode.containerInfo.firstChild),xr=o,Et=!0,wr=null,f=Ar(o,null,g,f),o.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling;else{if(Ns(),g===w){o=Bn(i,o,f);break e}j(i,o,g,f)}o=o.child}return o;case 5:return To(o),i===null&&Po(o),g=o.type,w=o.pendingProps,C=i!==null?i.memoizedProps:null,A=w.children,Wu(g,w)?A=null:C!==null&&Wu(g,C)&&(o.flags|=32),nt(i,o),j(i,o,A,f),o.child;case 6:return i===null&&Po(o),null;case 13:return ce(i,o,f);case 4:return Ki(o,o.stateNode.containerInfo),g=o.pendingProps,i===null?o.child=zs(o,null,g,f):j(i,o,g,f),o.child;case 11:return g=o.type,w=o.pendingProps,w=o.elementType===g?w:_n(g,w),X(i,o,g,w,f);case 7:return j(i,o,o.pendingProps,f),o.child;case 8:return j(i,o,o.pendingProps.children,f),o.child;case 12:return j(i,o,o.pendingProps.children,f),o.child;case 10:e:{if(g=o.type._context,w=o.pendingProps,C=o.memoizedProps,A=w.value,_t(Rl,g._currentValue),g._currentValue=A,C!==null)if(sr(C.value,A)){if(C.children===w.children&&!Ln.current){o=Bn(i,o,f);break e}}else for(C=o.child,C!==null&&(C.return=o);C!==null;){var z=C.dependencies;if(z!==null){A=C.child;for(var V=z.firstContext;V!==null;){if(V.context===g){if(C.tag===1){V=si(-1,f&-f),V.tag=2;var ne=C.updateQueue;if(ne!==null){ne=ne.shared;var ve=ne.pending;ve===null?V.next=V:(V.next=ve.next,ve.next=V),ne.pending=V}}C.lanes|=f,V=C.alternate,V!==null&&(V.lanes|=f),$a(C.return,f,o),z.lanes|=f;break}V=V.next}}else if(C.tag===10)A=C.type===o.type?null:C.child;else if(C.tag===18){if(A=C.return,A===null)throw Error(n(341));A.lanes|=f,z=A.alternate,z!==null&&(z.lanes|=f),$a(A,f,o),A=C.sibling}else A=C.child;if(A!==null)A.return=C;else for(A=C;A!==null;){if(A===o){A=null;break}if(C=A.sibling,C!==null){C.return=A.return,A=C;break}A=A.return}C=A}j(i,o,w.children,f),o=o.child}return o;case 9:return w=o.type,g=o.pendingProps.children,Pi(o,f),w=Gn(w),g=g(w),o.flags|=1,j(i,o,g,f),o.child;case 14:return g=o.type,w=_n(g,o.pendingProps),w=_n(g.type,w),ie(i,o,g,w,f);case 15:return Pe(i,o,o.type,o.pendingProps,f);case 17:return g=o.type,w=o.pendingProps,w=o.elementType===g?w:_n(g,w),pt(i,o),o.tag=1,Nn(g)?(i=!0,As(o)):i=!1,Pi(o,f),Df(o,g,w),Ga(o,g,w,f),kt(null,o,g,!0,i,f);case 19:return fn(i,o,f);case 22:return Be(i,o,f)}throw Error(n(156,o.tag))};function vm(i,o){return ef(i,o)}function h1(i,o,f,g){this.tag=i,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=g,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ui(i,o,f,g){return new h1(i,o,f,g)}function Qh(i){return i=i.prototype,!(!i||!i.isReactComponent)}function p1(i){if(typeof i=="function")return Qh(i)?1:0;if(i!=null){if(i=i.$$typeof,i===de)return 11;if(i===Ie)return 14}return 2}function Uo(i,o){var f=i.alternate;return f===null?(f=ui(i.tag,o,i.key,i.mode),f.elementType=i.elementType,f.type=i.type,f.stateNode=i.stateNode,f.alternate=i,i.alternate=f):(f.pendingProps=o,f.type=i.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=i.flags&14680064,f.childLanes=i.childLanes,f.lanes=i.lanes,f.child=i.child,f.memoizedProps=i.memoizedProps,f.memoizedState=i.memoizedState,f.updateQueue=i.updateQueue,o=i.dependencies,f.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},f.sibling=i.sibling,f.index=i.index,f.ref=i.ref,f}function Gf(i,o,f,g,w,C){var A=2;if(g=i,typeof i=="function")Qh(i)&&(A=1);else if(typeof i=="string")A=5;else e:switch(i){case se:return Fl(f.children,w,C,o);case oe:A=8,w|=8;break;case me:return i=ui(12,f,o,w|2),i.elementType=me,i.lanes=C,i;case we:return i=ui(13,f,o,w),i.elementType=we,i.lanes=C,i;case le:return i=ui(19,f,o,w),i.elementType=le,i.lanes=C,i;case Te:return Zf(f,w,C,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case K:A=10;break e;case ge:A=9;break e;case de:A=11;break e;case Ie:A=14;break e;case Se:A=16,g=null;break e}throw Error(n(130,i==null?i:typeof i,""))}return o=ui(A,f,o,w),o.elementType=i,o.type=g,o.lanes=C,o}function Fl(i,o,f,g){return i=ui(7,i,g,o),i.lanes=f,i}function Zf(i,o,f,g){return i=ui(22,i,g,o),i.elementType=Te,i.lanes=f,i.stateNode={isHidden:!1},i}function Xh(i,o,f){return i=ui(6,i,null,o),i.lanes=f,i}function Yh(i,o,f){return o=ui(4,i.children!==null?i.children:[],i.key,o),o.lanes=f,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function g1(i,o,f,g,w){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=dr(0),this.expirationTimes=dr(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=dr(0),this.identifierPrefix=g,this.onRecoverableError=w,this.mutableSourceEagerHydrationData=null}function Kh(i,o,f,g,w,C,A,z,V){return i=new g1(i,o,f,z,V),o===1?(o=1,C===!0&&(o|=8)):o=0,C=ui(3,null,null,o),i.current=C,C.stateNode=i,C.memoizedState={element:g,isDehydrated:f,cache:null,transitions:null,pendingSuspenseBoundaries:null},Il(C),i}function m1(i,o,f){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:H,key:g==null?null:""+g,children:i,containerInfo:o,implementation:f}}function xm(i){if(!i)return ti;i=i._reactInternals;e:{if(hs(i)!==i||i.tag!==1)throw Error(n(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Nn(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(n(171))}if(i.tag===1){var f=i.type;if(Nn(f))return ja(i,f,o)}return o}function wm(i,o,f,g,w,C,A,z,V){return i=Kh(f,g,!0,i,w,C,A,z,V),i.context=xm(null),f=i.current,g=kr(),w=Bo(f),C=si(g,w),C.callback=o??null,oi(f,C,w),i.current.lanes=w,al(i,w,g),Lr(i,g),i}function Jf(i,o,f,g){var w=o.current,C=kr(),A=Bo(w);return f=xm(f),o.context===null?o.context=f:o.pendingContext=f,o=si(C,A),o.payload={element:i},g=g===void 0?null:g,g!==null&&(o.callback=g),i=oi(w,o,A),i!==null&&(Ri(i,w,A,C),Wa(i,w,A)),A}function ed(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Sm(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var f=i.retryLane;i.retryLane=f!==0&&f<o?f:o}}function Gh(i,o){Sm(i,o),(i=i.alternate)&&Sm(i,o)}function y1(){return null}var Pm=typeof reportError=="function"?reportError:function(i){console.error(i)};function Zh(i){this._internalRoot=i}td.prototype.render=Zh.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(n(409));Jf(i,o,null,null)},td.prototype.unmount=Zh.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Ll(function(){Jf(null,i,null,null)}),o[ei]=null}};function td(i){this._internalRoot=i}td.prototype.unstable_scheduleHydration=function(i){if(i){var o=of();i={blockedOn:null,target:i,priority:o};for(var f=0;f<Zr.length&&o!==0&&o<Zr[f].priority;f++);Zr.splice(f,0,i),f===0&&ua(i)}};function Jh(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function nd(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function Em(){}function v1(i,o,f,g,w){if(w){if(typeof g=="function"){var C=g;g=function(){var ne=ed(A);C.call(ne)}}var A=wm(o,g,i,0,null,!1,!1,"",Em);return i._reactRootContainer=A,i[ei]=A.current,Ts(i.nodeType===8?i.parentNode:i),Ll(),A}for(;w=i.lastChild;)i.removeChild(w);if(typeof g=="function"){var z=g;g=function(){var ne=ed(V);z.call(ne)}}var V=Kh(i,0,!1,null,null,!1,!1,"",Em);return i._reactRootContainer=V,i[ei]=V.current,Ts(i.nodeType===8?i.parentNode:i),Ll(function(){Jf(o,V,f,g)}),V}function rd(i,o,f,g,w){var C=f._reactRootContainer;if(C){var A=C;if(typeof w=="function"){var z=w;w=function(){var V=ed(A);z.call(V)}}Jf(o,A,i,w)}else A=v1(f,o,i,w,g);return ed(A)}ro=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var f=gn(o.pendingLanes);f!==0&&(wu(o,f|1),Lr(o,Yt()),(xt&6)===0&&(tu=Yt()+500,qi()))}break;case 13:Ll(function(){var g=Pr(i,1);if(g!==null){var w=kr();Ri(g,i,1,w)}}),Gh(i,1)}},io=function(i){if(i.tag===13){var o=Pr(i,134217728);if(o!==null){var f=kr();Ri(o,i,134217728,f)}Gh(i,134217728)}},sf=function(i){if(i.tag===13){var o=Bo(i),f=Pr(i,o);if(f!==null){var g=kr();Ri(f,i,o,g)}Gh(i,o)}},of=function(){return yt},la=function(i,o){var f=yt;try{return yt=i,o()}finally{yt=f}},Pt=function(i,o,f){switch(o){case"input":if(Mn(i,f),o=f.name,f.type==="radio"&&o!=null){for(f=i;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<f.length;o++){var g=f[o];if(g!==i&&g.form===i.form){var w=vn(g);if(!w)throw Error(n(90));ze(g),Mn(g,w)}}}break;case"textarea":ke(i,f);break;case"select":o=f.value,o!=null&&br(i,!!f.multiple,o,!1)}},us=Hh,cs=Ll;var x1={usingClientEntryPoint:!1,Events:[kl,an,vn,Yr,Fr,Hh]},uc={findFiberByHostInstance:Hi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},w1={bundleType:uc.bundleType,version:uc.version,rendererPackageName:uc.rendererPackageName,rendererConfig:uc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Zc(i),i===null?null:i.stateNode},findFiberByHostInstance:uc.findFiberByHostInstance||y1,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var id=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!id.isDisabled&&id.supportsFiber)try{hi=id.inject(w1),kn=id}catch{}}return Nr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=x1,Nr.createPortal=function(i,o){var f=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Jh(o))throw Error(n(200));return m1(i,o,null,f)},Nr.createRoot=function(i,o){if(!Jh(i))throw Error(n(299));var f=!1,g="",w=Pm;return o!=null&&(o.unstable_strictMode===!0&&(f=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onRecoverableError!==void 0&&(w=o.onRecoverableError)),o=Kh(i,1,!1,null,null,f,!1,g,w),i[ei]=o.current,Ts(i.nodeType===8?i.parentNode:i),new Zh(o)},Nr.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(n(188)):(i=Object.keys(i).join(","),Error(n(268,i)));return i=Zc(o),i=i===null?null:i.stateNode,i},Nr.flushSync=function(i){return Ll(i)},Nr.hydrate=function(i,o,f){if(!nd(o))throw Error(n(200));return rd(null,i,o,!0,f)},Nr.hydrateRoot=function(i,o,f){if(!Jh(i))throw Error(n(405));var g=f!=null&&f.hydratedSources||null,w=!1,C="",A=Pm;if(f!=null&&(f.unstable_strictMode===!0&&(w=!0),f.identifierPrefix!==void 0&&(C=f.identifierPrefix),f.onRecoverableError!==void 0&&(A=f.onRecoverableError)),o=wm(o,null,i,1,f??null,w,!1,C,A),i[ei]=o.current,Ts(i),g)for(i=0;i<g.length;i++)f=g[i],w=f._getVersion,w=w(f._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[f,w]:o.mutableSourceEagerHydrationData.push(f,w);return new td(o)},Nr.render=function(i,o,f){if(!nd(o))throw Error(n(200));return rd(null,i,o,!1,f)},Nr.unmountComponentAtNode=function(i){if(!nd(i))throw Error(n(40));return i._reactRootContainer?(Ll(function(){rd(null,null,i,!1,function(){i._reactRootContainer=null,i[ei]=null})}),!0):!1},Nr.unstable_batchedUpdates=Hh,Nr.unstable_renderSubtreeIntoContainer=function(i,o,f,g){if(!nd(f))throw Error(n(200));if(i==null||i._reactInternals===void 0)throw Error(n(38));return rd(i,o,f,!1,g)},Nr.version="18.3.1-next-f1338f8080-20240426",Nr}var Om;function cv(){if(Om)return np.exports;Om=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),np.exports=b1(),np.exports}var Am;function R1(){if(Am)return sd;Am=1;var t=cv();return sd.createRoot=t.createRoot,sd.hydrateRoot=t.hydrateRoot,sd}var yg=R1();const _1=Jl(yg),I1=Wd({__proto__:null,default:_1},[yg]),fv="%[a-f0-9]{2}",Mm=new RegExp("("+fv+")|([^%]+?)","gi"),jm=new RegExp("("+fv+")+","gi");function $p(t,e){try{return[decodeURIComponent(t.join(""))]}catch{}if(t.length===1)return t;e=e||1;const n=t.slice(0,e),r=t.slice(e);return Array.prototype.concat.call([],$p(n),$p(r))}function O1(t){try{return decodeURIComponent(t)}catch{let e=t.match(Mm)||[];for(let n=1;n<e.length;n++)t=$p(e,n).join(""),e=t.match(Mm)||[];return t}}function A1(t){const e={"%FE%FF":"","%FF%FE":""};let n=jm.exec(t);for(;n;){try{e[n[0]]=decodeURIComponent(n[0])}catch{const s=O1(n[0]);s!==n[0]&&(e[n[0]]=s)}n=jm.exec(t)}e["%C2"]="";const r=Object.keys(e);for(const s of r)t=t.replace(new RegExp(s,"g"),e[s]);return t}function M1(t){if(typeof t!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return decodeURIComponent(t)}catch{return A1(t)}}function j1(t,e){const n={};if(Array.isArray(e))for(const r of e){const s=Object.getOwnPropertyDescriptor(t,r);s?.enumerable&&Object.defineProperty(n,r,s)}else for(const r of Reflect.ownKeys(t)){const s=Object.getOwnPropertyDescriptor(t,r);if(s.enumerable){const a=t[r];e(r,a,t)&&Object.defineProperty(n,r,s)}}return n}function dv(t,e){if(!(typeof t=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t===""||e==="")return[];const n=t.indexOf(e);return n===-1?[]:[t.slice(0,n),t.slice(n+e.length)]}const L1=t=>t==null,N1=t=>encodeURIComponent(t).replaceAll(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),Up=Symbol("encodeFragmentIdentifier");function z1(t){switch(t.arrayFormat){case"index":return e=>(n,r)=>{const s=n.length;return r===void 0||t.skipNull&&r===null||t.skipEmptyString&&r===""?n:r===null?[...n,[Sn(e,t),"[",s,"]"].join("")]:[...n,[Sn(e,t),"[",Sn(s,t),"]=",Sn(r,t)].join("")]};case"bracket":return e=>(n,r)=>r===void 0||t.skipNull&&r===null||t.skipEmptyString&&r===""?n:r===null?[...n,[Sn(e,t),"[]"].join("")]:[...n,[Sn(e,t),"[]=",Sn(r,t)].join("")];case"colon-list-separator":return e=>(n,r)=>r===void 0||t.skipNull&&r===null||t.skipEmptyString&&r===""?n:r===null?[...n,[Sn(e,t),":list="].join("")]:[...n,[Sn(e,t),":list=",Sn(r,t)].join("")];case"comma":case"separator":case"bracket-separator":{const e=t.arrayFormat==="bracket-separator"?"[]=":"=";return n=>(r,s)=>s===void 0||t.skipNull&&s===null||t.skipEmptyString&&s===""?r:(s=s===null?"":s,r.length===0?[[Sn(n,t),e,Sn(s,t)].join("")]:[[r,Sn(s,t)].join(t.arrayFormatSeparator)])}default:return e=>(n,r)=>r===void 0||t.skipNull&&r===null||t.skipEmptyString&&r===""?n:r===null?[...n,Sn(e,t)]:[...n,[Sn(e,t),"=",Sn(r,t)].join("")]}}function F1(t){let e;switch(t.arrayFormat){case"index":return(n,r,s)=>{if(e=/\[(\d*)]$/.exec(n),n=n.replace(/\[\d*]$/,""),!e){s[n]=r;return}s[n]===void 0&&(s[n]={}),s[n][e[1]]=r};case"bracket":return(n,r,s)=>{if(e=/(\[])$/.exec(n),n=n.replace(/\[]$/,""),!e){s[n]=r;return}if(s[n]===void 0){s[n]=[r];return}s[n]=[...s[n],r]};case"colon-list-separator":return(n,r,s)=>{if(e=/(:list)$/.exec(n),n=n.replace(/:list$/,""),!e){s[n]=r;return}if(s[n]===void 0){s[n]=[r];return}s[n]=[...s[n],r]};case"comma":case"separator":return(n,r,s)=>{const c=typeof r=="string"&&r.includes(t.arrayFormatSeparator)?r.split(t.arrayFormatSeparator).map(d=>Ql(d,t)):r===null?r:Ql(r,t);s[n]=c};case"bracket-separator":return(n,r,s)=>{const a=/(\[])$/.test(n);if(n=n.replace(/\[]$/,""),!a){s[n]=r&&Ql(r,t);return}const c=r===null?[]:Ql(r,t).split(t.arrayFormatSeparator);if(s[n]===void 0){s[n]=c;return}s[n]=[...s[n],...c]};default:return(n,r,s)=>{if(s[n]===void 0){s[n]=r;return}s[n]=[...[s[n]].flat(),r]}}}function hv(t){if(typeof t!="string"||t.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function Sn(t,e){return e.encode?e.strict?N1(t):encodeURIComponent(t):t}function Ql(t,e){return e.decode?M1(t):t}function pv(t){return Array.isArray(t)?t.sort():typeof t=="object"?pv(Object.keys(t)).sort((e,n)=>Number(e)-Number(n)).map(e=>t[e]):t}function gv(t){const e=t.indexOf("#");return e!==-1&&(t=t.slice(0,e)),t}function D1(t){let e="";const n=t.indexOf("#");return n!==-1&&(e=t.slice(n)),e}function Lm(t,e,n){return n==="string"&&typeof t=="string"?t:typeof n=="function"&&typeof t=="string"?n(t):n==="boolean"&&t===null?!0:n==="boolean"&&t!==null&&(t.toLowerCase()==="true"||t.toLowerCase()==="false")?t.toLowerCase()==="true":n==="boolean"&&t!==null&&(t.toLowerCase()==="1"||t.toLowerCase()==="0")?t.toLowerCase()==="1":n==="string[]"&&e.arrayFormat!=="none"&&typeof t=="string"?[t]:n==="number[]"&&e.arrayFormat!=="none"&&!Number.isNaN(Number(t))&&typeof t=="string"&&t.trim()!==""?[Number(t)]:n==="number"&&!Number.isNaN(Number(t))&&typeof t=="string"&&t.trim()!==""?Number(t):e.parseBooleans&&t!==null&&(t.toLowerCase()==="true"||t.toLowerCase()==="false")?t.toLowerCase()==="true":e.parseNumbers&&!Number.isNaN(Number(t))&&typeof t=="string"&&t.trim()!==""?Number(t):t}function vg(t){t=gv(t);const e=t.indexOf("?");return e===-1?"":t.slice(e+1)}function xg(t,e){e={decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1,types:Object.create(null),...e},hv(e.arrayFormatSeparator);const n=F1(e),r=Object.create(null);if(typeof t!="string"||(t=t.trim().replace(/^[?#&]/,""),!t))return r;for(const s of t.split("&")){if(s==="")continue;const a=e.decode?s.replaceAll("+"," "):s;let[c,d]=dv(a,"=");c===void 0&&(c=a),d=d===void 0?null:["comma","separator","bracket-separator"].includes(e.arrayFormat)?d:Ql(d,e),n(Ql(c,e),d,r)}for(const[s,a]of Object.entries(r))if(typeof a=="object"&&a!==null&&e.types[s]!=="string")for(const[c,d]of Object.entries(a)){const m=e.types[s],y=typeof m=="function"?m:m?m.replace("[]",""):void 0;a[c]=Lm(d,e,y)}else typeof a=="object"&&a!==null&&e.types[s]==="string"?r[s]=Object.values(a).join(e.arrayFormatSeparator):r[s]=Lm(a,e,e.types[s]);return e.sort===!1?r:(e.sort===!0?Object.keys(r).sort():Object.keys(r).sort(e.sort)).reduce((s,a)=>{const c=r[a];return s[a]=c&&typeof c=="object"&&!Array.isArray(c)?pv(c):c,s},Object.create(null))}function mv(t,e){if(!t)return"";e={encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:",",...e},hv(e.arrayFormatSeparator);const n=c=>e.skipNull&&L1(t[c])||e.skipEmptyString&&t[c]==="",r=z1(e),s={};for(const[c,d]of Object.entries(t))n(c)||(s[c]=d);const a=Object.keys(s);return e.sort!==!1&&a.sort(e.sort),a.map(c=>{let d=t[c];if(e.replacer&&(d=e.replacer(c,d),d===void 0)||d===void 0)return"";if(d===null)return Sn(c,e);if(Array.isArray(d)){if(d.length===0&&e.arrayFormat==="bracket-separator")return Sn(c,e)+"[]";let m=d;return e.replacer&&(m=d.map((y,h)=>e.replacer(`${c}[${h}]`,y)).filter(y=>y!==void 0)),m.reduce(r(c),[]).join("&")}return Sn(c,e)+"="+Sn(d,e)}).filter(c=>c.length>0).join("&")}function yv(t,e){e={decode:!0,...e};let[n,r]=dv(t,"#");return n===void 0&&(n=t),{url:n?.split("?")?.[0]??"",query:xg(vg(t),e),...e&&e.parseFragmentIdentifier&&r?{fragmentIdentifier:Ql(r,e)}:{}}}function vv(t,e){e={encode:!0,strict:!0,[Up]:!0,...e};const n=gv(t.url).split("?")[0]||"",r=vg(t.url),s={...xg(r,{sort:!1,...e}),...t.query};let a=mv(s,e);a&&=`?${a}`;let c=D1(t.url);if(typeof t.fragmentIdentifier=="string"){const d=new URL(n);d.hash=t.fragmentIdentifier,c=e[Up]?d.hash:`#${t.fragmentIdentifier}`}return`${n}${a}${c}`}function xv(t,e,n){n={parseFragmentIdentifier:!0,[Up]:!1,...n};const{url:r,query:s,fragmentIdentifier:a}=yv(t,n);return vv({url:r,query:j1(s,e),fragmentIdentifier:a},n)}function B1(t,e,n){const r=Array.isArray(e)?s=>!e.includes(s):(s,a)=>!e(s,a);return xv(t,r,n)}const Wp=Object.freeze(Object.defineProperty({__proto__:null,exclude:B1,extract:vg,parse:xg,parseUrl:yv,pick:xv,stringify:mv,stringifyUrl:vv},Symbol.toStringTag,{value:"Module"}));function Ac(t){"@babel/helpers - typeof";return Ac=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ac(t)}function $1(t,e){if(Ac(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Ac(r)!="object")return r;throw TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function U1(t){var e=$1(t,"string");return Ac(e)=="symbol"?e:e+""}function ur(t,e,n){return(e=U1(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var W1=Object.create,wv=Object.defineProperty,H1=Object.getOwnPropertyDescriptor,V1=Object.getOwnPropertyNames,q1=Object.getPrototypeOf,Q1=Object.prototype.hasOwnProperty,Sv=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),X1=(t,e,n,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(var s=V1(e),a=0,c=s.length,d;a<c;a++)d=s[a],!Q1.call(t,d)&&d!==n&&wv(t,d,{get:(m=>e[m]).bind(null,d),enumerable:!(r=H1(e,d))||r.enumerable});return t},Pv=(t,e,n)=>(n=t==null?{}:W1(q1(t)),X1(wv(n,"default",{value:t,enumerable:!0}),t));function Y1(t,e,n,r=1){return new Ev(t,e,n).subdivide(r)}function K1(t,e,n,r,s=1){return new Z1(new Float64Array([t.x,t.y,e.x,e.y,n.x,n.y,r.x,r.y])).subdivide(s)}function G1(t){return t.x*t.x+t.y*t.y}function Sc(t){let e=.67;return t/(1-e+(e**4+.25*t*t)**.25)}function uu(t){let e=.39;return t*(1-e+Math.sqrt(e*e+.25*t*t))}var Ev=class{constructor(e,n,r){ur(this,"start",void 0),ur(this,"control",void 0),ur(this,"end",void 0),this.start=e,this.control=n,this.end=r}eval(e){let n=1-e;return{x:this.start.x*n*n+2*this.control.x*n*e+this.end.x*e*e,y:this.start.y*n*n+2*this.control.y*n*e+this.end.y*e*e}}mapToBasic(){let{x:e,y:n}=this.start,{x:r,y:s}=this.control,{x:a,y:c}=this.end,d=2*r-e-a,m=2*s-n-c,y=(r-e)*d+(s-n)*m,h=(a-r)*d+(c-s)*m,v=(a-e)*m-(c-n)*d,E=y/v,T=h/v,P=Math.abs(v)/(Math.hypot(d,m)*Math.abs(T-E));return{x0:e,x2:a,scale:P,cross:v}}subdivide(e){let n=this.mapToBasic(),r=Sc(n.x0),s=Sc(n.x2),a=.5*Math.abs(s-r)*Math.sqrt(n.scale/e),c=Math.ceil(a),d=uu(r),m=uu(s),y=[0];for(let h=1;h<c;h++){let v=uu(r+(s-r)*h/c),E=(v-d)/(m-d);y.push(E)}return y.push(1),y.map(h=>this.eval(h))}},Z1=class kv{constructor(e){ur(this,"c",void 0),this.c=e}weightsum(e,n,r,s){let a=e*this.c[0]+n*this.c[2]+r*this.c[4]+s*this.c[6],c=e*this.c[1]+n*this.c[3]+r*this.c[5]+s*this.c[7];return{x:a,y:c}}eval(e){let n=1-e,r=n*n*n,s=3*n*n*e,a=3*n*e*e,c=e*e*e;return this.weightsum(r,s,a,c)}deriv(e){let n=1-e,r=-3*n*n,s=3*e*e,a=-6*e*n-r,c=6*e*n-s;return this.weightsum(r,a,c,s)}midpoint_quadbez(){let e=this.weightsum(-.25,.75,.75,-.25);return new Ev({x:this.c[0],y:this.c[1]},e,{x:this.c[6],y:this.c[7]})}subsegment(e,n){let r=new Float64Array(8),s=this.eval(e),a=this.eval(n);r[0]=s.x,r[1]=s.y;let c=(n-e)/3,d=this.deriv(e);r[2]=s.x+c*d.x,r[3]=s.y+c*d.y;let m=this.deriv(n);return r[4]=a.x-c*m.x,r[5]=a.y-c*m.y,r[6]=a.x,r[7]=a.y,new kv(r)}subdivide(e){let n=.1*e,r=e-n,s=Math.sqrt(r),a=G1(this.weightsum(1,-3,3,-1)),c=Math.ceil((a/(432*n*n))**(1/6)),d=[],m=0;for(let P=0;P<c;P++){let k=P/c,R=(P+1)/c,_=this.subsegment(k,R).midpoint_quadbez(),M=_.mapToBasic(),L=Sc(M.x0),$=Sc(M.x2),F=Math.sqrt(M.scale),H=Math.abs($-L)*F;if(Math.sign(M.x0)!=Math.sign(M.x2)){let se=s/F,oe=s*Math.abs($-L)/Sc(se);H=Math.max(H,oe)}d.push({quad:_,a0:L,a2:$,val:H}),m+=H}let y=.5*m/s,h=Math.ceil(y),v=[{x:this.c[0],y:this.c[1]}],E=0,T=0;for(let P=1;P<h;P++){let k=m*P/h;for(;E+d[T].val<k;)E+=d[T].val,T++;let R=d[T].a0,_=d[T].a2,M=uu(R),L=uu(_),$=R+(_-R)*(k-E)/d[T].val,F=uu($),H=(F-M)/(L-M);v.push(d[T].quad.eval(H))}return v.push({x:this.c[6],y:this.c[7]}),v}};function J1(t){let e={},n=t.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\s+/g," ").trim(),r=/([^{]+)\{([^}]+)\}/g,s;for(;(s=r.exec(n))!==null;){let a=s[1].trim(),c=s[2].trim(),d=a.match(/\.([a-zA-Z0-9_-]+)/);if(!d)continue;let m=d[1],y=c.split(";").filter(v=>v.trim()),h={};for(let v of y){let[E,T]=v.split(":").map(P=>P.trim());if(!(!E||!T))switch(E){case"background-color":h.backgroundColor=T;break;case"opacity":h.opacity=parseFloat(T);break;case"box-shadow":h.boxShadow=T;break;case"border-color":h.borderColor=T;break;case"border-width":h.borderWidth=T;break;case"border-style":h.borderStyle=T;break;case"outline-color":h.outlineColor=T;break;case"outline-width":h.outlineWidth=T;break;case"outline-offset":h.outlineOffset=T;break;case"outline-style":h.outlineStyle=T;break;case"border":h.border=T;break;case"outline":h.outline=T;break;case"background":h.background=T;break}}e[m]=h}return e}function Nm(t){let e={};return t&&(t.fill&&(e.backgroundColor=t.fill,t.fillOpacity),t.stroke&&(e.borderColor=t.stroke),t.strokeWidth&&(e.borderWidth=t.strokeWidth)),e}const sp=new Map;function eS(t,e){if(sp.has(t))return sp.get(t);let n=J1(e);return sp.set(t,Object.fromEntries(Object.entries(n).map(([r,s])=>[r,s]))),n}function op(t,e,n={}){if(!t||!e)return Nm(n||{});let r=Nm(n||{}),s=Object.entries(e);for(let[a,c]of s){if(!c)continue;let d=eS(a,c),m=Object.entries(d);for(let[y,h]of m)y===t&&Object.assign(r,h)}return r}var tS=(function(){function t(e,n){var r=[],s=!0,a=!1,c=void 0;try{for(var d=e[Symbol.iterator](),m;!(s=(m=d.next()).done)&&(r.push(m.value),!(n&&r.length===n));s=!0);}catch(y){a=!0,c=y}finally{try{!s&&d.return&&d.return()}finally{if(a)throw c}}return r}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw TypeError("Invalid attempt to destructure non-iterable instance")}})(),Pc=Math.PI*2,lp=function(t,e,n,r,s,a,c){var d=t.x,m=t.y;d*=e,m*=n;var y=r*d-s*m,h=s*d+r*m;return{x:y+a,y:h+c}},nS=function(t,e){var n=e===1.5707963267948966?.551915024494:e===-1.5707963267948966?-.551915024494:1.3333333333333333*Math.tan(e/4),r=Math.cos(t),s=Math.sin(t),a=Math.cos(t+e),c=Math.sin(t+e);return[{x:r-s*n,y:s+r*n},{x:a+c*n,y:c-a*n},{x:a,y:c}]},zm=function(t,e,n,r){var s=t*r-e*n<0?-1:1,a=t*n+e*r;return a>1&&(a=1),a<-1&&(a=-1),s*Math.acos(a)},rS=function(t,e,n,r,s,a,c,d,m,y,h,v){var E=s**2,T=a**2,P=h**2,k=v**2,R=E*T-E*k-T*P;R<0&&(R=0),R/=E*k+T*P,R=Math.sqrt(R)*(c===d?-1:1);var _=R*s/a*v,M=R*-a/s*h,L=y*_-m*M+(t+n)/2,$=m*_+y*M+(e+r)/2,F=(h-_)/s,H=(v-M)/a,se=(-h-_)/s,oe=(-v-M)/a,me=zm(1,0,F,H),K=zm(F,H,se,oe);return d===0&&K>0&&(K-=Pc),d===1&&K<0&&(K+=Pc),[L,$,me,K]},iS=function(t){var e=t.px,n=t.py,r=t.cx,s=t.cy,a=t.rx,c=t.ry,d=t.xAxisRotation,m=d===void 0?0:d,y=t.largeArcFlag,h=y===void 0?0:y,v=t.sweepFlag,E=v===void 0?0:v,T=[];if(a===0||c===0)return[];var P=Math.sin(m*Pc/360),k=Math.cos(m*Pc/360),R=k*(e-r)/2+P*(n-s)/2,_=-P*(e-r)/2+k*(n-s)/2;if(R===0&&_===0)return[];a=Math.abs(a),c=Math.abs(c);var M=R**2/a**2+_**2/c**2;M>1&&(a*=Math.sqrt(M),c*=Math.sqrt(M));var L=rS(e,n,r,s,a,c,h,E,P,k,R,_),$=tS(L,4),F=$[0],H=$[1],se=$[2],oe=$[3],me=Math.abs(oe)/(Pc/4);Math.abs(1-me)<1e-7&&(me=1);var K=Math.max(Math.ceil(me),1);oe/=K;for(var ge=0;ge<K;ge++)T.push(nS(se,oe)),se+=oe;return T.map(function(de){var we=lp(de[0],a,c,k,P,F,H),le=we.x,Ie=we.y,Se=lp(de[1],a,c,k,P,F,H),Te=Se.x,D=Se.y,U=lp(de[2],a,c,k,P,F,H),Q=U.x,B=U.y;return{x1:le,y1:Ie,x2:Te,y2:D,x:Q,y:B}})},sS=iS,oS=Sv(((t,e)=>{e.exports=s;var n={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},r=/([astvzqmhlc])([^astvzqmhlc]*)/gi;function s(d){var m=[];return d.replace(r,function(y,h,v){var E=h.toLowerCase();for(v=c(v),E=="m"&&v.length>2&&(m.push([h].concat(v.splice(0,2))),E="l",h=h=="m"?"l":"L");;){if(v.length==n[E])return v.unshift(h),m.push(v);if(v.length<n[E])throw Error("malformed path data");m.push([h].concat(v.splice(0,n[E])))}}),m}var a=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function c(d){var m=d.match(a);return m?m.map(Number):[]}})),lS=Sv(((t,e)=>{e.exports=n;function n(r){var s=0,a=0,c=0,d=0;return r.map(function(m){m=m.slice();var y=m[0],h=y.toUpperCase();if(y!=h)switch(m[0]=h,y){case"a":m[6]+=c,m[7]+=d;break;case"v":m[1]+=d;break;case"h":m[1]+=c;break;default:for(var v=1;v<m.length;)m[v++]+=c,m[v++]+=d}switch(h){case"Z":c=s,d=a;break;case"H":c=m[1];break;case"V":d=m[1];break;case"M":c=s=m[1],d=a=m[2];break;default:c=m[m.length-2],d=m[m.length-1]}return m})}})),aS=Pv(oS()),uS=Pv(lS());function cS(t){let e=(0,aS.default)(t),n=(0,uS.default)(e),r,s=0,a=0,c=0,d=0,m,y,h=0,v=0,E=[];for(let T=0;T<n.length;T++){let P=n[T],k=P[0];switch(k){case"M":s=P[1],a=P[2];break;case"H":P=["L",P[1],a];break;case"V":P=["L",s,P[1]];break;case"S":{let R=h,_=v;(r==="C"||r=="S")&&(R+=R-c,_+=_-d),P=["C",R,_,P[1],P[2],P[3],P[4]]}break;case"T":r==="Q"||r=="T"?(m=h*2-m,y=v*2-y):(m=h,y=v),P=["Q",m,y,P[1],P[2]];break;case"Q":m=P[1],y=P[2];break;case"A":{let R=sS({px:h,py:v,cx:P[6],cy:P[7],rx:P[1],ry:P[2],xAxisRotation:P[3],largeArcFlag:P[4],sweepFlag:P[5]});if(!R.length)continue;for(let[_,M]of R.entries())P=["C",M.x1,M.y1,M.x2,M.y2,M.x,M.y],_<R.length-1&&E.push(P);P=P}break;case"Z":P=["L",s,a];break}r=k,h=P[P.length-2],v=P[P.length-1],["C","Q","A"].indexOf(k)>-1?(c=P[P.length-4],d=P[P.length-3]):(c=h,d=v),E.push(P)}return E}const fS=/&?(xywh=)?(pixel:|percent:|pct:)?([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?),([0-9]+(?:\.[0-9]+)?)/,Fm=/&?(t=)(npt:)?([0-9]+(\.[0-9]+)?)?(,([0-9]+(\.[0-9]+)?))?/,Dm=/^rgba\((\d+),(\d+),(\d+),([0-9.]+)\)$/;function Ec(t,{domParser:e,svgPreprocessor:n,iiifRenderingHints:r,loadedStylesheets:s}={},{styleClass:a}={}){if(Array.isArray(t))return ci(t.reduce((c,d)=>{let{selector:m,selectors:y,iiifRenderingHints:h}=Ec(d,{domParser:e,svgPreprocessor:n,iiifRenderingHints:r},{styleClass:a});return m&&(c.selector?(!c.selector.temporal&&m.temporal&&(c.selector.temporal=m.temporal),!c.selector.spatial&&m.spatial&&(c.selector.spatial=m.spatial),!c.selector.svg&&m.svg&&(c.selector.svg=m.svg),!c.selector.svgShape&&m.svgShape&&(c.selector.svgShape=m.svgShape)):c.selector=m,c.selectors.push(...y)),h&&(c.iiifRenderingHints=c.iiifRenderingHints||{type:"ImageApiSelector"},Object.assign(c.iiifRenderingHints,h)),c},{selector:null,selectors:[],iiifRenderingHints:r}));if(!t)return ci({selector:null,selectors:[],iiifRenderingHints:r});if(typeof t=="string"){let[c,d]=t.split("#");return d?Ec({type:"FragmentSelector",value:d},{svgPreprocessor:n,iiifRenderingHints:r,domParser:e},{styleClass:a}):ci({selector:null,selectors:[],iiifRenderingHints:r})}if(t.type){if(t.type==="PointSelector"&&(t.t||t.t===0)){let c={type:"TemporalSelector",temporal:{startTime:t.t}};return ci({selector:c,selectors:[c],iiifRenderingHints:r})}if(t.type==="PointSelector"&&t.x&&t.y){let c={type:"PointSelector",spatial:{x:t.x,y:t.y}};return ci({selector:c,selectors:[c],iiifRenderingHints:r})}}if(gS(t)){let c=[];if(t.region){let d=Ec({type:"FragmentSelector",value:"xywh="+t.region},{domParser:e,svgPreprocessor:n,iiifRenderingHints:r},{styleClass:a});c.push(...d.selectors)}return ci({selector:c[0],selectors:c,iiifRenderingHints:r?{...r,...t}:t})}if(t.type==="FragmentSelector"){let c=fS.exec(t.value);if(c){let m={type:"BoxSelector",spatial:{unit:c[2]==="percent:"||c[2]==="pct:"?"percent":"pixel",x:Number.parseFloat(c[3]),y:Number.parseFloat(c[4]),width:Number.parseFloat(c[5]),height:Number.parseFloat(c[6])},boxStyle:op(a,s)},y=t.value.match(Fm);return y&&(m={type:"TemporalBoxSelector",spatial:m.spatial,temporal:{startTime:y[3]?Number.parseFloat(y[3]):0,endTime:y[6]?Number.parseFloat(y[6]):void 0},boxStyle:op(a,s)}),ci({selector:m,selectors:[m],iiifRenderingHints:r})}let d=t.value.match(Fm);if(d){let m={type:"TemporalSelector",temporal:{startTime:d[3]?Number.parseFloat(d[3]):0,endTime:d[6]?Number.parseFloat(d[6]):void 0}};return ci({selector:m,selectors:[m],iiifRenderingHints:r})}return ci({selector:null,selectors:[],iiifRenderingHints:r})}if(t.type==="SvgSelector"&&"value"in t){e||(typeof window<"u"?e=new window.DOMParser:console.warn("No DOMParser available, cannot parse SVG selector, `points`, `spatial` and `style` will be unavailable and the SVG will not be normalized."));let c=[],d,m,y=n?.(t.value)??t.value,h;if(e){let E=e.parseFromString(t.value,"image/svg+xml").querySelector("svg");if(!E)return console.warn(`Illegal SVG selector: ${t.value}`),ci({selector:null,selectors:[],iiifRenderingHints:r});let T=Cv(E);T&&(c=T.points,h=T.shapeType,d=[Math.min(...c.map(P=>P[0])),Math.min(...c.map(P=>P[1])),Math.max(...c.map(P=>P[0])),Math.max(...c.map(P=>P[1]))],{style:m,svg:y}=pS(T.element)??{svg:y})}let v={type:"SvgSelector",svg:y,svgShape:h,style:m,boxStyle:op(a,s,m),points:c.length?c:void 0,spatial:d?{unit:"pixel",x:d[0],y:d[1],width:d[2]-d[0],height:d[3]-d[1]}:void 0};return ci({selector:v,selectors:[v],iiifRenderingHints:r})}return ci({selector:null,selectors:[],iiifRenderingHints:r})}function dS(t){let e=t.map(r=>r[0]).reduce((r,s)=>(r[s]+=1,r),{C:0,Q:0,L:0,M:0}),n=new Set(t.map(r=>r[0]));if(e.C>0||e.Q>0)return"path";if(e.L>0&&(n.size===1||n.size===2&&n.has("M"))){if(e.L===4)return"rect";let r=t.slice(-1)[0];return t[0][0]==="M"&&r[0]==="L"&&r[1]==t[0][1]&&r[2]===t[0][2]||r[1]===0&&r[2]===0?"polygon":"polyline"}return"path"}function Cv(t){for(let e of Array.from(t.children))switch(e?.tagName.toLowerCase()){case"g":{let n=Cv(e);if(n)return n}continue;case"path":{let n=e.getAttribute("d");if(!n)continue;let r=cS(n);return{element:e,points:hS(r),shapeType:dS(r)}}case"circle":{let n=Number.parseFloat(e.getAttribute("cx")??"0"),r=Number.parseFloat(e.getAttribute("cy")??"0"),s=Number.parseFloat(e.getAttribute("r")??"0");if(!s)continue;let a=[];for(let c=0;c<=360;c+=12){let d=c*Math.PI/180;a.push([n+s*Math.cos(d),r+s*Math.sin(d)])}return{element:e,points:a,shapeType:"circle"}}case"ellipse":{let n=Number.parseFloat(e.getAttribute("cx")??"0"),r=Number.parseFloat(e.getAttribute("cy")??"0"),s=Number.parseFloat(e.getAttribute("rx")??"0"),a=Number.parseFloat(e.getAttribute("ry")??"0");if(!s&&!a)continue;let c=[];for(let d=0;d<=360;d+=12){let m=Math.tan(d/360*Math.PI),y=s*(1-m**2)/(1+m**2),h=a*2*m/(1+m**2);c.push([n+y,r+h])}return{element:e,points:c,shapeType:"ellipse"}}case"line":{let n=Number.parseFloat(e.getAttribute("x0")??"0"),r=Number.parseFloat(e.getAttribute("y0")??"0"),s=Number.parseFloat(e.getAttribute("x1")??"0"),a=Number.parseFloat(e.getAttribute("y1")??"0");if(n===s&&r===a)continue;return{element:e,points:[[n,r],[s,a]],shapeType:"polyline"}}case"polygon":case"polyline":{let n=e.getAttribute("points")?.split(" ").map(s=>s.split(",").map(Number.parseFloat))??[];if(!n.length)continue;let r="polyline";return e.tagName.toLowerCase()==="polygon"&&(n.push(n[0]),r="polygon"),{element:e,points:n,shapeType:r}}case"rect":{let n=Number.parseFloat(e.getAttribute("x")??"0"),r=Number.parseFloat(e.getAttribute("y")??"0"),s=Number.parseFloat(e.getAttribute("width")??"0"),a=Number.parseFloat(e.getAttribute("height")??"0");if(!s||!a)continue;return{element:e,points:[[n,r],[n+s,r],[n+s,r+a],[n,r+a],[n,r]],shapeType:"rect"}}default:continue}return null}function hS(t){let e=[];for(let n=0;n<t.length;n++){let r=e[e.length-1]??[0,0],s=t[n];switch(s[0]){case"M":case"L":e.push([s[1],s[2]]);continue;case"C":e.push(...K1({x:r[0],y:r[1]},{x:s[1],y:s[2]},{x:s[3],y:s[4]},{x:s[5],y:s[6]}).map(a=>[a.x,a.y]).slice(1));continue;case"Q":e.push(...Y1({x:r[0],y:r[1]},{x:s[1],y:s[2]},{x:s[3],y:s[4]}).map(a=>[a.x,a.y]).slice(1));continue}}return e}function pS(t){let e={};if(t.hasAttribute("fill")?(e.fill=t.getAttribute("fill"),t.removeAttribute("fill")):t.style&&t.style.fill&&(e.fill=t.style.fill),e.fill){let r=Dm.exec(e.fill);r&&(e.fillOpacity=Number.parseFloat(r[4]),e.fill=`rgb(${r[1]}, ${r[2]}, ${r[3]})`)}if(t.hasAttribute("fill-opacity")?(e.fillOpacity=Number.parseFloat(t.getAttribute("fill-opacity")),t.removeAttribute("fill-opacity")):t.style&&t.style.fillOpacity&&(e.fillOpacity=Number.parseFloat(t.style.fillOpacity)),t.hasAttribute("stroke")?(e.stroke=t.getAttribute("stroke"),t.removeAttribute("stroke")):t.style&&t.style.stroke&&(e.stroke=t.style.stroke),e.stroke){let r=Dm.exec(e.stroke);r&&(e.strokeOpacity=Number.parseFloat(r[4]),e.stroke=`rgb(${r[1]}, ${r[2]}, ${r[3]})`)}t.hasAttribute("stroke-opacity")?(e.strokeOpacity=Number.parseFloat(t.getAttribute("stroke-opacity")),t.removeAttribute("stroke-opacity")):t.style&&t.style.strokeOpacity&&(e.strokeOpacity=Number.parseFloat(t.style.strokeOpacity)),t.hasAttribute("stroke-width")?(e.strokeWidth=t.getAttribute("stroke-width"),t.removeAttribute("stroke-width")):t.style&&t.style.strokeWidth&&(e.strokeWidth=t.style.strokeWidth),t.hasAttribute("stroke-dasharray")?(e.strokeDasharray=t.getAttribute("stroke-dasharray"),t.removeAttribute("stroke-dasharray")):t.style&&t.style.strokeDasharray&&(e.strokeDasharray=t.style.strokeDasharray);let n=t;for(;n.tagName.toLowerCase()!=="svg";)if(n=n.parentElement,n===null)throw Error("Could not find root SVG element");return{svg:n.outerHTML,style:Object.keys(e).length>0?e:void 0}}function gS(t){if(!t)return!1;let e=t.type||t["@type"];return e==="iiif:ImageApiSelector"||e==="ImageApiSelector"}function ci(t){if(t.iiifRenderingHints){let e=t.iiifRenderingHints;if(e.rotation){let n=mS(`${e.rotation}`);if(n)if(t.selectors.length)for(let r of t.selectors)r.rotation=n;else t.selectors.push({type:"RotationSelector",rotation:n})}}else delete t.iiifRenderingHints;return t}function mS(t){let e=Number.parseFloat(t);return e&&t.startsWith("!")&&(e=360-e),e&&(e%=360),e===e&&e||0}function fi(t,e={}){if(Array.isArray(t))return fi(t[0]);if(typeof t=="string"){let[n,r]=t.split("#");return r?fi({type:"SpecificResource",source:{id:n,type:e.typeMap&&e.typeMap[n]||e.defaultType||"Canvas"},selector:{type:"FragmentSelector",value:r}},e):{type:"SpecificResource",source:{id:n,type:e.typeMap&&e.typeMap[n]||e.defaultType||"Canvas"},selector:null,selectors:[]}}if(t.type==="Choice"||t.type==="List"||t.type==="Composite"||t.type==="Independents")return fi(t.items[0],e);if(!t.type&&"source"in t&&(t.type="SpecificResource"),t.type==="SpecificResource"){t.source.type==="Canvas"&&t.source.partOf&&typeof t.source.partOf=="string"&&(t.source.partOf=[{id:t.source.partOf,type:"Manifest"}]);let n=t.styleClass||e.styleClass,r={selector:null,selectors:[]};if(typeof t.source=="string"&&t.source.includes("#")){let c=fi(t.source,{...e,styleClass:n});t.source=c.source,r={selector:c.selector,selectors:c.selectors}}let{selector:s,selectors:a}=t.selector?Ec(t.selector,e,{styleClass:n}):r;return{type:"SpecificResource",source:t.source,selector:s,selectors:a}}if(t.id){t.type==="Canvas"&&t.partOf&&typeof t.partOf=="string"&&(t.partOf=[{id:t.partOf,type:"Manifest"}]);let[n,r]=t.id.split("#");return r?fi({type:"SpecificResource",source:{...t,id:n},selector:{type:"FragmentSelector",value:r}},e):{type:"SpecificResource",source:{...t,id:n},selector:null,selectors:[]}}return{type:"SpecificResource",source:t,selector:null,selectors:[]}}const yS={collection:void 0,manifest:void 0,range:void 0,canvas:void 0,annotation:void 0,annotationPage:void 0},wg=Xt.createContext(yS),pu=()=>O.useContext(wg);function Hd({value:t,children:e}){const n=pu(),r=O.useMemo(()=>({...n,...t}),[t,n]);return I.jsx(wg.Provider,{value:r,children:e})}function du({canvas:t,children:e}){return I.jsx(Hd,{value:{canvas:t},children:e})}const vS={},Bm=t=>{let e,n=new Set,r=(h,v)=>{let E=typeof h=="function"?h(e):h;if(!Object.is(E,e)){let T=e;e=v??(typeof E!="object"||!E)?E:Object.assign({},e,E),n.forEach(P=>P(e,T))}},s=()=>e,a=()=>y,c=h=>(n.add(h),()=>n.delete(h)),d=()=>{(vS?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()},m={setState:r,getState:s,getInitialState:a,subscribe:c,destroy:d},y=e=t(r,s,m);return m},Tv=t=>t?Bm(t):Bm;function bv(t){return{all:t||=new Map,on:function(e,n){var r=t.get(e);r?r.push(n):t.set(e,[n])},off:function(e,n){var r=t.get(e);r&&(n?r.splice(r.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var r=t.get(e);r&&r.slice().map(function(s){s(n)}),(r=t.get("*"))&&r.slice().map(function(s){s(e,n)})}}}function Mc(t){"@babel/helpers - typeof";return Mc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mc(t)}function xS(t,e){if(Mc(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e);if(Mc(r)!="object")return r;throw TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function wS(t){var e=xS(t,"string");return Mc(e)=="symbol"?e:e+""}function Xo(t,e,n){return(e=wS(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ws(t){return Array.isArray(t)?t:t?[t]:[]}function is(t){for(let e in t)(t[e]===void 0||t[e]===null)&&delete t[e];return t}function Vs(t){return typeof t=="string"?!1:t&&!t.type&&"source"in t?(t.type="SpecificResource",!0):!!t&&t.type==="SpecificResource"}function od(...t){return e=>t.reduce((n,r)=>r(n),e)}const $m=["Collection","Manifest","Canvas","AnnotationPage","AnnotationCollection","Annotation","ContentResource","Range","Service","Selector","Agent"];function SS(t,e){if(t==null)throw Error("Null or undefined is not a valid entity.");if(Array.isArray(t))throw Error("Array is not a valid entity");if(typeof t!="object"){if(e)return e;throw Error(`${typeof t} is not a valid entity`)}if(typeof t.type=="string"){let n=$m.indexOf(t.type);if(n!==-1)return $m[n]}if(t.profile)return"Service";throw Error("Resource type is not known")}var PS=class Rv{constructor(e,n={}){Xo(this,"traversals",void 0),Xo(this,"options",void 0),Xo(this,"_traverseManifest",od(this.traverseManifestItems.bind(this),this.traverseNavPlace.bind(this),this.traverseLinking.bind(this),this.traverseDescriptive.bind(this),this.traverseLinkedCanvases.bind(this),this.traverseManifestStructures.bind(this),this.traverseInlineAnnotationPages.bind(this))),Xo(this,"_traverseCanvas",od(this.traverseCanvasItems.bind(this),this.traverseLinking.bind(this),this.traverseDescriptive.bind(this),this.traverseLinkedCanvases.bind(this),this.traverseInlineAnnotationPages.bind(this))),Xo(this,"_traverseAnnotationPage",od(this.traverseAnnotationPageItems.bind(this),this.traverseLinking.bind(this),this.traverseDescriptive.bind(this))),Xo(this,"_traverseRange",od(this.traverseRangeRanges.bind(this),this.traverseLinking.bind(this),this.traverseDescriptive.bind(this),this.traverseLinkedCanvases.bind(this))),this.traversals={collection:[],manifest:[],canvas:[],annotationCollection:[],annotationPage:[],annotation:[],contentResource:[],choice:[],range:[],service:[],agent:[],specificResource:[],geoJson:[],...e},this.options={allowUndefinedReturn:!1,...n}}static all(e){return new Rv({collection:[e],manifest:[e],canvas:[e],annotationCollection:[e],annotationPage:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e],geoJson:[e],specificResource:[e],agent:[e]})}traverseDescriptive(e){return e.thumbnail&&=Ws(e.thumbnail).map(n=>this.traverseType(n,{parent:e},this.traversals.contentResource)),e.provider&&=e.provider.map(n=>this.traverseAgent(n,e)),e}traverseLinking(e){return e.seeAlso&&=Ws(e.seeAlso).map(n=>this.traverseType(n,{parent:e},this.traversals.contentResource)),e.service&&=Ws(e.service).map(n=>this.traverseService(n)),e.services&&=Ws(e.services).map(n=>this.traverseService(n,e)),e.logo&&=Ws(e.logo).map(n=>this.traverseType(n,{parent:e},this.traversals.contentResource)),e.homepage&&=Ws(e.homepage).map(n=>this.traverseType(n,{parent:e},this.traversals.contentResource)),e.partOf&&=e.partOf.map(n=>typeof n=="string"||!n.type?this.traverseType(n,{parent:e},this.traversals.contentResource):n.type==="Canvas"?this.traverseType(n,{parent:e},this.traversals.canvas):n.type==="AnnotationCollection"?this.traverseType(n,{parent:e},this.traversals.annotationCollection):n.type==="Collection"?this.traverseType(n,{parent:e},this.traversals.collection):this.traverseType(n,{parent:e},this.traversals.contentResource)),e.start&&(Vs(e.start)?e.start=this.traverseSpecificResource(e.start,"Canvas",e):e.start=this.traverseType(e.start,{parent:e},this.traversals.canvas)),e.rendering&&=e.rendering.map(n=>this.traverseType(n,{parent:e},this.traversals.contentResource)),e.supplementary&&=e.supplementary.map(n=>this.traverseType(n,{parent:e},this.traversals.contentResource)),e}traverseCollectionItems(e){return e.items&&e.items.map(n=>n.type==="Collection"?this.traverseCollection(n):this.traverseManifest(n)),e}traverseCollection(e,n){return this.traverseType(this.traverseDescriptive(this.traverseNavPlace(this.traverseInlineAnnotationPages(this.traverseLinking(this.traverseLinkedCanvases(this.traverseCollectionItems(e)))))),{parent:n},this.traversals.collection)}traverseGeoJson(e,n){return this.traverseType(e,{parent:n},this.traversals.geoJson)}traverseNavPlace(e){return e.navPlace&&=this.traverseGeoJson(e.navPlace,e),e}traverseManifestItems(e){return e.items&&=e.items.map(n=>this.traverseCanvas(n)),e}traverseManifestStructures(e){return e.structures&&=e.structures.map(n=>this.traverseRange(n)),e}traverseManifest(e,n){return this.traverseType(this._traverseManifest(e),{parent:n},this.traversals.manifest)}traverseCanvasItems(e){return e.items=(e.items||[]).map(n=>this.traverseAnnotationPage(n,e)),e}traverseInlineAnnotationPages(e){return typeof e=="string"||!e||(e.annotations&&=e.annotations.map(n=>this.traverseAnnotationPage(n,e))),e}traverseCanvas(e,n){return this.traverseType(this._traverseCanvas(e),{parent:n},this.traversals.canvas)}traverseAnnotationPageItems(e){return e.items&&=e.items.map(n=>this.traverseAnnotation(n,e)),e}traverseAnnotationPage(e,n){return this.traverseType(this._traverseAnnotationPage(e),{parent:n},this.traversals.annotationPage)}traverseAnnotationBody(e){return Array.isArray(e.body)?e.body=e.body.map(n=>this.traverseContentResource(n,e)):e.body&&=this.traverseContentResource(e.body,e),e}traverseLinkedCanvases(e){return e.placeholderCanvas&&=this.traverseCanvas(e.placeholderCanvas),e.accompanyingCanvas&&=this.traverseCanvas(e.accompanyingCanvas),e}traverseAnnotation(e,n){return this.traverseType(this.traverseLinking(this.traverseAnnotationBody(this.traverseDescriptive(e))),{parent:n},this.traversals.annotation)}traverseContentResourceLinking(e){return typeof e=="string"||!e||e&&e.service&&(e.service=Ws(e.service||[]).map(n=>this.traverseService(n,e))),e}traverseContentResource(e,n){return e.type==="Choice"&&(e.items=e.items.map(r=>this.traverseContentResource(r,e))),Vs(e)?this.traverseSpecificResource(e,"ContentResource"):this.traverseType(this.traverseInlineAnnotationPages(this.traverseContentResourceLinking(e)),{parent:n},this.traversals.contentResource)}traverseSpecificResource(e,n,r){let s=e.source;return typeof e.source=="string"&&(s={id:e.source,type:n||"unknown"}),this.traverseType({...e,source:n==="Canvas"||s.type==="Canvas"?this.traverseType(s,{parent:r},this.traversals.canvas):n==="ContentResource"?this.traverseContentResource(s,{parent:r}):this.traverseUnknown(s,{parent:r,typeHint:n})},{parent:r},this.traversals.specificResource)}traverseRangeRanges(e){return e.items&&=e.items.map(n=>typeof n=="string"?this.traverseCanvas({id:n,type:"Canvas"},e):Vs(n)?this.traverseSpecificResource(n,"Canvas",e):n.type==="Manifest"?this.traverseManifest(n,e):this.traverseRange(n,e)),e}traverseRange(e,n){return this.traverseType(this._traverseRange(e),{parent:n},this.traversals.range)}traverseAgent(e,n){return this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),{parent:n},this.traversals.agent)}traverseType(e,n,r){return r.reduce((s,a)=>{let c=a(s,n);return c===void 0&&!this.options.allowUndefinedReturn?s:c},e)}traverseService(e,n){let r=Object.assign({},e);return r&&r.service&&(r.service=Ws(r.service).map(s=>this.traverseService(s))),this.traverseType(r,{parent:n},this.traversals.service)}traverseUnknown(e,{parent:n,typeHint:r}={}){let s=SS(e,r);switch(s){case"Collection":return this.traverseCollection(e,n);case"Manifest":return this.traverseManifest(e,n);case"Canvas":return this.traverseCanvas(e,n);case"AnnotationPage":return this.traverseAnnotationPage(e,n);case"Annotation":return this.traverseAnnotation(e,n);case"ContentResource":return this.traverseContentResource(e,n);case"Range":return this.traverseRange(e,n);case"Service":return this.traverseService(e,n);case"Agent":return this.traverseAgent(e,n);default:throw Error(`Unknown or unsupported resource type of ${s}`)}}};const _v="http://library.stanford.edu/iiif/image-api/compliance.html#level0",Iv="http://library.stanford.edu/iiif/image-api/compliance.html#level1",Ov="http://library.stanford.edu/iiif/image-api/compliance.html#level2",Av="http://library.stanford.edu/iiif/image-api/conformance.html#level0",Mv="http://library.stanford.edu/iiif/image-api/conformance.html#level1",jv="http://library.stanford.edu/iiif/image-api/conformance.html#level2",Lv="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",Nv="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",zv="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",Fv="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",Dv="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",Bv="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",$v="http://iiif.io/api/image/1/level0.json",Uv="http://iiif.io/api/image/1/profiles/level0.json",Wv="http://iiif.io/api/image/1/level1.json",Hv="http://iiif.io/api/image/1/profiles/level1.json",Vv="http://iiif.io/api/image/1/level2.json",qv="http://iiif.io/api/image/1/profiles/level2.json",Qv="http://iiif.io/api/image/2/level0.json",Xv="http://iiif.io/api/image/2/profiles/level0.json",Yv="http://iiif.io/api/image/2/level1.json",Kv="http://iiif.io/api/image/2/profiles/level1.json",Gv="http://iiif.io/api/image/2/level2.json",Zv="http://iiif.io/api/image/2/profiles/level2.json",Jv="level0",e0="level1",t0="level2",n0="http://iiif.io/api/image/2/level0",r0="http://iiif.io/api/image/2/level1",i0="http://iiif.io/api/image/2/level2",Vd=[i0,Ov,jv,zv,Bv,Vv,qv,Gv,Zv,t0],Sg=[...Vd,r0,Iv,Mv,Nv,Dv,Wv,Hv,Yv,Kv,e0],s0=[n0,r0,i0,_v,Iv,Ov,Av,Mv,jv,Lv,Nv,zv,Fv,Dv,Bv,$v,Uv,Wv,Hv,Vv,qv,Qv,Xv,Yv,Kv,Gv,Zv,Jv,e0,t0],ES=s0,o0=[n0,_v,Av,Lv,Fv,$v,Uv,Qv,Xv,Jv],kS={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},CS={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},TS={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]},Um=["sc:Collection","sc:Manifest","sc:Canvas","sc:AnnotationList","oa:Annotation","sc:Range","sc:Layer","sc:Sequence","oa:Choice","Service","ContentResource"];function bS(t){if(t==null)throw Error("Null or undefined is not a valid entity.");if(Array.isArray(t))throw Error("Array is not a valid entity");if(typeof t!="object")throw Error(`${typeof t} is not a valid entity`);if(typeof t["@type"]=="string"){let e=Um.indexOf(t["@type"]);if(e!==-1)return Um[e]}if(t.profile)return"Service";if(t.format||t["@type"])return"ContentResource";throw Error("Resource type is not known")}var RS=class l0{constructor(e,n={}){Xo(this,"traversals",void 0),Xo(this,"options",void 0),this.traversals={collection:[],manifest:[],canvas:[],annotationList:[],sequence:[],annotation:[],contentResource:[],choice:[],range:[],service:[],layer:[],...e},this.options={convertPropsToArray:!0,mergeMemberProperties:!0,allowUndefinedReturn:!1,...n}}static all(e){return new l0({collection:[e],manifest:[e],canvas:[e],annotationList:[e],sequence:[e],annotation:[e],contentResource:[e],choice:[e],range:[e],service:[e],layer:[e]})}traverseCollection(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCollectionItems(e))),this.traversals.collection)}traverseCollectionItems(e){if(this.options.mergeMemberProperties){let n=[...(e.manifests||[]).map(a=>typeof a=="string"?{"@id":a,"@type":"sc:Manifest"}:a),...(e.collections||[]).map(a=>typeof a=="string"?{"@id":a,"@type":"sc:Collection"}:a),...e.members||[]],r=[],s=n.filter(a=>r.includes(a["@id"])?!1:(r.push(a["@id"]),!0));delete e.collections,delete e.manifests,e.members=s}return e.manifests&&=e.manifests.map(n=>this.traverseManifest(typeof n=="string"?{"@id":n,"@type":"sc:Manifest"}:n)),e.collections&&=e.collections.map(n=>this.traverseCollection(typeof n=="string"?{"@id":n,"@type":"sc:Collection"}:n)),e.members&&=e.members.map(n=>typeof n=="string"?n:n["@type"]==="sc:Collection"?this.traverseCollection(n):n["@type"]==="sc:Manifest"?this.traverseManifest(n):this.traverseUnknown(n)),e}traverseManifest(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseManifestItems(e))),this.traversals.manifest)}traverseManifestItems(e){return e.sequences&&=e.sequences.map(n=>this.traverseSequence(n)),e.structures&&=e.structures.map(n=>this.traverseRange(n)),e}traverseSequence(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseSequenceItems(e))),this.traversals.sequence)}traverseSequenceItems(e){return e.canvases&&=e.canvases.map(n=>this.traverseCanvas(n)),e}traverseCanvas(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseCanvasItems(e))),this.traversals.canvas)}traverseCanvasItems(e){return e.images&&=e.images.map(n=>this.traverseAnnotation(n)),e.otherContent&&=e.otherContent.map(n=>this.traverseAnnotationList(n)),e}traverseRange(e){return e["@type"]!=="sc:Range"&&(e["@type"]="sc:Range"),this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseRangeItems(e))),this.traversals.range)}traverseRangeItems(e){if(this.options.mergeMemberProperties){let n=[...(e.ranges||[]).map(r=>typeof r=="string"?{"@id":r,"@type":"sc:Range"}:r),...(e.canvases||[]).map(r=>typeof r=="string"?{"@id":r,"@type":"sc:Canvas"}:r),...e.members||[]];delete e.ranges,delete e.canvases,e.members=n.length?n.map(r=>this.traverseUnknown(r)):void 0}return e}traverseAnnotationList(e){let n=typeof e=="string"?{"@id":e,"@type":"sc:AnnotationList"}:e;return this.traverseType(this.traverseDescriptive(this.traverseAnnotationListItems(n)),this.traversals.annotationList)}traverseAnnotationListItems(e){return e.resources&&=e.resources.map(n=>this.traverseAnnotation(n)),e}traverseAnnotation(e){return this.traverseType(this.traverseDescriptive(this.traverseLinking(this.traverseAnnotationItems(e))),this.traversals.annotation)}traverseAnnotationItems(e){return e.resource&&(Array.isArray(e.resource)?e.resource=e.resource.map(n=>this.traverseContentResource(n)):e.resource=this.traverseContentResource(e.resource)),e.on,e}traverseLayer(e){return this.traverseType(this.traverseLinking(this.traverseLayerItems(e)),this.traversals.layer)}traverseLayerItems(e){return e.otherContent&&=e.otherContent.map(n=>this.traverseAnnotationList(n)),e}traverseChoice(e){return this.traverseType(this.traverseChoiceItems(e),this.traversals.choice)}traverseChoiceItems(e){return e.default&&e.default!=="rdf:nil"&&(e.default=this.traverseContentResource(e.default)),e.item&&e.item!=="rdf:nil"&&(e.item=e.item.map(n=>this.traverseContentResource(n))),e}traverseService(e){return this.traverseType(this.traverseLinking(e),this.traversals.service)}traverseContentResource(e){return e["@type"]==="oa:Choice"?this.traverseChoice(e):this.traverseType(this.traverseDescriptive(this.traverseLinking(e)),this.traversals.contentResource)}traverseUnknown(e){if(!e["@type"]||typeof e=="string")return e;switch(bS(e)){case"sc:Collection":return this.traverseCollection(e);case"sc:Manifest":return this.traverseManifest(e);case"sc:Canvas":return this.traverseCanvas(e);case"sc:Sequence":return this.traverseSequence(e);case"sc:Range":return this.traverseRange(e);case"oa:Annotation":return this.traverseAnnotation(e);case"sc:AnnotationList":return this.traverseAnnotationList(e);case"sc:Layer":return this.traverseLayer(e);case"Service":return this.traverseService(e);case"oa:Choice":return this.traverseChoice(e);case"ContentResource":return this.traverseContentResource(e)}return e.profile?this.traverseService(e):e}traverseImageResource(e){let n=Array.isArray(e),r=Array.isArray(e)?e:[e],s=[];for(let a of r)typeof a=="string"?s.push(this.traverseContentResource({"@id":a,"@type":"dctypes:Image"})):s.push(this.traverseContentResource(a));return!n&&!this.options.convertPropsToArray?s[0]:s}traverseDescriptive(e){return e.thumbnail&&=this.traverseImageResource(e.thumbnail),e.logo&&=this.traverseImageResource(e.logo),e}traverseOneOrMoreServices(e){let n=Array.isArray(e),r=Array.isArray(e)?e:[e],s=[];for(let a of r)s.push(this.traverseService(a));return!n&&!this.options.convertPropsToArray?s[0]:s}traverseLinking(e){return e.related&&=this.traverseOneOrManyType(e.related,this.traversals.contentResource),e.rendering&&=this.traverseOneOrManyType(e.rendering,this.traversals.contentResource),e.service&&=this.traverseOneOrMoreServices(e.service),e.seeAlso&&=this.traverseOneOrManyType(e.seeAlso,this.traversals.contentResource),e.within&&(typeof e.within=="string"||(e.within=this.traverseOneOrManyType(e.within,this.traversals.contentResource))),e.startCanvas&&(typeof e.startCanvas=="string"?e.startCanvas=this.traverseType({"@id":e.startCanvas,"@type":"sc:Canvas"},this.traversals.canvas):e.startCanvas&&this.traverseType(e.startCanvas,this.traversals.canvas)),e.contentLayer&&(typeof e.contentLayer=="string"?e.contentLayer=this.traverseLayer({"@id":e.contentLayer,"@type":"sc:Layer"}):e.contentLayer=this.traverseLayer(e.contentLayer)),e}traverseOneOrManyType(e,n){if(!Array.isArray(e))if(this.options.convertPropsToArray)e=[e];else return this.traverseType(e,n);return e.map(r=>this.traverseType(r,n))}traverseType(e,n){return n.reduce((r,s)=>{let a=s(r);return a===void 0&&!this.options.allowUndefinedReturn?r:a},e)}};const _S=["http://iiif.io/api/image/2/level1","http://iiif.io/api/image/2/level2","http://library.stanford.edu/iiif/image-api/compliance.html#level1","http://library.stanford.edu/iiif/image-api/compliance.html#level2","http://library.stanford.edu/iiif/image-api/conformance.html#level1","http://library.stanford.edu/iiif/image-api/conformance.html#level2","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1","http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2","http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1","http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2","http://iiif.io/api/image/1/level1.json","http://iiif.io/api/image/1/profiles/level1.json","http://iiif.io/api/image/1/level2.json","http://iiif.io/api/image/1/profiles/level2.json","http://iiif.io/api/image/2/level1.json","http://iiif.io/api/image/2/profiles/level1.json","http://iiif.io/api/image/2/level2.json","http://iiif.io/api/image/2/profiles/level2.json","level1","level2"],Hp={attributionLabel:"Attribution",providerId:"http://example.org/provider",providerName:""};function IS(t){if(typeof t=="string")return[t];if(!t)return[];let e=Array.isArray(t)?t:[t],n=[];for(let r of e){if(typeof r=="string"){n.push(r);continue}n.push({"@language":r["@language"]||r.language,"@value":r["@value"]||r.value})}return n}function Xl(t,e="none"){if(!t)return{none:[""]};let n=IS(t),r={};for(let s of n){if(typeof s=="string"){r[e]=r[e]?r[e]:[],r[e].push(s||"");continue}if(!s["@language"]){r[e]=r[e]?r[e]:[],r[e].push(s["@value"]||"");continue}let a=s["@language"];r[a]=r[a]?r[a]:[],r[a].push(s["@value"]||"")}return Object.keys(r).length===0?{none:[""]}:r}function a0(t){if(Array.isArray(t))return a0(t.find(e=>typeof e=="string"));if(Vd.indexOf(t)!==-1)return"level2";if(_S.indexOf(t)!==-1)return"level1";if(ES.indexOf(t)!==-1)return"level0";if(typeof t=="string")return t}function OS(t){let e=Array.isArray(t)?t:[t];for(let n of e)switch(n){case"http://iiif.io/api/image/2/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2":return"ImageService2";case"http://iiif.io/api/image/1/context.json":case"http://library.stanford.edu/iiif/image-api/1.1/context.json":return"ImageService1";case"http://iiif.io/api/annex/openannotation/context.json":return"ImageApiSelector"}}function AS(t){switch(t){case"http://iiif.io/api/image/2/level0.json":case"http://iiif.io/api/image/2/level1.json":case"http://iiif.io/api/image/2/level2.json":return"ImageService2";case"http://iiif.io/api/auth/1/kiosk":case"http://iiif.io/api/auth/1/login":case"http://iiif.io/api/auth/1/clickthrough":case"http://iiif.io/api/auth/1/external":case"http://iiif.io/api/auth/0/kiosk":case"http://iiif.io/api/auth/0/login":case"http://iiif.io/api/auth/0/clickthrough":case"http://iiif.io/api/auth/0/external":return"AuthCookieService1";case"http://iiif.io/api/auth/1/token":case"http://iiif.io/api/auth/0/token":return"AuthTokenService1";case"http://iiif.io/api/auth/1/logout":case"http://iiif.io/api/auth/0/logout":return"AuthLogoutService1";case"http://iiif.io/api/search/1/search":case"http://iiif.io/api/search/0/search":return"SearchService1";case"http://iiif.io/api/search/1/autocomplete":case"http://iiif.io/api/search/0/autocomplete":return"AutoCompleteService1"}}function Wm(t){for(let e of["sc","oa","dcterms","dctypes","iiif"])if(t.startsWith(`${e}:`))return t.slice(e.length+1);return t}const MS=["Collection","Manifest","Annotation","AnnotationPage","Range","Service"];function Pg(t){let e=t["@id"]||t.id,n=t["@type"]||t.type,r=t.profile||void 0,s=t["@context"]||void 0;if(r){let a=AS(r);if(a)return a}if(s){let a=OS(s);if(a)return a}if(n){if(Array.isArray(n)){if(n.indexOf("oa:CssStylesheet")!==-1)return"CssStylesheet";if(n.indexOf("cnt:ContentAsText")!==-1)return"TextualBody";n=n[0]}for(let a of["sc","oa","dcterms","dctypes","iiif"])if(n.startsWith(`${a}:`)){n=n.slice(a.length+1);break}switch(n){case"Layer":return"AnnotationCollection";case"AnnotationList":return"AnnotationPage";case"cnt:ContentAsText":return"TextualBody"}}if(n&&MS.indexOf(n)!==-1)return n;if(t.format){if(t.format.startsWith("image/"))return"Image";if(t.format.startsWith("text/")||t.format==="application/pdf")return"Text";if(t.format.startsWith("application/"))return"Dataset"}return e&&(e.endsWith(".jpg")||e.endsWith(".png")||e.endsWith(".jpeg"))?"Image":n||"unknown"}const jS=/http(s)?:\/\/(creativecommons.org|rightsstatements.org)[^"'\\<\n]+/gm;function LS(t){let e=t.match(jS);return e?e[0]:t}function NS(t,e="Rights/License",n="none"){let r=null,s=[],a=Array.isArray(t)?t:[t];for(let c of a){let d=c?LS(c):void 0;if(d&&(d.indexOf("creativecommons.org")!==-1||d.indexOf("rightsstatements.org")!==-1)){r=d.startsWith("https://")?`http://${d.slice(8)}`:d;continue}d&&s.push({label:{[n]:[e]},value:{[n]:[d]}})}return[r,s]}const zS=["http://iiif.io/api/presentation/2/context.json","http://iiif.io/api/image/2/context.json","http://iiif.io/api/image/1/context.json","http://library.stanford.edu/iiif/image-api/1.1/context.json","http://iiif.io/api/search/1/context.json","http://iiif.io/api/search/0/context.json","http://iiif.io/api/auth/1/context.json","http://iiif.io/api/auth/0/context.json","http://iiif.io/api/annex/openannotation/context.json"];function FS(t){if(t){let e=Array.isArray(t)?t:[t],n=[];for(let r of e)r==="http://iiif.io/api/presentation/2/context.json"&&n.push("http://iiif.io/api/presentation/3/context.json"),zS.indexOf(r)===-1&&n.push(r);if(e.length)return n.length===1?n[0]:n}}function DS(t){return t?t.map(e=>({label:Xl(e.label),value:Xl(e.value)})):[]}let Hm=0;function u0(t,e){let n=encodeURI(t.id||t["@id"]||"").trim();return n&&e?`${n}/${e}`:n||(Hm++,`http://example.org/${t["@type"]}${e?`/${e}`:""}/${Hm}`)}function Zs(t){let e=[...t.behavior||[]];t.viewingHint&&e.push(t.viewingHint);let n;return Array.isArray(t.motivation)?n=t.motivation.map(Wm):t.motivation&&(n=Wm(t.motivation)),{"@context":t["@context"]?FS(t["@context"]):void 0,id:(t["@id"]||u0(t)).trim(),type:Pg(t),behavior:e.length?e:void 0,height:t.height?t.height:void 0,width:t.width?t.width:void 0,motivation:n,viewingDirection:t.viewingDirection,profile:t.profile,format:t.format?t.format:void 0,duration:void 0,timeMode:void 0}}function Js(t){let[e,n]=NS(t.license),r=[...t.metadata?DS(t.metadata):[],...n];return{rights:e,metadata:r.length?r:void 0,label:t.label?Xl(t.label):void 0,requiredStatement:t.attribution?{label:Xl(Hp.attributionLabel),value:Xl(t.attribution)}:void 0,navDate:t.navDate,summary:t.description?Xl(t.description):void 0,thumbnail:BS(t.thumbnail)}}function BS(t){return t&&(Array.isArray(t)?t:[t]).map(n=>typeof n=="string"?{id:n,type:"Image"}:(n.type==="unknown"&&(n.type="Image"),n))}function $S(t){if(!t.within)return;let e=Array.isArray(t.within)?t.within:[t.within],n=[];for(let r of e)if(typeof r=="string"){if(r)switch(t["@type"]){case"sc:Manifest":n.push({id:r,type:"Collection"});break}}else r["@id"]&&n.push({id:r["@id"],type:Pg(r)});return n.length?n:void 0}function il(t){let e=t.related?Array.isArray(t.related)?t.related:[t.related]:[],n=t.contentLayer;return{provider:t.logo||e.length?[{id:Hp.providerId,type:"Agent",homepage:e.length?[e[0]]:void 0,logo:t.logo?Array.isArray(t.logo)?t.logo:[t.logo]:void 0,label:Xl(Hp.providerName)}]:void 0,partOf:$S(t),rendering:t.rendering,seeAlso:t.seeAlso,start:t.startCanvas,service:t.service?Ws(t.service):void 0,supplementary:n?[n]:void 0}}function US(t){return{chars:t.chars,format:t.format?t.format:void 0,language:t.language}}function ap(t,e){return t?typeof t=="string"?{id:t,type:e}:typeof t?.["@id"]=="string"?{id:t["@id"],type:e}:typeof t.id=="string"?{id:t.id,type:e}:null:null}function WS(t){let e={};if(t.first){let n=ap(t.first,"Collection");n&&(e.first=n)}if((t.total||t.total===0)&&(e.total=t.total),t.prev){let n=ap(t.prev,"Collection");n&&(e.prev=n)}if(t.next){let n=ap(t.next,"Collection");n&&(e.next=n)}return e}function HS(t){let e=[];for(let n of t){let r={...n};r.items&&r.items.length===0&&delete r.items,e.push(r)}return e}function VS(t){return is({...Zs(t),...Js(t),...il(t),...WS(t),items:HS(t.members)})}function qS(t){let e=[],n=[],r,s;for(let c of t.sequences||[])c.canvases.length&&e.push(...c.canvases),c.behavior&&n.push(...c.behavior),c.viewingDirection&&(s=c.viewingDirection),c.startCanvas&&(r=c.startCanvas);let a=Zs(t);return n.length&&(a.behavior?a.behavior.push(...n):a.behavior=n),is({...a,...Js(t),...il(t),viewingDirection:s,start:r,items:e,structures:QS(t.structures)})}function QS(t){if(!t)return t;let e=new Map;for(let r of t)e.set(r.id,r);let n=[];for(let r of t)if(r.items){let s=r.items.map(a=>typeof a=="string"?(n.push(a),e.get(a)||a):a&&a.id?(n.push(a.id),e.get(a.id)||a):a);r.items=s}return t.filter(r=>n.indexOf(r.id)===-1)}function XS(t){return is({...Zs(t),...Js(t),...il(t),annotations:t.otherContent&&t.otherContent.length?t.otherContent:void 0,items:t.images&&t.images.length?[{id:u0(t,"annotation-page"),type:"AnnotationPage",items:t.images}]:void 0})}function YS(t){return is({...Zs(t),...Js(t),...il(t),items:t.resources&&t.resources.length?t.resources:void 0})}function KS(t){return!t.canvases||t.canvases.length===0?{canvases:[],behavior:[]}:{canvases:t.canvases,behavior:t.viewingHint?[t.viewingHint]:[],viewingDirection:t.viewingDirection,startCanvas:t.startCanvas}}function GS(t){function e(n){if(Array.isArray(n)){if(n.length>1)return{type:"List",items:n.map(e)};n=n[0]}if(typeof n=="string")return encodeURI(n).trim();if("@type"in n){let r;if(typeof n.full=="string")r=n.full;else if(n.full["@type"]==="dctypes:Image")r={id:n.full["@id"],type:"Image"};else if(n.full["@type"]==="sc:Canvas")r={id:n.full["@id"],type:"Canvas"};else throw Error(`Unsupported source type on annotation: ${n.full["@type"]}`);return{type:"SpecificResource",source:r,selector:Vp(n.selector)}}else return encodeURI(n["@id"]).trim()}return is({...Zs(t),...Js(t),...il(t),target:e(t.on),body:Array.isArray(t.resource)?t.resource.map(Vm):Vm(t.resource)})}function Vm(t){return t.type==="Choice"?t:c0(t)}function c0(t){let e=t;return is({...Zs(e),...Js(e),...il(e),...US(e)})}function ZS(t){let e=[];return t.default&&t.default!=="rdf:nil"&&e.push(t.default),t.item&&t.item!=="rdf:nil"&&e.push(...t.item),is({...Zs(t),...Js(t),items:e})}function JS(t){return is({...Zs(t),...Js(t),...il(t),items:t.members})}function eP(t){let{"@id":e,"@type":n,"@context":r,profile:s,...a}=t,c={};return e&&(c["@id"]=e),c["@type"]=Pg(t),c["@type"]==="unknown"&&(r&&r.length&&(c["@context"]=r),c["@type"]="Service"),s&&(c.profile=a0(s)),is({...c,...a})}function tP(t){return is({...Zs(t),...Js(t),...il(t)})}const nP=new RS({collection:[VS],manifest:[qS],canvas:[XS],annotationList:[YS],sequence:[KS],annotation:[GS],contentResource:[c0],choice:[ZS],range:[JS],service:[eP],layer:[tP]});function rP(t){return t&&t["@context"]&&(t["@context"]==="http://iiif.io/api/presentation/2/context.json"||t["@context"].indexOf("http://iiif.io/api/presentation/2/context.json")!==-1||t["@context"]==="http://www.shared-canvas.org/ns/context.json")||t["@context"]==="http://iiif.io/api/image/2/context.json"||t["@id"]&&t["@type"]==="sc:Collection"||t["@id"]&&t["@type"]==="sc:Manifest"?(t["@context"]||="http://iiif.io/api/presentation/2/context.json",nP.traverseUnknown(t)):t}function Vp(t){if((Array.isArray(t["@type"])&&t["@type"].includes("oa:SvgSelector")||t["@type"]=="oa:SvgSelector")&&("chars"in t||"value"in t))return{type:"SvgSelector",value:"chars"in t?t.chars:t.value};if(t["@type"]==="oa:FragmentSelector")return{type:"FragmentSelector",value:t.value};if(t["@type"]==="oa:Choice")return[Vp(t.default),...(Array.isArray(t.item)?t.item:[t.item]).map(Vp)];if(t["@type"]=="iiif:ImageApiSelector")return{type:"ImageApiSelector",region:"region"in t?t.region:void 0,rotation:"rotation"in t?t.rotation:void 0};throw Error(`Unsupported selector type: ${t["@type"]}`)}function qd(t,e){let n="unknown";if(!t)return;if(typeof t=="string")return{id:t,type:n};if(Vs(t))return qd(t.source);let r=t.type||t["@type"],s=t.id||t["@id"];if(r&&r.indexOf(":")!==-1&&(r=r.split(":").pop()),s&&r)return{id:s,type:r}}const kc={},On="iiif-parser:hasPart",Ks="iiif-parser:partOf",Cc="iiif-parser:isExternal",Ii="__$UNSET$__",f0="__$UNWRAP$__",He=[];Object.freeze(He),Object.freeze(kc);function iP(t){if(t===kc||Object.keys(t).length===0)return!0;for(let e in t)return!1;return!0}function Eg(t,e){if(e&&e["@explicit"]){let n={},r=Object.keys(e);for(let s of r)s===Ks||s==="@explicit"||(iP(e[s])?n[s]=t[s]:n[s]=e[s]);return n}return t}function d0(t,e,n){let r=qd(e);if(!r)return[void 0,void 0];let s=t.requests[r.id],a=r.type||t.mapping[r.id];if(!a||s&&s.resourceUri&&(!t.entities[a]||!t.entities[a][s.resourceUri]))return[void 0,void 0];let c=t.entities[a][s?s.resourceUri:r.id];if(r.type&&!c)return d0(t,{id:r.id},n);if(c&&c[On]){let d=c[On].find(y=>n?y[Ks]===n.id:y[Ks]===c.id);return[Eg(c,d),c]}return[c,c]}const sP={id:"https://iiif-parser/annotation-page",type:"AnnotationPage",behavior:He,label:null,thumbnail:He,summary:null,requiredStatement:null,metadata:He,rights:null,provider:He,items:He,seeAlso:He,homepage:He,rendering:He,service:He},oP={id:"https://iiif-parser/empty-canvas",type:"Canvas",label:null,behavior:He,thumbnail:He,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:He,rights:null,navDate:null,provider:He,items:He,annotations:He,seeAlso:He,homepage:He,partOf:He,rendering:He,service:He,duration:0,height:0,width:0},lP={id:"https://iiif-parser/empty-collection",type:"Collection",label:null,viewingDirection:"left-to-right",behavior:He,thumbnail:He,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:He,rights:null,navDate:null,provider:He,items:He,annotations:He,seeAlso:He,homepage:He,partOf:He,rendering:He,service:He,services:He},aP={id:"https://iiif-parser/empty-manifest",type:"Manifest",annotations:He,behavior:He,homepage:He,items:He,label:null,metadata:He,navDate:null,provider:He,partOf:He,accompanyingCanvas:null,placeholderCanvas:null,rendering:He,requiredStatement:null,rights:null,seeAlso:He,service:He,services:He,start:null,structures:He,summary:null,thumbnail:He,viewingDirection:"left-to-right"},uP={id:"https://iiif-parser/empty-canvas",type:"Range",label:null,behavior:He,thumbnail:He,accompanyingCanvas:null,placeholderCanvas:null,summary:null,requiredStatement:null,metadata:He,rights:null,navDate:null,provider:He,items:He,annotations:He,seeAlso:He,homepage:He,partOf:He,rendering:He,service:He,start:null,supplementary:null,viewingDirection:"left-to-right"},cP={id:"https://iiif-parser/empty-agent",type:"Agent",label:{},logo:He,seeAlso:He,homepage:He},fP={id:"https://iiif-parser/empty-service",type:"UnknownService"};function Pd(t,e={}){if(Array.isArray(t))return Pd(t[0]);if(typeof t=="string"){let[n,r]=t.split("#");return r?{type:"SpecificResource",source:{id:n,type:e.typeHint||"Unknown"},selector:{type:"FragmentSelector",value:r}}:{type:"SpecificResource",source:{id:n,type:e.typeMap&&e.typeMap[n]||e.typeHint||"Unknown"}}}if(t.type==="Choice"||t.type==="List"||t.type==="Composite"||t.type==="Independents")return Pd(t.items[0]);if(!t.type&&"source"in t&&(t.type="SpecificResource"),t.type==="SpecificResource"){t.source.type==="Canvas"&&t.source.partOf&&typeof t.source.partOf=="string"&&(t.source.partOf=[{id:t.source.partOf,type:"Manifest"}]);let n=typeof t.source=="string"?t.source:t.source.id;if(n?.includes("#")){let r=Pd(n,e);r&&(t.selector=r.selector,t.source=r.source)}return t.selector?{...t,type:"SpecificResource",source:t.source,selector:t.selector}:{...t,type:"SpecificResource",source:t.source}}if(t.id){t.type==="Canvas"&&t.partOf&&typeof t.partOf=="string"&&(t.partOf=[{id:t.partOf,type:"Manifest"}]);let[n,r]=t.id.split("#");return r?{type:"SpecificResource",source:{...t,id:n},selector:{type:"FragmentSelector",value:r}}:{type:"SpecificResource",source:{...t,id:n}}}return{type:"SpecificResource",source:t}}function dP(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}function h0(t,e){if(typeof t=="string")return{id:t,type:e};if(!t.id)throw Error(`Invalid resource does not have an ID (${JSON.stringify(t)}, ${e})`);return t}function hP(t,e){return(n,r)=>{let s=t[n]?t[n]:{};return(a,c)=>{let d=h0(a,r||n);return d&&d.id&&n?(s[d.id]=s[d.id]?Qp(s[d.id],d,{parent:c.parent,isTopLevel:e.id===d.id}):Qp({id:d.id,type:d.type},d,{parent:c.parent,isTopLevel:e.id===d.id}),{id:d.id,type:n==="ContentResource"?n:d.type}):d}}}function qp(t,e,n){if(!e)return t;if(Array.isArray(t)){if(!Array.isArray(e))throw Error("Cannot merge array with non-array");let r=[...t];for(let s of e)if(s["@id"]&&!s.id&&(s.id=s["@id"]),s["@type"]&&!s.type&&(s.type=s["@type"]),s!=null)if(Array.isArray(s))r.push(s);else if(typeof s=="object"&&s.id&&s.type){let a=r.findIndex(c=>c.id===s.id&&c.type===s.type);a>=0&&(r[a]=qp(r[a],s))}else t.indexOf(s)===-1&&r.push(s);return r}else if(typeof t=="object"){if(Array.isArray(e)||typeof e!="object")throw Error("Cannot merge object with non-object");let r={...t},s=[],a=[],c=Object.keys(t).filter(y=>y!==On&&y!=="id"&&y!=="type"),d={},m={};for(let[y,h]of Object.entries(e)){if(y===On||y==="id"||y==="type")continue;let v=r[y];v===h?a.push(y):v===He||!v?(s.push(y),r[y]=h):(v&&h&&(d[y]=v,m[y]=h),r[y]=qp(v,h),r[y]===d[y]&&(a.push(y),delete d[y]))}if(n&&(n.parent&&n.parent.id||n.isTopLevel)){let y=[],h={};if(n.parent?h[Ks]=n.parent.id:n.isTopLevel&&(h[Ks]=t.id),r[On]&&r[On].length){let v=!(r[On]||[]).find(T=>T["@explicit"]),E=s.length>0||a.length!==c.length;if(v&&E)for(let T of r[On]){let P={...T},k=Object.keys(d);if(P){P["@explicit"]=!0;for(let R of c)R!==On&&(P[R]=kc);for(let R of k)P[R]=d[R]}y.push(P)}else y.push(...r[On]);if(E){let T=Object.keys(m);h["@explicit"]=!0;for(let P of s)h[P]=kc;for(let P of a)h[P]=kc;for(let P of T)h[P]=m[P]}}h.id=r.id,h.type=r.type,y.push(h),r[On]=y}return r}else if(t)return t;return e}function Qp(t,e,n){if(typeof t=="string")return t;if(e.id!==t.id||e.type!==t.type){if(e.type==="ImageService3")return e;if(t.type==="ImageService3")return t;throw Error(`Can only merge entities with identical identifiers and type! ${e.type}(${e.id}) => ${t.type}(${t.id})`)}return qp({...t},e,n)}function pP(t){return(e,n)=>r=>{let{id:s,type:a}=h0(r,n||e);if(s===void 0)throw Error("Found invalid entity without an ID.");return e==="ContentResource"||e==="Service"?t[s]=e:t[s]=a,r}}function gP(t){let e=Object.assign({},t);if(e["@id"]&&(e.id=e["@id"]),e["@type"]&&(e.type=e["@type"]),e.service){let n=[];e.service=Array.isArray(e.service)?e.service:[e.service];for(let r of e.service)n.push({id:r["@id"]||r.id,type:r["@type"]||r.type});e.service=n}return Object.assign({},fP,e)}function mP(t){return e=>{t.Service=t.Service?t.Service:{};let n=e.id||e["@id"],r=gP(e);return r&&r.id&&(t.Service[r.id]?t.Service[n]=Qp(t.Service[n],r):t.Service[n]=r),e}}function yP(t){let e=JSON.stringify(t),n=5381,r=e.length;for(;r;)n=n*33^e.charCodeAt(--r);let s=n>>>0,a=s.toString(16);return a.length%2?"0"+a:a}function up(t){return e=>typeof e=="string"?{id:e,type:t}:e.id?e.type?e:{type:t,...e}:{id:`vault://${yP(e)}`,type:t,...e}}function ru(t){return e=>({...t,...e})}function fc(t){return Array.isArray(t)?t:[t]}function vP(t){return t.body&&=fc(t.body),t.seeAlso&&=fc(t.seeAlso),t.audience&&=fc(t.audience),t.accessibility&&=fc(t.accessibility),t.motivation&&=fc(t.motivation),t}function p0(t,{typeHint:e,partOfTypeHint:n}={}){if(typeof t=="string"&&(t={id:t,type:e||"unknown"}),Vs(t))return typeof t.source=="string"&&(t.source={id:t.source,type:e||"unknown"}),t.source.type==="Canvas"&&t.source.partOf&&typeof t.source.partOf=="string"&&(t.source.partOf=[{id:t.source.partOf,type:n||"Manifest"}]),t;let r;if((t.id||"").indexOf("#")!==-1){let[s,a]=(t.id||"").split("#");t.id=s,a&&(r={type:"FragmentSelector",value:a})}return{type:"SpecificResource",source:t,selector:r}}function xP(t){let e=Object.assign({},t);return t&&t.items&&(e.items=t.items.map(n=>typeof n=="string"||n.type==="Canvas"?p0(n):n)),e}function wP(t){let e=Object.assign({},t);return e.start?(e.start=p0(e.start,{typeHint:"Canvas"}),e):t}function SP(t){let e=Object.assign({},t);return e.target?(e.target=Pd(e.target,{typeHint:"Canvas"}),e):t}function PP(t){return t}function cp(t){return t.items===void 0&&(t[Cc]=!0),t}function EP(t){let e=rP(t),n=dP(),r={},s=hP(n,e),a=pP(r),c=new PS({collection:[cp,ru(lP),a("Collection"),s("Collection")],manifest:[cp,ru(aP),wP,a("Manifest"),s("Manifest")],canvas:[ru(oP),a("Canvas"),s("Canvas")],annotationPage:[cp,up("AnnotationPage"),ru(sP),a("AnnotationPage"),s("AnnotationPage")],annotation:[up("Annotation"),vP,SP,a("Annotation"),s("Annotation")],contentResource:[up("ContentResource"),a("ContentResource"),s("ContentResource")],range:[ru(uP),xP,a("Range","Canvas"),s("Range","Canvas")],agent:[ru(cP),a("Agent"),s("Agent")],specificResource:[PP],service:[mP(n)]}),d=c.traverseUnknown(e);return{entities:n,resource:d,mapping:r}}function kP(t){let e={};for(let[n,r]of t){if(n===f0&&r!==Ii)return r;r!==Ii&&r!=null&&(e[n]=r)}return e}function CP(t,e,n){if(!e.type||!e.id)throw Error("Unknown entity");if(!n[e.type])throw Error(`Serializer not found for ${e.type}`);function r(s,a,c=0){let d=n[s.type];if(!d)return Ii;if(c>20)throw Error("Circular reference: "+s.id+" "+s.type);let[m,y]=d0(t,s.type?s:s.id,a)||(s.id&&s.type?s:null);if(!m)return Ii;let h=d(m,t,{parent:a,isTopLevel:e.id===s.id,fullResource:y}),v=h.next();for(;!v.done;){let E=v.value,T=Ii;if(E)if(Array.isArray(E)){let P=[];for(let k of E)P.push(r(k,s,c+1));T=P}else T=r(E,s,c+1);v=h.next(T)}return v.value===Ii?Ii:kP(v.value)}return r(e)}function Tc(t,{allowSourceString:e=!0,allowString:n=!1,allowedStringType:r}={}){let s=a=>{if(e&&a&&a.source&&typeof a.source!="string"){let c=Object.keys(a.source);if(a.source.id&&a.source.type&&c.length===2)return{...a,source:a.source.id}}return a};if(t){if(t.source&&t.source.partOf)return s(t);let a=Object.keys(t);if(a.length===2&&t.type&&t.source||a.length===3&&t.type&&t.source&&a.indexOf("selector")!==-1&&!t.selector)return n&&(!r||r===t.source.type)?t.source.id:t.source.type==="ContentResource"?{type:"SpecificResource",source:t.source.id}:t.source;if(t.selector&&!Array.isArray(t.selector)&&typeof t.selector!="string"&&t.selector.type==="FragmentSelector"){let c=`${t.source.id}#${t.selector.value}`;return n?c:{id:c,type:t.source.type}}}return s(t)}function ou(t){if(!t)return;let e=Object.keys(t);if(e.length!==0){if(e.length===1){let n=e[0];if(!n)return"";let r=(t[n]||[]).join("");return n==="@none"||n==="none"||n==="en"?r:{"@language":n,"@value":r}}return e.map(n=>({"@language":n,"@value":(t[n]||[]).join("")}))}}function g0(t){return Array.isArray(t)?t.map(e=>g0(e)):typeof t=="string"?t:t.type&&t.type==="Canvas"?t.id:t}function Zo(t,e=!1){if(t)return t.length>1&&!e?t:t[0]||void 0}function TP(t){if(t){if(typeof t=="string")return{"@id":t};if("@id"in t){let e={...t};return delete e["@type"],e}return{"@context":"http://iiif.io/api/image/2/context.json","@id":t.id,profile:`http://iiif.io/api/image/2/profiles/${t.profile}.json`}}}function Dl(t,e){return[["@id",t.id],["@type",e],["format",t.format],["height",t.height],["width",t.width],["viewingDirection",t.viewingDirection==="left-to-right"?void 0:t.viewingDirection],["license",t.license?t.license:void 0]]}function*Bl(t){let e=t.provider?yield t.provider[0]:void 0;return[["label",ou(t.label)],["metadata",t.metadata&&t.metadata.length?t.metadata.map(n=>({label:ou(n.label)||"",value:ou(n.value)||""})):void 0],["description",ou(t.summary)],["thumbnail",Zo(yield t.thumbnail)],["navDate",t.navDate],["logo",e?Zo(e.logo):void 0],["homepage",e?e.homepage:void 0],["attribution",t.requiredStatement?ou(t.requiredStatement.value):void 0]]}function*dc(t){let e=t.start&&t.start.type&&t.start.type==="SpecificResource"?Tc(t.start):t.start;return[["seeAlso",Zo(yield t.seeAlso)],["service",Zo((t.service||[]).map(TP))],["rendering",Zo(yield t.rendering)],["startCanvas",e?e.id:void 0]]}function bP(t){return t.type==="SpecificResource"}function RP(t){return t&&t.type==="FragmentSelector"}function _P(t){if(t&&bP(t)){let e=t.id,n=t.selector?Array.isArray(t.selector)?t.selector[0]:t.selector:void 0;return RP(n)&&(e+="#"+n.value),e}return t?.id}const IP={Manifest:function*(t,e,{isTopLevel:n}){return[...n?[["@context","http://iiif.io/api/presentation/2/context.json"]]:[],...Dl(t,"sc:Manifest"),...yield*Bl(t),...yield*dc(t),["sequences",[{"@id":`${t.id}/sequence0`,"@type":"sc:Sequence",canvases:yield t.items}]],["structures",yield t.structures]]},Canvas:function*(t){let e=yield t.items,n=e[0];return[...Dl(t,"sc:Canvas"),...yield*Bl(t),...yield*dc(t),["images",n?[n.resources]:void 0],["annotations",t.annotations&&t.annotations.length?Zo(yield t.annotations):void 0]]},AnnotationPage:function*(t){return[...Dl(t,"sc:AnnotationList"),...yield*Bl(t),["resources",t.items&&t.items.length?Zo(yield t.items):void 0]]},Annotation:function*(t){return[["@id",t.id],["@type","oa:Annotation"],["motivation","sc:painting"],["on",g0(t.target)],["resource",Zo(yield t.body,!0)]]},ContentResource:function*(t){switch(t.type){case"Image":return[...Dl(t,"dctypes:Image"),...yield*Bl(t),...yield*dc(t)];case"Text":case"Dataset":default:return[...Dl(t,void 0),...yield*Bl(t)]}},AnnotationCollection:function*(t){return[["@id",t.id],["@type","sc:Layer"],["label",ou(t.label)]]},Collection:function*(t){return[...Dl(t,"sc:Collection"),...yield*Bl(t),...yield*dc(t),["members",yield*t.items]]},Range:function*(t){let e=[],n=[];if(t.items)for(let r of t.items){let s=r.type==="SpecificResource"?r.source:r;if(s){let a=yield s;e.push({"@id":_P(r),"@type":s.type,label:a?a.label:void 0,within:t.id}),s.type==="Canvas"&&n.push(s.id)}}return[...Dl(t,"sc:Range"),...yield*Bl(t),...yield*dc(t),["canvases",n.length===e.length?n:void 0],["members",n.length===e.length?void 0:e]]}};function $l(t){return[["id",t.id?.startsWith("vault://")?void 0:t.id],["type",t.type],["format",t.format],["profile",t.profile],["height",t.height||void 0],["width",t.width||void 0],["duration",t.duration||void 0],["viewingDirection",t.viewingDirection==="left-to-right"?void 0:t.viewingDirection],["behavior",t.behavior&&t.behavior.length?t.behavior:void 0],["timeMode",t.timeMode],["motivation",Array.isArray(t.motivation)?t.motivation[0]:t.motivation],[On,Ii]]}function Pn(t){if(t===Ii||!t||t.length===0)return;let e=t.filter(n=>n!==Ii);if(e.length!==0)return e}function m0(t){if(t&&t.type&&t.type==="ImageService2"){let{id:e,type:n,profile:r,...s}=t,a=typeof r=="string"?r:Array.isArray(r)?r.find(c=>typeof c=="string"):"";return{"@id":e,"@type":n,profile:a?a.startsWith("http")?a:`http://iiif.io/api/image/2/${a}.json`:"http://iiif.io/api/image/2/level0.json",...s}}return t}function qm(t){if(Array.isArray(t)||(t=t?[t]:[]),!(!t||t.length===0))return t.map(m0)}function*Ho(t){return[["label",t.label],["metadata",Pn(t.metadata)],["summary",t.summary],["requiredStatement",t.requiredStatement],["rights",Array.isArray(t.rights)?t.rights[0]||void 0:t.rights||void 0],["navDate",t.navDate],["language",t.language],["thumbnail",Pn(yield t.thumbnail)],["placeholderCanvas",yield t.placeholderCanvas],["accompanyingCanvas",yield t.accompanyingCanvas],["provider",Pn(yield t.provider)]]}function*Vo(t,e){let n=[];for(let r of t.partOf||[])r.type==="Manifest"&&e.type==="Manifest"||n.push(yield r);return[["seeAlso",Pn(yield t.seeAlso)],["service",Pn(qm(t.service))],["services",Pn(qm(t.services))],["rendering",Pn(yield t.rendering)],["supplementary",Pn(yield t.supplementary)],["homepage",Pn(yield t.homepage)],["logo",Pn(yield t.logo)],["partOf",Pn(n)],["start",t.start?Tc(t.start):t.start]]}const OP={Manifest:function*(t,e,{isTopLevel:n}){if(!n)return[...$l(t),...yield*Ho(t),["navPlace",t.navPlace]];let r="http://iiif.io/api/presentation/3/context.json";return(t.navPlace||Qm(t))&&(r=["http://iiif.io/api/presentation/3/context.json","http://iiif.io/api/extension/navplace/context.json"]),[["@context",t["@context"]?t["@context"]:r],...$l(t),...yield*Ho(t),...yield*Vo(t),["items",yield t.items],["structures",Pn(yield t.structures)],["annotations",Pn(yield t.annotations)],["navPlace",t.navPlace]]},Canvas:function*(t,e,{parent:n}){return n&&n.type!=="Manifest"&&n.type!=="Canvas"?[["id",t.id]]:[...$l(t),...yield*Ho(t),...yield*Vo(t,n),["items",yield t.items],["annotations",Pn(yield t.annotations)],["navPlace",t.navPlace]]},Agent:function*(t){return[["id",t.id],["type","Agent"],["label",t.label],...yield*Vo(t)]},AnnotationPage:function*(t){let e=Object.entries(t).map(([r,s])=>[r,Array.isArray(s)?Pn(s):s]).filter(([r,s])=>r!=="items"&&r!=="id"&&r!==On&&r!==Ks&&r!==Cc),n=yield t.items;return[["id",t.id?.startsWith("vault://")?void 0:t.id],...e,...yield*Vo(t),["items",n.length||t[Cc]===!1?n:Ii]]},Service:function*(t){return[[f0,m0(t)]]},Annotation:function*(t){let e=Object.entries(t).map(([r,s])=>r==="motivation"?[r,Array.isArray(s)?s[0]:s]:r==="target"?[r,Tc(s,{allowString:!0,allowSourceString:!0,allowedStringType:"Canvas"})]:[r,Array.isArray(s)?Pn(s):s]).filter(([r])=>r!=="body"&&r!==On&&r!==Cc),n;if(Array.isArray(t.body)){let r=[];for(let s of t.body)if(s&&Vs(s)){let a={...s};s.source.type==="Canvas"?a.source=s.source:a.source=yield s.source,r.push(Tc(a,{allowSourceString:!0}))}else r.push(yield s);n=r}else t.body&&Vs(t.body)?(n={...t.body},n.source=yield t.body.source):n=yield t.body;return[...e,...yield*Ho(t),...yield*Vo(t),["body",n.length===1?n[0]:n]]},ContentResource:function*(t){return AP([...$l(t),...yield*Ho(t),...yield*Vo(t),["annotations",Pn(yield t.annotations)],["items",Pn(yield t.items)]],t)},AnnotationCollection:function*(t){return[["id",t.id],["type","AnnotationCollection"],["label",t.label]]},Collection:function*(t,e,{isTopLevel:n}){if(n){let r="http://iiif.io/api/presentation/3/context.json";return(t.navPlace||Qm(t))&&(r=["http://iiif.io/api/extension/navplace/context.json","http://iiif.io/api/presentation/3/context.json"]),[["@context",r],...$l(t),...yield*Ho(t),...yield*Vo(t),["items",Pn(yield t.items)],["navPlace",t.navPlace]]}return[...$l(t),...yield*Ho(t),["navPlace",t.navPlace]]},Range:function*(t){let e=[];for(let n of t.items)n.type==="Range"?e.push(yield n):n&&n.type==="SpecificResource"?e.push(Tc(n)):e.push(n);return[...$l(t),...yield*Ho(t),...yield*Vo(t),["items",e],["annotations",Pn(yield t.annotations)],["navPlace",t.navPlace]]}};function AP(t,e){let n=Object.keys(e),r=t.map(([s])=>s);for(let s of n)s===On||s===Cc||r.indexOf(s)===-1&&e[s]!==void 0&&t.push([s,e[s]]);return t}function Qm(t){if(!t.items||!Array.isArray(t.items))return!1;for(let e of t.items)if(e.navPlace)return!0;return!1}function MP(t,e){return Vs(t)?typeof t.source=="string"?{...t,source:e}:{...t,source:{...t.source||{},id:e}}:{...t,id:e}}const Zt=function(t){return function(){let e={type:t,getType:()=>t,toString:()=>t};return(n,r)=>({...e,...n!==void 0&&{payload:n},...r!==void 0&&{meta:r}})}},y0="@iiif/IMPORT_ENTITIES",v0="@iiif/MODIFY_ENTITY_FIELD",x0="@iiif/REORDER_ENTITY_FIELD",w0="@iiif/MOVE_ENTITY",Xp="@iiif/MOVE_ENTITIES",S0="@iiif/ADD_REFERENCE",Yp="@iiif/UPDATE_REFERENCE",P0="@iiif/CHANGE_REFERENCE_IDENTIFIER",E0="@iiif/REMOVE_REFERENCE",k0="@iiif/ADD_METADATA",C0="@iiif/REMOVE_METADATA",Kp="@iiif/UPDATE_METADATA",T0="@iiif/REORDER_METADATA",b0=Zt(y0)(),jP=Zt(v0)(),LP=Zt(x0)(),NP=Zt(w0)(),zP=Zt(Xp)(),FP=Zt(S0)(),DP=Zt(E0)(),BP=Zt(Yp)(),$P=Zt(P0)(),UP=Zt(k0)(),WP=Zt(Kp)(),HP=Zt(C0)(),VP=Zt(T0)(),Ed={importEntities:b0,modifyEntityField:jP,reorderEntityField:LP,addReference:FP,removeReference:DP,updateReference:BP,changeReferenceIdentifier:$P,addMetadata:UP,removeMetadata:HP,updateMetadata:WP,reorderMetadata:VP,moveEntity:NP,moveEntities:zP},R0="@iiif/ADD_MAPPING",_0="@iiif/ADD_MAPPINGS",qP=Zt(R0)(),QP=Zt(_0)(),Gp="RESOURCE_ERROR",I0="RESOURCE_LOADING",Zp="RESOURCE_READY",O0="@iiif/REQUEST_RESOURCE",A0="@iiif/REQUEST_ERROR",M0="@iiif/REQUEST_MISMATCH",j0="@iiif/REQUEST_COMPLETE",XP="@iiif/REQUEST_OFFLINE_RESOURCE",YP=Zt(O0)(),Jp=Zt(A0)(),KP=Zt(M0)(),GP=Zt(j0)(),kg="@iiif/BATCH",ZP="@iiif/BATCH_IMPORT",eg=Zt(kg)(),L0="@iiif/SET_META_VALUE",N0="@iiif/SET_META_VALUE_DYNAMIC",z0="@iiif/UNSET_META_VALUE",JP=Zt(L0)(),eE=Zt(N0)(),tE=Zt(z0)(),Xm={setMetaValue:JP,setMetaValueDynamic:eE,unsetMetaValue:tE},nE=(t,e)=>{let{entities:n,resource:r,mapping:s}=EP(e);if(r.id===void 0)return[Jp({id:t,message:"ID is not defined in resource."})];let a=[b0({entities:n}),QP({mapping:s})];return r.id!==t&&(a.push(qP({id:t,type:r.type})),a.push(KP({requestId:t,actualId:r.id}))),a.push(GP({id:t})),a},Ym=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function rE(t,e){return!!(t===e||Ym(t)&&Ym(e))}function Km(t,e){if(!Array.isArray(t)||!Array.isArray(e))return t===e;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!rE(t[n],e[n]))return!1;return!0}function fp(t,e,n){let r=t.iiif.requests[e],s=t.iiif.mapping[e];if(!s||!t.iiif.entities[s][r.resourceUri])return;let a=t.iiif.entities[s][r.resourceUri];if(a&&a[On]){let c=a[On].find(d=>d[Ks]===a.id);return Eg(a,c)}return a}function iE(t){return t&&typeof t.then=="function"}function Gm(t,e,{waitTimeout:n=30}={}){return(r,s,a)=>{let c=t.getStore(),d=c.getState(),m=d.iiif.requests[r];if(m){if(m.loadingState===Zp){let h=fp(d,r);if(h)return h}switch(m.loadingState){case Gp:break;case I0:return(async()=>{let h,v=!1;try{let E=await Promise.race([new Promise((T,P)=>{v||(h=c.subscribe(()=>{let k=c.getState();if(k.iiif.requests[r].loadingState===Gp){P();return}if(k.iiif.requests[r].loadingState===Zp){let R=fp(k,r);R?T(R):P()}}))}),new Promise((T,P)=>setTimeout(()=>{v=!0,P()},n*60*1e3))]);if(h&&h(),E)return E}catch{h&&h()}})()}}t.dispatch(YP({id:r}));let y=h=>{if(!h)return;!h.id&&!h["@id"]&&(h["@type"]&&(h["@id"]=r),h.id=r);let v=nE(r,h);return t.dispatch(eg({actions:v})),fp(c.getState(),r)};try{let h=e(r,s);return iE(h)?(async()=>{try{let v=await h;return a&&(v=a(v)),y(v)}catch(v){throw t.dispatch(Jp({id:r,message:v.toString()})),v}})():y(a?a(h):h)}catch(h){throw t.dispatch(Jp({id:r,message:h.toString()})),h}}}function F0(){return{Collection:{},Manifest:{},Canvas:{},AnnotationPage:{},AnnotationCollection:{},Annotation:{},ContentResource:{},Range:{},Service:{},Selector:{},Agent:{}}}const dp={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_APP_VERSION:"0-0-0"},sE=(t,e)=>(n,r,s)=>(s.dispatch=a=>(n(c=>t(c,a),!1,a),a),s.dispatchFromDevtools=!0,{dispatch:(...a)=>s.dispatch(...a),...e}),oE=sE,tg=new Map,ld=t=>{let e=tg.get(t);return e?Object.fromEntries(Object.entries(e.stores).map(([n,r])=>[n,r.getState()])):{}},lE=(t,e,n)=>{if(t===void 0)return{type:"untracked",connection:e.connect(n)};let r=tg.get(n.name);if(r)return{type:"tracked",store:t,...r};let s={connection:e.connect(n),stores:{}};return tg.set(n.name,s),{type:"tracked",store:t,...s}},aE=(t,e={})=>(n,r,s)=>{let{enabled:a,anonymousActionType:c,store:d,...m}=e,y;try{y=(a??(dp?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!y)return(dp?"production":void 0)!=="production"&&a&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),t(n,r,s);let{connection:h,...v}=lE(d,y,m),E=!0;s.setState=(k,R,_)=>{let M=n(k,R);if(!E)return M;let L=_===void 0?{type:c||"anonymous"}:typeof _=="string"?{type:_}:_;return d===void 0?(h?.send(L,r()),M):(h?.send({...L,type:`${d}/${L.type}`},{...ld(m.name),[d]:s.getState()}),M)};let T=(...k)=>{let R=E;E=!1,n(...k),E=R},P=t(s.setState,r,s);if(v.type==="untracked"?h?.init(P):(v.stores[v.store]=s,h?.init(Object.fromEntries(Object.entries(v.stores).map(([k,R])=>[k,k===v.store?P:R.getState()])))),s.dispatchFromDevtools&&typeof s.dispatch=="function"){let k=!1,R=s.dispatch;s.dispatch=(..._)=>{(dp?"production":void 0)!=="production"&&_[0].type==="__setState"&&!k&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),k=!0),R(..._)}}return h.subscribe(k=>{switch(k.type){case"ACTION":if(typeof k.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return hp(k.payload,R=>{if(R.type==="__setState"){if(d===void 0){T(R.state);return}Object.keys(R.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);let _=R.state[d];if(_==null)return;JSON.stringify(s.getState())!==JSON.stringify(_)&&T(_);return}s.dispatchFromDevtools&&typeof s.dispatch=="function"&&s.dispatch(R)});case"DISPATCH":switch(k.payload.type){case"RESET":return T(P),d===void 0?h?.init(s.getState()):h?.init(ld(m.name));case"COMMIT":if(d===void 0){h?.init(s.getState());return}return h?.init(ld(m.name));case"ROLLBACK":return hp(k.state,R=>{if(d===void 0){T(R),h?.init(s.getState());return}T(R[d]),h?.init(ld(m.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return hp(k.state,R=>{if(d===void 0){T(R);return}JSON.stringify(s.getState())!==JSON.stringify(R[d])&&T(R[d])});case"IMPORT_STATE":{let{nextLiftedState:R}=k.payload,_=R.computedStates.slice(-1)[0]?.state;if(!_)return;T(d===void 0?_:_[d]),h?.send(null,R);return}case"PAUSE_RECORDING":return E=!E}return}}),P},uE=aE,hp=(t,e)=>{let n;try{n=JSON.parse(t)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&e(n)},cE=t=>(e,n,r)=>{let s=r.subscribe;return r.subscribe=(c,d,m)=>{let y=c;if(d){let h=m?.equalityFn||Object.is,v=c(r.getState());y=E=>{let T=c(E);if(!h(v,T)){let P=v;d(v=T,P)}},m?.fireImmediately&&d(v,v)}return s(y)},t(e,n,r)},fE=cE,dE=(t={},e)=>{switch(e.type){case R0:return{...t,[e.payload.id]:e.payload.type};case _0:return{...t,...e.payload.mapping};default:return t}};function hc(t,e,n,r){return!(!t[n]||!t[n][e]||!t[n][e][r]||!Array.isArray(t[n][e][r]))}function hE(t,e){let n={},r=[];for(let[s,a]of Object.entries(t||{})){r.push(s);let c=(e||{})[s];if(!c||c.length===0){n[s]=a;continue}n[s]=c}for(let[s,a]of Object.entries(e||{}))r.indexOf(s)===-1&&(n[s]=a);return n}function qe(t){return t.payload||{}}function pE(t,e,n){if(!t[e]||!Array.isArray(t[e]))return null;let r=n.index===void 0?t[e].findIndex(s=>s?qd(s)?.id===n.id:!1):n.index;return r===-1?null:{entity:t[e][r],index:r}}function Zm(t,e){if(!(!e?.id||!e?.type))return t[e.type]?.[e.id]}function ad(t,e){return t===void 0?e:t}const D0=(t=F0(),e)=>{let n=(r,s)=>({...t,[qe(e).type]:{...t[qe(e).type],[qe(e).id]:{...r,...s}}});switch(e.type){case v0:{if(!t[qe(e).type]||!t[qe(e).type][qe(e).id])return t;let r=t[qe(e).type][qe(e).id];return typeof r=="string"?t:n(r,{[qe(e).key]:qe(e).value})}case x0:{if(!hc(t,qe(e).id,qe(e).type,qe(e).key))return t;let r=t[qe(e).type][qe(e).id];if(typeof r=="string")return t;let s=Array.from(r[qe(e).key]),[a]=s.splice(qe(e).startIndex,1);return s.splice(qe(e).endIndex,0,a),n(r,{[qe(e).key]:s})}case Xp:{let r=qe(e).subjects,s=qe(e).from,a=qe(e).to||s,c=Zm(t,s),d=a?.key||s.key;if(!hc(t,s.id,s.type,s.key)||!hc(t,a.id,a.type,a.key))return t;let m=[],y=[];if(r.type==="slice"){let _=r.startIndex,M=r.length;m=Array.from(c[s.key]),y=m.splice(_,M)}else{let _=Array.from(c[s.key]);for(let M of r.items){let L=pE(c,s.key,M);L&&(y.push(L.entity),_[L.index]=null),m=_.filter($=>$!==null)}}let h={...c,[s.key]:m},v={...t,[s.type]:{...t[s.type],[s.id]:h}},E=Zm(v,a);if(!E)return t;let T=a?.index===void 0?E[d].length:a.index,P=Array.from(E[a.key]);P.splice(T,0,...y);let k={...E,[d]:P};return{...v,[a.type]:{...v[a.type],[a.id]:k}}}case w0:return D0(t,{type:Xp,payload:{subjects:{type:"list",items:[qe(e).subject]},from:qe(e).from,to:qe(e).to}});case P0:{let{id:r,index:s,key:a,newIdentifier:c,reference:d,type:m}=qe(e),y=t[m][r],h=qd(d);if(!y||!y[a]||!h||s<0)return t;let v=y[a],E=v[s],T=t[h.type]?.[h.id];if(!T||!E)return t;let P=MP(E,c),k=Array.from(v);k.splice(ad(s,k.length+1),1,P);let R=n(y,{[a]:k}),_={...T,id:c};_["iiif-parser:hasPart"]&&=_["iiif-parser:hasPart"].filter(L=>L["iiif-parser:partOf"]===r).map(L=>({...L,id:c}));let M={...R[h.type],[c]:_};return R[h.type]=M,R}case y0:{let r=Object.keys(qe(e).entities),s={...t};for(let a of r){let c=qe(e).entities[a],d={...t[a]||{}},m=!1,y=Object.keys(c||{})||[];if(c&&y){for(let h of y)m=!0,d[h]=t[a][h]?hE(t[a][h],c[h]):c[h];m&&(s[a]=d)}}return s}case S0:{if(!hc(t,qe(e).id,qe(e).type,qe(e).key))return t;let r=t[qe(e).type][qe(e).id],s=Array.from(r[qe(e).key]);return s.splice(ad(qe(e).index,s.length+1),0,qe(e).reference),n(r,{[qe(e).key]:s})}case Yp:case E0:{if(!hc(t,qe(e).id,qe(e).type,qe(e).key))return t;let r=t[qe(e).type][qe(e).id],s=Array.from(r[qe(e).key]),a=ad(qe(e).index,s.findIndex(c=>c&&c.id===qe(e).reference.id));return a===-1||s[a]?.id!==qe(e).reference.id?t:(e.type===Yp?s.splice(a,1,qe(e).reference):s.splice(a,1),n(r,{[qe(e).key]:s}))}case k0:{let r=t[qe(e).type][qe(e).id];if(!r)return t;let s=Array.from(r.metadata||[]),a=qe(e);return s.splice(ad(e.payload.beforeIndex,s.length+1),0,{label:a.label,value:a.label}),n(r,{metadata:s})}case T0:{let r=t[qe(e).type][qe(e).id];if(typeof r=="string"||!r)return t;let s=Array.from(r.metadata||[]),[a]=s.splice(qe(e).startIndex,1);return s.splice(qe(e).endIndex,0,a),n(r,{metadata:s})}case Kp:case C0:{let r=t[qe(e).type][qe(e).id],s=Array.from(r.metadata||[]),a=qe(e).atIndex;return a===void 0||a===-1||!s[a]?t:(e.type===Kp?s.splice(a,1,{label:qe(e).label,value:qe(e).value}):s.splice(a,1),n(r,{metadata:s}))}default:return t}},gE=(t={},e)=>{switch(e.type){case O0:case XP:return{...t,[e.payload.id]:{requestUri:e.payload.id,loadingState:I0,uriMismatch:!1,resourceUri:e.payload.id}};case M0:return{...t,[e.payload.requestId]:{...t[e.payload.requestId]||{},uriMismatch:!0,resourceUri:e.payload.actualId},[e.payload.actualId]:{requestUri:e.payload.requestId,loadingState:t[e.payload.requestId].loadingState,uriMismatch:!0,resourceUri:e.payload.actualId}};case A0:return{...t,[e.payload.id]:{...t[e.payload.id]||{},loadingState:Gp,error:e.payload.message}};case j0:return{...t,[e.payload.id]:{...t[e.payload.id]||{},loadingState:Zp,error:void 0}}}return t},mE=(t={},e)=>{let{id:n,updateValue:r,value:s,meta:a,key:c}=e&&e.payload||{};switch(e.type){case L0:return{...t,[n]:{...t[n]||{},[a]:{...t[n]&&t[n][a]||{},[c]:s}}};case N0:return{...t,[n]:{...t[n]||{},[a]:{...t[n]&&t[n][a]||{},[c]:t[n]&&t[n][a]?r(t[n][a][c]):r(void 0)}}};case z0:return t[n]&&t[n][a]&&t[n][a][c]?{...t,[n]:{...t[n]||{},[a]:{...t[n]&&t[n][a]||{},[c]:void 0}}}:t;default:return t}};function B0(t={}){let e=Object.keys(t);return function(n={},r){let s=!1,a={};for(let c=0;c<e.length;c++){let d=e[c];a[d]=t[d](n[d],r),s||=a[d]!==n[d]}return s?a:n}}function yE(t){return(e,n)=>n&&n.type===kg?n.payload.actions.reduce(t,e):n&&n.type===ZP?{...e,iiif:{...e.iiif,...n.payload.state}}:t(e,n)}const vE=B0({mapping:dE,entities:D0,requests:gE,meta:mE});function xE(){return{iiif:{entities:F0(),meta:{},mapping:{},requests:{}}}}function wE(t={}){let{enableDevtools:e=!1,iiifStoreName:n="iiif",defaultState:r=xE(),customReducers:s={}}=t,a=yE(B0({[n]:vE,...s})),c=!!(typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__);return Tv(fE((c?uE:(m,y)=>m)(oE(a,r),{enabled:e})))}function Cr(t,e,n,r=!0){e[cu]=e[cu]||[],e[cu].push(t);let s=new Map;Object.defineProperty(e,t,{enumerable:r,get(){if(e[Wl][t]===void 0)return;let a=e[Wl][t];if(!a)return a;let c=n.get(e[Wl][t],{parent:this.id?{id:this.id,type:this.type}:void 0});return s.has(c)||(s.clear(),s.set(c,Hl(c,n))),s.get(c)},set(a){e[Wl][t]!==a&&(this[Ul]?n.modifyEntityField({id:this.id,type:this.type},t,$0(a)):this[Wl][t]=a)}})}const Wl=Symbol.for("_refs_"),Ul=Symbol.for("_reactive_"),cu=Symbol.for("_defined_"),Jm=Symbol.for("_parent_");function SE(t,e=!1,n){let r={id:"",type:"unknown",[cu]:[],[Wl]:{},[Jm]:null,[Ul]:null,is(s){return typeof s=="string"?this.id===s:s.id?s.id===this.id:!1},reactive(){if(!this[Ul])return this[Ul]=this.subscribe(()=>this.refresh(),!0),()=>{this.unreactive()}},refresh(){if(this.id){let s=this.unwrap();for(let a of Object.keys(s||{}))this[cu].includes(a)?this[Wl][a]=s[a]:this[a]=s[a]}},unreactive(){this[Ul]&&(this[Ul](),this[Ul]=null)},unwrap(){if(!this.id)throw Error("Invalid object");let s=this[Jm];return t.get(this.id,{parent:s?{id:s,type:"unknown"}:void 0})},toPresentation3(){return t.toPresentation3(this.unwrap())},toPresentation2(){return t.toPresentation2(this.unwrap())},valueOf(){return this.unwrap()},toJSON(){let s=this;return{...s,items:s.items,annotations:s.annotations,structures:s.structures,seeAlso:s.seeAlso,service:s.service,services:s.services,rendering:s.rendering,partOf:s.partOf,start:s.start,supplementary:s.supplementary,homepage:s.homepage,thumbnail:s.thumbnail,placeholderCanvas:s.placeholderCanvas,accompanyingCanvas:s.accompanyingCanvas,provider:s.provider}},subscribe(s,a=!0){return t.subscribe(()=>this.id?t.get(this.id):null,s,a)}};return Cr("items",r,t),Cr("annotations",r,t),Cr("structures",r,t),Cr("seeAlso",r,t),Cr("rendering",r,t),Cr("partOf",r,t),Cr("start",r,t,!1),Cr("supplementary",r,t),Cr("homepage",r,t),Cr("thumbnail",r,t),Cr("placeholderCanvas",r,t,!1),Cr("accompanyingCanvas",r,t,!1),Cr("provider",r,t),Cr("body",r,t),Cr("logo",r,t),r}function PE(t){return!!t[cu]}function $0(t){return Array.isArray(t)?t.map(e=>$0(e)):!t||!t.type?t:{id:t.id,type:t.type}}function Hl(t,e,n=!1,r){if(Array.isArray(t))return t.map(d=>Hl(d,e,n));if(!t||!t.type||!t.id)return t;let s=SE(e,n),a=Object.create(s),c=Object.assign(a,t);return n&&c.reactive(),c}function ey(t){switch(t){case"Image":case"Video":case"Sound":case"Dataset":case"Text":case"Composite":case"List":case"Independents":case"Audience":return"ContentResource";case"ImageService1":case"ImageService2":case"ImageService3":return"Service"}return t}var ng=class{constructor(e,n){ur(this,"options",void 0),ur(this,"store",void 0),ur(this,"emitter",void 0),ur(this,"isBatching",!1),ur(this,"batchQueue",[]),ur(this,"remoteFetcher",void 0),ur(this,"staticFetcher",void 0),ur(this,"defaultFetcher",r=>fetch(r).then(s=>{if(s.status===200)return s.json();{let a=Error(`${s.status} ${s.statusText}`);throw a.name="HTTPError",a}})),this.options=Object.assign({reducers:{},customFetcher:this.defaultFetcher,enableDevtools:!0},e||{}),this.store=n||wE({customReducers:this.options.reducers,defaultState:this.options.defaultState,enableDevtools:this.options.enableDevtools}),this.emitter=bv(),this.remoteFetcher=Gm(this,this.options.customFetcher),this.staticFetcher=Gm(this,(r,s)=>s)}batch(e){this.isBatching=!0;try{e(this),this.isBatching=!1,this.dispatch(eg({actions:this.batchQueue}))}catch(n){throw this.batchQueue=[],this.isBatching=!1,n}this.batchQueue=[]}async asyncBatch(e){this.isBatching=!0;try{await e(this),this.isBatching=!1,this.dispatch(eg({actions:this.batchQueue}))}catch(n){throw this.batchQueue=[],this.isBatching=!1,n}this.batchQueue=[]}modifyEntityField(e,n,r){this.dispatch(Ed.modifyEntityField({id:e.id,type:e.type,key:n,value:r}))}dispatch(e){if(this.isBatching)this.batchQueue.push(e);else{if(e.type===kg){for(let s of e.payload.actions)this.emitter.emit(s.type,{action:s,state:this.store.getState()});this.store.dispatch(e);let r=this.getState();for(let s of e.payload.actions)this.emitter.emit(`after:${s.type}`,{action:s,state:r});return}this.emitter.emit(e.type,{action:e,state:this.store.getState()}),this.store.dispatch(e);let n=this.store.getState();this.emitter.emit(`after:${e.type}`,{action:e,state:n});return}}on(e,n){return this.emitter.on(e,n),()=>{this.emitter.off(e,n)}}serialize(e,n){return CP(this.getState().iiif,e,n)}toPresentation2(e){return this.serialize(e,IP)}toPresentation3(e){return this.serialize(e,OP)}hydrate(e,n,r={}){return this.get(e,n,{...r,skipSelfReturn:!1})}get(e,n,r={}){typeof n!="string"&&(r=n||{},n=void 0);let{skipSelfReturn:s=!0}=r||{},a=r.parent?typeof r.parent=="string"?r.parent:r.parent.id:void 0;if(Array.isArray(e))return e.map(v=>this.get(v,r));let c=this.getState();if(Vs(e)&&!r.preserveSpecificResources&&(e=e.source),typeof e=="string"){let v=ey(n||c.iiif.mapping[e]);if(!v)return s?null:{id:e,type:"unknown"};e={id:e,type:v}}if(e&&e.partOf&&!a&&!r.skipPartOfCheck){let v=Array.isArray(e.partOf)?e.partOf[0]:e.partOf;v&&(typeof v=="string"&&(a=v),typeof v.id=="string"&&(a=v.id))}let d=ey(n||e?.type),m=e?.id,y=c.iiif.entities[d];if(!y){let v=c.iiif.requests[m];return v&&v.resourceUri!==m?this.get(v.resourceUri,r):s?null:e}let h=y[e.id];if(h&&h[On]){let v=h[On].find(E=>a?E[Ks]===a:E[Ks]===h.id);return Eg(h,v)}return y[e.id]||(s?null:e)}select(e){return e(this.getState())}getStore(){return this.store}getState(){return this.store.getState()}deep(e,n){if(e===void 0)return this.get(n,{skipSelfReturn:!1});if(typeof e=="function")try{let s=e(this.get(n,{skipSelfReturn:!1})),a=c=>this.deep(c,s);return a.size=Array.isArray(s)?s.length:1,a}catch{let s=a=>this.deep(a,void 0);return s.size=0,s}let r=s=>this.deep(s,e);return r.size=Array.isArray(e)?e.length:1,r}loadManifest(e,n,r){let s=typeof e=="string"?e:e.id;return this.load(s,n,r)}loadCollection(e,n,r){let s=typeof e=="string"?e:e.id;return this.load(s,n,r)}load(e,n,r){let s=typeof e=="string"?e:e.id;return n?Promise.resolve(this.staticFetcher(s,n,r)):Promise.resolve(this.remoteFetcher(s,{},r))}loadSync(e,n,r){let s=typeof e=="string"?e:e.id;return this.staticFetcher(s,n,r)}loadManifestSync(e,n,r){let s=typeof e=="string"?e:e.id;return this.loadSync(s,n,r)}loadCollectionSync(e,n,r){let s=typeof e=="string"?e:e.id;return this.loadSync(s,n,r)}areInputsEqual(e,n){return Km(e,n)}subscribe(e,n,r){return r===void 0&&(n===void 0||n===!1||n===!0)&&(r=n,n=e,e=s=>s),this.store.subscribe(e,s=>n(s,this),{equalityFn:Km,fireImmediately:!r})}async ensureLoaded(e){let n=typeof e=="string"?e:e.id;this.requestStatus(n)||await this.load(n)}requestStatus(e){return this.select(n=>n.iiif.requests[e])}getPaginationState(e){let n=typeof e=="string"?e:e.id;if(!n)return null;let r=this.getResourceMeta(n,"@vault/pagination");if(r?.state)return r.state;let s=this.get(e);if(s.first){let a={currentPage:null,currentPageIndex:null,isFetching:!1,isFullyLoaded:!1,next:s.first,page:1,pages:[],previous:null,totalItems:s.total,currentLength:0};return this.setMetaValue([n,"@vault/pagination","state"],a),a}return null}async loadNextPage(e,n){let r=typeof e=="string"?e:e.id;if(!r)return[null,null];let s=this.getPaginationState(e);if(!s||s.isFullyLoaded||!s.next)return[null,null];if(s.isFetching)return[s,null];let a=typeof s.next=="string"?s.next:s.next.id,c=s.currentPage,d={...s,isFetching:!0};this.setMetaValue([r,"@vault/pagination","state"],d);let m;try{m=await this.loadCollection(a,n,T=>{let{id:P,"@id":k,...R}=T||{};return k?{"@id":a,...R}:{id:a,...R}})}catch(T){let P={...s,isFetching:!1,error:T};return this.setMetaValue([r,"@vault/pagination","state"],P),[P,null]}if(!m){let T={...s,isFetching:!1,error:Error("Collection not found")};return this.setMetaValue([r,"@vault/pagination","state"],T),[T,null]}let y=this.get(r),h=[...y.items||[],...m.items||[]].map(T=>({id:T.id,type:T.type}));this.modifyEntityField({id:r,type:"Collection"},"items",h);let v=this.getPaginationState(e);if(!v)throw Error("Pagination state not found");let E={...v,isFetching:!1,error:null,currentPage:m.id,next:m.next?.id||null,currentPageIndex:v.pages.length,currentLength:h.length,pages:[...v.pages,{id:m.id,type:"Collection",startIndex:y.items.length,pageLength:m.items.length,order:typeof v.currentPageIndex=="number"?v.currentPageIndex+1:0}],isFullyLoaded:!m.next,previous:c,page:v.pages.length+1};return this.setMetaValue([r,"@vault/pagination","state"],E),[E,m]}getResourceMeta(e,n){let r=this.getState().iiif.meta[e];if(r)return n?r[n]:r}getObject(e,n,r={}){let{reactive:s,...a}=r;return Hl(this.get(e,n,a),this,s)}async loadObject(e,n){return Hl(await this.load(e,n),this)}async loadManifestObject(e,n){return Hl(await this.loadManifest(e,n),this)}async loadCollectionObject(e,n){return Hl(await this.loadCollection(e,n),this)}wrapObject(e){return Hl(this.get(e,{skipSelfReturn:!1}),this)}isWrapped(e){return PE(e)}setMetaValue([e,n,r],s){this.dispatch(typeof s=="function"?Xm.setMetaValueDynamic({id:e,meta:n,key:r,updateValue:s}):Xm.setMetaValue({id:e,meta:n,key:r,value:s}))}};function EE(){return typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}}function U0(t){let e=EE();try{let r=e.IIIF_VAULT;if(r)return r}catch{}let n=new ng(t);try{e.IIIF_VAULT=n}catch{}return n}const Qd=Xt.createContext({vault:null,setVaultInstance:t=>{}});function Cg({vault:t,vaultOptions:e,useGlobal:n,resources:r,children:s}){const[a,c]=O.useState(()=>t||(n?U0(e):e?new ng(e):new ng));return I.jsx(Qd.Provider,{value:{vault:a,setVaultInstance:c},children:I.jsx(Hd,{value:r||{},children:s})})}const cr=()=>{const{vault:t}=O.useContext(Qd);if(t===null)throw new Error("Vault not found. Ensure you have your provider set up correctly.");return t};function zr(t,e=[]){const n=cr(),[r,s]=O.useState(()=>t(n.getState(),n));return O.useEffect(()=>n.subscribe(a=>t(a,n),a=>{s(a)},!1),e),r}const Xd=Xt.createContext([]);function W0(){const t=O.useContext(Xd);return zr(e=>t.map(n=>e.iiif.entities.Canvas[n]).filter(Boolean),[t])}function Tg(t){const e=O.useContext(Qd);return t||(e&&e.vault?e.vault:U0())}function ss(t={},e=[]){const{id:n,selector:r}=t,s=pu();cr();const a=n||s.manifest,c=zr(d=>a?d.iiif.entities.Manifest[a]:void 0,[a]);return O.useMemo(()=>{if(c)return r?r(c):c},[c,r,...e])}function kE(t,{noCache:e=!1}={}){const n=typeof t=="string"?t:t.id,r=Tg(),[s,a]=O.useState(n),[c,d]=O.useState(void 0),m=O.useMemo(()=>r.get(n,{skipSelfReturn:!0})||void 0,[n,r]),[y,h]=O.useState(m);return O.useEffect(()=>{(async()=>{try{const v=m&&!e?m:await r.load(n),E=v?v.id||v["@id"]:null;v&&s!==E&&a(E),h(v)}catch(v){d(v)}})()},[n,e]),{isLoaded:!!y,id:s,requestId:n,error:c,resource:y,cached:!!(y&&y===m)}}function CE(t,e){const{id:n,isLoaded:r,error:s,resource:a,requestId:c,cached:d}=kE(t,e);return{id:n,isLoaded:r,error:s,manifest:a,requestId:c,cached:d}}function TE({manifest:t,children:e}){return I.jsx(Hd,{value:{manifest:t},children:e})}function bE({range:t,children:e}){return I.jsx(Hd,{value:{range:t},children:e})}function H0(t,e){const n=[];for(const r of e.items)if(r.type==="SpecificResource"&&r.source?.type==="Canvas"&&(r.source.id.indexOf("#")!==-1?n.push({id:r.source.id.split("#")[0],type:"Canvas"}):n.push(r.source)),r.type==="Range"&&n.push(...H0(t,t.get(r))),r.type==="SpecificResource"){const s=typeof r.source=="string"?r.source:r.source.id;n.push({id:s,type:"Canvas"})}return n}function RE(t,e,{disablePaging:n,skipNonPaged:r}={}){const s=e.behavior,a=s.includes("paged"),c=a?!1:s.includes("continuous"),d=a||c?!1:s.includes("individuals"),m=e.type==="Manifest"?e.items:H0(t,e);if(c)return[m,[m.map((P,k)=>k)]];if(d||!a||n)return[m,m.map((P,k)=>[k])];const y=[];let h=[];const v=()=>{h.length&&(y.push([...h]),h=[])};let E=0,T=!1;for(let P=0;P<m.length;P++){const k=t.get(m[P]);if(k.behavior.includes("non-paged")){P===E&&E++,r||(v(),y.push([P]),v());continue}if(P===E||k.behavior.includes("facing-pages")){h.length&&(T=!0),v(),y.push([P]),v();continue}if(h.push(P),T){v(),T=!1;continue}h.length>1&&v()}return h.length&&v(),[m,y]}function V0(t={},e=[]){const{id:n,selector:r}=t,s=pu(),a=n||s.range,c=zr(d=>a?d.iiif.entities.Range[a]:void 0,[a]);return O.useMemo(()=>{if(c)return r?r(c):c},[c,r,...e])}function _E({startCanvas:t,disablePaging:e}){const n=cr(),r=ss(),s=V0(),[a,c]=O.useState(void 0),d=s||r;if(!d)throw new Error("Nothing selected");const[m,y]=O.useMemo(()=>RE(n,d,{disablePaging:e}),[n,d,e]),h=O.useRef(y);if(h.current!==y){const R=h.current[a][0],_=y.findIndex(M=>M.includes(R));h.current=y,c(_)}const v=O.useCallback(k=>{const R=y.findIndex(_=>_.includes(k));c(R===-1?0:R)},[m,y]),E=O.useCallback(k=>{const R=m.findIndex(_=>_.id===k);R!==-1?v(R):c(0)},[m,y]),T=O.useCallback(()=>{c(k=>k>=y.length-1?k:k+1)},[y]),P=O.useCallback(()=>{c(k=>k<=0?0:k-1)},[y]);return typeof a>"u"&&(t?E(t):c(0)),{visibleItems:y[a]?.map(k=>m[k].id)||[],cursor:a,items:m,sequence:y,hasPrevious:a>0,hasNext:a<y.length-1,setSequenceIndex:c,setCanvasIndex:v,setCanvasId:E,next:T,previous:P}}const IE={},ty=t=>{let e;const n=new Set,r=(h,v)=>{const E=typeof h=="function"?h(e):h;if(!Object.is(E,e)){const T=e;e=v??(typeof E!="object"||E===null)?E:Object.assign({},e,E),n.forEach(P=>P(e,T))}},s=()=>e,m={setState:r,getState:s,getInitialState:()=>y,subscribe:h=>(n.add(h),()=>n.delete(h)),destroy:()=>{(IE?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},y=e=t(r,s,m);return m},ta=t=>t?ty(t):ty;var pp={exports:{}},gp={},mp={exports:{}},yp={};var ny;function OE(){if(ny)return yp;ny=1;var t=ea();function e(v,E){return v===E&&(v!==0||1/v===1/E)||v!==v&&E!==E}var n=typeof Object.is=="function"?Object.is:e,r=t.useState,s=t.useEffect,a=t.useLayoutEffect,c=t.useDebugValue;function d(v,E){var T=E(),P=r({inst:{value:T,getSnapshot:E}}),k=P[0].inst,R=P[1];return a(function(){k.value=T,k.getSnapshot=E,m(k)&&R({inst:k})},[v,T,E]),s(function(){return m(k)&&R({inst:k}),v(function(){m(k)&&R({inst:k})})},[v]),c(T),T}function m(v){var E=v.getSnapshot;v=v.value;try{var T=E();return!n(v,T)}catch{return!0}}function y(v,E){return E()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?y:d;return yp.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:h,yp}var ry;function AE(){return ry||(ry=1,mp.exports=OE()),mp.exports}var iy;function ME(){if(iy)return gp;iy=1;var t=ea(),e=AE();function n(y,h){return y===h&&(y!==0||1/y===1/h)||y!==y&&h!==h}var r=typeof Object.is=="function"?Object.is:n,s=e.useSyncExternalStore,a=t.useRef,c=t.useEffect,d=t.useMemo,m=t.useDebugValue;return gp.useSyncExternalStoreWithSelector=function(y,h,v,E,T){var P=a(null);if(P.current===null){var k={hasValue:!1,value:null};P.current=k}else k=P.current;P=d(function(){function _(H){if(!M){if(M=!0,L=H,H=E(H),T!==void 0&&k.hasValue){var se=k.value;if(T(se,H))return $=se}return $=H}if(se=$,r(L,H))return se;var oe=E(H);return T!==void 0&&T(se,oe)?(L=H,se):(L=H,$=oe)}var M=!1,L,$,F=v===void 0?null:v;return[function(){return _(h())},F===null?void 0:function(){return _(F())}]},[h,v,E,T]);var R=s(y,P[0],P[1]);return c(function(){k.hasValue=!0,k.value=R},[R]),m(R),R},gp}var sy;function jE(){return sy||(sy=1,pp.exports=ME()),pp.exports}var LE=jE();const NE=Jl(LE),q0={},{useDebugValue:zE}=Xt,{useSyncExternalStoreWithSelector:FE}=NE;let oy=!1;const DE=t=>t;function Tt(t,e=DE,n){(q0?"production":void 0)!=="production"&&n&&!oy&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),oy=!0);const r=FE(t.subscribe,t.getState,t.getServerState||t.getInitialState,e,n);return zE(r),r}const BE=t=>{(q0?"production":void 0)!=="production"&&typeof t!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof t=="function"?ta(t):t,n=(r,s)=>Tt(e,r,s);return Object.assign(n,e),n},$E=t=>BE;function _i(t,e,n){const r=e.findIndex(c=>c.service.id===t);if(r===-1)return e;const s=[...e],a=n(s[r]);return a===s[r]?e:(s[r]=a,s)}const UE=()=>ta((t,e)=>({currentAuth:-1,authItems:[],login:()=>{const n=e().authItems[e().currentAuth];if(!n||n.isPending||n.isLoggedIn)return;if(n.type!=="active")throw new Error("Cannot login to non-active service");const r=n.service.service.find(s=>s.type==="AuthAccessTokenService2");if(!r)throw new Error("Token service not found");t(()=>({authItems:_i(n.id,e().authItems,s=>({...s,isPending:!0}))})),ly(n.service).then(()=>{vp(r).then(s=>{const a=s.expiresIn,c=Date.now()+a*1e3;t(()=>({authItems:_i(n.id,e().authItems,d=>({...d,isLoggedIn:!0,isPending:!1,session:{token:s.accessToken,expires:c}}))}))}).catch(s=>{t(()=>({authItems:_i(n.id,e().authItems,a=>({...a,isLoggedIn:!1,isPending:!1,error:s.message}))}))})})},logout:()=>{const n=e().authItems[e().currentAuth];if(!n||n.isPending||!n.isLoggedIn)return;if(n.type!=="active")throw new Error("Cannot logout of non-active service");const r=n.service.service.find(a=>a.type==="AuthLogoutService2");if(!r)return;const s=`${r.id}?origin=${Q0()}`;window.open(s),t(()=>({authItems:_i(n.id,e().authItems,a=>({...a,isLoggedIn:!1,session:null,isPending:!1}))}))},nextAuth:()=>{const n=e().authItems.length,r=e().currentAuth+1;r>=n||t(()=>({currentAuth:r}))},previousAuth:()=>{const n=e().currentAuth-1;n<0||t(()=>({currentAuth:n}))},setAuth:n=>{n!==-1&&(n<0||n>=e().authItems.length)||t(()=>({currentAuth:n}))},addService:(n,r)=>{if(!n.service)return;const s=n.service.find(d=>d.type==="AuthAccessTokenService2"),a=n;if(e().authItems.find(d=>d.service.id===n.id)){t(()=>({authItems:_i(n.id,e().authItems,d=>({...d,instances:d.instances+1}))}));return}if(t(()=>({currentAuth:a.profile==="active"?0:e().currentAuth,authItems:[{id:n.id,type:n.profile,service:n,probeId:r,canAuthenticate:!0,instances:1,isPending:!1,isLoggedIn:!1,session:null},...e().authItems]})),n.profile==="external"){if(!s)throw new Error("Token service not found");vp(s).then(d=>{t(()=>({authItems:_i(n.id,e().authItems,m=>({...m,isLoggedIn:!0,isPending:!1,session:{token:d.accessToken,expires:d.expiresIn}}))}))}).catch(d=>{t(()=>({authItems:_i(n.id,e().authItems,m=>({...m,isLoggedIn:!1,isPending:!1,canAuthenticate:!1,error:d.message}))}))})}if(n.profile==="kiosk"){if(!s)throw new Error("Token service not found");t(()=>({authItems:_i(n.id,e().authItems,d=>({...d,isPending:!0}))})),ly(a).then(()=>{vp(s).then(d=>{t(()=>({authItems:_i(n.id,e().authItems,m=>({...m,isLoggedIn:!0,isPending:!1,session:{token:d.accessToken,expires:d.expiresIn}}))}))}).catch(d=>{t(()=>({authItems:_i(n.id,e().authItems,m=>({...m,isLoggedIn:!1,isPending:!1,error:d.message}))}))})})}n.profile},removeService:(n,r)=>{const s=e().currentAuth===e().authItems.findIndex(c=>c.service.id===n.id);let a=e().currentAuth;if(s){const c=e().authItems.find(m=>m.service.id===n.id);c&&c.instances>1||(a=e().authItems.findIndex(y=>y.service.id!==n.id&&y.instances>0))}t(()=>({authItems:_i(n.id,e().authItems,c=>({...c,instances:c.instances-1})),currentAuth:a}))}})),WE=(t,e)=>ta((n,r)=>({service:t,status:t?"unknown":"success",shouldRedirect:!1,redirectResource:null,shouldSubstitute:!1,substituteResource:null,error:null,errorHeading:null,errorNote:null,shouldDisplayResource:!1,token:e||null,async probe(){if(!r().service)return;const s=r().service?.id;if(!s){n({status:"error",error:"Service ID not found",errorHeading:{en:["Service ID not found"]}});return}n({status:"probing"});const a=r().token;try{const c=await fetch(s,{headers:a?{Authorization:`Bearer ${r().token}`,Accept:"application/json"}:{Accept:"application/json"}}).then(d=>d.json());if(c.status===200)n({status:"success",shouldDisplayResource:!0,error:null,errorHeading:null,errorNote:null,shouldSubstitute:!1,shouldRedirect:!1});else if(c.status<400&&c.status>=300){if(!c.location)throw new Error("Redirect location not found");n({status:"error",shouldDisplayResource:!1,shouldRedirect:!0,redirectResource:c.location||null})}else if(c.status===401)n({status:"error",shouldDisplayResource:!1,shouldRedirect:!1,shouldSubstitute:!!c.substitute,substituteResource:c.substitute||null,error:"Unauthorized",errorHeading:c.heading||{en:["Unauthorized"]},errorNote:c.note||null});else throw new Error("Unknown error")}catch(c){n({status:"error",error:c.message,errorHeading:{en:["Unknown error"]}})}},setToken(s){n({token:s})}}));function HE(t){const e=t.service||t.services||[],n={hasAuth:!1,services:{}};for(const r of e)if(r.type==="AuthProbeService2"){n.services.probe=r,n.hasAuth=!0;const s=r.service.filter(a=>a.type==="AuthAccessService2");s[0]&&(n.services.access=s[0])}return n}async function vp(t,{strict:e=!0}={}){return new Promise((n,r)=>{const s=Math.random().toString(36).substring(7),a=`${t.id}?messageId=${s}&origin=${window.location.origin}`,c=y=>{const h=y.data;if(h.messageId===s){if(e&&h.type!=="AuthAccessToken2"){d(),r("Invalid response, expected type=AuthAccessToken2");return}if(!h.accessToken){d(),r("Invalid response, expected accessToken");return}d(),n(h)}},d=()=>window.removeEventListener("message",c),m=document.createElement("iframe");m.src=a,m.style.display="none",document.body.appendChild(m),window.addEventListener("message",c)})}function Q0(t){const e=window.location;return e.protocol+"//"+e.hostname+(e.port?":"+e.port:"")}async function ly(t){const e=`${t.id}?origin=${Q0()}`,n=window.open(e);if(!n)throw new Error("Failed to open window");return new Promise((r,s)=>{const a=setInterval(()=>{n.closed&&(clearInterval(a),r())},500)})}function VE(t){const e=O.useMemo(()=>HE(t),[t]),n=ZE(e.services.access?.id),r=O.useMemo(()=>WE(e.services.probe,n),[e.services.probe]),s=Tt(r);return O.useEffect(()=>{s.status==="unknown"&&!n&&s.probe()},[e.services.probe,s.status]),O.useEffect(()=>{n&&(s.setToken(n),s.probe())},[n]),[t,s,e.hasAuth]}const Bc=O.createContext(null),qE=O.createContext(null);qE.displayName="CurrentAuth";const QE=O.createContext(null);QE.displayName="AuthActions";function XE({children:t}){const e=O.useMemo(()=>UE(),[]);return I.jsx(Bc.Provider,{value:e,children:t})}function YE(){return!!O.useContext(Bc)}function bg(){const t=O.useContext(Bc);if(!t)throw new Error("useAuthActions must be used within a AuthProvider");return t}function KE(){const t=bg();return Tt(t,n=>({login:n.login,logout:n.logout,nextAuth:n.nextAuth,previousAuth:n.previousAuth,setAuth:n.setAuth,addService:n.addService,removeService:n.removeService}))}function GE(t){const e=bg();return Tt(e,r=>r.authItems.find(s=>s.service.id===t))}function ZE(t){const e=bg();return Tt(e,r=>r.authItems.find(s=>s.id===t)?.session?.token)}function JE(t){const e=KE(),n=GE(t.service.id);return O.useEffect(()=>(e?.addService(t.service,t.probeId),()=>{e?.removeService(t.service,t.probeId)}),[t.service]),n?(n.error||!n.isLoggedIn,t.children):null}function xp(){return null}function ek(t){const[e,n,r]=VE(t.resource);t.fallbackComponent;const s=t.loadingComponent||xp,a=t.errorComponent||xp,c=n.service;let d=null;if(!r||!c)return t.children(e);const m=c.service.filter(y=>y.type==="AuthAccessService2");n.status==="error"&&(d=I.jsx(a,{resource:t.resource,error:n.error||"",heading:n.errorHeading,note:n.errorNote,extra:t.extra})),(n.status==="unknown"||n.status==="probing")&&(d=I.jsx(s,{})),n.status==="success"&&(d=t.children(e));for(const y of m)d=I.jsx(JE,{service:y,probeId:c.id,children:d},y.id);return d}const tk=t=>t.id||t["@id"];function nk(t){return(Array.isArray(t.service)?t.service:[t.service]).find(n=>n.profile==="http://iiif.io/api/search/0/autocomplete"||n.profile==="http://iiif.io/api/search/1/autocomplete"||n.profile==="AutoCompleteService1")}const rk=t=>{let e;typeof t=="string"?e={"@context":"http://iiif.io/api/search/1/context.json",profile:"http://iiif.io/api/search/1/search","@id":t,id:t,service:[]}:e=t;const n=e?tk(e):void 0;let r=null;return ta((s,a)=>({service:e,resources:[],lastQuery:{},loading:!1,error:!1,highlight:null,hasSearch:!!e,hasAutocomplete:e?!!nk(e):!1,errorMessage:"",search(c,d={}){if(!n)throw new Error("No search service found.");r&&!r.signal.aborted&&r.abort(),r=new AbortController;const m=new URLSearchParams;c.q&&m.set("q",c.q),c.motivation&&m.set("motivation",c.motivation),c.date&&m.set("date",c.date),c.user&&m.set("user",c.user),s({loading:!0}),fetch(`${n}?${m.toString()}`,{signal:r.signal,headers:{"Content-Type":"application/json",Accept:"application/json",...d.headers||{}}}).then(async y=>{if(!r?.signal.aborted)if(y.ok){const h=await y.json();s({resources:h.resources,error:!1,errorMessage:""})}else s({resources:[],error:!0,errorMessage:y.statusText})})},clearSearch(){s({resources:[],error:!1,errorMessage:""})},highlightResult(c){const d=a().resources.find(m=>m["@id"]===c);s({highlight:d})},nextResult(){const c=a().resources,d=a().highlight;if(!d){s({highlight:c[0]||null});return}const m=c.findIndex(y=>y["@id"]===d["@id"]);if(m===-1){s({highlight:c[0]||null});return}s({highlight:c[m+1]||c[0]||null})},previousResult(){const c=a().resources,d=a().highlight;if(!d){s({highlight:c[c.length-1]||null});return}const m=c.findIndex(y=>y["@id"]===d["@id"]);if(m===-1){s({highlight:c[c.length-1]||null});return}if(m===0){s({highlight:c[c.length-1]||null});return}s({highlight:c[m-1]||c[c.length-1]||null})}}))};function ik(){const t=ss();return t?t.service.find(e=>e.profile==="SearchService1"||e.profile==="http://iiif.io/api/search/1/search"):void 0}const $c=O.createContext(null);$c.displayName="Search";function sk(t){const e=ik();return t.store?I.jsx($c.Provider,{value:t.store,children:t.children}):I.jsx(ok,{service:e,children:t.children})}function ok({service:t,children:e}){const n=O.useMemo(()=>rk(t),[t]);return I.jsx($c.Provider,{value:n,children:e})}const pc=()=>{},Yd=O.createContext({setCurrentCanvasId:pc,setCurrentCanvasIndex:pc,nextCanvas:pc,previousCanvas:pc,items:[],sequence:[],setSequenceIndex:pc,currentSequenceIndex:0,hasNext:!1,hasPrevious:!1});function lk(t){const e=ss(),{cursor:n,visibleItems:r,next:s,sequence:a,items:c,setCanvasIndex:d,setCanvasId:m,previous:y,setSequenceIndex:h,hasNext:v,hasPrevious:E}=_E({startCanvas:t.startCanvas,disablePaging:t.pagingEnabled===!1}),T=O.useMemo(()=>({sequence:a,items:c,setCurrentCanvasId:m,nextCanvas:s,previousCanvas:y,totalCanvases:c.length,setCurrentCanvasIndex:d,setSequenceIndex:h,currentSequenceIndex:n,hasNext:v,hasPrevious:E}),[a,c,m,s,y,c,d,h,n]);return e?r.length===0?null:I.jsx(Yd.Provider,{value:T,children:I.jsx(Xd.Provider,{value:r,children:I.jsx(du,{canvas:r[0],children:t.children})})}):(console.warn("The manifest passed to the provider is not a valid IIIF manifest."),I.jsx("div",{children:"Sorry, something went wrong."}))}function ak(t){const e=Tg(t.vault),n=CE(t.manifest);if(!n)return console.warn("The manifest passed to the provider is not a valid IIIF manifest."),I.jsx("div",{children:"Sorry, something went wrong."});if(n.error)return I.jsx("div",{children:n.error.toString()});if(!n.isLoaded)return I.jsx("div",{children:"Loading..."});const r=I.jsx(lk,{...t,children:t.children});return I.jsx(Cg,{vault:e,children:I.jsx(TE,{manifest:n.id,children:I.jsx(XE,{children:I.jsx(sk,{children:t.rangeId?I.jsx(bE,{range:t.rangeId,children:r}):r})})})})}function Rg(){return O.useContext(Yd)}const uk="modulepreload",ck=function(t){return"/"+t},ay={},uy=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){let y=function(h){return Promise.all(h.map(v=>Promise.resolve(v).then(E=>({status:"fulfilled",value:E}),E=>({status:"rejected",reason:E}))))};var c=y;document.getElementsByTagName("link");const d=document.querySelector("meta[property=csp-nonce]"),m=d?.nonce||d?.getAttribute("nonce");s=y(n.map(h=>{if(h=ck(h),h in ay)return;ay[h]=!0;const v=h.endsWith(".css"),E=v?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${h}"]${E}`))return;const T=document.createElement("link");if(T.rel=v?"stylesheet":uk,v||(T.as="script"),T.crossOrigin="",T.href=h,m&&T.setAttribute("nonce",m),document.head.appendChild(T),v)return new Promise((P,k)=>{T.addEventListener("load",P),T.addEventListener("error",()=>k(new Error(`Unable to preload CSS for ${h}`)))})}))}function a(d){const m=new Event("vite:preloadError",{cancelable:!0});if(m.payload=d,window.dispatchEvent(m),!m.defaultPrevented)throw d}return s.then(d=>{for(const m of d||[])m.status==="rejected"&&a(m.reason);return e().catch(a)})},jc=(t,e,n)=>{const r=t.length,s=n||Ye(r);for(let a=0;a<r;a++)s[a]=a%5===0?t[a+1]<e[3]&&t[a+3]>e[1]&&t[a+2]<e[4]&&t[a+4]>e[2]?1:0:t[a];return s};function Ye(t,e,n){return new Float32Array(t,e,n)}const fk=(t,e,n)=>{const r=t[1]<=e[3]&&t[3]>=e[1]&&t[2]<=e[4]&&t[4]>=e[2],s=n||Ye(5);return r?(s[0]=1,s[1]=Math.max(t[1],e[1]),s[2]=Math.max(t[2],e[2]),s[3]=Math.min(t[3],e[3]),s[4]=Math.min(t[4],e[4]),s):(s[0]=0,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s)},dk=t=>t.length/5,qs=(t,e,n)=>{const r=n||Ye(9);return r[0]=t[0]*e[0]+t[1]*e[3]+t[2]*e[6],r[1]=t[0]*e[1]+t[1]*e[4]+t[2]*e[7],r[2]=t[0]*e[2]+t[1]*e[5]+t[2]*e[8],r[3]=t[3]*e[0]+t[4]*e[3]+t[5]*e[6],r[4]=t[3]*e[1]+t[4]*e[4]+t[5]*e[7],r[5]=t[3]*e[2]+t[4]*e[5]+t[5]*e[8],r[6]=t[6]*e[0]+t[7]*e[3]+t[8]*e[6],r[7]=t[6]*e[1]+t[7]*e[4]+t[8]*e[7],r[8]=t[6]*e[2]+t[7]*e[5]+t[8]*e[8],r};class vt{constructor(e){this.index=0,this.length=e,this.points=Ye(this.length)}static grid(e=1,n=1){return new vt(5*e*n)}static point(e,n){const r=Ye(5);return r[0]=1,r[1]=e,r[2]=n,r[3]=e,r[4]=n,r}static positionPair(e){const n=Ye(5);return n[0]=1,n[1]=e.x1,n[2]=e.y1,n[3]=e.x2,n[4]=e.y2,n}static projection(e){return vt.singleBox(e.width,e.height,e.x,e.y)}static singleBox(e,n,r=0,s=0){const a=Ye(5);return a[0]=1,a[1]=r,a[2]=s,a[3]=e+r,a[4]=n+s,a}row(e){return e(this)}addPoints(e,n,r,s){return this.points[this.index]=1,this.points[1+this.index]=e,this.points[2+this.index]=n,this.points[3+this.index]=r,this.points[4+this.index]=s,this.index+=5,this}addBox(e,n,r,s){return this.addPoints(e,n,e+r,n+s),this}build(){return this.points}}const ns=(t,e)=>{const n=t.length;for(let r=0;r<n;r++)t[r]=r%5===0?e[6]*t[r+1]+e[7]*t[r+2]+e[8]*t[r]:r%5%2===1?e[0]*t[r]+e[1]*t[r+1]+e[2]:e[3]*t[r-1]+e[4]*t[r]+e[5];return t},tl=t=>{const e=Ye(9);return e[0]=t,e[4]=t,e[8]=1,e},Tr=(t,e)=>{const n=Ye(9);return n[0]=1,n[2]=t,n[4]=1,n[5]=e,n[8]=1,n},Lc=(t,e,n)=>qs(Tr((1-t)*e,(1-t)*n),tl(t)),Qs=(t,e,n)=>{const r=t.length,s=n&&n.length>=r?n.slice(0,r):Ye(r);for(let a=0;a<r;a++)s[a]=a%5===0?e[6]*t[a+1]+e[7]*t[a+2]+e[8]*t[a]:a%5%2===1?e[0]*t[a]+e[1]*t[a+1]+e[2]:e[3]*t[a-1]+e[4]*t[a]+e[5];return s},gc=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,hk=typeof AbortController=="function",Id=hk?AbortController:class{constructor(){this.signal=new X0}abort(e=new Error("This operation was aborted")){this.signal.reason=this.signal.reason||e,this.signal.aborted=!0,this.signal.dispatchEvent({type:"abort",target:this.signal})}},pk=typeof AbortSignal=="function",gk=typeof Id.AbortSignal=="function",X0=pk?AbortSignal:gk?Id.AbortController:class{constructor(){this.reason=void 0,this.aborted=!1,this._listeners=[]}dispatchEvent(e){e.type==="abort"&&(this.aborted=!0,this.onabort(e),this._listeners.forEach(n=>n(e),this))}onabort(){}addEventListener(e,n){e==="abort"&&this._listeners.push(n)}removeEventListener(e,n){e==="abort"&&(this._listeners=this._listeners.filter(r=>r!==n))}},_g=new Set,wp=(t,e)=>{const n=`LRU_CACHE_OPTION_${t}`;Kd(n)&&Ig(n,`${t} option`,`options.${e}`,Kl)},Sp=(t,e)=>{const n=`LRU_CACHE_METHOD_${t}`;if(Kd(n)){const{prototype:r}=Kl,{get:s}=Object.getOwnPropertyDescriptor(r,t);Ig(n,`${t} method`,`cache.${e}()`,s)}},mk=(t,e)=>{const n=`LRU_CACHE_PROPERTY_${t}`;if(Kd(n)){const{prototype:r}=Kl,{get:s}=Object.getOwnPropertyDescriptor(r,t);Ig(n,`${t} property`,`cache.${e}`,s)}},Y0=(...t)=>{typeof process=="object"&&process&&typeof process.emitWarning=="function"?process.emitWarning(...t):console.error(...t)},Kd=t=>!_g.has(t),Ig=(t,e,n,r)=>{_g.add(t);const s=`The ${e} is deprecated. Please use ${n} instead.`;Y0(s,"DeprecationWarning",t,r)},Qo=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),K0=t=>Qo(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?kd:null:null;class kd extends Array{constructor(e){super(e),this.fill(0)}}class yk{constructor(e){if(e===0)return[];const n=K0(e);this.heap=new n(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}}class Kl{constructor(e={}){const{max:n=0,ttl:r,ttlResolution:s=1,ttlAutopurge:a,updateAgeOnGet:c,updateAgeOnHas:d,allowStale:m,dispose:y,disposeAfter:h,noDisposeOnSet:v,noUpdateTTL:E,maxSize:T=0,maxEntrySize:P=0,sizeCalculation:k,fetchMethod:R,fetchContext:_,noDeleteOnFetchRejection:M,noDeleteOnStaleGet:L,allowStaleOnFetchRejection:$,allowStaleOnFetchAbort:F,ignoreFetchAbort:H}=e,{length:se,maxAge:oe,stale:me}=e instanceof Kl?{}:e;if(n!==0&&!Qo(n))throw new TypeError("max option must be a nonnegative integer");const K=n?K0(n):Array;if(!K)throw new Error("invalid max value: "+n);if(this.max=n,this.maxSize=T,this.maxEntrySize=P||this.maxSize,this.sizeCalculation=k||se,this.sizeCalculation){if(!this.maxSize&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(this.fetchMethod=R||null,this.fetchMethod&&typeof this.fetchMethod!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.fetchContext=_,!this.fetchMethod&&_!==void 0)throw new TypeError("cannot set fetchContext without fetchMethod");if(this.keyMap=new Map,this.keyList=new Array(n).fill(null),this.valList=new Array(n).fill(null),this.next=new K(n),this.prev=new K(n),this.head=0,this.tail=0,this.free=new yk(n),this.initialFill=1,this.size=0,typeof y=="function"&&(this.dispose=y),typeof h=="function"?(this.disposeAfter=h,this.disposed=[]):(this.disposeAfter=null,this.disposed=null),this.noDisposeOnSet=!!v,this.noUpdateTTL=!!E,this.noDeleteOnFetchRejection=!!M,this.allowStaleOnFetchRejection=!!$,this.allowStaleOnFetchAbort=!!F,this.ignoreFetchAbort=!!H,this.maxEntrySize!==0){if(this.maxSize!==0&&!Qo(this.maxSize))throw new TypeError("maxSize must be a positive integer if specified");if(!Qo(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.initializeSizeTracking()}if(this.allowStale=!!m||!!me,this.noDeleteOnStaleGet=!!L,this.updateAgeOnGet=!!c,this.updateAgeOnHas=!!d,this.ttlResolution=Qo(s)||s===0?s:1,this.ttlAutopurge=!!a,this.ttl=r||oe||0,this.ttl){if(!Qo(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.initializeTTLTracking()}if(this.max===0&&this.ttl===0&&this.maxSize===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.max&&!this.maxSize){const ge="LRU_CACHE_UNBOUNDED";Kd(ge)&&(_g.add(ge),Y0("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",ge,Kl))}me&&wp("stale","allowStale"),oe&&wp("maxAge","ttl"),se&&wp("length","sizeCalculation")}getRemainingTTL(e){return this.has(e,{updateAgeOnHas:!1})?1/0:0}initializeTTLTracking(){this.ttls=new kd(this.max),this.starts=new kd(this.max),this.setItemTTL=(r,s,a=gc.now())=>{if(this.starts[r]=s!==0?a:0,this.ttls[r]=s,s!==0&&this.ttlAutopurge){const c=setTimeout(()=>{this.isStale(r)&&this.delete(this.keyList[r])},s+1);c.unref&&c.unref()}},this.updateItemAge=r=>{this.starts[r]=this.ttls[r]!==0?gc.now():0},this.statusTTL=(r,s)=>{r&&(r.ttl=this.ttls[s],r.start=this.starts[s],r.now=e||n(),r.remainingTTL=r.now+r.ttl-r.start)};let e=0;const n=()=>{const r=gc.now();if(this.ttlResolution>0){e=r;const s=setTimeout(()=>e=0,this.ttlResolution);s.unref&&s.unref()}return r};this.getRemainingTTL=r=>{const s=this.keyMap.get(r);return s===void 0?0:this.ttls[s]===0||this.starts[s]===0?1/0:this.starts[s]+this.ttls[s]-(e||n())},this.isStale=r=>this.ttls[r]!==0&&this.starts[r]!==0&&(e||n())-this.starts[r]>this.ttls[r]}updateItemAge(e){}statusTTL(e,n){}setItemTTL(e,n,r){}isStale(e){return!1}initializeSizeTracking(){this.calculatedSize=0,this.sizes=new kd(this.max),this.removeItemSize=e=>{this.calculatedSize-=this.sizes[e],this.sizes[e]=0},this.requireSize=(e,n,r,s)=>{if(this.isBackgroundFetch(n))return 0;if(!Qo(r))if(s){if(typeof s!="function")throw new TypeError("sizeCalculation must be a function");if(r=s(n,e),!Qo(r))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return r},this.addItemSize=(e,n,r)=>{if(this.sizes[e]=n,this.maxSize){const s=this.maxSize-this.sizes[e];for(;this.calculatedSize>s;)this.evict(!0)}this.calculatedSize+=this.sizes[e],r&&(r.entrySize=n,r.totalCalculatedSize=this.calculatedSize)}}removeItemSize(e){}addItemSize(e,n){}requireSize(e,n,r,s){if(r||s)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache")}*indexes({allowStale:e=this.allowStale}={}){if(this.size)for(let n=this.tail;!(!this.isValidIndex(n)||((e||!this.isStale(n))&&(yield n),n===this.head));)n=this.prev[n]}*rindexes({allowStale:e=this.allowStale}={}){if(this.size)for(let n=this.head;!(!this.isValidIndex(n)||((e||!this.isStale(n))&&(yield n),n===this.tail));)n=this.next[n]}isValidIndex(e){return e!==void 0&&this.keyMap.get(this.keyList[e])===e}*entries(){for(const e of this.indexes())this.valList[e]!==void 0&&this.keyList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield[this.keyList[e],this.valList[e]])}*rentries(){for(const e of this.rindexes())this.valList[e]!==void 0&&this.keyList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield[this.keyList[e],this.valList[e]])}*keys(){for(const e of this.indexes())this.keyList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield this.keyList[e])}*rkeys(){for(const e of this.rindexes())this.keyList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield this.keyList[e])}*values(){for(const e of this.indexes())this.valList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield this.valList[e])}*rvalues(){for(const e of this.rindexes())this.valList[e]!==void 0&&!this.isBackgroundFetch(this.valList[e])&&(yield this.valList[e])}[Symbol.iterator](){return this.entries()}find(e,n){for(const r of this.indexes()){const s=this.valList[r],a=this.isBackgroundFetch(s)?s.__staleWhileFetching:s;if(a!==void 0&&e(a,this.keyList[r],this))return this.get(this.keyList[r],n)}}forEach(e,n=this){for(const r of this.indexes()){const s=this.valList[r],a=this.isBackgroundFetch(s)?s.__staleWhileFetching:s;a!==void 0&&e.call(n,a,this.keyList[r],this)}}rforEach(e,n=this){for(const r of this.rindexes()){const s=this.valList[r],a=this.isBackgroundFetch(s)?s.__staleWhileFetching:s;a!==void 0&&e.call(n,a,this.keyList[r],this)}}get prune(){return Sp("prune","purgeStale"),this.purgeStale}purgeStale(){let e=!1;for(const n of this.rindexes({allowStale:!0}))this.isStale(n)&&(this.delete(this.keyList[n]),e=!0);return e}dump(){const e=[];for(const n of this.indexes({allowStale:!0})){const r=this.keyList[n],s=this.valList[n],a=this.isBackgroundFetch(s)?s.__staleWhileFetching:s;if(a===void 0)continue;const c={value:a};if(this.ttls){c.ttl=this.ttls[n];const d=gc.now()-this.starts[n];c.start=Math.floor(Date.now()-d)}this.sizes&&(c.size=this.sizes[n]),e.unshift([r,c])}return e}load(e){this.clear();for(const[n,r]of e){if(r.start){const s=Date.now()-r.start;r.start=gc.now()-s}this.set(n,r.value,r)}}dispose(e,n,r){}set(e,n,{ttl:r=this.ttl,start:s,noDisposeOnSet:a=this.noDisposeOnSet,size:c=0,sizeCalculation:d=this.sizeCalculation,noUpdateTTL:m=this.noUpdateTTL,status:y}={}){if(c=this.requireSize(e,n,c,d),this.maxEntrySize&&c>this.maxEntrySize)return y&&(y.set="miss",y.maxEntrySizeExceeded=!0),this.delete(e),this;let h=this.size===0?void 0:this.keyMap.get(e);if(h===void 0)h=this.newIndex(),this.keyList[h]=e,this.valList[h]=n,this.keyMap.set(e,h),this.next[this.tail]=h,this.prev[h]=this.tail,this.tail=h,this.size++,this.addItemSize(h,c,y),y&&(y.set="add"),m=!1;else{this.moveToTail(h);const v=this.valList[h];if(n!==v){if(this.isBackgroundFetch(v)?v.__abortController.abort(new Error("replaced")):a||(this.dispose(v,e,"set"),this.disposeAfter&&this.disposed.push([v,e,"set"])),this.removeItemSize(h),this.valList[h]=n,this.addItemSize(h,c,y),y){y.set="replace";const E=v&&this.isBackgroundFetch(v)?v.__staleWhileFetching:v;E!==void 0&&(y.oldValue=E)}}else y&&(y.set="update")}if(r!==0&&this.ttl===0&&!this.ttls&&this.initializeTTLTracking(),m||this.setItemTTL(h,r,s),this.statusTTL(y,h),this.disposeAfter)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return this}newIndex(){return this.size===0?this.tail:this.size===this.max&&this.max!==0?this.evict(!1):this.free.length!==0?this.free.pop():this.initialFill++}pop(){if(this.size){const e=this.valList[this.head];return this.evict(!0),e}}evict(e){const n=this.head,r=this.keyList[n],s=this.valList[n];return this.isBackgroundFetch(s)?s.__abortController.abort(new Error("evicted")):(this.dispose(s,r,"evict"),this.disposeAfter&&this.disposed.push([s,r,"evict"])),this.removeItemSize(n),e&&(this.keyList[n]=null,this.valList[n]=null,this.free.push(n)),this.head=this.next[n],this.keyMap.delete(r),this.size--,n}has(e,{updateAgeOnHas:n=this.updateAgeOnHas,status:r}={}){const s=this.keyMap.get(e);if(s!==void 0)if(this.isStale(s))r&&(r.has="stale",this.statusTTL(r,s));else return n&&this.updateItemAge(s),r&&(r.has="hit"),this.statusTTL(r,s),!0;else r&&(r.has="miss");return!1}peek(e,{allowStale:n=this.allowStale}={}){const r=this.keyMap.get(e);if(r!==void 0&&(n||!this.isStale(r))){const s=this.valList[r];return this.isBackgroundFetch(s)?s.__staleWhileFetching:s}}backgroundFetch(e,n,r,s){const a=n===void 0?void 0:this.valList[n];if(this.isBackgroundFetch(a))return a;const c=new Id;r.signal&&r.signal.addEventListener("abort",()=>c.abort(r.signal.reason));const d={signal:c.signal,options:r,context:s},m=(T,P=!1)=>{const{aborted:k}=c.signal,R=r.ignoreFetchAbort&&T!==void 0;return r.status&&(k&&!P?(r.status.fetchAborted=!0,r.status.fetchError=c.signal.reason,R&&(r.status.fetchAbortIgnored=!0)):r.status.fetchResolved=!0),k&&!R&&!P?h(c.signal.reason):(this.valList[n]===E&&(T===void 0?E.__staleWhileFetching?this.valList[n]=E.__staleWhileFetching:this.delete(e):(r.status&&(r.status.fetchUpdated=!0),this.set(e,T,d.options))),T)},y=T=>(r.status&&(r.status.fetchRejected=!0,r.status.fetchError=T),h(T)),h=T=>{const{aborted:P}=c.signal,k=P&&r.allowStaleOnFetchAbort,R=k||r.allowStaleOnFetchRejection,_=R||r.noDeleteOnFetchRejection;if(this.valList[n]===E&&(!_||E.__staleWhileFetching===void 0?this.delete(e):k||(this.valList[n]=E.__staleWhileFetching)),R)return r.status&&E.__staleWhileFetching!==void 0&&(r.status.returnedStale=!0),E.__staleWhileFetching;if(E.__returned===E)throw T},v=(T,P)=>{this.fetchMethod(e,a,d).then(k=>T(k),P),c.signal.addEventListener("abort",()=>{(!r.ignoreFetchAbort||r.allowStaleOnFetchAbort)&&(T(),r.allowStaleOnFetchAbort&&(T=k=>m(k,!0)))})};r.status&&(r.status.fetchDispatched=!0);const E=new Promise(v).then(m,y);return E.__abortController=c,E.__staleWhileFetching=a,E.__returned=null,n===void 0?(this.set(e,E,{...d.options,status:void 0}),n=this.keyMap.get(e)):this.valList[n]=E,E}isBackgroundFetch(e){return e&&typeof e=="object"&&typeof e.then=="function"&&Object.prototype.hasOwnProperty.call(e,"__staleWhileFetching")&&Object.prototype.hasOwnProperty.call(e,"__returned")&&(e.__returned===e||e.__returned===null)}async fetch(e,{allowStale:n=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,ttl:a=this.ttl,noDisposeOnSet:c=this.noDisposeOnSet,size:d=0,sizeCalculation:m=this.sizeCalculation,noUpdateTTL:y=this.noUpdateTTL,noDeleteOnFetchRejection:h=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:v=this.allowStaleOnFetchRejection,ignoreFetchAbort:E=this.ignoreFetchAbort,allowStaleOnFetchAbort:T=this.allowStaleOnFetchAbort,fetchContext:P=this.fetchContext,forceRefresh:k=!1,status:R,signal:_}={}){if(!this.fetchMethod)return R&&(R.fetch="get"),this.get(e,{allowStale:n,updateAgeOnGet:r,noDeleteOnStaleGet:s,status:R});const M={allowStale:n,updateAgeOnGet:r,noDeleteOnStaleGet:s,ttl:a,noDisposeOnSet:c,size:d,sizeCalculation:m,noUpdateTTL:y,noDeleteOnFetchRejection:h,allowStaleOnFetchRejection:v,allowStaleOnFetchAbort:T,ignoreFetchAbort:E,status:R,signal:_};let L=this.keyMap.get(e);if(L===void 0){R&&(R.fetch="miss");const $=this.backgroundFetch(e,L,M,P);return $.__returned=$}else{const $=this.valList[L];if(this.isBackgroundFetch($)){const me=n&&$.__staleWhileFetching!==void 0;return R&&(R.fetch="inflight",me&&(R.returnedStale=!0)),me?$.__staleWhileFetching:$.__returned=$}const F=this.isStale(L);if(!k&&!F)return R&&(R.fetch="hit"),this.moveToTail(L),r&&this.updateItemAge(L),this.statusTTL(R,L),$;const H=this.backgroundFetch(e,L,M,P),se=H.__staleWhileFetching!==void 0,oe=se&&n;return R&&(R.fetch=se&&F?"stale":"refresh",oe&&F&&(R.returnedStale=!0)),oe?H.__staleWhileFetching:H.__returned=H}}get(e,{allowStale:n=this.allowStale,updateAgeOnGet:r=this.updateAgeOnGet,noDeleteOnStaleGet:s=this.noDeleteOnStaleGet,status:a}={}){const c=this.keyMap.get(e);if(c!==void 0){const d=this.valList[c],m=this.isBackgroundFetch(d);return this.statusTTL(a,c),this.isStale(c)?(a&&(a.get="stale"),m?(a&&(a.returnedStale=n&&d.__staleWhileFetching!==void 0),n?d.__staleWhileFetching:void 0):(s||this.delete(e),a&&(a.returnedStale=n),n?d:void 0)):(a&&(a.get="hit"),m?d.__staleWhileFetching:(this.moveToTail(c),r&&this.updateItemAge(c),d))}else a&&(a.get="miss")}connect(e,n){this.prev[n]=e,this.next[e]=n}moveToTail(e){e!==this.tail&&(e===this.head?this.head=this.next[e]:this.connect(this.prev[e],this.next[e]),this.connect(this.tail,e),this.tail=e)}get del(){return Sp("del","delete"),this.delete}delete(e){let n=!1;if(this.size!==0){const r=this.keyMap.get(e);if(r!==void 0)if(n=!0,this.size===1)this.clear();else{this.removeItemSize(r);const s=this.valList[r];this.isBackgroundFetch(s)?s.__abortController.abort(new Error("deleted")):(this.dispose(s,e,"delete"),this.disposeAfter&&this.disposed.push([s,e,"delete"])),this.keyMap.delete(e),this.keyList[r]=null,this.valList[r]=null,r===this.tail?this.tail=this.prev[r]:r===this.head?this.head=this.next[r]:(this.next[this.prev[r]]=this.next[r],this.prev[this.next[r]]=this.prev[r]),this.size--,this.free.push(r)}}if(this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift());return n}clear(){for(const e of this.rindexes({allowStale:!0})){const n=this.valList[e];if(this.isBackgroundFetch(n))n.__abortController.abort(new Error("deleted"));else{const r=this.keyList[e];this.dispose(n,r,"delete"),this.disposeAfter&&this.disposed.push([n,r,"delete"])}}if(this.keyMap.clear(),this.valList.fill(null),this.keyList.fill(null),this.ttls&&(this.ttls.fill(0),this.starts.fill(0)),this.sizes&&this.sizes.fill(0),this.head=0,this.tail=0,this.initialFill=1,this.free.length=0,this.calculatedSize=0,this.size=0,this.disposed)for(;this.disposed.length;)this.disposeAfter(...this.disposed.shift())}get reset(){return Sp("reset","clear"),this.clear}get length(){return mk("length","size"),this.size}static get AbortController(){return Id}static get AbortSignal(){return X0}}var Pp,cy;function vk(){if(cy)return Pp;cy=1;var t=!1,e,n,r,s,a,c,d,m,y,h,v,E,T,P,k;function R(){if(!t){t=!0;var M=navigator.userAgent,L=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(M),$=/(Mac OS X)|(Windows)|(Linux)/.exec(M);if(E=/\b(iPhone|iP[ao]d)/.exec(M),T=/\b(iP[ao]d)/.exec(M),h=/Android/i.exec(M),P=/FBAN\/\w+;/i.exec(M),k=/Mobile/i.exec(M),v=!!/Win64/.exec(M),L){e=L[1]?parseFloat(L[1]):L[5]?parseFloat(L[5]):NaN,e&&document&&document.documentMode&&(e=document.documentMode);var F=/(?:Trident\/(\d+.\d+))/.exec(M);c=F?parseFloat(F[1])+4:e,n=L[2]?parseFloat(L[2]):NaN,r=L[3]?parseFloat(L[3]):NaN,s=L[4]?parseFloat(L[4]):NaN,s?(L=/(?:Chrome\/(\d+\.\d+))/.exec(M),a=L&&L[1]?parseFloat(L[1]):NaN):a=NaN}else e=n=r=a=s=NaN;if($){if($[1]){var H=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(M);d=H?parseFloat(H[1].replace("_",".")):!0}else d=!1;m=!!$[2],y=!!$[3]}else d=m=y=!1}}var _={ie:function(){return R()||e},ieCompatibilityMode:function(){return R()||c>e},ie64:function(){return _.ie()&&v},firefox:function(){return R()||n},opera:function(){return R()||r},webkit:function(){return R()||s},safari:function(){return _.webkit()},chrome:function(){return R()||a},windows:function(){return R()||m},osx:function(){return R()||d},linux:function(){return R()||y},iphone:function(){return R()||E},mobile:function(){return R()||E||T||h||k},nativeApp:function(){return R()||P},android:function(){return R()||h},ipad:function(){return R()||T}};return Pp=_,Pp}var Ep,fy;function xk(){if(fy)return Ep;fy=1;var t=!!(typeof window<"u"&&window.document&&window.document.createElement),e={canUseDOM:t,canUseWorkers:typeof Worker<"u",canUseEventListeners:t&&!!(window.addEventListener||window.attachEvent),canUseViewport:t&&!!window.screen,isInWorker:!t};return Ep=e,Ep}var kp,dy;function wk(){if(dy)return kp;dy=1;var t=xk(),e;t.canUseDOM&&(e=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function n(r,s){if(!t.canUseDOM||s&&!("addEventListener"in document))return!1;var a="on"+r,c=a in document;if(!c){var d=document.createElement("div");d.setAttribute(a,"return;"),c=typeof d[a]=="function"}return!c&&e&&r==="wheel"&&(c=document.implementation.hasFeature("Events.wheel","3.0")),c}return kp=n,kp}var Cp,hy;function Sk(){if(hy)return Cp;hy=1;var t=vk(),e=wk(),n=10,r=40,s=800;function a(c){var d=0,m=0,y=0,h=0;return"detail"in c&&(m=c.detail),"wheelDelta"in c&&(m=-c.wheelDelta/120),"wheelDeltaY"in c&&(m=-c.wheelDeltaY/120),"wheelDeltaX"in c&&(d=-c.wheelDeltaX/120),"axis"in c&&c.axis===c.HORIZONTAL_AXIS&&(d=m,m=0),y=d*n,h=m*n,"deltaY"in c&&(h=c.deltaY),"deltaX"in c&&(y=c.deltaX),(y||h)&&c.deltaMode&&(c.deltaMode==1?(y*=r,h*=r):(y*=s,h*=s)),y&&!d&&(d=y<1?-1:1),h&&!m&&(m=h<1?-1:1),{spinX:d,spinY:m,pixelX:y,pixelY:h}}return a.getEventType=function(){return t.firefox()?"DOMMouseScroll":e("wheel")?"wheel":"mousewheel"},Cp=a,Cp}var Tp,py;function Pk(){return py||(py=1,Tp=Sk()),Tp}var Ek=Pk();const kk=Jl(Ek);function gy(t,e){let n;return(...r)=>{window.clearTimeout(n),n=window.setTimeout(()=>t(...r),e)}}function G0({debounce:t,scroll:e,polyfill:n,offsetSize:r}={debounce:0,scroll:!1,offsetSize:!1}){const s=n||(typeof window>"u"?class{}:window.ResizeObserver);if(!s)throw new Error("This browser does not support ResizeObserver out of the box. See: https://github.com/react-spring/react-use-measure/#resize-observer-polyfills");const[a,c]=O.useState({left:0,top:0,width:0,height:0,bottom:0,right:0,x:0,y:0}),d=O.useRef({element:null,scrollContainers:null,resizeObserver:null,lastBounds:a,orientationHandler:null}),m=t?typeof t=="number"?t:t.scroll:null,y=t?typeof t=="number"?t:t.resize:null,h=O.useRef(!1);O.useEffect(()=>(h.current=!0,()=>void(h.current=!1)));const[v,E,T]=O.useMemo(()=>{const _=()=>{if(!d.current.element)return;const{left:M,top:L,width:$,height:F,bottom:H,right:se,x:oe,y:me}=d.current.element.getBoundingClientRect(),K={left:M,top:L,width:$,height:F,bottom:H,right:se,x:oe,y:me};d.current.element instanceof HTMLElement&&r&&(K.height=d.current.element.offsetHeight,K.width=d.current.element.offsetWidth),Object.freeze(K),h.current&&!Rk(d.current.lastBounds,K)&&c(d.current.lastBounds=K)};return[_,y?gy(_,y):_,m?gy(_,m):_]},[c,r,m,y]);function P(){d.current.scrollContainers&&(d.current.scrollContainers.forEach(_=>_.removeEventListener("scroll",T,!0)),d.current.scrollContainers=null),d.current.resizeObserver&&(d.current.resizeObserver.disconnect(),d.current.resizeObserver=null),d.current.orientationHandler&&("orientation"in screen&&"removeEventListener"in screen.orientation?screen.orientation.removeEventListener("change",d.current.orientationHandler):"onorientationchange"in window&&window.removeEventListener("orientationchange",d.current.orientationHandler))}function k(){d.current.element&&(d.current.resizeObserver=new s(T),d.current.resizeObserver.observe(d.current.element),e&&d.current.scrollContainers&&d.current.scrollContainers.forEach(_=>_.addEventListener("scroll",T,{capture:!0,passive:!0})),d.current.orientationHandler=()=>{T()},"orientation"in screen&&"addEventListener"in screen.orientation?screen.orientation.addEventListener("change",d.current.orientationHandler):"onorientationchange"in window&&window.addEventListener("orientationchange",d.current.orientationHandler))}const R=_=>{!_||_===d.current.element||(P(),d.current.element=_,d.current.scrollContainers=Z0(_),k())};return Tk(T,!!e),Ck(E),O.useEffect(()=>{P(),k()},[e,T,E]),O.useEffect(()=>P,[]),[R,a,v]}function Ck(t){O.useEffect(()=>{const e=t;return window.addEventListener("resize",e),()=>void window.removeEventListener("resize",e)},[t])}function Tk(t,e){O.useEffect(()=>{if(e){const n=t;return window.addEventListener("scroll",n,{capture:!0,passive:!0}),()=>void window.removeEventListener("scroll",n,!0)}},[t,e])}function Z0(t){const e=[];if(!t||t===document.body)return e;const{overflow:n,overflowX:r,overflowY:s}=window.getComputedStyle(t);return[n,r,s].some(a=>a==="auto"||a==="scroll")&&e.push(t),[...e,...Z0(t.parentElement)]}const bk=["x","y","top","bottom","left","right","width","height"],Rk=(t,e)=>bk.every(n=>t[n]===e[n]);var bp={exports:{}},Rp={exports:{}},_p={};var my;function _k(){return my||(my=1,(function(t){function e(D,U){var Q=D.length;D.push(U);e:for(;0<Q;){var B=Q-1>>>1,re=D[B];if(0<s(re,U))D[B]=U,D[Q]=re,Q=B;else break e}}function n(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var U=D[0],Q=D.pop();if(Q!==U){D[0]=Q;e:for(var B=0,re=D.length,Re=re>>>1;B<Re;){var je=2*(B+1)-1,Le=D[je],De=je+1,Je=D[De];if(0>s(Le,Q))De<re&&0>s(Je,Le)?(D[B]=Je,D[De]=Q,B=De):(D[B]=Le,D[je]=Q,B=je);else if(De<re&&0>s(Je,Q))D[B]=Je,D[De]=Q,B=De;else break e}}return U}function s(D,U){var Q=D.sortIndex-U.sortIndex;return Q!==0?Q:D.id-U.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;t.unstable_now=function(){return a.now()}}else{var c=Date,d=c.now();t.unstable_now=function(){return c.now()-d}}var m=[],y=[],h=1,v=null,E=3,T=!1,P=!1,k=!1,R=typeof setTimeout=="function"?setTimeout:null,_=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function L(D){for(var U=n(y);U!==null;){if(U.callback===null)r(y);else if(U.startTime<=D)r(y),U.sortIndex=U.expirationTime,e(m,U);else break;U=n(y)}}function $(D){if(k=!1,L(D),!P)if(n(m)!==null)P=!0,Se(F);else{var U=n(y);U!==null&&Te($,U.startTime-D)}}function F(D,U){P=!1,k&&(k=!1,_(oe),oe=-1),T=!0;var Q=E;try{for(L(U),v=n(m);v!==null&&(!(v.expirationTime>U)||D&&!ge());){var B=v.callback;if(typeof B=="function"){v.callback=null,E=v.priorityLevel;var re=B(v.expirationTime<=U);U=t.unstable_now(),typeof re=="function"?v.callback=re:v===n(m)&&r(m),L(U)}else r(m);v=n(m)}if(v!==null)var Re=!0;else{var je=n(y);je!==null&&Te($,je.startTime-U),Re=!1}return Re}finally{v=null,E=Q,T=!1}}var H=!1,se=null,oe=-1,me=5,K=-1;function ge(){return!(t.unstable_now()-K<me)}function de(){if(se!==null){var D=t.unstable_now();K=D;var U=!0;try{U=se(!0,D)}finally{U?we():(H=!1,se=null)}}else H=!1}var we;if(typeof M=="function")we=function(){M(de)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,Ie=le.port2;le.port1.onmessage=de,we=function(){Ie.postMessage(null)}}else we=function(){R(de,0)};function Se(D){se=D,H||(H=!0,we())}function Te(D,U){oe=R(function(){D(t.unstable_now())},U)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(D){D.callback=null},t.unstable_continueExecution=function(){P||T||(P=!0,Se(F))},t.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):me=0<D?Math.floor(1e3/D):5},t.unstable_getCurrentPriorityLevel=function(){return E},t.unstable_getFirstCallbackNode=function(){return n(m)},t.unstable_next=function(D){switch(E){case 1:case 2:case 3:var U=3;break;default:U=E}var Q=E;E=U;try{return D()}finally{E=Q}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(D,U){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var Q=E;E=D;try{return U()}finally{E=Q}},t.unstable_scheduleCallback=function(D,U,Q){var B=t.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?B+Q:B):Q=B,D){case 1:var re=-1;break;case 2:re=250;break;case 5:re=1073741823;break;case 4:re=1e4;break;default:re=5e3}return re=Q+re,D={id:h++,callback:U,priorityLevel:D,startTime:Q,expirationTime:re,sortIndex:-1},Q>B?(D.sortIndex=Q,e(y,D),n(m)===null&&D===n(y)&&(k?(_(oe),oe=-1):k=!0,Te($,Q-B))):(D.sortIndex=re,e(m,D),P||T||(P=!0,Se(F))),D},t.unstable_shouldYield=ge,t.unstable_wrapCallback=function(D){var U=E;return function(){var Q=E;E=U;try{return D.apply(this,arguments)}finally{E=Q}}}})(_p)),_p}var yy;function Ik(){return yy||(yy=1,Rp.exports=_k()),Rp.exports}var Ip,vy;function Ok(){return vy||(vy=1,Ip=function(e){var n={},r=ea(),s=Ik(),a=Object.assign;function c(l){for(var u="https://reactjs.org/docs/error-decoder.html?invariant="+l,p=1;p<arguments.length;p++)u+="&args[]="+encodeURIComponent(arguments[p]);return"Minified React error #"+l+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,m=Symbol.for("react.element"),y=Symbol.for("react.portal"),h=Symbol.for("react.fragment"),v=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),P=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),_=Symbol.for("react.suspense_list"),M=Symbol.for("react.memo"),L=Symbol.for("react.lazy"),$=Symbol.for("react.offscreen"),F=Symbol.iterator;function H(l){return l===null||typeof l!="object"?null:(l=F&&l[F]||l["@@iterator"],typeof l=="function"?l:null)}function se(l){if(l==null)return null;if(typeof l=="function")return l.displayName||l.name||null;if(typeof l=="string")return l;switch(l){case h:return"Fragment";case y:return"Portal";case E:return"Profiler";case v:return"StrictMode";case R:return"Suspense";case _:return"SuspenseList"}if(typeof l=="object")switch(l.$$typeof){case P:return(l.displayName||"Context")+".Consumer";case T:return(l._context.displayName||"Context")+".Provider";case k:var u=l.render;return l=l.displayName,l||(l=u.displayName||u.name||"",l=l!==""?"ForwardRef("+l+")":"ForwardRef"),l;case M:return u=l.displayName||null,u!==null?u:se(l.type)||"Memo";case L:u=l._payload,l=l._init;try{return se(l(u))}catch{}}return null}function oe(l){var u=l.type;switch(l.tag){case 24:return"Cache";case 9:return(u.displayName||"Context")+".Consumer";case 10:return(u._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return l=u.render,l=l.displayName||l.name||"",u.displayName||(l!==""?"ForwardRef("+l+")":"ForwardRef");case 7:return"Fragment";case 5:return u;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return se(u);case 8:return u===v?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u}return null}function me(l){var u=l,p=l;if(l.alternate)for(;u.return;)u=u.return;else{l=u;do u=l,(u.flags&4098)!==0&&(p=u.return),l=u.return;while(l)}return u.tag===3?p:null}function K(l){if(me(l)!==l)throw Error(c(188))}function ge(l){var u=l.alternate;if(!u){if(u=me(l),u===null)throw Error(c(188));return u!==l?null:l}for(var p=l,x=u;;){var S=p.return;if(S===null)break;var b=S.alternate;if(b===null){if(x=S.return,x!==null){p=x;continue}break}if(S.child===b.child){for(b=S.child;b;){if(b===p)return K(S),l;if(b===x)return K(S),u;b=b.sibling}throw Error(c(188))}if(p.return!==x.return)p=S,x=b;else{for(var j=!1,X=S.child;X;){if(X===p){j=!0,p=S,x=b;break}if(X===x){j=!0,x=S,p=b;break}X=X.sibling}if(!j){for(X=b.child;X;){if(X===p){j=!0,p=b,x=S;break}if(X===x){j=!0,x=b,p=S;break}X=X.sibling}if(!j)throw Error(c(189))}}if(p.alternate!==x)throw Error(c(190))}if(p.tag!==3)throw Error(c(188));return p.stateNode.current===p?l:u}function de(l){return l=ge(l),l!==null?we(l):null}function we(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){var u=we(l);if(u!==null)return u;l=l.sibling}return null}function le(l){if(l.tag===5||l.tag===6)return l;for(l=l.child;l!==null;){if(l.tag!==4){var u=le(l);if(u!==null)return u}l=l.sibling}return null}var Ie=Array.isArray,Se=e.getPublicInstance,Te=e.getRootHostContext,D=e.getChildHostContext,U=e.prepareForCommit,Q=e.resetAfterCommit,B=e.createInstance,re=e.appendInitialChild,Re=e.finalizeInitialChildren,je=e.prepareUpdate,Le=e.shouldSetTextContent,De=e.createTextInstance,Je=e.scheduleTimeout,it=e.cancelTimeout,ut=e.noTimeout,mt=e.isPrimaryRenderer,ot=e.supportsMutation,ze=e.supportsPersistence,be=e.supportsHydration,ct=e.getInstanceFromNode,An=e.preparePortalMount,fr=e.getCurrentEventPriority,Mn=e.detachDeletedInstance,En=e.supportsMicrotasks,as=e.scheduleMicrotask,Vn=e.supportsTestSelectors,br=e.findFiberRoot,Z=e.getBoundingRect,fe=e.getTextContent,ke=e.isHiddenSubtree,G=e.matchAccessibilityRole,W=e.setFocusIfFocusable,ae=e.setupIntersectionObserver,he=e.appendChild,Xe=e.appendChildToContainer,Ze=e.commitTextUpdate,at=e.commitMount,ue=e.commitUpdate,pe=e.insertBefore,Oe=e.insertInContainerBefore,Ne=e.removeChild,Ae=e.removeChildFromContainer,tt=e.resetTextContent,St=e.hideInstance,bt=e.hideTextInstance,Pt=e.unhideInstance,Dt=e.unhideTextInstance,Rt=e.clearContainer,sn=e.cloneInstance,Yr=e.createContainerChildSet,Fr=e.appendChildToContainerChildSet,us=e.finalizeContainerChildren,cs=e.replaceContainerChildren,fs=e.cloneHiddenInstance,mu=e.cloneHiddenTextInstance,ol=e.canHydrateInstance,yu=e.canHydrateTextInstance,ll=e.canHydrateSuspenseInstance,Yc=e.isSuspenseInstancePending,ds=e.isSuspenseInstanceFallback,ra=e.getSuspenseInstanceFallbackErrorDetails,ia=e.registerSuspenseInstanceRetry,eo=e.getNextHydratableSibling,mh=e.getFirstHydratableChild,yh=e.getFirstHydratableChildWithinContainer,vh=e.getFirstHydratableChildWithinSuspenseInstance,hs=e.hydrateInstance,Kc=e.hydrateTextInstance,Gc=e.hydrateSuspenseInstance,xh=e.getNextHydratableInstanceAfterSuspenseInstance,Zc=e.commitHydratedContainer,Jc=e.commitHydratedSuspenseInstance,ef=e.clearSuspenseBoundary,tf=e.clearSuspenseBoundaryFromContainer,wh=e.shouldDeleteUnhydratedTailInstances,Sh=e.didNotMatchHydratedContainerTextInstance,Yt=e.didNotMatchHydratedTextInstance,vu;function ps(l){if(vu===void 0)try{throw Error()}catch(p){var u=p.stack.trim().match(/\n( *(at )?)/);vu=u&&u[1]||""}return`
`+vu+l}var sa=!1;function to(l,u){if(!l||sa)return"";sa=!0;var p=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(u)if(u=function(){throw Error()},Object.defineProperty(u.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(u,[])}catch(Pe){var x=Pe}Reflect.construct(l,[],u)}else{try{u.call()}catch(Pe){x=Pe}l.call(u.prototype)}else{try{throw Error()}catch(Pe){x=Pe}l()}}catch(Pe){if(Pe&&x&&typeof Pe.stack=="string"){for(var S=Pe.stack.split(`
`),b=x.stack.split(`
`),j=S.length-1,X=b.length-1;1<=j&&0<=X&&S[j]!==b[X];)X--;for(;1<=j&&0<=X;j--,X--)if(S[j]!==b[X]){if(j!==1||X!==1)do if(j--,X--,0>X||S[j]!==b[X]){var ie=`
`+S[j].replace(" at new "," at ");return l.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",l.displayName)),ie}while(1<=j&&0<=X);break}}}finally{sa=!1,Error.prepareStackTrace=p}return(l=l?l.displayName||l.name:"")?ps(l):""}var Ph=Object.prototype.hasOwnProperty,oa=[],hi=-1;function kn(l){return{current:l}}function Lt(l){0>hi||(l.current=oa[hi],oa[hi]=null,hi--)}function ft(l,u){hi++,oa[hi]=l.current,l.current=u}var Mi={},jn=kn(Mi),nr=kn(!1),Kr=Mi;function pi(l,u){var p=l.type.contextTypes;if(!p)return Mi;var x=l.stateNode;if(x&&x.__reactInternalMemoizedUnmaskedChildContext===u)return x.__reactInternalMemoizedMaskedChildContext;var S={},b;for(b in p)S[b]=u[b];return x&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=u,l.__reactInternalMemoizedMaskedChildContext=S),S}function gn(l){return l=l.childContextTypes,l!=null}function gs(){Lt(nr),Lt(jn)}function nf(l,u,p){if(jn.current!==Mi)throw Error(c(168));ft(jn,u),ft(nr,p)}function rf(l,u,p){var x=l.stateNode;if(u=u.childContextTypes,typeof x.getChildContext!="function")return p;x=x.getChildContext();for(var S in x)if(!(S in u))throw Error(c(108,oe(l)||"Unknown",S));return a({},p,x)}function no(l){return l=(l=l.stateNode)&&l.__reactInternalMemoizedMergedChildContext||Mi,Kr=jn.current,ft(jn,l),ft(nr,nr.current),!0}function xu(l,u,p){var x=l.stateNode;if(!x)throw Error(c(169));p?(l=rf(l,u,Kr),x.__reactInternalMemoizedMergedChildContext=l,Lt(nr),Lt(jn),ft(jn,l)):Lt(nr),ft(nr,p)}var dr=Math.clz32?Math.clz32:wu,al=Math.log,Eh=Math.LN2;function wu(l){return l>>>=0,l===0?32:31-(al(l)/Eh|0)|0}var yt=64,ul=4194304;function ro(l){switch(l&-l){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return l&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return l}}function io(l,u){var p=l.pendingLanes;if(p===0)return 0;var x=0,S=l.suspendedLanes,b=l.pingedLanes,j=p&268435455;if(j!==0){var X=j&~S;X!==0?x=ro(X):(b&=j,b!==0&&(x=ro(b)))}else j=p&~S,j!==0?x=ro(j):b!==0&&(x=ro(b));if(x===0)return 0;if(u!==0&&u!==x&&(u&S)===0&&(S=x&-x,b=u&-u,S>=b||S===16&&(b&4194240)!==0))return u;if((x&4)!==0&&(x|=p&16),u=l.entangledLanes,u!==0)for(l=l.entanglements,u&=x;0<u;)p=31-dr(u),S=1<<p,x|=l[p],u&=~S;return x}function sf(l,u){switch(l){case 1:case 2:case 4:return u+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function of(l,u){for(var p=l.suspendedLanes,x=l.pingedLanes,S=l.expirationTimes,b=l.pendingLanes;0<b;){var j=31-dr(b),X=1<<j,ie=S[j];ie===-1?((X&p)===0||(X&x)!==0)&&(S[j]=sf(X,u)):ie<=u&&(l.expiredLanes|=X),b&=~X}}function la(l){return l=l.pendingLanes&-1073741825,l!==0?l:l&1073741824?1073741824:0}function aa(){var l=yt;return yt<<=1,(yt&4194240)===0&&(yt=64),l}function so(l){for(var u=[],p=0;31>p;p++)u.push(l);return u}function Rr(l,u,p){l.pendingLanes|=u,u!==536870912&&(l.suspendedLanes=0,l.pingedLanes=0),l=l.eventTimes,u=31-dr(u),l[u]=p}function ji(l,u){var p=l.pendingLanes&~u;l.pendingLanes=u,l.suspendedLanes=0,l.pingedLanes=0,l.expiredLanes&=u,l.mutableReadLanes&=u,l.entangledLanes&=u,u=l.entanglements;var x=l.eventTimes;for(l=l.expirationTimes;0<p;){var S=31-dr(p),b=1<<S;u[S]=0,x[S]=-1,l[S]=-1,p&=~b}}function Gr(l,u){var p=l.entangledLanes|=u;for(l=l.entanglements;p;){var x=31-dr(p),S=1<<x;S&u|l[x]&u&&(l[x]|=u),p&=~S}}var dt=0;function oo(l){return l&=-l,1<l?4<l?(l&268435455)!==0?16:536870912:4:1}var Zr=s.unstable_scheduleCallback,lf=s.unstable_cancelCallback,af=s.unstable_shouldYield,cl=s.unstable_requestPaint,mn=s.unstable_now,ua=s.unstable_ImmediatePriority,ca=s.unstable_UserBlockingPriority,fa=s.unstable_NormalPriority,kh=s.unstable_IdlePriority,Li=null,rr=null;function lo(l){if(rr&&typeof rr.onCommitFiberRoot=="function")try{rr.onCommitFiberRoot(Li,l,void 0,(l.current.flags&128)===128)}catch{}}function da(l,u){return l===u&&(l!==0||1/l===1/u)||l!==l&&u!==u}var Dr=typeof Object.is=="function"?Object.is:da,gi=null,ao=!1,uo=!1;function ha(l){gi===null?gi=[l]:gi.push(l)}function uf(l){ao=!0,ha(l)}function Cn(){if(!uo&&gi!==null){uo=!0;var l=0,u=dt;try{var p=gi;for(dt=1;l<p.length;l++){var x=p[l];do x=x(!0);while(x!==null)}gi=null,ao=!1}catch(S){throw gi!==null&&(gi=gi.slice(l+1)),Zr(ua,Cn),S}finally{dt=u,uo=!1}}return null}var Ni=[],mi=0,fl=null,ms=0,qn=[],hr=0,on=null,ir=1,Br="";function $r(l,u){Ni[mi++]=ms,Ni[mi++]=fl,fl=l,ms=u}function cf(l,u,p){qn[hr++]=ir,qn[hr++]=Br,qn[hr++]=on,on=l;var x=ir;l=Br;var S=32-dr(x)-1;x&=~(1<<S),p+=1;var b=32-dr(u)+S;if(30<b){var j=S-S%5;b=(x&(1<<j)-1).toString(32),x>>=j,S-=j,ir=1<<32-dr(u)+S|p<<S|x,Br=b+l}else ir=1<<b|p<<S|x,Br=l}function dl(l){l.return!==null&&($r(l,1),cf(l,1,0))}function hl(l){for(;l===fl;)fl=Ni[--mi],Ni[mi]=null,ms=Ni[--mi],Ni[mi]=null;for(;l===on;)on=qn[--hr],qn[hr]=null,Br=qn[--hr],qn[hr]=null,ir=qn[--hr],qn[hr]=null}var Tn=null,Qn=null,Nt=!1,pl=!1,Ur=null;function ff(l,u){var p=Er(5,null,null,0);p.elementType="DELETED",p.stateNode=u,p.return=l,u=l.deletions,u===null?(l.deletions=[p],l.flags|=16):u.push(p)}function pa(l,u){switch(l.tag){case 5:return u=ol(u,l.type,l.pendingProps),u!==null?(l.stateNode=u,Tn=l,Qn=mh(u),!0):!1;case 6:return u=yu(u,l.pendingProps),u!==null?(l.stateNode=u,Tn=l,Qn=null,!0):!1;case 13:if(u=ll(u),u!==null){var p=on!==null?{id:ir,overflow:Br}:null;return l.memoizedState={dehydrated:u,treeContext:p,retryLane:1073741824},p=Er(18,null,null,0),p.stateNode=u,p.return=l,l.child=p,Tn=l,Qn=null,!0}return!1;default:return!1}}function Su(l){return(l.mode&1)!==0&&(l.flags&128)===0}function Pu(l){if(Nt){var u=Qn;if(u){var p=u;if(!pa(l,u)){if(Su(l))throw Error(c(418));u=eo(p);var x=Tn;u&&pa(l,u)?ff(x,p):(l.flags=l.flags&-4097|2,Nt=!1,Tn=l)}}else{if(Su(l))throw Error(c(418));l.flags=l.flags&-4097|2,Nt=!1,Tn=l}}}function df(l){for(l=l.return;l!==null&&l.tag!==5&&l.tag!==3&&l.tag!==13;)l=l.return;Tn=l}function ga(l){if(!be||l!==Tn)return!1;if(!Nt)return df(l),Nt=!0,!1;if(l.tag!==3&&(l.tag!==5||wh(l.type)&&!Le(l.type,l.memoizedProps))){var u=Qn;if(u){if(Su(l))throw hf(),Error(c(418));for(;u;)ff(l,u),u=eo(u)}}if(df(l),l.tag===13){if(!be)throw Error(c(316));if(l=l.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(c(317));Qn=xh(l)}else Qn=Tn?eo(l.stateNode):null;return!0}function hf(){for(var l=Qn;l;)l=eo(l)}function ys(){be&&(Qn=Tn=null,pl=Nt=!1)}function Eu(l){Ur===null?Ur=[l]:Ur.push(l)}var Ch=d.ReactCurrentBatchConfig;function ma(l,u){if(Dr(l,u))return!0;if(typeof l!="object"||l===null||typeof u!="object"||u===null)return!1;var p=Object.keys(l),x=Object.keys(u);if(p.length!==x.length)return!1;for(x=0;x<p.length;x++){var S=p[x];if(!Ph.call(u,S)||!Dr(l[S],u[S]))return!1}return!0}function Th(l){switch(l.tag){case 5:return ps(l.type);case 16:return ps("Lazy");case 13:return ps("Suspense");case 19:return ps("SuspenseList");case 0:case 2:case 15:return l=to(l.type,!1),l;case 11:return l=to(l.type.render,!1),l;case 1:return l=to(l.type,!0),l;default:return""}}function vs(l,u,p){if(l=p.ref,l!==null&&typeof l!="function"&&typeof l!="object"){if(p._owner){if(p=p._owner,p){if(p.tag!==1)throw Error(c(309));var x=p.stateNode}if(!x)throw Error(c(147,l));var S=x,b=""+l;return u!==null&&u.ref!==null&&typeof u.ref=="function"&&u.ref._stringRef===b?u.ref:(u=function(j){var X=S.refs;j===null?delete X[b]:X[b]=j},u._stringRef=b,u)}if(typeof l!="string")throw Error(c(284));if(!p._owner)throw Error(c(290,l))}return l}function ya(l,u){throw l=Object.prototype.toString.call(u),Error(c(31,l==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":l))}function pf(l){var u=l._init;return u(l._payload)}function gf(l){function u(te,Y){if(l){var ce=te.deletions;ce===null?(te.deletions=[Y],te.flags|=16):ce.push(Y)}}function p(te,Y){if(!l)return null;for(;Y!==null;)u(te,Y),Y=Y.sibling;return null}function x(te,Y){for(te=new Map;Y!==null;)Y.key!==null?te.set(Y.key,Y):te.set(Y.index,Y),Y=Y.sibling;return te}function S(te,Y){return te=es(te,Y),te.index=0,te.sibling=null,te}function b(te,Y,ce){return te.index=ce,l?(ce=te.alternate,ce!==null?(ce=ce.index,ce<Y?(te.flags|=2,Y):ce):(te.flags|=2,Y)):(te.flags|=1048576,Y)}function j(te){return l&&te.alternate===null&&(te.flags|=2),te}function X(te,Y,ce,Me){return Y===null||Y.tag!==6?(Y=Lo(ce,te.mode,Me),Y.return=te,Y):(Y=S(Y,ce),Y.return=te,Y)}function ie(te,Y,ce,Me){var Qe=ce.type;return Qe===h?Be(te,Y,ce.props.children,Me,ce.key):Y!==null&&(Y.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===L&&pf(Qe)===Y.type)?(Me=S(Y,ce.props),Me.ref=vs(te,Y,ce),Me.return=te,Me):(Me=Ya(ce.type,ce.key,ce.props,null,te.mode,Me),Me.ref=vs(te,Y,ce),Me.return=te,Me)}function Pe(te,Y,ce,Me){return Y===null||Y.tag!==4||Y.stateNode.containerInfo!==ce.containerInfo||Y.stateNode.implementation!==ce.implementation?(Y=Ka(ce,te.mode,Me),Y.return=te,Y):(Y=S(Y,ce.children||[]),Y.return=te,Y)}function Be(te,Y,ce,Me,Qe){return Y===null||Y.tag!==7?(Y=_n(ce,te.mode,Me,Qe),Y.return=te,Y):(Y=S(Y,ce),Y.return=te,Y)}function nt(te,Y,ce){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return Y=Lo(""+Y,te.mode,ce),Y.return=te,Y;if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case m:return ce=Ya(Y.type,Y.key,Y.props,null,te.mode,ce),ce.ref=vs(te,null,Y),ce.return=te,ce;case y:return Y=Ka(Y,te.mode,ce),Y.return=te,Y;case L:var Me=Y._init;return nt(te,Me(Y._payload),ce)}if(Ie(Y)||H(Y))return Y=_n(Y,te.mode,ce,null),Y.return=te,Y;ya(te,Y)}return null}function _e(te,Y,ce,Me){var Qe=Y!==null?Y.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number")return Qe!==null?null:X(te,Y,""+ce,Me);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case m:return ce.key===Qe?ie(te,Y,ce,Me):null;case y:return ce.key===Qe?Pe(te,Y,ce,Me):null;case L:return Qe=ce._init,_e(te,Y,Qe(ce._payload),Me)}if(Ie(ce)||H(ce))return Qe!==null?null:Be(te,Y,ce,Me,null);ya(te,ce)}return null}function jt(te,Y,ce,Me,Qe){if(typeof Me=="string"&&Me!==""||typeof Me=="number")return te=te.get(ce)||null,X(Y,te,""+Me,Qe);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case m:return te=te.get(Me.key===null?ce:Me.key)||null,ie(Y,te,Me,Qe);case y:return te=te.get(Me.key===null?ce:Me.key)||null,Pe(Y,te,Me,Qe);case L:var lt=Me._init;return jt(te,Y,ce,lt(Me._payload),Qe)}if(Ie(Me)||H(Me))return te=te.get(ce)||null,Be(Y,te,Me,Qe,null);ya(Y,Me)}return null}function kt(te,Y,ce,Me){for(var Qe=null,lt=null,rt=Y,gt=Y=0,fn=null;rt!==null&&gt<ce.length;gt++){rt.index>gt?(fn=rt,rt=null):fn=rt.sibling;var pt=_e(te,rt,ce[gt],Me);if(pt===null){rt===null&&(rt=fn);break}l&&rt&&pt.alternate===null&&u(te,rt),Y=b(pt,Y,gt),lt===null?Qe=pt:lt.sibling=pt,lt=pt,rt=fn}if(gt===ce.length)return p(te,rt),Nt&&$r(te,gt),Qe;if(rt===null){for(;gt<ce.length;gt++)rt=nt(te,ce[gt],Me),rt!==null&&(Y=b(rt,Y,gt),lt===null?Qe=rt:lt.sibling=rt,lt=rt);return Nt&&$r(te,gt),Qe}for(rt=x(te,rt);gt<ce.length;gt++)fn=jt(rt,te,gt,ce[gt],Me),fn!==null&&(l&&fn.alternate!==null&&rt.delete(fn.key===null?gt:fn.key),Y=b(fn,Y,gt),lt===null?Qe=fn:lt.sibling=fn,lt=fn);return l&&rt.forEach(function(Bn){return u(te,Bn)}),Nt&&$r(te,gt),Qe}function Jn(te,Y,ce,Me){var Qe=H(ce);if(typeof Qe!="function")throw Error(c(150));if(ce=Qe.call(ce),ce==null)throw Error(c(151));for(var lt=Qe=null,rt=Y,gt=Y=0,fn=null,pt=ce.next();rt!==null&&!pt.done;gt++,pt=ce.next()){rt.index>gt?(fn=rt,rt=null):fn=rt.sibling;var Bn=_e(te,rt,pt.value,Me);if(Bn===null){rt===null&&(rt=fn);break}l&&rt&&Bn.alternate===null&&u(te,rt),Y=b(Bn,Y,gt),lt===null?Qe=Bn:lt.sibling=Bn,lt=Bn,rt=fn}if(pt.done)return p(te,rt),Nt&&$r(te,gt),Qe;if(rt===null){for(;!pt.done;gt++,pt=ce.next())pt=nt(te,pt.value,Me),pt!==null&&(Y=b(pt,Y,gt),lt===null?Qe=pt:lt.sibling=pt,lt=pt);return Nt&&$r(te,gt),Qe}for(rt=x(te,rt);!pt.done;gt++,pt=ce.next())pt=jt(rt,te,gt,pt.value,Me),pt!==null&&(l&&pt.alternate!==null&&rt.delete(pt.key===null?gt:pt.key),Y=b(pt,Y,gt),lt===null?Qe=pt:lt.sibling=pt,lt=pt);return l&&rt.forEach(function(Oh){return u(te,Oh)}),Nt&&$r(te,gt),Qe}function li(te,Y,ce,Me){if(typeof ce=="object"&&ce!==null&&ce.type===h&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case m:e:{for(var Qe=ce.key,lt=Y;lt!==null;){if(lt.key===Qe){if(Qe=ce.type,Qe===h){if(lt.tag===7){p(te,lt.sibling),Y=S(lt,ce.props.children),Y.return=te,te=Y;break e}}else if(lt.elementType===Qe||typeof Qe=="object"&&Qe!==null&&Qe.$$typeof===L&&pf(Qe)===lt.type){p(te,lt.sibling),Y=S(lt,ce.props),Y.ref=vs(te,lt,ce),Y.return=te,te=Y;break e}p(te,lt);break}else u(te,lt);lt=lt.sibling}ce.type===h?(Y=_n(ce.props.children,te.mode,Me,ce.key),Y.return=te,te=Y):(Me=Ya(ce.type,ce.key,ce.props,null,te.mode,Me),Me.ref=vs(te,Y,ce),Me.return=te,te=Me)}return j(te);case y:e:{for(lt=ce.key;Y!==null;){if(Y.key===lt)if(Y.tag===4&&Y.stateNode.containerInfo===ce.containerInfo&&Y.stateNode.implementation===ce.implementation){p(te,Y.sibling),Y=S(Y,ce.children||[]),Y.return=te,te=Y;break e}else{p(te,Y);break}else u(te,Y);Y=Y.sibling}Y=Ka(ce,te.mode,Me),Y.return=te,te=Y}return j(te);case L:return lt=ce._init,li(te,Y,lt(ce._payload),Me)}if(Ie(ce))return kt(te,Y,ce,Me);if(H(ce))return Jn(te,Y,ce,Me);ya(te,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"?(ce=""+ce,Y!==null&&Y.tag===6?(p(te,Y.sibling),Y=S(Y,ce),Y.return=te,te=Y):(p(te,Y),Y=Lo(ce,te.mode,Me),Y.return=te,te=Y),j(te)):p(te,Y)}return li}var xs=gf(!0),mf=gf(!1),va=kn(null),xa=null,co=null,ku=null;function Cu(){ku=co=xa=null}function yf(l,u,p){mt?(ft(va,u._currentValue),u._currentValue=p):(ft(va,u._currentValue2),u._currentValue2=p)}function gl(l){var u=va.current;Lt(va),mt?l._currentValue=u:l._currentValue2=u}function ws(l,u,p){for(;l!==null;){var x=l.alternate;if((l.childLanes&u)!==u?(l.childLanes|=u,x!==null&&(x.childLanes|=u)):x!==null&&(x.childLanes&u)!==u&&(x.childLanes|=u),l===p)break;l=l.return}}function fo(l,u){xa=l,ku=co=null,l=l.dependencies,l!==null&&l.firstContext!==null&&((l.lanes&u)!==0&&(an=!0),l.firstContext=null)}function pr(l){var u=mt?l._currentValue:l._currentValue2;if(ku!==l)if(l={context:l,memoizedValue:u,next:null},co===null){if(xa===null)throw Error(c(308));co=l,xa.dependencies={lanes:0,firstContext:l}}else co=co.next=l;return u}var zi=null;function wa(l){zi===null?zi=[l]:zi.push(l)}function Tu(l,u,p,x){var S=u.interleaved;return S===null?(p.next=p,wa(u)):(p.next=S.next,S.next=p),u.interleaved=p,Wr(l,x)}function Wr(l,u){l.lanes|=u;var p=l.alternate;for(p!==null&&(p.lanes|=u),p=l,l=l.return;l!==null;)l.childLanes|=u,p=l.alternate,p!==null&&(p.childLanes|=u),p=l,l=l.return;return p.tag===3?p.stateNode:null}var gr=!1;function bu(l){l.updateQueue={baseState:l.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vf(l,u){l=l.updateQueue,u.updateQueue===l&&(u.updateQueue={baseState:l.baseState,firstBaseUpdate:l.firstBaseUpdate,lastBaseUpdate:l.lastBaseUpdate,shared:l.shared,effects:l.effects})}function yi(l,u){return{eventTime:l,lane:u,tag:0,payload:null,callback:null,next:null}}function vi(l,u,p){var x=l.updateQueue;if(x===null)return null;if(x=x.shared,(st&2)!==0){var S=x.pending;return S===null?u.next=u:(u.next=S.next,S.next=u),x.pending=u,Wr(l,p)}return S=x.interleaved,S===null?(u.next=u,wa(x)):(u.next=S.next,S.next=u),x.interleaved=u,Wr(l,p)}function ml(l,u,p){if(u=u.updateQueue,u!==null&&(u=u.shared,(p&4194240)!==0)){var x=u.lanes;x&=l.pendingLanes,p|=x,u.lanes=p,Gr(l,p)}}function ho(l,u){var p=l.updateQueue,x=l.alternate;if(x!==null&&(x=x.updateQueue,p===x)){var S=null,b=null;if(p=p.firstBaseUpdate,p!==null){do{var j={eventTime:p.eventTime,lane:p.lane,tag:p.tag,payload:p.payload,callback:p.callback,next:null};b===null?S=b=j:b=b.next=j,p=p.next}while(p!==null);b===null?S=b=u:b=b.next=u}else S=b=u;p={baseState:x.baseState,firstBaseUpdate:S,lastBaseUpdate:b,shared:x.shared,effects:x.effects},l.updateQueue=p;return}l=p.lastBaseUpdate,l===null?p.firstBaseUpdate=u:l.next=u,p.lastBaseUpdate=u}function Fi(l,u,p,x){var S=l.updateQueue;gr=!1;var b=S.firstBaseUpdate,j=S.lastBaseUpdate,X=S.shared.pending;if(X!==null){S.shared.pending=null;var ie=X,Pe=ie.next;ie.next=null,j===null?b=Pe:j.next=Pe,j=ie;var Be=l.alternate;Be!==null&&(Be=Be.updateQueue,X=Be.lastBaseUpdate,X!==j&&(X===null?Be.firstBaseUpdate=Pe:X.next=Pe,Be.lastBaseUpdate=ie))}if(b!==null){var nt=S.baseState;j=0,Be=Pe=ie=null,X=b;do{var _e=X.lane,jt=X.eventTime;if((x&_e)===_e){Be!==null&&(Be=Be.next={eventTime:jt,lane:0,tag:X.tag,payload:X.payload,callback:X.callback,next:null});e:{var kt=l,Jn=X;switch(_e=u,jt=p,Jn.tag){case 1:if(kt=Jn.payload,typeof kt=="function"){nt=kt.call(jt,nt,_e);break e}nt=kt;break e;case 3:kt.flags=kt.flags&-65537|128;case 0:if(kt=Jn.payload,_e=typeof kt=="function"?kt.call(jt,nt,_e):kt,_e==null)break e;nt=a({},nt,_e);break e;case 2:gr=!0}}X.callback!==null&&X.lane!==0&&(l.flags|=64,_e=S.effects,_e===null?S.effects=[X]:_e.push(X))}else jt={eventTime:jt,lane:_e,tag:X.tag,payload:X.payload,callback:X.callback,next:null},Be===null?(Pe=Be=jt,ie=nt):Be=Be.next=jt,j|=_e;if(X=X.next,X===null){if(X=S.shared.pending,X===null)break;_e=X,X=_e.next,_e.next=null,S.lastBaseUpdate=_e,S.shared.pending=null}}while(!0);if(Be===null&&(ie=nt),S.baseState=ie,S.firstBaseUpdate=Pe,S.lastBaseUpdate=Be,u=S.shared.interleaved,u!==null){S=u;do j|=S.lane,S=S.next;while(S!==u)}else b===null&&(S.shared.lanes=0);Ei|=j,l.lanes=j,l.memoizedState=nt}}function xf(l,u,p){if(l=u.effects,u.effects=null,l!==null)for(u=0;u<l.length;u++){var x=l[u],S=x.callback;if(S!==null){if(x.callback=null,x=p,typeof S!="function")throw Error(c(191,S));S.call(x)}}}var Di={},_r=kn(Di),po=kn(Di),Bi=kn(Di);function Ir(l){if(l===Di)throw Error(c(174));return l}function Sa(l,u){ft(Bi,u),ft(po,l),ft(_r,Di),l=Te(u),Lt(_r),ft(_r,l)}function Ss(){Lt(_r),Lt(po),Lt(Bi)}function Ru(l){var u=Ir(Bi.current),p=Ir(_r.current);u=D(p,l.type,u),p!==u&&(ft(po,l),ft(_r,u))}function _u(l){po.current===l&&(Lt(_r),Lt(po))}var Ht=kn(0);function Pa(l){for(var u=l;u!==null;){if(u.tag===13){var p=u.memoizedState;if(p!==null&&(p=p.dehydrated,p===null||Yc(p)||ds(p)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}var Iu=[];function Ou(){for(var l=0;l<Iu.length;l++){var u=Iu[l];mt?u._workInProgressVersionPrimary=null:u._workInProgressVersionSecondary=null}Iu.length=0}var sr=d.ReactCurrentDispatcher,Ps=d.ReactCurrentBatchConfig,$i=0,Bt=null,Jt=null,ln=null,go=!1,yl=!1,vl=0,mo=0;function yn(){throw Error(c(321))}function Es(l,u){if(u===null)return!1;for(var p=0;p<u.length&&p<l.length;p++)if(!Dr(l[p],u[p]))return!1;return!0}function xl(l,u,p,x,S,b){if($i=b,Bt=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,sr.current=l===null||l.memoizedState===null?$u:Uu,l=p(x,S),yl){b=0;do{if(yl=!1,vl=0,25<=b)throw Error(c(301));b+=1,ln=Jt=null,u.updateQueue=null,sr.current=Wu,l=p(x,S)}while(yl)}if(sr.current=Rs,u=Jt!==null&&Jt.next!==null,$i=0,ln=Jt=Bt=null,go=!1,u)throw Error(c(300));return l}function Ea(){var l=vl!==0;return vl=0,l}function mr(){var l={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ln===null?Bt.memoizedState=ln=l:ln=ln.next=l,ln}function bn(){if(Jt===null){var l=Bt.alternate;l=l!==null?l.memoizedState:null}else l=Jt.next;var u=ln===null?Bt.memoizedState:ln.next;if(u!==null)ln=u,Jt=l;else{if(l===null)throw Error(c(310));Jt=l,l={memoizedState:Jt.memoizedState,baseState:Jt.baseState,baseQueue:Jt.baseQueue,queue:Jt.queue,next:null},ln===null?Bt.memoizedState=ln=l:ln=ln.next=l}return ln}function ks(l,u){return typeof u=="function"?u(l):u}function ka(l){var u=bn(),p=u.queue;if(p===null)throw Error(c(311));p.lastRenderedReducer=l;var x=Jt,S=x.baseQueue,b=p.pending;if(b!==null){if(S!==null){var j=S.next;S.next=b.next,b.next=j}x.baseQueue=S=b,p.pending=null}if(S!==null){b=S.next,x=x.baseState;var X=j=null,ie=null,Pe=b;do{var Be=Pe.lane;if(($i&Be)===Be)ie!==null&&(ie=ie.next={lane:0,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null}),x=Pe.hasEagerState?Pe.eagerState:l(x,Pe.action);else{var nt={lane:Be,action:Pe.action,hasEagerState:Pe.hasEagerState,eagerState:Pe.eagerState,next:null};ie===null?(X=ie=nt,j=x):ie=ie.next=nt,Bt.lanes|=Be,Ei|=Be}Pe=Pe.next}while(Pe!==null&&Pe!==b);ie===null?j=x:ie.next=X,Dr(x,u.memoizedState)||(an=!0),u.memoizedState=x,u.baseState=j,u.baseQueue=ie,p.lastRenderedState=x}if(l=p.interleaved,l!==null){S=l;do b=S.lane,Bt.lanes|=b,Ei|=b,S=S.next;while(S!==l)}else S===null&&(p.lanes=0);return[u.memoizedState,p.dispatch]}function yo(l){var u=bn(),p=u.queue;if(p===null)throw Error(c(311));p.lastRenderedReducer=l;var x=p.dispatch,S=p.pending,b=u.memoizedState;if(S!==null){p.pending=null;var j=S=S.next;do b=l(b,j.action),j=j.next;while(j!==S);Dr(b,u.memoizedState)||(an=!0),u.memoizedState=b,u.baseQueue===null&&(u.baseState=b),p.lastRenderedState=b}return[b,x]}function Au(){}function Mu(l,u){var p=Bt,x=bn(),S=u(),b=!Dr(x.memoizedState,S);if(b&&(x.memoizedState=S,an=!0),x=x.queue,ba(Nu.bind(null,p,x,l),[l]),x.getSnapshot!==u||b||ln!==null&&ln.memoizedState.tag&1){if(p.flags|=2048,Cs(9,Lu.bind(null,p,x,S,u),void 0,null),It===null)throw Error(c(349));($i&30)!==0||ju(p,u,S)}return S}function ju(l,u,p){l.flags|=16384,l={getSnapshot:u,value:p},u=Bt.updateQueue,u===null?(u={lastEffect:null,stores:null},Bt.updateQueue=u,u.stores=[l]):(p=u.stores,p===null?u.stores=[l]:p.push(l))}function Lu(l,u,p,x){u.value=p,u.getSnapshot=x,zu(u)&&xi(l)}function Nu(l,u,p){return p(function(){zu(u)&&xi(l)})}function zu(l){var u=l.getSnapshot;l=l.value;try{var p=u();return!Dr(l,p)}catch{return!0}}function xi(l){var u=Wr(l,1);u!==null&&Fn(u,l,1,-1)}function Ca(l){var u=mr();return typeof l=="function"&&(l=l()),u.memoizedState=u.baseState=l,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ks,lastRenderedState:l},u.queue=l,l=l.dispatch=bh.bind(null,Bt,l),[u.memoizedState,l]}function Cs(l,u,p,x){return l={tag:l,create:u,destroy:p,deps:x,next:null},u=Bt.updateQueue,u===null?(u={lastEffect:null,stores:null},Bt.updateQueue=u,u.lastEffect=l.next=l):(p=u.lastEffect,p===null?u.lastEffect=l.next=l:(x=p.next,p.next=l,l.next=x,u.lastEffect=l)),l}function wf(){return bn().memoizedState}function Ta(l,u,p,x){var S=mr();Bt.flags|=l,S.memoizedState=Cs(1|u,p,void 0,x===void 0?null:x)}function Ui(l,u,p,x){var S=bn();x=x===void 0?null:x;var b=void 0;if(Jt!==null){var j=Jt.memoizedState;if(b=j.destroy,x!==null&&Es(x,j.deps)){S.memoizedState=Cs(u,p,b,x);return}}Bt.flags|=l,S.memoizedState=Cs(1|u,p,b,x)}function Sf(l,u){return Ta(8390656,8,l,u)}function ba(l,u){return Ui(2048,8,l,u)}function Fu(l,u){return Ui(4,2,l,u)}function Ot(l,u){return Ui(4,4,l,u)}function Ra(l,u){if(typeof u=="function")return l=l(),u(l),function(){u(null)};if(u!=null)return l=l(),u.current=l,function(){u.current=null}}function wl(l,u,p){return p=p!=null?p.concat([l]):null,Ui(4,4,Ra.bind(null,u,l),p)}function Ts(){}function Du(l,u){var p=bn();u=u===void 0?null:u;var x=p.memoizedState;return x!==null&&u!==null&&Es(u,x[1])?x[0]:(p.memoizedState=[l,u],l)}function _a(l,u){var p=bn();u=u===void 0?null:u;var x=p.memoizedState;return x!==null&&u!==null&&Es(u,x[1])?x[0]:(l=l(),p.memoizedState=[l,u],l)}function vo(l,u,p){return($i&21)===0?(l.baseState&&(l.baseState=!1,an=!0),l.memoizedState=p):(Dr(p,u)||(p=aa(),Bt.lanes|=p,Ei|=p,l.baseState=!0),u)}function Ia(l,u){var p=dt;dt=p!==0&&4>p?p:4,l(!0);var x=Ps.transition;Ps.transition={};try{l(!1),u()}finally{dt=p,Ps.transition=x}}function bs(){return bn().memoizedState}function Pf(l,u,p){var x=cn(l);if(p={lane:x,action:p,hasEagerState:!1,eagerState:null,next:null},Ef(l))Bu(u,p);else if(p=Tu(l,u,p,x),p!==null){var S=zt();Fn(p,l,x,S),Sl(p,u,x)}}function bh(l,u,p){var x=cn(l),S={lane:x,action:p,hasEagerState:!1,eagerState:null,next:null};if(Ef(l))Bu(u,S);else{var b=l.alternate;if(l.lanes===0&&(b===null||b.lanes===0)&&(b=u.lastRenderedReducer,b!==null))try{var j=u.lastRenderedState,X=b(j,p);if(S.hasEagerState=!0,S.eagerState=X,Dr(X,j)){var ie=u.interleaved;ie===null?(S.next=S,wa(u)):(S.next=ie.next,ie.next=S),u.interleaved=S;return}}catch{}finally{}p=Tu(l,u,S,x),p!==null&&(S=zt(),Fn(p,l,x,S),Sl(p,u,x))}}function Ef(l){var u=l.alternate;return l===Bt||u!==null&&u===Bt}function Bu(l,u){yl=go=!0;var p=l.pending;p===null?u.next=u:(u.next=p.next,p.next=u),l.pending=u}function Sl(l,u,p){if((p&4194240)!==0){var x=u.lanes;x&=l.pendingLanes,p|=x,u.lanes=p,Gr(l,p)}}var Rs={readContext:pr,useCallback:yn,useContext:yn,useEffect:yn,useImperativeHandle:yn,useInsertionEffect:yn,useLayoutEffect:yn,useMemo:yn,useReducer:yn,useRef:yn,useState:yn,useDebugValue:yn,useDeferredValue:yn,useTransition:yn,useMutableSource:yn,useSyncExternalStore:yn,useId:yn,unstable_isNewReconciler:!1},$u={readContext:pr,useCallback:function(l,u){return mr().memoizedState=[l,u===void 0?null:u],l},useContext:pr,useEffect:Sf,useImperativeHandle:function(l,u,p){return p=p!=null?p.concat([l]):null,Ta(4194308,4,Ra.bind(null,u,l),p)},useLayoutEffect:function(l,u){return Ta(4194308,4,l,u)},useInsertionEffect:function(l,u){return Ta(4,2,l,u)},useMemo:function(l,u){var p=mr();return u=u===void 0?null:u,l=l(),p.memoizedState=[l,u],l},useReducer:function(l,u,p){var x=mr();return u=p!==void 0?p(u):u,x.memoizedState=x.baseState=u,l={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:l,lastRenderedState:u},x.queue=l,l=l.dispatch=Pf.bind(null,Bt,l),[x.memoizedState,l]},useRef:function(l){var u=mr();return l={current:l},u.memoizedState=l},useState:Ca,useDebugValue:Ts,useDeferredValue:function(l){return mr().memoizedState=l},useTransition:function(){var l=Ca(!1),u=l[0];return l=Ia.bind(null,l[1]),mr().memoizedState=l,[u,l]},useMutableSource:function(){},useSyncExternalStore:function(l,u,p){var x=Bt,S=mr();if(Nt){if(p===void 0)throw Error(c(407));p=p()}else{if(p=u(),It===null)throw Error(c(349));($i&30)!==0||ju(x,u,p)}S.memoizedState=p;var b={value:p,getSnapshot:u};return S.queue=b,Sf(Nu.bind(null,x,b,l),[l]),x.flags|=2048,Cs(9,Lu.bind(null,x,b,p,u),void 0,null),p},useId:function(){var l=mr(),u=It.identifierPrefix;if(Nt){var p=Br,x=ir;p=(x&~(1<<32-dr(x)-1)).toString(32)+p,u=":"+u+"R"+p,p=vl++,0<p&&(u+="H"+p.toString(32)),u+=":"}else p=mo++,u=":"+u+"r"+p.toString(32)+":";return l.memoizedState=u},unstable_isNewReconciler:!1},Uu={readContext:pr,useCallback:Du,useContext:pr,useEffect:ba,useImperativeHandle:wl,useInsertionEffect:Fu,useLayoutEffect:Ot,useMemo:_a,useReducer:ka,useRef:wf,useState:function(){return ka(ks)},useDebugValue:Ts,useDeferredValue:function(l){var u=bn();return vo(u,Jt.memoizedState,l)},useTransition:function(){var l=ka(ks)[0],u=bn().memoizedState;return[l,u]},useMutableSource:Au,useSyncExternalStore:Mu,useId:bs,unstable_isNewReconciler:!1},Wu={readContext:pr,useCallback:Du,useContext:pr,useEffect:ba,useImperativeHandle:wl,useInsertionEffect:Fu,useLayoutEffect:Ot,useMemo:_a,useReducer:yo,useRef:wf,useState:function(){return yo(ks)},useDebugValue:Ts,useDeferredValue:function(l){var u=bn();return Jt===null?u.memoizedState=l:vo(u,Jt.memoizedState,l)},useTransition:function(){var l=yo(ks)[0],u=bn().memoizedState;return[l,u]},useMutableSource:Au,useSyncExternalStore:Mu,useId:bs,unstable_isNewReconciler:!1};function yr(l,u){if(l&&l.defaultProps){u=a({},u),l=l.defaultProps;for(var p in l)u[p]===void 0&&(u[p]=l[p]);return u}return u}function Hu(l,u,p,x){u=l.memoizedState,p=p(x,u),p=p==null?u:a({},u,p),l.memoizedState=p,l.lanes===0&&(l.updateQueue.baseState=p)}var Pl={isMounted:function(l){return(l=l._reactInternals)?me(l)===l:!1},enqueueSetState:function(l,u,p){l=l._reactInternals;var x=zt(),S=cn(l),b=yi(x,S);b.payload=u,p!=null&&(b.callback=p),u=vi(l,b,S),u!==null&&(Fn(u,l,S,x),ml(u,l,S))},enqueueReplaceState:function(l,u,p){l=l._reactInternals;var x=zt(),S=cn(l),b=yi(x,S);b.tag=1,b.payload=u,p!=null&&(b.callback=p),u=vi(l,b,S),u!==null&&(Fn(u,l,S,x),ml(u,l,S))},enqueueForceUpdate:function(l,u){l=l._reactInternals;var p=zt(),x=cn(l),S=yi(p,x);S.tag=2,u!=null&&(S.callback=u),u=vi(l,S,x),u!==null&&(Fn(u,l,x,p),ml(u,l,x))}};function kf(l,u,p,x,S,b,j){return l=l.stateNode,typeof l.shouldComponentUpdate=="function"?l.shouldComponentUpdate(x,b,j):u.prototype&&u.prototype.isPureReactComponent?!ma(p,x)||!ma(S,b):!0}function Cf(l,u,p){var x=!1,S=Mi,b=u.contextType;return typeof b=="object"&&b!==null?b=pr(b):(S=gn(u)?Kr:jn.current,x=u.contextTypes,b=(x=x!=null)?pi(l,S):Mi),u=new u(p,b),l.memoizedState=u.state!==null&&u.state!==void 0?u.state:null,u.updater=Pl,l.stateNode=u,u._reactInternals=l,x&&(l=l.stateNode,l.__reactInternalMemoizedUnmaskedChildContext=S,l.__reactInternalMemoizedMaskedChildContext=b),u}function Oa(l,u,p,x){l=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(p,x),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(p,x),u.state!==l&&Pl.enqueueReplaceState(u,u.state,null)}function Jr(l,u,p,x){var S=l.stateNode;S.props=p,S.state=l.memoizedState,S.refs={},bu(l);var b=u.contextType;typeof b=="object"&&b!==null?S.context=pr(b):(b=gn(u)?Kr:jn.current,S.context=pi(l,b)),S.state=l.memoizedState,b=u.getDerivedStateFromProps,typeof b=="function"&&(Hu(l,u,b,p),S.state=l.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(u=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),u!==S.state&&Pl.enqueueReplaceState(S,S.state,null),Fi(l,p,S,x),S.state=l.memoizedState),typeof S.componentDidMount=="function"&&(l.flags|=4194308)}function _s(l,u){try{var p="",x=u;do p+=Th(x),x=x.return;while(x);var S=p}catch(b){S=`
Error generating stack: `+b.message+`
`+b.stack}return{value:l,source:u,stack:S,digest:null}}function Wi(l,u,p){return{value:l,source:null,stack:p??null,digest:u??null}}function Or(l,u){try{console.error(u.value)}catch(p){setTimeout(function(){throw p})}}var El=typeof WeakMap=="function"?WeakMap:Map;function ei(l,u,p){p=yi(-1,p),p.tag=3,p.payload={element:null};var x=u.value;return p.callback=function(){Qt||(Qt=!0,en=x),Or(l,u)},p}function Aa(l,u,p){p=yi(-1,p),p.tag=3;var x=l.type.getDerivedStateFromError;if(typeof x=="function"){var S=u.value;p.payload=function(){return x(S)},p.callback=function(){Or(l,u)}}var b=l.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(p.callback=function(){Or(l,u),typeof x!="function"&&(Vr===null?Vr=new Set([this]):Vr.add(this));var j=u.stack;this.componentDidCatch(u.value,{componentStack:j!==null?j:""})}),p}function Tf(l,u,p){var x=l.pingCache;if(x===null){x=l.pingCache=new El;var S=new Set;x.set(u,S)}else S=x.get(u),S===void 0&&(S=new Set,x.set(u,S));S.has(p)||(S.add(p),l=jf.bind(null,l,u,p),u.then(l,l))}function bf(l){do{var u;if((u=l.tag===13)&&(u=l.memoizedState,u=u!==null?u.dehydrated!==null:!0),u)return l;l=l.return}while(l!==null);return null}function Hi(l,u,p,x,S){return(l.mode&1)===0?(l===u?l.flags|=65536:(l.flags|=128,p.flags|=131072,p.flags&=-52805,p.tag===1&&(p.alternate===null?p.tag=17:(u=yi(-1,1),u.tag=2,vi(p,u,1))),p.lanes|=1),l):(l.flags|=65536,l.lanes=S,l)}var kl=d.ReactCurrentOwner,an=!1;function vn(l,u,p,x){u.child=l===null?mf(u,null,p,x):xs(u,l.child,p,x)}function Ma(l,u,p,x,S){p=p.render;var b=u.ref;return fo(u,S),x=xl(l,u,p,x,b,S),p=Ea(),l!==null&&!an?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~S,Si(l,u,S)):(Nt&&p&&dl(u),u.flags|=1,vn(l,u,x,S),u.child)}function Is(l,u,p,x,S){if(l===null){var b=p.type;return typeof b=="function"&&!Mo(b)&&b.defaultProps===void 0&&p.compare===null&&p.defaultProps===void 0?(u.tag=15,u.type=b,wi(l,u,b,x,S)):(l=Ya(p.type,null,x,u,u.mode,S),l.ref=u.ref,l.return=u,u.child=l)}if(b=l.child,(l.lanes&S)===0){var j=b.memoizedProps;if(p=p.compare,p=p!==null?p:ma,p(j,x)&&l.ref===u.ref)return Si(l,u,S)}return u.flags|=1,l=es(b,x),l.ref=u.ref,l.return=u,u.child=l}function wi(l,u,p,x,S){if(l!==null){var b=l.memoizedProps;if(ma(b,x)&&l.ref===u.ref)if(an=!1,u.pendingProps=x=b,(l.lanes&S)!==0)(l.flags&131072)!==0&&(an=!0);else return u.lanes=l.lanes,Si(l,u,S)}return ti(l,u,p,x,S)}function At(l,u,p){var x=u.pendingProps,S=x.children,b=l!==null?l.memoizedState:null;if(x.mode==="hidden")if((u.mode&1)===0)u.memoizedState={baseLanes:0,cachePool:null,transitions:null},ft(Ki,un),un|=p;else{if((p&1073741824)===0)return l=b!==null?b.baseLanes|p:p,u.lanes=u.childLanes=1073741824,u.memoizedState={baseLanes:l,cachePool:null,transitions:null},u.updateQueue=null,ft(Ki,un),un|=l,null;u.memoizedState={baseLanes:0,cachePool:null,transitions:null},x=b!==null?b.baseLanes:p,ft(Ki,un),un|=x}else b!==null?(x=b.baseLanes|p,u.memoizedState=null):x=p,ft(Ki,un),un|=x;return vn(l,u,S,p),u.child}function _t(l,u){var p=u.ref;(l===null&&p!==null||l!==null&&l.ref!==p)&&(u.flags|=512,u.flags|=2097152)}function ti(l,u,p,x,S){var b=gn(p)?Kr:jn.current;return b=pi(u,b),fo(u,S),p=xl(l,u,p,x,b,S),x=Ea(),l!==null&&!an?(u.updateQueue=l.updateQueue,u.flags&=-2053,l.lanes&=~S,Si(l,u,S)):(Nt&&x&&dl(u),u.flags|=1,vn(l,u,p,S),u.child)}function Rn(l,u,p,x,S){if(gn(p)){var b=!0;no(u)}else b=!1;if(fo(u,S),u.stateNode===null)Cl(l,u),Cf(u,p,x),Jr(u,p,x,S),x=!0;else if(l===null){var j=u.stateNode,X=u.memoizedProps;j.props=X;var ie=j.context,Pe=p.contextType;typeof Pe=="object"&&Pe!==null?Pe=pr(Pe):(Pe=gn(p)?Kr:jn.current,Pe=pi(u,Pe));var Be=p.getDerivedStateFromProps,nt=typeof Be=="function"||typeof j.getSnapshotBeforeUpdate=="function";nt||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(X!==x||ie!==Pe)&&Oa(u,j,x,Pe),gr=!1;var _e=u.memoizedState;j.state=_e,Fi(u,x,j,S),ie=u.memoizedState,X!==x||_e!==ie||nr.current||gr?(typeof Be=="function"&&(Hu(u,p,Be,x),ie=u.memoizedState),(X=gr||kf(u,p,X,x,_e,ie,Pe))?(nt||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(u.flags|=4194308)):(typeof j.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=x,u.memoizedState=ie),j.props=x,j.state=ie,j.context=Pe,x=X):(typeof j.componentDidMount=="function"&&(u.flags|=4194308),x=!1)}else{j=u.stateNode,vf(l,u),X=u.memoizedProps,Pe=u.type===u.elementType?X:yr(u.type,X),j.props=Pe,nt=u.pendingProps,_e=j.context,ie=p.contextType,typeof ie=="object"&&ie!==null?ie=pr(ie):(ie=gn(p)?Kr:jn.current,ie=pi(u,ie));var jt=p.getDerivedStateFromProps;(Be=typeof jt=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(X!==nt||_e!==ie)&&Oa(u,j,x,ie),gr=!1,_e=u.memoizedState,j.state=_e,Fi(u,x,j,S);var kt=u.memoizedState;X!==nt||_e!==kt||nr.current||gr?(typeof jt=="function"&&(Hu(u,p,jt,x),kt=u.memoizedState),(Pe=gr||kf(u,p,Pe,x,_e,kt,ie)||!1)?(Be||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(x,kt,ie),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(x,kt,ie)),typeof j.componentDidUpdate=="function"&&(u.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof j.componentDidUpdate!="function"||X===l.memoizedProps&&_e===l.memoizedState||(u.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||X===l.memoizedProps&&_e===l.memoizedState||(u.flags|=1024),u.memoizedProps=x,u.memoizedState=kt),j.props=x,j.state=kt,j.context=ie,x=Pe):(typeof j.componentDidUpdate!="function"||X===l.memoizedProps&&_e===l.memoizedState||(u.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||X===l.memoizedProps&&_e===l.memoizedState||(u.flags|=1024),x=!1)}return Ln(l,u,p,x,b,S)}function Ln(l,u,p,x,S,b){_t(l,u);var j=(u.flags&128)!==0;if(!x&&!j)return S&&xu(u,p,!1),Si(l,u,b);x=u.stateNode,kl.current=u;var X=j&&typeof p.getDerivedStateFromError!="function"?null:x.render();return u.flags|=1,l!==null&&j?(u.child=xs(u,l.child,null,b),u.child=xs(u,null,X,b)):vn(l,u,X,b),u.memoizedState=x.state,S&&xu(u,p,!0),u.child}function Vi(l){var u=l.stateNode;u.pendingContext?nf(l,u.pendingContext,u.pendingContext!==u.context):u.context&&nf(l,u.context,!1),Sa(l,u.containerInfo)}function Os(l,u,p,x,S){return ys(),Eu(S),u.flags|=256,vn(l,u,p,x),u.child}var Nn={dehydrated:null,treeContext:null,retryLane:0};function xo(l){return{baseLanes:l,cachePool:null,transitions:null}}function Vu(l,u,p){var x=u.pendingProps,S=Ht.current,b=!1,j=(u.flags&128)!==0,X;if((X=j)||(X=l!==null&&l.memoizedState===null?!1:(S&2)!==0),X?(b=!0,u.flags&=-129):(l===null||l.memoizedState!==null)&&(S|=1),ft(Ht,S&1),l===null)return Pu(u),l=u.memoizedState,l!==null&&(l=l.dehydrated,l!==null)?((u.mode&1)===0?u.lanes=1:ds(l)?u.lanes=8:u.lanes=1073741824,null):(j=x.children,l=x.fallback,b?(x=u.mode,b=u.child,j={mode:"hidden",children:j},(x&1)===0&&b!==null?(b.childLanes=0,b.pendingProps=j):b=jo(j,x,0,null),l=_n(l,x,p,null),b.return=u,l.return=u,b.sibling=l,u.child=b,u.child.memoizedState=xo(p),u.memoizedState=Nn,l):ja(u,j));if(S=l.memoizedState,S!==null&&(X=S.dehydrated,X!==null))return Rf(l,u,j,x,X,S,p);if(b){b=x.fallback,j=u.mode,S=l.child,X=S.sibling;var ie={mode:"hidden",children:x.children};return(j&1)===0&&u.child!==S?(x=u.child,x.childLanes=0,x.pendingProps=ie,u.deletions=null):(x=es(S,ie),x.subtreeFlags=S.subtreeFlags&14680064),X!==null?b=es(X,b):(b=_n(b,j,p,null),b.flags|=2),b.return=u,x.return=u,x.sibling=b,u.child=x,x=b,b=u.child,j=l.child.memoizedState,j=j===null?xo(p):{baseLanes:j.baseLanes|p,cachePool:null,transitions:j.transitions},b.memoizedState=j,b.childLanes=l.childLanes&~p,u.memoizedState=Nn,x}return b=l.child,l=b.sibling,x=es(b,{mode:"visible",children:x.children}),(u.mode&1)===0&&(x.lanes=p),x.return=u,x.sibling=null,l!==null&&(p=u.deletions,p===null?(u.deletions=[l],u.flags|=16):p.push(l)),u.child=x,u.memoizedState=null,x}function ja(l,u){return u=jo({mode:"visible",children:u},l.mode,0,null),u.return=l,l.child=u}function As(l,u,p,x){return x!==null&&Eu(x),xs(u,l.child,null,p),l=ja(u,u.pendingProps.children),l.flags|=2,u.memoizedState=null,l}function Rf(l,u,p,x,S,b,j){if(p)return u.flags&256?(u.flags&=-257,x=Wi(Error(c(422))),As(l,u,j,x)):u.memoizedState!==null?(u.child=l.child,u.flags|=128,null):(b=x.fallback,S=u.mode,x=jo({mode:"visible",children:x.children},S,0,null),b=_n(b,S,j,null),b.flags|=2,x.return=u,b.return=u,x.sibling=b,u.child=x,(u.mode&1)!==0&&xs(u,l.child,null,j),u.child.memoizedState=xo(j),u.memoizedState=Nn,b);if((u.mode&1)===0)return As(l,u,j,null);if(ds(S))return x=ra(S).digest,b=Error(c(419)),x=Wi(b,x,void 0),As(l,u,j,x);if(p=(j&l.childLanes)!==0,an||p){if(x=It,x!==null){switch(j&-j){case 4:S=2;break;case 16:S=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:S=32;break;case 536870912:S=268435456;break;default:S=0}S=(S&(x.suspendedLanes|j))!==0?0:S,S!==0&&S!==b.retryLane&&(b.retryLane=S,Wr(l,S),Fn(x,l,S,-1))}return Ao(),x=Wi(Error(c(421))),As(l,u,j,x)}return Yc(S)?(u.flags|=128,u.child=l.child,u=Nf.bind(null,l),ia(S,u),null):(l=b.treeContext,be&&(Qn=vh(S),Tn=u,Nt=!0,Ur=null,pl=!1,l!==null&&(qn[hr++]=ir,qn[hr++]=Br,qn[hr++]=on,ir=l.id,Br=l.overflow,on=u)),u=ja(u,x.children),u.flags|=4096,u)}function ni(l,u,p){l.lanes|=u;var x=l.alternate;x!==null&&(x.lanes|=u),ws(l.return,u,p)}function wo(l,u,p,x,S){var b=l.memoizedState;b===null?l.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:x,tail:p,tailMode:S}:(b.isBackwards=u,b.rendering=null,b.renderingStartTime=0,b.last=x,b.tail=p,b.tailMode=S)}function La(l,u,p){var x=u.pendingProps,S=x.revealOrder,b=x.tail;if(vn(l,u,x.children,p),x=Ht.current,(x&2)!==0)x=x&1|2,u.flags|=128;else{if(l!==null&&(l.flags&128)!==0)e:for(l=u.child;l!==null;){if(l.tag===13)l.memoizedState!==null&&ni(l,p,u);else if(l.tag===19)ni(l,p,u);else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===u)break e;for(;l.sibling===null;){if(l.return===null||l.return===u)break e;l=l.return}l.sibling.return=l.return,l=l.sibling}x&=1}if(ft(Ht,x),(u.mode&1)===0)u.memoizedState=null;else switch(S){case"forwards":for(p=u.child,S=null;p!==null;)l=p.alternate,l!==null&&Pa(l)===null&&(S=p),p=p.sibling;p=S,p===null?(S=u.child,u.child=null):(S=p.sibling,p.sibling=null),wo(u,!1,S,p,b);break;case"backwards":for(p=null,S=u.child,u.child=null;S!==null;){if(l=S.alternate,l!==null&&Pa(l)===null){u.child=S;break}l=S.sibling,S.sibling=p,p=S,S=l}wo(u,!0,p,null,b);break;case"together":wo(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Cl(l,u){(u.mode&1)===0&&l!==null&&(l.alternate=null,u.alternate=null,u.flags|=2)}function Si(l,u,p){if(l!==null&&(u.dependencies=l.dependencies),Ei|=u.lanes,(p&u.childLanes)===0)return null;if(l!==null&&u.child!==l.child)throw Error(c(153));if(u.child!==null){for(l=u.child,p=es(l,l.pendingProps),u.child=p,p.return=u;l.sibling!==null;)l=l.sibling,p=p.sibling=es(l,l.pendingProps),p.return=u;p.sibling=null}return u.child}function qi(l,u,p){switch(u.tag){case 3:Vi(u),ys();break;case 5:Ru(u);break;case 1:gn(u.type)&&no(u);break;case 4:Sa(u,u.stateNode.containerInfo);break;case 10:yf(u,u.type._context,u.memoizedProps.value);break;case 13:var x=u.memoizedState;if(x!==null)return x.dehydrated!==null?(ft(Ht,Ht.current&1),u.flags|=128,null):(p&u.child.childLanes)!==0?Vu(l,u,p):(ft(Ht,Ht.current&1),l=Si(l,u,p),l!==null?l.sibling:null);ft(Ht,Ht.current&1);break;case 19:if(x=(p&u.childLanes)!==0,(l.flags&128)!==0){if(x)return La(l,u,p);u.flags|=128}var S=u.memoizedState;if(S!==null&&(S.rendering=null,S.tail=null,S.lastEffect=null),ft(Ht,Ht.current),x)break;return null;case 22:case 23:return u.lanes=0,At(l,u,p)}return Si(l,u,p)}function Xn(l){l.flags|=4}function Ms(l,u){if(l!==null&&l.child===u.child)return!0;if((u.flags&16)!==0)return!1;for(l=u.child;l!==null;){if((l.flags&12854)!==0||(l.subtreeFlags&12854)!==0)return!1;l=l.sibling}return!0}var Qi,Xi,Yn,Kn;if(ot)Qi=function(l,u){for(var p=u.child;p!==null;){if(p.tag===5||p.tag===6)re(l,p.stateNode);else if(p.tag!==4&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===u)break;for(;p.sibling===null;){if(p.return===null||p.return===u)return;p=p.return}p.sibling.return=p.return,p=p.sibling}},Xi=function(){},Yn=function(l,u,p,x,S){if(l=l.memoizedProps,l!==x){var b=u.stateNode,j=Ir(_r.current);p=je(b,p,l,x,S,j),(u.updateQueue=p)&&Xn(u)}},Kn=function(l,u,p,x){p!==x&&Xn(u)};else if(ze){Qi=function(l,u,p,x){for(var S=u.child;S!==null;){if(S.tag===5){var b=S.stateNode;p&&x&&(b=fs(b,S.type,S.memoizedProps,S)),re(l,b)}else if(S.tag===6)b=S.stateNode,p&&x&&(b=mu(b,S.memoizedProps,S)),re(l,b);else if(S.tag!==4){if(S.tag===22&&S.memoizedState!==null)b=S.child,b!==null&&(b.return=S),Qi(l,S,!0,!0);else if(S.child!==null){S.child.return=S,S=S.child;continue}}if(S===u)break;for(;S.sibling===null;){if(S.return===null||S.return===u)return;S=S.return}S.sibling.return=S.return,S=S.sibling}};var Yi=function(l,u,p,x){for(var S=u.child;S!==null;){if(S.tag===5){var b=S.stateNode;p&&x&&(b=fs(b,S.type,S.memoizedProps,S)),Fr(l,b)}else if(S.tag===6)b=S.stateNode,p&&x&&(b=mu(b,S.memoizedProps,S)),Fr(l,b);else if(S.tag!==4){if(S.tag===22&&S.memoizedState!==null)b=S.child,b!==null&&(b.return=S),Yi(l,S,!0,!0);else if(S.child!==null){S.child.return=S,S=S.child;continue}}if(S===u)break;for(;S.sibling===null;){if(S.return===null||S.return===u)return;S=S.return}S.sibling.return=S.return,S=S.sibling}};Xi=function(l,u){var p=u.stateNode;if(!Ms(l,u)){l=p.containerInfo;var x=Yr(l);Yi(x,u,!1,!1),p.pendingChildren=x,Xn(u),us(l,x)}},Yn=function(l,u,p,x,S){var b=l.stateNode,j=l.memoizedProps;if((l=Ms(l,u))&&j===x)u.stateNode=b;else{var X=u.stateNode,ie=Ir(_r.current),Pe=null;j!==x&&(Pe=je(X,p,j,x,S,ie)),l&&Pe===null?u.stateNode=b:(b=sn(b,Pe,p,j,x,u,l,X),Re(b,p,x,S,ie)&&Xn(u),u.stateNode=b,l?Xn(u):Qi(b,u,!1,!1))}},Kn=function(l,u,p,x){p!==x?(l=Ir(Bi.current),p=Ir(_r.current),u.stateNode=De(x,l,p,u),Xn(u)):u.stateNode=l.stateNode}}else Xi=function(){},Yn=function(){},Kn=function(){};function vr(l,u){if(!Nt)switch(l.tailMode){case"hidden":u=l.tail;for(var p=null;u!==null;)u.alternate!==null&&(p=u),u=u.sibling;p===null?l.tail=null:p.sibling=null;break;case"collapsed":p=l.tail;for(var x=null;p!==null;)p.alternate!==null&&(x=p),p=p.sibling;x===null?u||l.tail===null?l.tail=null:l.tail.sibling=null:x.sibling=null}}function $t(l){var u=l.alternate!==null&&l.alternate.child===l.child,p=0,x=0;if(u)for(var S=l.child;S!==null;)p|=S.lanes|S.childLanes,x|=S.subtreeFlags&14680064,x|=S.flags&14680064,S.return=l,S=S.sibling;else for(S=l.child;S!==null;)p|=S.lanes|S.childLanes,x|=S.subtreeFlags,x|=S.flags,S.return=l,S=S.sibling;return l.subtreeFlags|=x,l.childLanes=p,u}function js(l,u,p){var x=u.pendingProps;switch(hl(u),u.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $t(u),null;case 1:return gn(u.type)&&gs(),$t(u),null;case 3:return p=u.stateNode,Ss(),Lt(nr),Lt(jn),Ou(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(l===null||l.child===null)&&(ga(u)?Xn(u):l===null||l.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Ur!==null&&(Qa(Ur),Ur=null))),Xi(l,u),$t(u),null;case 5:_u(u),p=Ir(Bi.current);var S=u.type;if(l!==null&&u.stateNode!=null)Yn(l,u,S,x,p),l.ref!==u.ref&&(u.flags|=512,u.flags|=2097152);else{if(!x){if(u.stateNode===null)throw Error(c(166));return $t(u),null}if(l=Ir(_r.current),ga(u)){if(!be)throw Error(c(175));l=hs(u.stateNode,u.type,u.memoizedProps,p,l,u,!pl),u.updateQueue=l,l!==null&&Xn(u)}else{var b=B(S,x,p,l,u);Qi(b,u,!1,!1),u.stateNode=b,Re(b,S,x,p,l)&&Xn(u)}u.ref!==null&&(u.flags|=512,u.flags|=2097152)}return $t(u),null;case 6:if(l&&u.stateNode!=null)Kn(l,u,l.memoizedProps,x);else{if(typeof x!="string"&&u.stateNode===null)throw Error(c(166));if(l=Ir(Bi.current),p=Ir(_r.current),ga(u)){if(!be)throw Error(c(176));if(l=u.stateNode,p=u.memoizedProps,(x=Kc(l,p,u,!pl))&&(S=Tn,S!==null))switch(S.tag){case 3:Sh(S.stateNode.containerInfo,l,p,(S.mode&1)!==0);break;case 5:Yt(S.type,S.memoizedProps,S.stateNode,l,p,(S.mode&1)!==0)}x&&Xn(u)}else u.stateNode=De(x,l,p,u)}return $t(u),null;case 13:if(Lt(Ht),x=u.memoizedState,l===null||l.memoizedState!==null&&l.memoizedState.dehydrated!==null){if(Nt&&Qn!==null&&(u.mode&1)!==0&&(u.flags&128)===0)hf(),ys(),u.flags|=98560,S=!1;else if(S=ga(u),x!==null&&x.dehydrated!==null){if(l===null){if(!S)throw Error(c(318));if(!be)throw Error(c(344));if(S=u.memoizedState,S=S!==null?S.dehydrated:null,!S)throw Error(c(317));Gc(S,u)}else ys(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;$t(u),S=!1}else Ur!==null&&(Qa(Ur),Ur=null),S=!0;if(!S)return u.flags&65536?u:null}return(u.flags&128)!==0?(u.lanes=p,u):(p=x!==null,p!==(l!==null&&l.memoizedState!==null)&&p&&(u.child.flags|=8192,(u.mode&1)!==0&&(l===null||(Ht.current&1)!==0?Wt===0&&(Wt=3):Ao())),u.updateQueue!==null&&(u.flags|=4),$t(u),null);case 4:return Ss(),Xi(l,u),l===null&&An(u.stateNode.containerInfo),$t(u),null;case 10:return gl(u.type._context),$t(u),null;case 17:return gn(u.type)&&gs(),$t(u),null;case 19:if(Lt(Ht),S=u.memoizedState,S===null)return $t(u),null;if(x=(u.flags&128)!==0,b=S.rendering,b===null)if(x)vr(S,!1);else{if(Wt!==0||l!==null&&(l.flags&128)!==0)for(l=u.child;l!==null;){if(b=Pa(l),b!==null){for(u.flags|=128,vr(S,!1),l=b.updateQueue,l!==null&&(u.updateQueue=l,u.flags|=4),u.subtreeFlags=0,l=p,p=u.child;p!==null;)x=p,S=l,x.flags&=14680066,b=x.alternate,b===null?(x.childLanes=0,x.lanes=S,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=b.childLanes,x.lanes=b.lanes,x.child=b.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=b.memoizedProps,x.memoizedState=b.memoizedState,x.updateQueue=b.updateQueue,x.type=b.type,S=b.dependencies,x.dependencies=S===null?null:{lanes:S.lanes,firstContext:S.firstContext}),p=p.sibling;return ft(Ht,Ht.current&1|2),u.child}l=l.sibling}S.tail!==null&&mn()>Al&&(u.flags|=128,x=!0,vr(S,!1),u.lanes=4194304)}else{if(!x)if(l=Pa(b),l!==null){if(u.flags|=128,x=!0,l=l.updateQueue,l!==null&&(u.updateQueue=l,u.flags|=4),vr(S,!0),S.tail===null&&S.tailMode==="hidden"&&!b.alternate&&!Nt)return $t(u),null}else 2*mn()-S.renderingStartTime>Al&&p!==1073741824&&(u.flags|=128,x=!0,vr(S,!1),u.lanes=4194304);S.isBackwards?(b.sibling=u.child,u.child=b):(l=S.last,l!==null?l.sibling=b:u.child=b,S.last=b)}return S.tail!==null?(u=S.tail,S.rendering=u,S.tail=u.sibling,S.renderingStartTime=mn(),u.sibling=null,l=Ht.current,ft(Ht,x?l&1|2:l&1),u):($t(u),null);case 22:case 23:return Xa(),p=u.memoizedState!==null,l!==null&&l.memoizedState!==null!==p&&(u.flags|=8192),p&&(u.mode&1)!==0?(un&1073741824)!==0&&($t(u),ot&&u.subtreeFlags&6&&(u.flags|=8192)):$t(u),null;case 24:return null;case 25:return null}throw Error(c(156,u.tag))}function _f(l,u){switch(hl(u),u.tag){case 1:return gn(u.type)&&gs(),l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 3:return Ss(),Lt(nr),Lt(jn),Ou(),l=u.flags,(l&65536)!==0&&(l&128)===0?(u.flags=l&-65537|128,u):null;case 5:return _u(u),null;case 13:if(Lt(Ht),l=u.memoizedState,l!==null&&l.dehydrated!==null){if(u.alternate===null)throw Error(c(340));ys()}return l=u.flags,l&65536?(u.flags=l&-65537|128,u):null;case 19:return Lt(Ht),null;case 4:return Ss(),null;case 10:return gl(u.type._context),null;case 22:case 23:return Xa(),null;case 24:return null;default:return null}}var So=!1,xn=!1,xr=typeof WeakSet=="function"?WeakSet:Set,Ce=null;function Et(l,u){var p=l.ref;if(p!==null)if(typeof p=="function")try{p(null)}catch(x){Ft(l,u,x)}else p.current=null}function wr(l,u,p){try{p()}catch(x){Ft(l,u,x)}}var qu=!1;function If(l,u){for(U(l.containerInfo),Ce=u;Ce!==null;)if(l=Ce,u=l.child,(l.subtreeFlags&1028)!==0&&u!==null)u.return=l,Ce=u;else for(;Ce!==null;){l=Ce;try{var p=l.alternate;if((l.flags&1024)!==0)switch(l.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var x=p.memoizedProps,S=p.memoizedState,b=l.stateNode,j=b.getSnapshotBeforeUpdate(l.elementType===l.type?x:yr(l.type,x),S);b.__reactInternalSnapshotBeforeUpdate=j}break;case 3:ot&&Rt(l.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(c(163))}}catch(X){Ft(l,l.return,X)}if(u=l.sibling,u!==null){u.return=l.return,Ce=u;break}Ce=l.return}return p=qu,qu=!1,p}function Ls(l,u,p){var x=u.updateQueue;if(x=x!==null?x.lastEffect:null,x!==null){var S=x=x.next;do{if((S.tag&l)===l){var b=S.destroy;S.destroy=void 0,b!==void 0&&wr(u,p,b)}S=S.next}while(S!==x)}}function Po(l,u){if(u=u.updateQueue,u=u!==null?u.lastEffect:null,u!==null){var p=u=u.next;do{if((p.tag&l)===l){var x=p.create;p.destroy=x()}p=p.next}while(p!==u)}}function Na(l){var u=l.ref;if(u!==null){var p=l.stateNode;switch(l.tag){case 5:l=Se(p);break;default:l=p}typeof u=="function"?u(l):u.current=l}}function Tl(l){var u=l.alternate;u!==null&&(l.alternate=null,Tl(u)),l.child=null,l.deletions=null,l.sibling=null,l.tag===5&&(u=l.stateNode,u!==null&&Mn(u)),l.stateNode=null,l.return=null,l.dependencies=null,l.memoizedProps=null,l.memoizedState=null,l.pendingProps=null,l.stateNode=null,l.updateQueue=null}function Qu(l){return l.tag===5||l.tag===3||l.tag===4}function Ns(l){e:for(;;){for(;l.sibling===null;){if(l.return===null||Qu(l.return))return null;l=l.return}for(l.sibling.return=l.return,l=l.sibling;l.tag!==5&&l.tag!==6&&l.tag!==18;){if(l.flags&2||l.child===null||l.tag===4)continue e;l.child.return=l,l=l.child}if(!(l.flags&2))return l.stateNode}}function bl(l,u,p){var x=l.tag;if(x===5||x===6)l=l.stateNode,u?Oe(p,l,u):Xe(p,l);else if(x!==4&&(l=l.child,l!==null))for(bl(l,u,p),l=l.sibling;l!==null;)bl(l,u,p),l=l.sibling}function Xu(l,u,p){var x=l.tag;if(x===5||x===6)l=l.stateNode,u?pe(p,l,u):he(p,l);else if(x!==4&&(l=l.child,l!==null))for(Xu(l,u,p),l=l.sibling;l!==null;)Xu(l,u,p),l=l.sibling}var Kt=null,or=!1;function Hr(l,u,p){for(p=p.child;p!==null;)za(l,u,p),p=p.sibling}function za(l,u,p){if(rr&&typeof rr.onCommitFiberUnmount=="function")try{rr.onCommitFiberUnmount(Li,p)}catch{}switch(p.tag){case 5:xn||Et(p,u);case 6:if(ot){var x=Kt,S=or;Kt=null,Hr(l,u,p),Kt=x,or=S,Kt!==null&&(or?Ae(Kt,p.stateNode):Ne(Kt,p.stateNode))}else Hr(l,u,p);break;case 18:ot&&Kt!==null&&(or?tf(Kt,p.stateNode):ef(Kt,p.stateNode));break;case 4:ot?(x=Kt,S=or,Kt=p.stateNode.containerInfo,or=!0,Hr(l,u,p),Kt=x,or=S):(ze&&(x=p.stateNode.containerInfo,S=Yr(x),cs(x,S)),Hr(l,u,p));break;case 0:case 11:case 14:case 15:if(!xn&&(x=p.updateQueue,x!==null&&(x=x.lastEffect,x!==null))){S=x=x.next;do{var b=S,j=b.destroy;b=b.tag,j!==void 0&&((b&2)!==0||(b&4)!==0)&&wr(p,u,j),S=S.next}while(S!==x)}Hr(l,u,p);break;case 1:if(!xn&&(Et(p,u),x=p.stateNode,typeof x.componentWillUnmount=="function"))try{x.props=p.memoizedProps,x.state=p.memoizedState,x.componentWillUnmount()}catch(X){Ft(p,u,X)}Hr(l,u,p);break;case 21:Hr(l,u,p);break;case 22:p.mode&1?(xn=(x=xn)||p.memoizedState!==null,Hr(l,u,p),xn=x):Hr(l,u,p);break;default:Hr(l,u,p)}}function zs(l){var u=l.updateQueue;if(u!==null){l.updateQueue=null;var p=l.stateNode;p===null&&(p=l.stateNode=new xr),u.forEach(function(x){var S=Rh.bind(null,l,x);p.has(x)||(p.add(x),x.then(S,S))})}}function Ar(l,u){var p=u.deletions;if(p!==null)for(var x=0;x<p.length;x++){var S=p[x];try{var b=l,j=u;if(ot){var X=j;e:for(;X!==null;){switch(X.tag){case 5:Kt=X.stateNode,or=!1;break e;case 3:Kt=X.stateNode.containerInfo,or=!0;break e;case 4:Kt=X.stateNode.containerInfo,or=!0;break e}X=X.return}if(Kt===null)throw Error(c(160));za(b,j,S),Kt=null,or=!1}else za(b,j,S);var ie=S.alternate;ie!==null&&(ie.return=null),S.return=null}catch(Pe){Ft(S,u,Pe)}}if(u.subtreeFlags&12854)for(u=u.child;u!==null;)Rl(u,l),u=u.sibling}function Rl(l,u){var p=l.alternate,x=l.flags;switch(l.tag){case 0:case 11:case 14:case 15:if(Ar(u,l),Sr(l),x&4){try{Ls(3,l,l.return),Po(3,l)}catch(_e){Ft(l,l.return,_e)}try{Ls(5,l,l.return)}catch(_e){Ft(l,l.return,_e)}}break;case 1:Ar(u,l),Sr(l),x&512&&p!==null&&Et(p,p.return);break;case 5:if(Ar(u,l),Sr(l),x&512&&p!==null&&Et(p,p.return),ot){if(l.flags&32){var S=l.stateNode;try{tt(S)}catch(_e){Ft(l,l.return,_e)}}if(x&4&&(S=l.stateNode,S!=null)){var b=l.memoizedProps;if(p=p!==null?p.memoizedProps:b,x=l.type,u=l.updateQueue,l.updateQueue=null,u!==null)try{ue(S,u,x,p,b,l)}catch(_e){Ft(l,l.return,_e)}}}break;case 6:if(Ar(u,l),Sr(l),x&4&&ot){if(l.stateNode===null)throw Error(c(162));S=l.stateNode,b=l.memoizedProps,p=p!==null?p.memoizedProps:b;try{Ze(S,p,b)}catch(_e){Ft(l,l.return,_e)}}break;case 3:if(Ar(u,l),Sr(l),x&4){if(ot&&be&&p!==null&&p.memoizedState.isDehydrated)try{Zc(u.containerInfo)}catch(_e){Ft(l,l.return,_e)}if(ze){S=u.containerInfo,b=u.pendingChildren;try{cs(S,b)}catch(_e){Ft(l,l.return,_e)}}}break;case 4:if(Ar(u,l),Sr(l),x&4&&ze){b=l.stateNode,S=b.containerInfo,b=b.pendingChildren;try{cs(S,b)}catch(_e){Ft(l,l.return,_e)}}break;case 13:Ar(u,l),Sr(l),S=l.child,S.flags&8192&&(b=S.memoizedState!==null,S.stateNode.isHidden=b,!b||S.alternate!==null&&S.alternate.memoizedState!==null||(Ro=mn())),x&4&&zs(l);break;case 22:var j=p!==null&&p.memoizedState!==null;if(l.mode&1?(xn=(p=xn)||j,Ar(u,l),xn=p):Ar(u,l),Sr(l),x&8192){if(p=l.memoizedState!==null,(l.stateNode.isHidden=p)&&!j&&(l.mode&1)!==0)for(Ce=l,x=l.child;x!==null;){for(u=Ce=x;Ce!==null;){j=Ce;var X=j.child;switch(j.tag){case 0:case 11:case 14:case 15:Ls(4,j,j.return);break;case 1:Et(j,j.return);var ie=j.stateNode;if(typeof ie.componentWillUnmount=="function"){var Pe=j,Be=j.return;try{var nt=Pe;ie.props=nt.memoizedProps,ie.state=nt.memoizedState,ie.componentWillUnmount()}catch(_e){Ft(Pe,Be,_e)}}break;case 5:Et(j,j.return);break;case 22:if(j.memoizedState!==null){Ba(u);continue}}X!==null?(X.return=j,Ce=X):Ba(u)}x=x.sibling}if(ot){e:if(x=null,ot)for(u=l;;){if(u.tag===5){if(x===null){x=u;try{S=u.stateNode,p?St(S):Pt(u.stateNode,u.memoizedProps)}catch(_e){Ft(l,l.return,_e)}}}else if(u.tag===6){if(x===null)try{b=u.stateNode,p?bt(b):Dt(b,u.memoizedProps)}catch(_e){Ft(l,l.return,_e)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===l)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===l)break e;for(;u.sibling===null;){if(u.return===null||u.return===l)break e;x===u&&(x=null),u=u.return}x===u&&(x=null),u.sibling.return=u.return,u=u.sibling}}}break;case 19:Ar(u,l),Sr(l),x&4&&zs(l);break;case 21:break;default:Ar(u,l),Sr(l)}}function Sr(l){var u=l.flags;if(u&2){try{if(ot){e:{for(var p=l.return;p!==null;){if(Qu(p)){var x=p;break e}p=p.return}throw Error(c(160))}switch(x.tag){case 5:var S=x.stateNode;x.flags&32&&(tt(S),x.flags&=-33);var b=Ns(l);Xu(l,b,S);break;case 3:case 4:var j=x.stateNode.containerInfo,X=Ns(l);bl(l,X,j);break;default:throw Error(c(161))}}}catch(ie){Ft(l,l.return,ie)}l.flags&=-3}u&4096&&(l.flags&=-4097)}function Eo(l,u,p){Ce=l,Fa(l)}function Fa(l,u,p){for(var x=(l.mode&1)!==0;Ce!==null;){var S=Ce,b=S.child;if(S.tag===22&&x){var j=S.memoizedState!==null||So;if(!j){var X=S.alternate,ie=X!==null&&X.memoizedState!==null||xn;X=So;var Pe=xn;if(So=j,(xn=ie)&&!Pe)for(Ce=S;Ce!==null;)j=Ce,ie=j.child,j.tag===22&&j.memoizedState!==null?$a(S):ie!==null?(ie.return=j,Ce=ie):$a(S);for(;b!==null;)Ce=b,Fa(b),b=b.sibling;Ce=S,So=X,xn=Pe}Da(l)}else(S.subtreeFlags&8772)!==0&&b!==null?(b.return=S,Ce=b):Da(l)}}function Da(l){for(;Ce!==null;){var u=Ce;if((u.flags&8772)!==0){var p=u.alternate;try{if((u.flags&8772)!==0)switch(u.tag){case 0:case 11:case 15:xn||Po(5,u);break;case 1:var x=u.stateNode;if(u.flags&4&&!xn)if(p===null)x.componentDidMount();else{var S=u.elementType===u.type?p.memoizedProps:yr(u.type,p.memoizedProps);x.componentDidUpdate(S,p.memoizedState,x.__reactInternalSnapshotBeforeUpdate)}var b=u.updateQueue;b!==null&&xf(u,b,x);break;case 3:var j=u.updateQueue;if(j!==null){if(p=null,u.child!==null)switch(u.child.tag){case 5:p=Se(u.child.stateNode);break;case 1:p=u.child.stateNode}xf(u,j,p)}break;case 5:var X=u.stateNode;p===null&&u.flags&4&&at(X,u.type,u.memoizedProps,u);break;case 6:break;case 4:break;case 12:break;case 13:if(be&&u.memoizedState===null){var ie=u.alternate;if(ie!==null){var Pe=ie.memoizedState;if(Pe!==null){var Be=Pe.dehydrated;Be!==null&&Jc(Be)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(c(163))}xn||u.flags&512&&Na(u)}catch(nt){Ft(u,u.return,nt)}}if(u===l){Ce=null;break}if(p=u.sibling,p!==null){p.return=u.return,Ce=p;break}Ce=u.return}}function Ba(l){for(;Ce!==null;){var u=Ce;if(u===l){Ce=null;break}var p=u.sibling;if(p!==null){p.return=u.return,Ce=p;break}Ce=u.return}}function $a(l){for(;Ce!==null;){var u=Ce;try{switch(u.tag){case 0:case 11:case 15:var p=u.return;try{Po(4,u)}catch(ie){Ft(u,p,ie)}break;case 1:var x=u.stateNode;if(typeof x.componentDidMount=="function"){var S=u.return;try{x.componentDidMount()}catch(ie){Ft(u,S,ie)}}var b=u.return;try{Na(u)}catch(ie){Ft(u,b,ie)}break;case 5:var j=u.return;try{Na(u)}catch(ie){Ft(u,j,ie)}}}catch(ie){Ft(u,u.return,ie)}if(u===l){Ce=null;break}var X=u.sibling;if(X!==null){X.return=u.return,Ce=X;break}Ce=u.return}}var Pi=0,Gn=1,ri=2,ko=3,_l=4;if(typeof Symbol=="function"&&Symbol.for){var Pr=Symbol.for;Pi=Pr("selector.component"),Gn=Pr("selector.has_pseudo_class"),ri=Pr("selector.role"),ko=Pr("selector.test_id"),_l=Pr("selector.text")}function ii(l){var u=ct(l);if(u!=null){if(typeof u.memoizedProps["data-testname"]!="string")throw Error(c(364));return u}if(l=br(l),l===null)throw Error(c(362));return l.stateNode.current}function Il(l,u){switch(u.$$typeof){case Pi:if(l.type===u.value)return!0;break;case Gn:e:{u=u.value,l=[l,0];for(var p=0;p<l.length;){var x=l[p++],S=l[p++],b=u[S];if(x.tag!==5||!ke(x)){for(;b!=null&&Il(x,b);)S++,b=u[S];if(S===u.length){u=!0;break e}else for(x=x.child;x!==null;)l.push(x,S),x=x.sibling}}u=!1}return u;case ri:if(l.tag===5&&G(l.stateNode,u.value))return!0;break;case _l:if((l.tag===5||l.tag===6)&&(l=fe(l),l!==null&&0<=l.indexOf(u.value)))return!0;break;case ko:if(l.tag===5&&(l=l.memoizedProps["data-testname"],typeof l=="string"&&l.toLowerCase()===u.value.toLowerCase()))return!0;break;default:throw Error(c(365))}return!1}function Ua(l){switch(l.$$typeof){case Pi:return"<"+(se(l.value)||"Unknown")+">";case Gn:return":has("+(Ua(l)||"")+")";case ri:return'[role="'+l.value+'"]';case _l:return'"'+l.value+'"';case ko:return'[data-testname="'+l.value+'"]';default:throw Error(c(365))}}function si(l,u){var p=[];l=[l,0];for(var x=0;x<l.length;){var S=l[x++],b=l[x++],j=u[b];if(S.tag!==5||!ke(S)){for(;j!=null&&Il(S,j);)b++,j=u[b];if(b===u.length)p.push(S);else for(S=S.child;S!==null;)l.push(S,b),S=S.sibling}}return p}function oi(l,u){if(!Vn)throw Error(c(363));l=ii(l),l=si(l,u),u=[],l=Array.from(l);for(var p=0;p<l.length;){var x=l[p++];if(x.tag===5)ke(x)||u.push(x.stateNode);else for(x=x.child;x!==null;)l.push(x),x=x.sibling}return u}var Wa=Math.ceil,Ol=d.ReactCurrentDispatcher,Co=d.ReactCurrentOwner,qt=d.ReactCurrentBatchConfig,st=0,It=null,Ut=null,Gt=0,un=0,Ki=kn(0),Wt=0,To=null,Ei=0,Mt=0,bo=0,Fs=null,zn=null,Ro=0,Al=1/0,Zn=null;function Ct(){Al=mn()+500}var Qt=!1,en=null,Vr=null,Gi=!1,Mr=null,Ha=0,tn=0,Ml=null,_o=-1,Io=0;function zt(){return(st&6)!==0?mn():_o!==-1?_o:_o=mn()}function cn(l){return(l.mode&1)===0?1:(st&2)!==0&&Gt!==0?Gt&-Gt:Ch.transition!==null?(Io===0&&(Io=aa()),Io):(l=dt,l!==0?l:fr())}function Fn(l,u,p,x){if(50<tn)throw tn=0,Ml=null,Error(c(185));Rr(l,p,x),((st&2)===0||l!==It)&&(l===It&&((st&2)===0&&(Mt|=p),Wt===4&&ki(l,Gt)),Dn(l,x),p===1&&st===0&&(u.mode&1)===0&&(Ct(),ao&&Cn()))}function Dn(l,u){var p=l.callbackNode;of(l,u);var x=io(l,l===It?Gt:0);if(x===0)p!==null&&lf(p),l.callbackNode=null,l.callbackPriority=0;else if(u=x&-x,l.callbackPriority!==u){if(p!=null&&lf(p),u===1)l.tag===0?uf(Yu.bind(null,l)):ha(Yu.bind(null,l)),En?as(function(){(st&6)===0&&Cn()}):Zr(ua,Cn),p=null;else{switch(oo(x)){case 1:p=ua;break;case 4:p=ca;break;case 16:p=fa;break;case 536870912:p=kh;break;default:p=fa}p=nc(p,Va.bind(null,l))}l.callbackPriority=u,l.callbackNode=p}}function Va(l,u){if(_o=-1,Io=0,(st&6)!==0)throw Error(c(327));var p=l.callbackNode;if(Ci()&&l.callbackNode!==p)return null;var x=io(l,l===It?Gt:0);if(x===0)return null;if((x&30)!==0||(x&l.expiredLanes)!==0||u)u=Ds(l,x);else{u=x;var S=st;st|=2;var b=Gu();(It!==l||Gt!==u)&&(Zn=null,Ct(),Zi(l,u));do try{Zu();break}catch(X){Oo(l,X)}while(!0);Cu(),Ol.current=b,st=S,Ut!==null?u=0:(It=null,Gt=0,u=Wt)}if(u!==0){if(u===2&&(S=la(l),S!==0&&(x=S,u=qa(l,S))),u===1)throw p=To,Zi(l,0),ki(l,x),Dn(l,mn()),p;if(u===6)ki(l,x);else{if(S=l.current.alternate,(x&30)===0&&!Of(S)&&(u=Ds(l,x),u===2&&(b=la(l),b!==0&&(x=b,u=qa(l,b))),u===1))throw p=To,Zi(l,0),ki(l,x),Dn(l,mn()),p;switch(l.finishedWork=S,l.finishedLanes=x,u){case 0:case 1:throw Error(c(345));case 2:Ji(l,zn,Zn);break;case 3:if(ki(l,x),(x&130023424)===x&&(u=Ro+500-mn(),10<u)){if(io(l,0)!==0)break;if(S=l.suspendedLanes,(S&x)!==x){zt(),l.pingedLanes|=l.suspendedLanes&S;break}l.timeoutHandle=Je(Ji.bind(null,l,zn,Zn),u);break}Ji(l,zn,Zn);break;case 4:if(ki(l,x),(x&4194240)===x)break;for(u=l.eventTimes,S=-1;0<x;){var j=31-dr(x);b=1<<j,j=u[j],j>S&&(S=j),x&=~b}if(x=S,x=mn()-x,x=(120>x?120:480>x?480:1080>x?1080:1920>x?1920:3e3>x?3e3:4320>x?4320:1960*Wa(x/1960))-x,10<x){l.timeoutHandle=Je(Ji.bind(null,l,zn,Zn),x);break}Ji(l,zn,Zn);break;case 5:Ji(l,zn,Zn);break;default:throw Error(c(329))}}}return Dn(l,mn()),l.callbackNode===p?Va.bind(null,l):null}function qa(l,u){var p=Fs;return l.current.memoizedState.isDehydrated&&(Zi(l,u).flags|=256),l=Ds(l,u),l!==2&&(u=zn,zn=p,u!==null&&Qa(u)),l}function Qa(l){zn===null?zn=l:zn.push.apply(zn,l)}function Of(l){for(var u=l;;){if(u.flags&16384){var p=u.updateQueue;if(p!==null&&(p=p.stores,p!==null))for(var x=0;x<p.length;x++){var S=p[x],b=S.getSnapshot;S=S.value;try{if(!Dr(b(),S))return!1}catch{return!1}}}if(p=u.child,u.subtreeFlags&16384&&p!==null)p.return=u,u=p;else{if(u===l)break;for(;u.sibling===null;){if(u.return===null||u.return===l)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function ki(l,u){for(u&=~bo,u&=~Mt,l.suspendedLanes|=u,l.pingedLanes&=~u,l=l.expirationTimes;0<u;){var p=31-dr(u),x=1<<p;l[p]=-1,u&=~x}}function Yu(l){if((st&6)!==0)throw Error(c(327));Ci();var u=io(l,0);if((u&1)===0)return Dn(l,mn()),null;var p=Ds(l,u);if(l.tag!==0&&p===2){var x=la(l);x!==0&&(u=x,p=qa(l,x))}if(p===1)throw p=To,Zi(l,0),ki(l,u),Dn(l,mn()),p;if(p===6)throw Error(c(345));return l.finishedWork=l.current.alternate,l.finishedLanes=u,Ji(l,zn,Zn),Dn(l,mn()),null}function Ku(l){Mr!==null&&Mr.tag===0&&(st&6)===0&&Ci();var u=st;st|=1;var p=qt.transition,x=dt;try{if(qt.transition=null,dt=1,l)return l()}finally{dt=x,qt.transition=p,st=u,(st&6)===0&&Cn()}}function Xa(){un=Ki.current,Lt(Ki)}function Zi(l,u){l.finishedWork=null,l.finishedLanes=0;var p=l.timeoutHandle;if(p!==ut&&(l.timeoutHandle=ut,it(p)),Ut!==null)for(p=Ut.return;p!==null;){var x=p;switch(hl(x),x.tag){case 1:x=x.type.childContextTypes,x!=null&&gs();break;case 3:Ss(),Lt(nr),Lt(jn),Ou();break;case 5:_u(x);break;case 4:Ss();break;case 13:Lt(Ht);break;case 19:Lt(Ht);break;case 10:gl(x.type._context);break;case 22:case 23:Xa()}p=p.return}if(It=l,Ut=l=es(l.current,null),Gt=un=u,Wt=0,To=null,bo=Mt=Ei=0,zn=Fs=null,zi!==null){for(u=0;u<zi.length;u++)if(p=zi[u],x=p.interleaved,x!==null){p.interleaved=null;var S=x.next,b=p.pending;if(b!==null){var j=b.next;b.next=S,x.next=j}p.pending=x}zi=null}return l}function Oo(l,u){do{var p=Ut;try{if(Cu(),sr.current=Rs,go){for(var x=Bt.memoizedState;x!==null;){var S=x.queue;S!==null&&(S.pending=null),x=x.next}go=!1}if($i=0,ln=Jt=Bt=null,yl=!1,vl=0,Co.current=null,p===null||p.return===null){Wt=1,To=u,Ut=null;break}e:{var b=l,j=p.return,X=p,ie=u;if(u=Gt,X.flags|=32768,ie!==null&&typeof ie=="object"&&typeof ie.then=="function"){var Pe=ie,Be=X,nt=Be.tag;if((Be.mode&1)===0&&(nt===0||nt===11||nt===15)){var _e=Be.alternate;_e?(Be.updateQueue=_e.updateQueue,Be.memoizedState=_e.memoizedState,Be.lanes=_e.lanes):(Be.updateQueue=null,Be.memoizedState=null)}var jt=bf(j);if(jt!==null){jt.flags&=-257,Hi(jt,j,X,b,u),jt.mode&1&&Tf(b,Pe,u),u=jt,ie=Pe;var kt=u.updateQueue;if(kt===null){var Jn=new Set;Jn.add(ie),u.updateQueue=Jn}else kt.add(ie);break e}else{if((u&1)===0){Tf(b,Pe,u),Ao();break e}ie=Error(c(426))}}else if(Nt&&X.mode&1){var li=bf(j);if(li!==null){(li.flags&65536)===0&&(li.flags|=256),Hi(li,j,X,b,u),Eu(_s(ie,X));break e}}b=ie=_s(ie,X),Wt!==4&&(Wt=2),Fs===null?Fs=[b]:Fs.push(b),b=j;do{switch(b.tag){case 3:b.flags|=65536,u&=-u,b.lanes|=u;var te=ei(b,ie,u);ho(b,te);break e;case 1:X=ie;var Y=b.type,ce=b.stateNode;if((b.flags&128)===0&&(typeof Y.getDerivedStateFromError=="function"||ce!==null&&typeof ce.componentDidCatch=="function"&&(Vr===null||!Vr.has(ce)))){b.flags|=65536,u&=-u,b.lanes|=u;var Me=Aa(b,X,u);ho(b,Me);break e}}b=b.return}while(b!==null)}ec(p)}catch(Qe){u=Qe,Ut===p&&p!==null&&(Ut=p=p.return);continue}break}while(!0)}function Gu(){var l=Ol.current;return Ol.current=Rs,l===null?Rs:l}function Ao(){(Wt===0||Wt===3||Wt===2)&&(Wt=4),It===null||(Ei&268435455)===0&&(Mt&268435455)===0||ki(It,Gt)}function Ds(l,u){var p=st;st|=2;var x=Gu();(It!==l||Gt!==u)&&(Zn=null,Zi(l,u));do try{Af();break}catch(S){Oo(l,S)}while(!0);if(Cu(),st=p,Ol.current=x,Ut!==null)throw Error(c(261));return It=null,Gt=0,Wt}function Af(){for(;Ut!==null;)Ju(Ut)}function Zu(){for(;Ut!==null&&!af();)Ju(Ut)}function Ju(l){var u=zf(l.alternate,l,un);l.memoizedProps=l.pendingProps,u===null?ec(l):Ut=u,Co.current=null}function ec(l){var u=l;do{var p=u.alternate;if(l=u.return,(u.flags&32768)===0){if(p=js(p,u,un),p!==null){Ut=p;return}}else{if(p=_f(p,u),p!==null){p.flags&=32767,Ut=p;return}if(l!==null)l.flags|=32768,l.subtreeFlags=0,l.deletions=null;else{Wt=6,Ut=null;return}}if(u=u.sibling,u!==null){Ut=u;return}Ut=u=l}while(u!==null);Wt===0&&(Wt=5)}function Ji(l,u,p){var x=dt,S=qt.transition;try{qt.transition=null,dt=1,Mf(l,u,p,x)}finally{qt.transition=S,dt=x}return null}function Mf(l,u,p,x){do Ci();while(Mr!==null);if((st&6)!==0)throw Error(c(327));p=l.finishedWork;var S=l.finishedLanes;if(p===null)return null;if(l.finishedWork=null,l.finishedLanes=0,p===l.current)throw Error(c(177));l.callbackNode=null,l.callbackPriority=0;var b=p.lanes|p.childLanes;if(ji(l,b),l===It&&(Ut=It=null,Gt=0),(p.subtreeFlags&2064)===0&&(p.flags&2064)===0||Gi||(Gi=!0,nc(fa,function(){return Ci(),null})),b=(p.flags&15990)!==0,(p.subtreeFlags&15990)!==0||b){b=qt.transition,qt.transition=null;var j=dt;dt=1;var X=st;st|=4,Co.current=null,If(l,p),Rl(p,l),Q(l.containerInfo),l.current=p,Eo(p),cl(),st=X,dt=j,qt.transition=b}else l.current=p;if(Gi&&(Gi=!1,Mr=l,Ha=S),b=l.pendingLanes,b===0&&(Vr=null),lo(p.stateNode),Dn(l,mn()),u!==null)for(x=l.onRecoverableError,p=0;p<u.length;p++)S=u[p],x(S.value,{componentStack:S.stack,digest:S.digest});if(Qt)throw Qt=!1,l=en,en=null,l;return(Ha&1)!==0&&l.tag!==0&&Ci(),b=l.pendingLanes,(b&1)!==0?l===Ml?tn++:(tn=0,Ml=l):tn=0,Cn(),null}function Ci(){if(Mr!==null){var l=oo(Ha),u=qt.transition,p=dt;try{if(qt.transition=null,dt=16>l?16:l,Mr===null)var x=!1;else{if(l=Mr,Mr=null,Ha=0,(st&6)!==0)throw Error(c(331));var S=st;for(st|=4,Ce=l.current;Ce!==null;){var b=Ce,j=b.child;if((Ce.flags&16)!==0){var X=b.deletions;if(X!==null){for(var ie=0;ie<X.length;ie++){var Pe=X[ie];for(Ce=Pe;Ce!==null;){var Be=Ce;switch(Be.tag){case 0:case 11:case 15:Ls(8,Be,b)}var nt=Be.child;if(nt!==null)nt.return=Be,Ce=nt;else for(;Ce!==null;){Be=Ce;var _e=Be.sibling,jt=Be.return;if(Tl(Be),Be===Pe){Ce=null;break}if(_e!==null){_e.return=jt,Ce=_e;break}Ce=jt}}}var kt=b.alternate;if(kt!==null){var Jn=kt.child;if(Jn!==null){kt.child=null;do{var li=Jn.sibling;Jn.sibling=null,Jn=li}while(Jn!==null)}}Ce=b}}if((b.subtreeFlags&2064)!==0&&j!==null)j.return=b,Ce=j;else e:for(;Ce!==null;){if(b=Ce,(b.flags&2048)!==0)switch(b.tag){case 0:case 11:case 15:Ls(9,b,b.return)}var te=b.sibling;if(te!==null){te.return=b.return,Ce=te;break e}Ce=b.return}}var Y=l.current;for(Ce=Y;Ce!==null;){j=Ce;var ce=j.child;if((j.subtreeFlags&2064)!==0&&ce!==null)ce.return=j,Ce=ce;else e:for(j=Y;Ce!==null;){if(X=Ce,(X.flags&2048)!==0)try{switch(X.tag){case 0:case 11:case 15:Po(9,X)}}catch(Qe){Ft(X,X.return,Qe)}if(X===j){Ce=null;break e}var Me=X.sibling;if(Me!==null){Me.return=X.return,Ce=Me;break e}Ce=X.return}}if(st=S,Cn(),rr&&typeof rr.onPostCommitFiberRoot=="function")try{rr.onPostCommitFiberRoot(Li,l)}catch{}x=!0}return x}finally{dt=p,qt.transition=u}}return!1}function tc(l,u,p){u=_s(p,u),u=ei(l,u,1),l=vi(l,u,1),u=zt(),l!==null&&(Rr(l,1,u),Dn(l,u))}function Ft(l,u,p){if(l.tag===3)tc(l,l,p);else for(;u!==null;){if(u.tag===3){tc(u,l,p);break}else if(u.tag===1){var x=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof x.componentDidCatch=="function"&&(Vr===null||!Vr.has(x))){l=_s(p,l),l=Aa(u,l,1),u=vi(u,l,1),l=zt(),u!==null&&(Rr(u,1,l),Dn(u,l));break}}u=u.return}}function jf(l,u,p){var x=l.pingCache;x!==null&&x.delete(u),u=zt(),l.pingedLanes|=l.suspendedLanes&p,It===l&&(Gt&p)===p&&(Wt===4||Wt===3&&(Gt&130023424)===Gt&&500>mn()-Ro?Zi(l,0):bo|=p),Dn(l,u)}function Lf(l,u){u===0&&((l.mode&1)===0?u=1:(u=ul,ul<<=1,(ul&130023424)===0&&(ul=4194304)));var p=zt();l=Wr(l,u),l!==null&&(Rr(l,u,p),Dn(l,p))}function Nf(l){var u=l.memoizedState,p=0;u!==null&&(p=u.retryLane),Lf(l,p)}function Rh(l,u){var p=0;switch(l.tag){case 13:var x=l.stateNode,S=l.memoizedState;S!==null&&(p=S.retryLane);break;case 19:x=l.stateNode;break;default:throw Error(c(314))}x!==null&&x.delete(u),Lf(l,p)}var zf;zf=function(l,u,p){if(l!==null)if(l.memoizedProps!==u.pendingProps||nr.current)an=!0;else{if((l.lanes&p)===0&&(u.flags&128)===0)return an=!1,qi(l,u,p);an=(l.flags&131072)!==0}else an=!1,Nt&&(u.flags&1048576)!==0&&cf(u,ms,u.index);switch(u.lanes=0,u.tag){case 2:var x=u.type;Cl(l,u),l=u.pendingProps;var S=pi(u,jn.current);fo(u,p),S=xl(null,u,x,l,S,p);var b=Ea();return u.flags|=1,typeof S=="object"&&S!==null&&typeof S.render=="function"&&S.$$typeof===void 0?(u.tag=1,u.memoizedState=null,u.updateQueue=null,gn(x)?(b=!0,no(u)):b=!1,u.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,bu(u),S.updater=Pl,u.stateNode=S,S._reactInternals=u,Jr(u,x,l,p),u=Ln(null,u,x,!0,b,p)):(u.tag=0,Nt&&b&&dl(u),vn(null,u,S,p),u=u.child),u;case 16:x=u.elementType;e:{switch(Cl(l,u),l=u.pendingProps,S=x._init,x=S(x._payload),u.type=x,S=u.tag=_h(x),l=yr(x,l),S){case 0:u=ti(null,u,x,l,p);break e;case 1:u=Rn(null,u,x,l,p);break e;case 11:u=Ma(null,u,x,l,p);break e;case 14:u=Is(null,u,x,yr(x.type,l),p);break e}throw Error(c(306,x,""))}return u;case 0:return x=u.type,S=u.pendingProps,S=u.elementType===x?S:yr(x,S),ti(l,u,x,S,p);case 1:return x=u.type,S=u.pendingProps,S=u.elementType===x?S:yr(x,S),Rn(l,u,x,S,p);case 3:e:{if(Vi(u),l===null)throw Error(c(387));x=u.pendingProps,b=u.memoizedState,S=b.element,vf(l,u),Fi(u,x,null,p);var j=u.memoizedState;if(x=j.element,be&&b.isDehydrated)if(b={element:x,isDehydrated:!1,cache:j.cache,pendingSuspenseBoundaries:j.pendingSuspenseBoundaries,transitions:j.transitions},u.updateQueue.baseState=b,u.memoizedState=b,u.flags&256){S=_s(Error(c(423)),u),u=Os(l,u,x,p,S);break e}else if(x!==S){S=_s(Error(c(424)),u),u=Os(l,u,x,p,S);break e}else for(be&&(Qn=yh(u.stateNode.containerInfo),Tn=u,Nt=!0,Ur=null,pl=!1),p=mf(u,null,x,p),u.child=p;p;)p.flags=p.flags&-3|4096,p=p.sibling;else{if(ys(),x===S){u=Si(l,u,p);break e}vn(l,u,x,p)}u=u.child}return u;case 5:return Ru(u),l===null&&Pu(u),x=u.type,S=u.pendingProps,b=l!==null?l.memoizedProps:null,j=S.children,Le(x,S)?j=null:b!==null&&Le(x,b)&&(u.flags|=32),_t(l,u),vn(l,u,j,p),u.child;case 6:return l===null&&Pu(u),null;case 13:return Vu(l,u,p);case 4:return Sa(u,u.stateNode.containerInfo),x=u.pendingProps,l===null?u.child=xs(u,null,x,p):vn(l,u,x,p),u.child;case 11:return x=u.type,S=u.pendingProps,S=u.elementType===x?S:yr(x,S),Ma(l,u,x,S,p);case 7:return vn(l,u,u.pendingProps,p),u.child;case 8:return vn(l,u,u.pendingProps.children,p),u.child;case 12:return vn(l,u,u.pendingProps.children,p),u.child;case 10:e:{if(x=u.type._context,S=u.pendingProps,b=u.memoizedProps,j=S.value,yf(u,x,j),b!==null)if(Dr(b.value,j)){if(b.children===S.children&&!nr.current){u=Si(l,u,p);break e}}else for(b=u.child,b!==null&&(b.return=u);b!==null;){var X=b.dependencies;if(X!==null){j=b.child;for(var ie=X.firstContext;ie!==null;){if(ie.context===x){if(b.tag===1){ie=yi(-1,p&-p),ie.tag=2;var Pe=b.updateQueue;if(Pe!==null){Pe=Pe.shared;var Be=Pe.pending;Be===null?ie.next=ie:(ie.next=Be.next,Be.next=ie),Pe.pending=ie}}b.lanes|=p,ie=b.alternate,ie!==null&&(ie.lanes|=p),ws(b.return,p,u),X.lanes|=p;break}ie=ie.next}}else if(b.tag===10)j=b.type===u.type?null:b.child;else if(b.tag===18){if(j=b.return,j===null)throw Error(c(341));j.lanes|=p,X=j.alternate,X!==null&&(X.lanes|=p),ws(j,p,u),j=b.sibling}else j=b.child;if(j!==null)j.return=b;else for(j=b;j!==null;){if(j===u){j=null;break}if(b=j.sibling,b!==null){b.return=j.return,j=b;break}j=j.return}b=j}vn(l,u,S.children,p),u=u.child}return u;case 9:return S=u.type,x=u.pendingProps.children,fo(u,p),S=pr(S),x=x(S),u.flags|=1,vn(l,u,x,p),u.child;case 14:return x=u.type,S=yr(x,u.pendingProps),S=yr(x.type,S),Is(l,u,x,S,p);case 15:return wi(l,u,u.type,u.pendingProps,p);case 17:return x=u.type,S=u.pendingProps,S=u.elementType===x?S:yr(x,S),Cl(l,u),u.tag=1,gn(x)?(l=!0,no(u)):l=!1,fo(u,p),Cf(u,x,S),Jr(u,x,S,p),Ln(null,u,x,!0,l,p);case 19:return La(l,u,p);case 22:return At(l,u,p)}throw Error(c(156,u.tag))};function nc(l,u){return Zr(l,u)}function Ff(l,u,p,x){this.tag=l,this.key=p,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=x,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Er(l,u,p,x){return new Ff(l,u,p,x)}function Mo(l){return l=l.prototype,!(!l||!l.isReactComponent)}function _h(l){if(typeof l=="function")return Mo(l)?1:0;if(l!=null){if(l=l.$$typeof,l===k)return 11;if(l===M)return 14}return 2}function es(l,u){var p=l.alternate;return p===null?(p=Er(l.tag,u,l.key,l.mode),p.elementType=l.elementType,p.type=l.type,p.stateNode=l.stateNode,p.alternate=l,l.alternate=p):(p.pendingProps=u,p.type=l.type,p.flags=0,p.subtreeFlags=0,p.deletions=null),p.flags=l.flags&14680064,p.childLanes=l.childLanes,p.lanes=l.lanes,p.child=l.child,p.memoizedProps=l.memoizedProps,p.memoizedState=l.memoizedState,p.updateQueue=l.updateQueue,u=l.dependencies,p.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},p.sibling=l.sibling,p.index=l.index,p.ref=l.ref,p}function Ya(l,u,p,x,S,b){var j=2;if(x=l,typeof l=="function")Mo(l)&&(j=1);else if(typeof l=="string")j=5;else e:switch(l){case h:return _n(p.children,S,b,u);case v:j=8,S|=8;break;case E:return l=Er(12,p,u,S|2),l.elementType=E,l.lanes=b,l;case R:return l=Er(13,p,u,S),l.elementType=R,l.lanes=b,l;case _:return l=Er(19,p,u,S),l.elementType=_,l.lanes=b,l;case $:return jo(p,S,b,u);default:if(typeof l=="object"&&l!==null)switch(l.$$typeof){case T:j=10;break e;case P:j=9;break e;case k:j=11;break e;case M:j=14;break e;case L:j=16,x=null;break e}throw Error(c(130,l==null?l:typeof l,""))}return u=Er(j,p,u,S),u.elementType=l,u.type=x,u.lanes=b,u}function _n(l,u,p,x){return l=Er(7,l,x,u),l.lanes=p,l}function jo(l,u,p,x){return l=Er(22,l,x,u),l.elementType=$,l.lanes=p,l.stateNode={isHidden:!1},l}function Lo(l,u,p){return l=Er(6,l,null,u),l.lanes=p,l}function Ka(l,u,p){return u=Er(4,l.children!==null?l.children:[],l.key,u),u.lanes=p,u.stateNode={containerInfo:l.containerInfo,pendingChildren:null,implementation:l.implementation},u}function Df(l,u,p,x,S){this.tag=u,this.containerInfo=l,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=ut,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=so(0),this.expirationTimes=so(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=so(0),this.identifierPrefix=x,this.onRecoverableError=S,be&&(this.mutableSourceEagerHydrationData=null)}function rc(l,u,p,x,S,b,j,X,ie){return l=new Df(l,u,p,X,ie),u===1?(u=1,b===!0&&(u|=8)):u=0,b=Er(3,null,null,u),l.current=b,b.stateNode=l,b.memoizedState={element:x,isDehydrated:p,cache:null,transitions:null,pendingSuspenseBoundaries:null},bu(b),l}function Ga(l){if(!l)return Mi;l=l._reactInternals;e:{if(me(l)!==l||l.tag!==1)throw Error(c(170));var u=l;do{switch(u.tag){case 3:u=u.stateNode.context;break e;case 1:if(gn(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break e}}u=u.return}while(u!==null);throw Error(c(171))}if(l.tag===1){var p=l.type;if(gn(p))return rf(l,p,u)}return u}function Bs(l){var u=l._reactInternals;if(u===void 0)throw typeof l.render=="function"?Error(c(188)):(l=Object.keys(l).join(","),Error(c(268,l)));return l=de(u),l===null?null:l.stateNode}function Za(l,u){if(l=l.memoizedState,l!==null&&l.dehydrated!==null){var p=l.retryLane;l.retryLane=p!==0&&p<u?p:u}}function No(l,u){Za(l,u),(l=l.alternate)&&Za(l,u)}function Ih(l){return l=de(l),l===null?null:l.stateNode}function Bf(){return null}return n.attemptContinuousHydration=function(l){if(l.tag===13){var u=Wr(l,134217728);if(u!==null){var p=zt();Fn(u,l,134217728,p)}No(l,134217728)}},n.attemptDiscreteHydration=function(l){if(l.tag===13){var u=Wr(l,1);if(u!==null){var p=zt();Fn(u,l,1,p)}No(l,1)}},n.attemptHydrationAtCurrentPriority=function(l){if(l.tag===13){var u=cn(l),p=Wr(l,u);if(p!==null){var x=zt();Fn(p,l,u,x)}No(l,u)}},n.attemptSynchronousHydration=function(l){switch(l.tag){case 3:var u=l.stateNode;if(u.current.memoizedState.isDehydrated){var p=ro(u.pendingLanes);p!==0&&(Gr(u,p|1),Dn(u,mn()),(st&6)===0&&(Ct(),Cn()))}break;case 13:Ku(function(){var x=Wr(l,1);if(x!==null){var S=zt();Fn(x,l,1,S)}}),No(l,1)}},n.batchedUpdates=function(l,u){var p=st;st|=1;try{return l(u)}finally{st=p,st===0&&(Ct(),ao&&Cn())}},n.createComponentSelector=function(l){return{$$typeof:Pi,value:l}},n.createContainer=function(l,u,p,x,S,b,j){return rc(l,u,!1,null,p,x,S,b,j)},n.createHasPseudoClassSelector=function(l){return{$$typeof:Gn,value:l}},n.createHydrationContainer=function(l,u,p,x,S,b,j,X,ie){return l=rc(p,x,!0,l,S,b,j,X,ie),l.context=Ga(null),p=l.current,x=zt(),S=cn(p),b=yi(x,S),b.callback=u??null,vi(p,b,S),l.current.lanes=S,Rr(l,S,x),Dn(l,x),l},n.createPortal=function(l,u,p){var x=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:y,key:x==null?null:""+x,children:l,containerInfo:u,implementation:p}},n.createRoleSelector=function(l){return{$$typeof:ri,value:l}},n.createTestNameSelector=function(l){return{$$typeof:ko,value:l}},n.createTextSelector=function(l){return{$$typeof:_l,value:l}},n.deferredUpdates=function(l){var u=dt,p=qt.transition;try{return qt.transition=null,dt=16,l()}finally{dt=u,qt.transition=p}},n.discreteUpdates=function(l,u,p,x,S){var b=dt,j=qt.transition;try{return qt.transition=null,dt=1,l(u,p,x,S)}finally{dt=b,qt.transition=j,st===0&&Ct()}},n.findAllNodes=oi,n.findBoundingRects=function(l,u){if(!Vn)throw Error(c(363));u=oi(l,u),l=[];for(var p=0;p<u.length;p++)l.push(Z(u[p]));for(u=l.length-1;0<u;u--){p=l[u];for(var x=p.x,S=x+p.width,b=p.y,j=b+p.height,X=u-1;0<=X;X--)if(u!==X){var ie=l[X],Pe=ie.x,Be=Pe+ie.width,nt=ie.y,_e=nt+ie.height;if(x>=Pe&&b>=nt&&S<=Be&&j<=_e){l.splice(u,1);break}else if(x!==Pe||p.width!==ie.width||_e<b||nt>j){if(!(b!==nt||p.height!==ie.height||Be<x||Pe>S)){Pe>x&&(ie.width+=Pe-x,ie.x=x),Be<S&&(ie.width=S-Pe),l.splice(u,1);break}}else{nt>b&&(ie.height+=nt-b,ie.y=b),_e<j&&(ie.height=j-nt),l.splice(u,1);break}}}return l},n.findHostInstance=Bs,n.findHostInstanceWithNoPortals=function(l){return l=ge(l),l=l!==null?le(l):null,l===null?null:l.stateNode},n.findHostInstanceWithWarning=function(l){return Bs(l)},n.flushControlled=function(l){var u=st;st|=1;var p=qt.transition,x=dt;try{qt.transition=null,dt=1,l()}finally{dt=x,qt.transition=p,st=u,st===0&&(Ct(),Cn())}},n.flushPassiveEffects=Ci,n.flushSync=Ku,n.focusWithin=function(l,u){if(!Vn)throw Error(c(363));for(l=ii(l),u=si(l,u),u=Array.from(u),l=0;l<u.length;){var p=u[l++];if(!ke(p)){if(p.tag===5&&W(p.stateNode))return!0;for(p=p.child;p!==null;)u.push(p),p=p.sibling}}return!1},n.getCurrentUpdatePriority=function(){return dt},n.getFindAllNodesFailureDescription=function(l,u){if(!Vn)throw Error(c(363));var p=0,x=[];l=[ii(l),0];for(var S=0;S<l.length;){var b=l[S++],j=l[S++],X=u[j];if((b.tag!==5||!ke(b))&&(Il(b,X)&&(x.push(Ua(X)),j++,j>p&&(p=j)),j<u.length))for(b=b.child;b!==null;)l.push(b,j),b=b.sibling}if(p<u.length){for(l=[];p<u.length;p++)l.push(Ua(u[p]));return`findAllNodes was able to match part of the selector:
  `+(x.join(" > ")+`

No matching component was found for:
  `)+l.join(" > ")}return null},n.getPublicRootInstance=function(l){if(l=l.current,!l.child)return null;switch(l.child.tag){case 5:return Se(l.child.stateNode);default:return l.child.stateNode}},n.injectIntoDevTools=function(l){if(l={bundleType:l.bundleType,version:l.version,rendererPackageName:l.rendererPackageName,rendererConfig:l.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:d.ReactCurrentDispatcher,findHostInstanceByFiber:Ih,findFiberByHostInstance:l.findFiberByHostInstance||Bf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")l=!1;else{var u=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(u.isDisabled||!u.supportsFiber)l=!0;else{try{Li=u.inject(l),rr=u}catch{}l=!!u.checkDCE}}return l},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(l,u,p,x){if(!Vn)throw Error(c(363));l=oi(l,u);var S=ae(l,p,x).disconnect;return{disconnect:function(){S()}}},n.registerMutableSourceForHydration=function(l,u){var p=u._getVersion;p=p(u._source),l.mutableSourceEagerHydrationData==null?l.mutableSourceEagerHydrationData=[u,p]:l.mutableSourceEagerHydrationData.push(u,p)},n.runWithPriority=function(l,u){var p=dt;try{return dt=l,u()}finally{dt=p}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(l,u,p,x){var S=u.current,b=zt(),j=cn(S);return p=Ga(p),u.context===null?u.context=p:u.pendingContext=p,u=yi(b,j),u.payload={element:l},x=x===void 0?null:x,x!==null&&(u.callback=x),l=vi(S,u,j),l!==null&&(Fn(l,S,j,b),ml(l,S,j)),j},n}),Ip}var xy;function Ak(){return xy||(xy=1,bp.exports=Ok()),bp.exports}var Mk=Ak();const jk=Jl(Mk);var Lk=Object.defineProperty,Nk=(t,e,n)=>e in t?Lk(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ud=(t,e,n)=>(Nk(t,typeof e!="symbol"?e+"":e,n),n);function Vl(t){return t.endsWith("info.json")?t:t.endsWith("/")?`${t}info.json`:`${t}/info.json`}var zk="http://library.stanford.edu/iiif/image-api/compliance.html#level0",J0="http://library.stanford.edu/iiif/image-api/compliance.html#level1",ex="http://library.stanford.edu/iiif/image-api/compliance.html#level2",Fk="http://library.stanford.edu/iiif/image-api/conformance.html#level0",tx="http://library.stanford.edu/iiif/image-api/conformance.html#level1",nx="http://library.stanford.edu/iiif/image-api/conformance.html#level2",Dk="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level0",rx="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level1",ix="http://library.stanford.edu/iiif/image-api/1.1/compliance.html#level2",Bk="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level0",sx="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level1",ox="http://library.stanford.edu/iiif/image-api/1.1/conformance.html#level2",$k="http://iiif.io/api/image/1/level0.json",Uk="http://iiif.io/api/image/1/profiles/level0.json",lx="http://iiif.io/api/image/1/level1.json",ax="http://iiif.io/api/image/1/profiles/level1.json",ux="http://iiif.io/api/image/1/level2.json",cx="http://iiif.io/api/image/1/profiles/level2.json",Wk="http://iiif.io/api/image/2/level0.json",Hk="http://iiif.io/api/image/2/profiles/level0.json",fx="http://iiif.io/api/image/2/level1.json",dx="http://iiif.io/api/image/2/profiles/level1.json",hx="http://iiif.io/api/image/2/level2.json",px="http://iiif.io/api/image/2/profiles/level2.json",Vk="level0",gx="level1",mx="level2",qk="http://iiif.io/api/image/2/level0",yx="http://iiif.io/api/image/2/level1",vx="http://iiif.io/api/image/2/level2",Qk="https://iiif.io/api/image/1.1/compliance/#level0",xx="https://iiif.io/api/image/1.1/compliance/#level1",wx="https://iiif.io/api/image/1.1/compliance/#level2",Sx=[vx,ex,nx,ix,ox,ux,cx,hx,px,mx,wx],Px=[...Sx,yx,J0,tx,rx,sx,lx,ax,fx,dx,gx,xx],Xk=[qk,yx,vx,zk,J0,ex,Fk,tx,nx,Dk,rx,ix,Bk,sx,ox,$k,Uk,lx,ax,ux,cx,Wk,Hk,fx,dx,hx,px,Vk,gx,mx,Qk,xx,wx],Yk={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["sizeByWhListed"]},Kk={extraFormats:["jpg"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPx","regionSquare","sizeByWhListed","sizeByH","sizeByW","sizeByWh"]},Gk={extraFormats:["jpg","png"],extraQualities:["default"],extraFeatures:["baseUriRedirect","cors","jsonldMediaType","regionByPct","regionByPx","regionSquare","rotationBy90s","sizeByWhListed","sizeByConfinedWh","sizeByH","sizeByPct","sizeByW","sizeByWh"]};function Zk(t){return Sx.indexOf(t)!==-1?Gk:Px.indexOf(t)!==-1?Kk:Yk}function Jk(t){let e=t?Array.isArray(t.profile)?t.profile:[t.profile]:[],n={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let r of e)if(typeof r=="string"&&(r=Zk(r)),!!r){if(r.formats)for(let s of r.formats)n.extraFormats.indexOf(s)===-1&&n.extraFormats.push(s);if(r.qualities)for(let s of r.qualities)n.extraQualities.indexOf(s)===-1&&n.extraQualities.push(s);if(r.supports)for(let s of r.supports)n.extraFeatures.indexOf(s)===-1&&n.extraFeatures.push(s);if(r.maxHeight&&(n.maxHeight=r.maxHeight),r.maxWidth&&(n.maxWidth=r.maxWidth),r.maxArea&&(n.maxArea=r.maxArea),r.extraFormats)for(let s of r.extraFormats)n.extraFormats.indexOf(s)===-1&&n.extraFormats.push(s);if(r.extraQualities)for(let s of r.extraQualities)n.extraQualities.indexOf(s)===-1&&n.extraQualities.push(s);if(r.extraFeatures)for(let s of r.extraFeatures)n.extraFeatures.indexOf(s)===-1&&n.extraFeatures.push(s);r.maxHeight&&(n.maxHeight=r.maxHeight),r.maxWidth&&(n.maxWidth=r.maxWidth),r.maxArea&&(n.maxArea=r.maxArea)}if(t.extraFormats)for(let r of t.extraFormats)n.extraFormats.indexOf(r)===-1&&n.extraFormats.push(r);if(t.extraFeatures)for(let r of t.extraFeatures)n.extraFeatures.indexOf(r)===-1&&n.extraFeatures.push(r);if(t.extraQualities)for(let r of t.extraQualities)n.extraQualities.indexOf(r)===-1&&n.extraQualities.push(r);return n}function eC(t){try{if(t==="full")return{full:!0};if(t==="square")return{square:!0};let e=t.startsWith("pct:"),n=t.substr(e?4:0).split(",").map(r=>parseFloat(r));return{x:n[0],y:n[1],w:n[2],h:n[3],percent:e}}catch{throw new Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+t)}}function tC(t){let e={upscaled:!1,max:!1,confined:!1};if(t[0]==="^"&&(e.upscaled=!0,t=t.slice(1)),t==="max"||t==="full")return e.max=!0,e.serialiseAsFull=t==="full",e;if(t[0]==="!"&&(e.confined=!0,t=t.slice(1)),t[0]==="p")return e.percentScale=parseFloat(t.slice(4)),e;let n=t.split(",").map(r=>r.trim());return n.length&&typeof n[0]<"u"&&(n[0]!==""&&(e.width=parseInt(n[0],10)),typeof n[1]<"u"&&n[1]!==""?(e.height=parseInt(n[1],10),e.version=2):e.version=3),e}function nC(t){let e={angle:0};if(t[0]==="!"&&(e.mirror=!0,t=t.substr(1)),e.angle=parseFloat(t)%360,Number.isNaN(e.angle))throw new Error(`Invalid rotation ${t}`);return e}function rC(t,e=""){let n=t.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!n)throw new Error(`Invalid or unknown input ${t}`);let r=n[2],s=n[3],a=n[4];if(a[0]==="/"&&(a=a.substring(1)),e.length>0){if(e[0]==="/"&&(e=e.substring(1)),e!==a.substring(0,e.length))throw new Error(`Path does not start with prefix (path: ${a}, prefix: ${e})`);a=a.substring(e.length)}return{scheme:r,server:s,path:a,prefix:e}}function iC(t,e=""){let{path:n,scheme:r,server:s,prefix:a}=rC(t,e),c=(n||"").split("/").reverse(),[d,m,y,h,...v]=c,E=v.reverse().filter(Boolean).join("/");if(c.length===1||d==="")return{type:"base",scheme:r,server:s,prefix:a,identifier:E};if(d==="info.json"){let[,...P]=c;return{type:"info",scheme:r,server:s,prefix:a,identifier:P.reverse().filter(Boolean).join("/")}}let T=(d||"").split(".");if(typeof T[1]>"u"||typeof T[0]>"u"||typeof h>"u"||typeof y>"u"||typeof m>"u")throw new Error("Invalid image request");return{type:"image",scheme:r,server:s,prefix:a,identifier:E,originalPath:n,region:eC(h),size:tC(y),rotation:nC(m),quality:T[0],format:T[1]}}function sC(t){let e=iC(Vl(t.id));if(e.type!=="info")throw new Error("Invalid service URL");let n=Jk(t);return{identifier:e.identifier,originalPath:"",server:e.server,prefix:e.prefix,scheme:e.scheme,type:"image",quality:n.extraQualities.indexOf("default")===-1?n.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function oC(t,e,n){let r=n.length,s=[];for(let a=0;a<r;a++){let c=n[a];if(c){let d=c.width;s.push(t/d)}}return s}function lC(t,e,n){let r=n.length,s=[];for(let a=0;a<r;a++){let c=n[a];c&&s.push({width:Math.floor(t/c),height:Math.floor(e/c)})}return s}function rn(t){if(t["@id"])return t["@id"];if(t.id)return t.id}function Gd(t){if(!t||!t.profile||!rn(t))return!1;let e=Array.isArray(t.profile)?t.profile:[t.profile];for(let n of e)if(typeof n=="string"&&Xk.indexOf(n)!==-1)return!0;return!1}function aC(t){if(!Gd(t))return!1;let e=Array.isArray(t.profile)?t.profile:[t.profile];for(let n of e)if(typeof n=="string"){if(Px.indexOf(n)!==-1)return!0}else{let r=[...n.supports||[],...n.extraFeatures||[]];if(r.indexOf("regionByPx")!==-1&&(r.indexOf("sizeByW")!==-1||r.indexOf("sizeByWh")!==-1))return!0}return!1}function Cd(t,e){if(e&&e.profile){let n=e.profile;if(n){let r=Array.isArray(n)?n:[n];return r.includes(`level${t}`)||r.includes(`http://iiif.io/api/image/2/level${t}.json`)||r.includes(`http://iiif.io/api/image/1/level${t}.json`)||r.includes(`http://iiif.io/api/image/1/profiles/level${t}.json`)}}return!1}function rg(t){return Gd(t)?Cd(0,t)?0:Cd(1,t)?1:Cd(2,t)?2:null:null}function Ex(t){return(t["@context"]?Array.isArray(t["@context"])?t["@context"]:[t["@context"]]:[]).indexOf("http://iiif.io/api/image/3/context.json")!==-1}function uC(t){if(!aC(t))return[];let e=[],n=Array.isArray(t.profile)?t.profile:[t.profile],r=n.length;for(let s=0;s<r;s++){let a=n[s];if(a&&typeof a!="string"&&(a.maxHeight||a.maxWidth))return[{id:rn(t),type:"variable",minWidth:0,minHeight:0,maxHeight:a.maxHeight||a.maxWidth,maxWidth:a.maxWidth||a.maxHeight,level:rg(t),version:t["@context"]==="http://iiif.io/api/image/3/context.json"?3:2}]}if(t.tiles){let s=t.tiles.length;for(let a=0;a<s;a++){let c=t.tiles[a];c&&(c.height||c.width)&&e.push({id:rn(t),type:"variable",minHeight:0,minWidth:0,maxHeight:c.height||c.width,maxWidth:c.width,level:rg(t),version:Ex(t)?3:2})}}return e}function wy(t){let e=/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/,n=t.match(e);if(n&&n[4]&&n[5]){let r=n[1],s=parseInt(n[4],10),a=parseInt(n[5],10),c=n[7];if((r==="max"||r==="full")&&s&&a&&c)return{type:"fixed",id:t,height:a,width:s}}return{type:"unknown",id:t}}function cC(t){if(t["@type"])return t["@type"];if(t.type)return t.type}function fC(t){if(typeof t=="string")return wy(t);let e=cC(t);if(e!=="Image"&&e!=="sc:Image")return null;let n=t,r=rn(n);return r?r&&n.width&&n.height?{id:r,type:"fixed",width:n.width,height:n.height,unsafe:!0}:wy(r):null}function dC(t){return Gd(t)?(t&&t.sizes?t.sizes:[]).map(e=>({id:rn(t),type:"fixed-service",height:e.height,width:e.width,level:rg(t),version:Ex(t)?3:2})):[]}function Sy(t){let e=[],n=t.length;for(let r=0;r<n;r++){let s=t[r];if(!s)continue;let a=dC(s);a.length&&e.push(...a);let c=uC(s);c.length&&e.push(...c)}return e}function kx(t){let e=t.service?Array.isArray(t.service)?t.service:[t.service]:[],n=e.length,r=[];for(let s=0;s<n;s++)Gd(e[s])&&r.push(e[s]);return r}function hC(t,e=!0,n){let r=[],s=fC(t);if(s===null)return r;let a=t;if(r.push(s),e&&a&&a.width&&a.height){let c=[],d=kx(a);for(let m of d){let y={id:rn(m),width:a.width,height:a.height};if(n.canLoadSync(y)){let h=n.loadServiceSync(y);h&&(h.height||(h.height=a.height),h.width||(h.width=a.width),c.push(...Sy([h])))}}if(c.length)return r.push(...c),r}return a.service&&r.push(...Sy(a.service)),r}function pC({x:t=0,y:e=0,w:n,h:r,full:s,square:a,percent:c}){return"full"}function gC({max:t,percentScale:e,upscaled:n,confined:r,width:s,height:a,serialiseAsFull:c,version:d}){let m=[];return n&&m.push("^"),t?(m.push(c?"full":"max"),m.join("")):(r&&m.push("!"),e&&m.push(`pct:${e}`),s&&m.push(`${s}`),m.push(","),a&&d===3&&m.push(`${a}`),m.join(""))}function mC(t){return`${t.mirror?"!":""}${(t.angle||0)%360}`}function yC(t,e){let n=t.prefix.startsWith("/")?t.prefix.substr(1):t.prefix,r=`${t.scheme}://${t.server}/${n?`${n}/`:""}${t.identifier}`,{size:s}=t,{region:a,rotation:c,format:d,quality:m}=t;return[r,pC(a),gC(s),mC(c),`${m}.${d}`].filter(Boolean).join("/")}function Op(t,e,n){let r=sC({"@context":t.version===3?"http://iiif.io/api/image/3/context.json":"http://iiif.io/api/image/2/context.json",id:Vl(rn(t)),profile:t.level===null||typeof t.level>"u"?"level0":`level${t.level}`,type:t.version===3?"ImageService3":"ImageService2"});return r.size.max=!1,r.size.width=e,r.size.height=n,{id:yC(r),type:"fixed",width:e,height:n||t.height/(t.width||1)*e,unsafe:t.width>e}}function iu(t){let e=t.replace(/(https?:\/\/)?(www.)?/i,"");return e.indexOf("/")!==-1?e.split("/")[0]:e}function vC(t,e,n){let r=t.width?t.width:t.maxWidth;return n.height<=t.maxHeight&&n.width<=t.maxWidth&&n.height>=t.minHeight&&n.width>=t.minWidth&&(!e||Math.abs(n.width-r)<Math.abs(e.width-r))}function xC(t,e){let n=[],r=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},t),s=(h,v=0)=>r.explain?n.push(new Array(v).fill(0).map(E=>"    ").join("")+h().trim()):void 0,a=[],c=[],d=null;s(()=>`Using configuration: ${JSON.stringify(r,null,2)}`);let m=(h,v)=>{if(s(()=>"Swapping choice",3),vC(r,v,h)){if(r.preferFixedSize&&h.unsafe){s(()=>`We found an image that was marked as unsafe, but it was the best size. (${h.id})`,4),c.push(h);return}r.returnAllOptions&&v&&c.push(v),s(()=>`We found a new image that was the best size. (${h.id})`,4),d=h}else r.returnAllOptions&&c.push(h)};s(()=>`The input shows we have ${e.length} list(s) of candidates to choose from.`);let y=e.length;for(let h=0;h<y;h++){let v=e[h]();s(()=>`Candidate group ${h}: ${JSON.stringify(v,null,2)}`,1);let E=v.length;s(()=>`Checking candidate list number ${h} and found ${E} potential ways of creating image(s)`,1);for(let T=0;T<E;T++){let P=v[T];if(s(()=>`-> Checking candidate ${T}`,1),P.type==="unknown"&&r.atAnyCost&&(s(()=>`We've found an unknown image type, adding this to the "last resort" list`,2),a.push(P)),P.type==="fixed"&&(P.unsafe?(s(()=>`We've found an unsafe fixed image type, adding this to the "last resort" list`,2),a.push(P)):(s(()=>"We've found a fixed size image, checking if it matches the request",2),m(P,d))),P.type==="fixed-service")if(r.unsafeImageService){s(()=>"Checking for an image from the tile source, without calculating the right height and width (unsafeImageService)",2);let k=Op(P,r.width,r.height);m(k,d)}else{s(()=>"Checking for an image from the tile source 3",2);let k=Op(P,P.width,P.height);m(k,d)}if(P.type==="variable"&&P.maxWidth){let k=Op({id:P.id,width:P.maxWidth,height:P.maxWidth,level:P.level,version:P.version},P.maxWidth);m(k,d)}}if(d&&!r.returnAllOptions){if(d.unsafe||r.allowUnsafe)continue;s(()=>`We found a match in choice list number ${h}, no searching any more`);break}}return r.atAnyCost&&c.length===0?(s(()=>d?`We found an image! ${d.id} of type ${d.type}`:'We found no images, but "atAnyCost" is set, so returning that'),{best:d||a[0]||null,fallback:a.slice(1),log:n}):r.returnAllOptions?(s(()=>"Returning all options that we have found"),{best:(r.atAnyCost?d||c[0]||a[0]:d||c[0])||null,fallback:[...c,...a],log:n}):(s(()=>"Returning the best image that we found, and a fallback"),{best:d||c[0]||null,fallback:d?c:c.slice(1),log:n})}function wC(t,e,n){let r=t>e?t:e,s=n.length,a=[];for(let c=0;c<s;c++){let d=n[c];if(!d||d.scaleFactors.length===0)continue;let m=d.scaleFactors[0];if(!m)continue;let y=r/m,h=[m];for(;y>=d.width;)m=m*2,h.push(m),y=y/2;a.push({...d,scaleFactors:h})}return a}function SC(t,e){if(t.length!==e.length)return!1;if(t.length===0&&e.length===0)return!0;let n=t.length,r=!0;for(let a=0;a<n;a++){let c=t[a],d=e[a];if(c.width!==d.width||c.height!==d.height){r=!1;break}}if(r)return!0;let s=0;for(let a=0;a<n;a++)for(let c=0;c<n;c++)if(t[a].width===e[c].width&&t[a].height===e[c].height){s++;break}return s===n}function Py(t){return Cd(0,t)}var PC=class{constructor(t={}){ud(this,"config",{verificationsRequired:1,approximateServices:!1,enableFetching:!0,disableThrottling:!1}),ud(this,"fetchingCount",0),ud(this,"imageServices",{}),ud(this,"knownImageServers",{}),this.config=Object.assign(this.config,t)}setConfig(t){Object.assign(this.config,t)}sample(t,e,n=!0){let r=iu(rn(t)),s=Vl(rn(t)),a=this.knownImageServers[r];return this.imageServices[s]=Object.assign(t,{real:!0}),!a&&t.tiles&&!Py(t)?(this.knownImageServers[r]={verifications:0,malformed:!1,root:r,preLoaded:n,sampledId:rn(t),verified:!1,server:null,result:{context:t["@context"]||[],sampledProfile:t.profile,resourceServiceRatio:e&&t.height?e.height/t.height:1,sampledSizes:t.sizes||[],sizeRatios:oC(t.width,t.height,t.sizes||[]),sampledTiles:t.tiles||[]}},!0):this.verify(t)}preLoad(t,e=!0){this.knownImageServers[t.root]=t,e&&(this.knownImageServers[t.root].malformed=!1,this.knownImageServers[t.root].verifications=this.config.verificationsRequired)}predict(t,e=!1,n=!1){let r=t?.source,s=iu(rn(t)),a=this.knownImageServers[s],c=Vl(rn(t));return this.imageServices[c]?this.imageServices[c]||null:!this.config.approximateServices||!a||!a.result||!(r?.height||t.height)||!(r?.width||t.width)||!n&&(a.malformed||a.verifications<this.config.verificationsRequired)||Py(t.source)?null:(this.imageServices[c]||(this.imageServices[c]={"@context":a.result.context,"@id":rn(t),id:rn(t),protocol:"http://iiif.io/api/image",tiles:r?.tiles||wC(t.width,t.height,a.result.sampledTiles),sizes:r?.sizes||lC(Math.round(t.width/a.result.resourceServiceRatio),Math.round(t.height/a.result.resourceServiceRatio),a.result.sizeRatios),profile:r?.profile||a.result.sampledProfile,height:r?.height||t.height,width:r?.width||t.width,real:!1}),this.imageServices[c]||null)}async getThumbnailFromResource(t,e,n=!0,r=[]){let s=t?await this.getImageCandidates(t,n):[];return xC(e,[()=>r,()=>s])}async getImageCandidates(t,e=!0){let n=t;if(e&&n&&n.height&&n.width){let r=kx(n);for(let s of r){let a={id:rn(s),width:s.width?s.width:n.width,height:s.height?s.height:n.height,source:s};await this.loadService(a)}}return hC(t,e,this)}async verify(t){let e=this.predict(t,!1,!0),n=await this.fetchService(rn(t));if(!e)return!1;let r=e.height===n.height&&e.width===n.width&&e["@context"]===n["@context"]&&SC(e.sizes||[],n.sizes||[]);if(r){let s=iu(rn(t)),a=this.knownImageServers[s];a&&(a.verifications+=1,a.verifications>=this.config.verificationsRequired&&(a.verified=!0))}return r}canLoadSync(t){let e=typeof t=="string"?t:rn(t),n=Vl(e);if(this.imageServices[n])return!0;let r=this.knownImageServers[iu(e)];return!!(r&&!r.malformed&&r.verifications>=this.config.verificationsRequired)}async markAsMalformed(t){return this.knownImageServers[iu(rn(t))].malformed=!0,this.loadService(t,!0)}async fetchService(t,e=!1){let n=Vl(t),r=this.imageServices[n];if(r&&(!e||r.real))return r;if(!this.config.enableFetching)throw new Error("Fetching is not enabled");let s=await this.fetch(n).then(a=>a.json());return!s.id&&s["@id"]&&(s.id=s["@id"]),s.id!==t&&(s.id=t,s["@id"]&&(s["@id"]=t)),this.imageServices[n]=Object.assign(s,{real:!0}),this.imageServices[n]}async fetch(t,e){return fetch(t,e)}async loadService(t,e=!1){if(!this.config.disableThrottling){let s=!0;for(;s;)if(this.fetchingCount>=this.config.verificationsRequired)await new Promise(a=>setTimeout(a,500));else{s=!1;break}}let n=this.knownImageServers[iu(rn(t))];if(n&&!n.malformed&&!e){await n.result;let s=this.loadServiceSync(t);if(s)return s}this.fetchingCount++;let r=await this.fetchService(rn(t),e);return this.fetchingCount--,r.real&&this.sample(r,t),r}loadServiceSync(t){let e=Vl(rn(t));return this.imageServices[e]?this.imageServices[e]:this.config.approximateServices?this.predict(t):null}};new PC;const cd={},Uc={get(t){return t},setMetaValue([t,e,n],r){let s=Uc.getResourceMeta(t,e),a=s?s[n]:void 0,c=typeof r=="function"?r(a):r;cd[t]={...cd[t]||{},[e]:{...(cd[t]||{})[e]||{},[n]:c}}},getResourceMeta:((t,e)=>{let n=cd[t];if(n)return e?n[e]:n}),async load(t){let e=typeof t=="string"?t:t.id;return fetch(e).then(n=>n.json())},requestStatus(t){}};function EC(t){try{if(t==="full")return{full:!0};if(t==="square")return{square:!0};let e=t.startsWith("pct:"),n=t.substr(e?4:0).split(","),r=n.map(s=>parseFloat(s));return{x:r[0],y:r[1],w:r[2],h:r[3],percent:e}}catch{throw Error("Expected 'full', 'square' or 'x,y,w,h'. Found "+t)}}function kC(t){let e={upscaled:!1,max:!1,confined:!1};if(t[0]==="^"&&(e.upscaled=!0,t=t.slice(1)),t==="max"||t==="full")return e.max=!0,e.serialiseAsFull=t==="full",e;if(t[0]==="!"&&(e.confined=!0,t=t.slice(1)),t[0]==="p")return e.percentScale=parseFloat(t.slice(4)),e;let n=t.split(",").map(r=>r.trim());return n.length&&(n[0]!==""&&(e.width=parseInt(n[0],10)),n[1]!==""&&(e.height=parseInt(n[1],10))),e}function CC(t){let e={angle:0};if(t[0]==="!"&&(e.mirror=!0,t=t.substr(1)),e.angle=parseFloat(t)%360,Number.isNaN(e.angle))throw Error(`Invalid rotation ${t}`);return e}function TC(t,e=""){let n=t.match(/^(([a-zA-Z]+):\/\/([^/]+))?((.*)+)/);if(!n)throw Error(`Invalid or unknown input ${t}`);let r=n[2],s=n[3],a=n[4];if(a[0]==="/"&&(a=a.substring(1)),e.length>0){if(e[0]==="/"&&(e=e.substring(1)),e!==a.substring(0,e.length))throw Error(`Path does not start with prefix (path: ${a}, prefix: ${e})`);a=a.substring(e.length)}return{scheme:r,server:s,path:a,prefix:e}}function bC(t,e=""){let{path:n,scheme:r,server:s,prefix:a}=TC(t,e),c=n.split("/").reverse(),[d,m,y,h,...v]=c,E=v.reverse().filter(Boolean).join("/");if(c.length===1||d==="")return{type:"base",scheme:r,server:s,prefix:a,identifier:E};if(d==="info.json"){let[,...k]=c;return{type:"info",scheme:r,server:s,prefix:a,identifier:k.reverse().filter(Boolean).join("/")}}if(r===void 0||s===void 0||n===void 0||h===void 0||y===void 0||m===void 0||d===void 0)throw Error("Invalid image service URL");let[T="",P=""]=d.split(".");return{type:"image",scheme:r,server:s,prefix:a,identifier:E,originalPath:n,region:EC(h),size:kC(y),rotation:CC(m),quality:T,format:P}}function RC(t){return Vd.indexOf(t)!==-1?TS:Sg.indexOf(t)!==-1?CS:kS}function _C(t){let e=t?Array.isArray(t.profile)?t.profile:[t.profile]:[],n={extraQualities:[],extraFormats:[],extraFeatures:[]};for(let r of e)if(typeof r=="string"&&(r=RC(r)),!!r){if(r.formats)for(let s of r.formats)n.extraFormats.indexOf(s)===-1&&n.extraFormats.push(s);if(r.qualities)for(let s of r.qualities)n.extraQualities.indexOf(s)===-1&&n.extraQualities.push(s);if(r.supports)for(let s of r.supports)n.extraFeatures.indexOf(s)===-1&&n.extraFeatures.push(s);if(r.maxHeight&&(n.maxHeight=r.maxHeight),r.maxWidth&&(n.maxWidth=r.maxWidth),r.maxArea&&(n.maxArea=r.maxArea),r.extraFormats)for(let s of r.extraFormats)n.extraFormats.indexOf(s)===-1&&n.extraFormats.push(s);if(r.extraQualities)for(let s of r.extraQualities)n.extraQualities.indexOf(s)===-1&&n.extraQualities.push(s);if(r.extraFeatures)for(let s of r.extraFeatures)n.extraFeatures.indexOf(s)===-1&&n.extraFeatures.push(s);r.maxHeight&&(n.maxHeight=r.maxHeight),r.maxWidth&&(n.maxWidth=r.maxWidth),r.maxArea&&(n.maxArea=r.maxArea)}if(t.extraFormats)for(let r of t.extraFormats)n.extraFormats.indexOf(r)===-1&&n.extraFormats.push(r);if(t.extraFeatures)for(let r of t.extraFeatures)n.extraFeatures.indexOf(r)===-1&&n.extraFeatures.push(r);if(t.extraQualities)for(let r of t.extraQualities)n.extraQualities.indexOf(r)===-1&&n.extraQualities.push(r);return n}function Ey(t){let e=Array.isArray(t.profile)?t.profile:[t.profile];for(let n of e)if(typeof n=="string"&&o0.indexOf(n)!==-1)return!0;return!1}function Vt(t){if(t["@id"])return t["@id"];if(t.id)return t.id}function Zd(t){if(!t||!t.profile||!Vt(t))return!1;let e=Array.isArray(t.profile)?t.profile:[t.profile];for(let n of e)if(typeof n=="string"&&s0.indexOf(n)!==-1)return!0;return!1}function IC(t){if(!Zd(t))return!1;let e=Array.isArray(t.profile)?t.profile:[t.profile];for(let n of e)if(typeof n=="string"){if(Sg.indexOf(n)!==-1)return!0}else{let r=[...n.supports||[],...n.extraFeatures||[]];if(r.indexOf("regionByPx")!==-1&&(r.indexOf("sizeByW")!==-1||r.indexOf("sizeByWh")!==-1))return!0}return!1}function OC({x:t=0,y:e=0,w:n,h:r,full:s,square:a,percent:c}){return"full"}function AC({max:t,percentScale:e,upscaled:n,confined:r,width:s,height:a,serialiseAsFull:c,version:d}){let m=[];return n&&m.push("^"),t?(m.push(c?"full":"max"),m.join("")):(r&&m.push("!"),e&&m.push(`pct:${e}`),s&&m.push(`${s}`),m.push(","),a&&d===3&&m.push(`${a}`),m.join(""))}function MC(t){return`${t.mirror?"!":""}${(t.angle||0)%360}`}function jC(t,e){let n=t.prefix.startsWith("/")?t.prefix.substring(1):t.prefix,r=`${t.scheme}://${t.server}/${n?`${n}/`:""}${t.identifier}`,{size:s}=t,{region:a,rotation:c,format:d,quality:m}=t;return[r,OC(a),AC(s),MC(c),`${m}.${d}`].filter(Boolean).join("/")}function ql(t){return t.endsWith("info.json")?t:t.endsWith("/")?`${t}info.json`:`${t}/info.json`}function LC(t){let e=bC(ql(t.id));if(e.type!=="info")throw Error("Invalid service URL");let n=_C(t);return{identifier:e.identifier,originalPath:"",server:e.server,prefix:e.prefix,scheme:e.scheme,type:"image",quality:n.extraQualities.indexOf("default")===-1?n.extraQualities[0]:"default",region:{full:!0},size:{max:!0,upscaled:!1,confined:!1},format:"jpg",rotation:{angle:0}}}function NC(t,e,n){let r=n.length,s=[];for(let a=0;a<r;a++){let c=n[a];if(!c)continue;let d=c.width;s.push(t/d)}return s}function zC(t,e,n){let r=n.length,s=[];for(let a=0;a<r;a++){let c=n[a];c&&s.push({width:Math.floor(t/c),height:Math.floor(e/c)})}return s}function bc(t,e){if(e&&e.profile){let n=e.profile;if(n){let r=Array.isArray(n)?n:[n];if(r.includes(`level${t}`)||r.includes(`http://iiif.io/api/image/2/level${t}.json`)||r.includes(`http://iiif.io/api/image/1/level${t}.json`)||r.includes(`http://iiif.io/api/image/1/profiles/level${t}.json`))return!0;if(t===2){for(let s of r)if(Vd.includes(s))return!0}if(t===1){for(let s of r)if(Sg.includes(s))return!0}if(t===0){for(let s of r)if(o0.includes(s))return!0}}}return!1}function ig(t){return Zd(t)?bc(2,t)?2:bc(1,t)?1:bc(0,t)?0:null:null}function Og(t){let e=t.service?Array.isArray(t.service)?t.service:[t.service]:[],n=e.length,r=[];for(let s=0;s<n;s++)Zd(e[s])&&r.push(e[s]);return r}function FC(t){if(t["@type"])return t["@type"];if(t.type)return t.type}function su(t){let e=t.replace(/(https?:\/\/)?(www.)?/i,"");return e.indexOf("/")===-1?e:e.split("/")[0]}function DC(t,e,n){let r=t>e?t:e,s=n.length,a=[];for(let c=0;c<s;c++){let d=n[c];if(!d||d.scaleFactors.length===0)continue;let m=d.scaleFactors[0];if(!m)continue;let y=r/m,h=[m];for(;y>=d.width;)m*=2,h.push(m),y/=2;a.push({...d,scaleFactors:h})}return a}function Ap(t,e,n){let r=LC({"@context":t.version===3?"http://iiif.io/api/image/3/context.json":"http://iiif.io/api/image/2/context.json",id:ql(Vt(t)),profile:t.level===null||t.level===void 0?"level0":`level${t.level}`,type:t.version===3?"ImageService3":"ImageService2"});return r.size.max=!1,r.size.width=e,r.size.height=n,{id:jC(r),type:"fixed",width:e,height:n||t.height/(t.width||1)*e,unsafe:t.width>e}}function BC(t,e,n){let r=t.width?t.width:t.maxWidth;return n.height<=t.maxHeight&&n.width<=t.maxWidth&&n.height>=t.minHeight&&n.width>=t.minWidth&&(!e||Math.abs(n.width-r)<Math.abs(e.width-r))}function $C(t,e){let n=[],r=Object.assign({unsafeImageService:!1,atAnyCost:!0,fallback:!0,minHeight:64,minWidth:64,maxHeight:1/0,maxWidth:1/0,returnAllOptions:!1,preferFixedSize:!1,allowUnsafe:!1,explain:!1,height:0,width:0},t),s=(h,v=0)=>r.explain?n.push(Array(v).fill(0).map(E=>"    ").join("")+h().trim()):void 0,a=[],c=[],d=null;s(()=>`Using configuration: ${JSON.stringify(r,null,2)}`);let m=(h,v)=>{if(s(()=>"Swapping choice",3),BC(r,v,h)){if(r.preferFixedSize&&h.unsafe){s(()=>`We found an image that was marked as unsafe, but it was the best size. (${h.id})`,4),c.push(h);return}r.returnAllOptions&&v&&c.push(v),s(()=>`We found a new image that was the best size. (${h.id})`,4),d=h}else r.returnAllOptions&&c.push(h)};s(()=>`The input shows we have ${e.length} list(s) of candidates to choose from.`);let y=e.length;for(let h=0;h<y;h++){let v=e[h]();s(()=>`Candidate group ${h}: ${JSON.stringify(v,null,2)}`,1);let E=v.length;s(()=>`Checking candidate list number ${h} and found ${E} potential ways of creating image(s)`,1);for(let T=0;T<E;T++){let P=v[T];if(s(()=>`-> Checking candidate ${T}`,1),P.type==="unknown"&&r.atAnyCost&&(s(()=>`We've found an unknown image type, adding this to the "last resort" list`,2),a.push(P)),P.type==="fixed"&&(P.unsafe?(s(()=>`We've found an unsafe fixed image type, adding this to the "last resort" list`,2),a.push(P)):(s(()=>"We've found a fixed size image, checking if it matches the request",2),m(P,d))),P.type==="fixed-service")if(r.unsafeImageService){s(()=>"Checking for an image from the tile source, without calculating the right height and width (unsafeImageService)",2);let k=Ap(P,r.width,r.height);m(k,d)}else{s(()=>"Checking for an image from the tile source 3",2);let k=Ap(P,P.width,P.height);m(k,d)}if(P.type==="variable"&&P.maxWidth){let k=Ap({id:P.id,type:"fixed-service",width:P.maxWidth,height:P.maxWidth,level:P.level,version:P.version},P.maxWidth);m(k,d)}}if(d&&!r.returnAllOptions){if(d.unsafe||r.allowUnsafe)continue;s(()=>`We found a match in choice list number ${h}, no searching any more`);break}}return r.atAnyCost&&c.length===0?(s(()=>d?`We found an image! ${d.id} of type ${d.type}`:'We found no images, but "atAnyCost" is set, so returning that'),{best:d||a[0]||null,fallback:a.slice(1),log:n}):r.returnAllOptions?(s(()=>"Returning all options that we have found"),{best:(r.atAnyCost?d||c[0]||a[0]:d||c[0])||null,fallback:[...c,...a],log:n}):(s(()=>"Returning the best image that we found, and a fallback"),{best:d||c[0]||null,fallback:d?c:c.slice(1),log:n})}function Cx(t){return(t["@context"]?Array.isArray(t["@context"])?t["@context"]:[t["@context"]]:[]).indexOf("http://iiif.io/api/image/3/context.json")!==-1}function UC(t){return Zd(t)?(t&&t.sizes?t.sizes:[]).map(e=>({id:Vt(t),type:"fixed-service",height:e.height,width:e.width,level:ig(t),version:Cx(t)?3:2})):[]}function WC(t){if(!IC(t))return[];let e=[],n=Array.isArray(t.profile)?t.profile:[t.profile],r=n.length;for(let s=0;s<r;s++){let a=n[s];if(a&&typeof a!="string"&&(a.maxHeight||a.maxWidth))return[{id:Vt(t),type:"variable",minWidth:0,minHeight:0,maxHeight:a.maxHeight||a.maxWidth,maxWidth:a.maxWidth||a.maxHeight,level:ig(t),version:t["@context"]==="http://iiif.io/api/image/3/context.json"?3:2}]}if(t.tiles){let s=t.tiles.length;for(let a=0;a<s;a++){let c=t.tiles[a];c&&(c.height||c.width)&&e.push({id:Vt(t),type:"variable",minHeight:0,minWidth:0,maxHeight:c.height||c.width,maxWidth:c.width,level:ig(t),version:Cx(t)?3:2})}}return e}function ky(t){let e=[],n=t.length;for(let r=0;r<n;r++){let s=t[r];if(!s)continue;let a=UC(s);a.length&&e.push(...a);let c=WC(s);c.length&&e.push(...c)}return e}function Cy(t){let e=/^.*\/(full)\/(((\d+),(\d+)?)|max)\/(\d+)\/default\.(jpg|png|jpeg)$/,n=t.match(e);if(n&&n[4]&&n[5]){let r=n[1],s=parseInt(n[4],10),a=parseInt(n[5],10),c=n[7];if((r==="max"||r==="full")&&s&&a&&c)return{type:"fixed",id:t,height:a,width:s}}return{type:"unknown",id:t}}function sg(t){if(typeof t=="string")return Cy(t);let e=FC(t);if(e!=="Image"&&e!=="sc:Image")return null;let n=t,r=Vt(n);return r?r&&n.width&&n.height?{id:r,type:"fixed",width:n.width,height:n.height,unsafe:!0}:Cy(r):null}function HC(t,e=!0,n){let r=[],s=sg(t);if(s===null)return r;let a=t;if(r.push(s),e&&a&&a.width&&a.height){let c=[],d=Og(a);for(let m of d){let y={id:Vt(m),width:a.width,height:a.height};if(n.canLoadSync(y)){let h=n.loadServiceSync(y);h&&(h.height||=a.height,h.width||=a.width,c.push(...ky([h])))}}if(c.length)return r.push(...c),r}return a.service&&r.push(...ky(a.service)),r}function VC(t,e){if(t.length!==e.length)return!1;if(t.length===0&&e.length===0)return!0;let n=t.length,r=!0;for(let a=0;a<n;a++){let c=t[a],d=e[a];if(c.width!==d.width||c.height!==d.height){r=!1;break}}if(r)return!0;let s=0;for(let a=0;a<n;a++)for(let c=0;c<n;c++)if(t[a].width===e[c].width&&t[a].height===e[c].height){s++;break}return s===n}var Ag=class{constructor(t={}){ur(this,"config",{verificationsRequired:1,approximateServices:!1,enableFetching:!0,disableThrottling:!1}),ur(this,"fetchingCount",0),ur(this,"imageServices",{}),ur(this,"knownImageServers",{}),this.config=Object.assign(this.config,t)}setConfig(t){Object.assign(this.config,t)}sample(t,e,n=!0){let r=su(Vt(t)),s=ql(Vt(t)),a=this.knownImageServers[r];return this.imageServices[s]=Object.assign(t,{real:!0}),!a&&t.tiles&&!Ey(t)?(this.knownImageServers[r]={verifications:0,malformed:!1,root:r,preLoaded:n,sampledId:Vt(t),verified:!1,server:null,result:{context:t["@context"]||[],sampledProfile:t.profile,resourceServiceRatio:e&&t.height?e.height/t.height:1,sampledSizes:t.sizes||[],sizeRatios:NC(t.width,t.height,t.sizes||[]),sampledTiles:t.tiles||[]}},!0):this.verify(t)}preLoad(t,e=!0){this.knownImageServers[t.root]=t,e&&(this.knownImageServers[t.root].malformed=!1,this.knownImageServers[t.root].verifications=this.config.verificationsRequired)}predict(t,e=!1,n=!1){let r=t?.source,s=su(Vt(t)),a=this.knownImageServers[s],c=ql(Vt(t));return this.imageServices[c]?this.imageServices[c]||null:!this.config.approximateServices||!a||!a.result||!(r?.height||t.height)||!(r?.width||t.width)||!n&&(a.malformed||a.verifications<this.config.verificationsRequired)||t.source&&Ey(t.source)?null:(this.imageServices[c]||(this.imageServices[c]={"@context":a.result.context,"@id":Vt(t),id:Vt(t),protocol:"http://iiif.io/api/image",tiles:r?.tiles||DC(t.width,t.height,a.result.sampledTiles),sizes:r?.sizes||zC(Math.round(t.width/a.result.resourceServiceRatio),Math.round(t.height/a.result.resourceServiceRatio),a.result.sizeRatios),profile:r?.profile||a.result.sampledProfile,height:r?.height||t.height,width:r?.width||t.width,real:!1}),this.imageServices[c]||null)}async getThumbnailFromResource(t,e,n=!0,r=[]){let s=t?await this.getImageCandidates(t,n):[];return $C(e,[()=>r,()=>s])}async getImageCandidates(t,e=!0){let n=t;if(e&&n&&n.height&&n.width){let r=Og(n);for(let s of r){let a={id:Vt(s),width:s.width?s.width:n.width,height:s.height?s.height:n.height,source:s};await this.loadService(a)}}return HC(t,e,this)}async verify(t){let e=this.predict(t,!1,!0),n=await this.fetchService(Vt(t));if(!e)return!1;let r=e.height===n.height&&e.width===n.width&&e["@context"]===n["@context"]&&VC(e.sizes||[],n.sizes||[]);if(r){let s=su(Vt(t)),a=this.knownImageServers[s];a&&(a.verifications+=1,a.verifications>=this.config.verificationsRequired&&(a.verified=!0))}return r}canLoadSync(t){let e=typeof t=="string"?t:Vt(t),n=ql(e);if(this.imageServices[n])return!0;let r=this.knownImageServers[su(e)];return!!(r&&!r.malformed&&r.verifications>=this.config.verificationsRequired)}async markAsMalformed(t){return this.knownImageServers[su(Vt(t))].malformed=!0,this.loadService(t,!0)}async fetchService(t,e=!1){let n=ql(t),r=this.imageServices[n];if(r&&(!e||r.real))return r;if(!this.config.enableFetching)throw Error("Fetching is not enabled");let s=await this.fetch(n).then(a=>a.json());return!s.id&&s["@id"]&&(s.id=s["@id"]),s.id!==t&&(s.id=t,s["@id"]&&=t),this.imageServices[n]=Object.assign(s,{real:!0}),this.imageServices[n]}async fetch(t,e){return fetch(t,e)}async loadService(t,e=!1){if(!this.config.disableThrottling){let s=!0;for(;s;)if(this.fetchingCount>=this.config.verificationsRequired)await new Promise(a=>setTimeout(a,500));else{s=!1;break}}let n=this.knownImageServers[su(Vt(t))];if(n&&!n.malformed&&!e){await n.result;let s=this.loadServiceSync(t);if(s)return s}this.fetchingCount++;let r=await this.fetchService(Vt(t),e);return this.fetchingCount--,r.real&&this.sample(r,t),r}loadServiceSync(t){let e=ql(Vt(t));return this.imageServices[e]?this.imageServices[e]:this.config.approximateServices?this.predict(t):null}};function qC(t={}){let e=t.events||bv(),n=t.loader||new Ag;return{store:Tv((s,a)=>({loaded:{},loadServiceSync:(c,d,m)=>{let y=c.id||c["@id"],h=a().loaded[y];if(h&&h.status==="done")return h.service;if(h&&h.status==="loading")return null;if(h&&h.status==="error")throw Error("Failed to load image service");let v={id:Vt(c),width:c.width||d?.width||0,height:c.height||d?.height||0,source:c},E=n.loadServiceSync(v);return E?(s(T=>({loaded:{...T.loaded,[y]:{status:"done",service:E,real:!0}}})),e.emit("image-service.loaded",{id:y,service:E})):m&&a().loadService(c,d).then(()=>{}),E},loadService:async(c,d)=>{let m=c.id||c["@id"],y=a().loaded[m];if(y&&y.status==="done")return y.service;if(y&&y.status==="loading")return new Promise((h,v)=>{let E=T=>{T.id===m&&(e.off("image-service.loaded",E),h(T.service||c))};e.on("image-service.loaded",E)});if(y&&y.status==="error"&&!d?.force)throw Error("Failed to load image service");e.emit("image-service.loading",{id:m});try{let h={id:Vt(c),width:c.width||0,height:c.height||0,source:c},v=await n.loadService(h,d?.force);return s(E=>({loaded:{...E.loaded,[m]:{status:"done",service:v,real:v.real}}})),e.emit("image-service.loaded",{id:m,service:v}),v}catch(h){throw e.emit("image-service.error",{id:m,error:h}),h}}})),events:e}}const QC=qC(),XC=new Ag;function YC(t=Uc,e={}){let n=e.imageServiceLoader||XC;async function r(s,a,c=!1,d=[],m){let y=()=>n.getThumbnailFromResource(void 0,a,c,d);if(!s)return await n.getThumbnailFromResource(void 0,a,c,d);if(typeof s=="string"){let E=sg(s);return E&&d.push(E),await n.getThumbnailFromResource(void 0,a,c,d)}let h=t.get(s,{skipSelfReturn:!1});if(typeof h=="string")return{best:sg(h),fallback:[],log:[]};if(!h)return await y();switch(await(async E=>{if(E&&E.thumbnail&&E.thumbnail.length){let T=t.get(E.thumbnail[0]),P=await n.getImageCandidates(T,c);P&&P.length&&d.push(...P)}})(h),h.type){case"Annotation":{let E=Array.isArray(h.body)?h.body:[h.body],T=t.get(E[0]);return m&&!T.width&&(T.width=m.width,T.height=m.height),await n.getThumbnailFromResource(T,a,c,d)}case"Canvas":{let E=h;return r(E.items[0],a,c,d,{width:E.width,height:E.height})}case"AnnotationPage":return r(h.items[0],a,c,d,m);case"Choice":{let E=h;return!E.items||E.items[0]?await y():r(E.items[0],a,c,d,m)}case"Collection":{let E=h,T=E.items[0];return T?r(T,a,c,d,m):await y()}case"Manifest":{let E=h,T=E.items[0];return T?r(T,a,c,d,m):await y()}case"SpecificResource":case"Image":case"Dataset":case"Sound":case"Text":case"TextualBody":case"Video":return m&&!h.width&&(h.width=m.width,h.height=m.height),n.getThumbnailFromResource(h,a,c,d)}return await y()}return{getBestThumbnailAtSize:r}}var KC=Object.defineProperty,GC=(t,e,n)=>e in t?KC(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,N=(t,e,n)=>(GC(t,typeof e!="symbol"?e+"":e,n),n),Jd=["onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onTouchCancel","onTouchEnd","onTouchMove","onTouchStart","onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut","onScroll","onWheel","onClick","onDragStart","onDragEnd","onDragEnter","onDragExit","onDrag","onDragOver","onContextMenu"];function ZC(){return Jd.reduce((t,e)=>(t[e]=[],t),{})}var hu=Jd.reduce((t,e)=>(t[e.slice(2).toLowerCase()]=e,t[e]=e,t),{}),JC="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",eh=(t=21)=>{let e="",n=crypto.getRandomValues(new Uint8Array(t));for(;t--;)e+=JC[n[t]&63];return e},os=class{constructor(){N(this,"__id"),N(this,"__revision",0),N(this,"__host"),N(this,"__onCreate"),N(this,"__parent"),N(this,"__owner",{value:void 0}),N(this,"__state",{}),N(this,"eventHandlers"),N(this,"scale",1),N(this,"layers",[]),N(this,"time",[]),N(this,"_crop"),N(this,"cropData"),N(this,"id"),N(this,"addEventListener",(t,e,n)=>{let r=hu[t];if(!this.eventHandlers[r])throw new Error(`Unknown event ${r}`);this.eventHandlers[r].indexOf(e)===-1&&this.eventHandlers[r].push(e)}),N(this,"removeEventListener",(t,e)=>{let n=hu[t];if(!this.eventHandlers[n]){console.warn(`Unknown event ${n}`);return}this.eventHandlers[n].indexOf(e)!==-1&&(this.eventHandlers[n]=this.eventHandlers[n].filter(r=>r!==e))}),this.id=this.__id=eh(),this.eventHandlers=ZC()}get crop(){return this._crop}set crop(t){this._crop=t}getObjectsAt(t){return[]}getAllPointsAt(t,e,n){return[]}getScheduledUpdates(t,e){return[]}dispatchEvent(t,e){let n=this.eventHandlers[t],r=n?n.length:0,s=!1;if(r)for(let a=0;a<r;a++)try{n[a](e),s=!0}catch(c){console.error(t,c)}return s}get x(){return this.points[1]}get y(){return this.points[2]}get width(){return this.points[3]-this.points[1]}get height(){return this.points[4]-this.points[2]}translate(t,e){ns(this.points,Tr(t,e))}atScale(t){ns(this.points,Lc(t,this.x,this.y)),this.scale*=t}transform(t){ns(this.points,t)}applyProps(t){this.__revision++}appendChild(t){}removeChild(t){}insertBefore(t,e){}hideInstance(){}},nl=class og extends os{constructor(e){if(super(),N(this,"type","spacial-content"),N(this,"id"),N(this,"uri"),N(this,"display"),N(this,"points"),N(this,"priority"),N(this,"style",{opacity:1}),!e)this.id="",this.uri="",this.display={x:0,y:0,scale:1,width:0,height:0,points:Ye(5)},this.points=Ye(5);else{let n=e.scale||1;this.id=e.id||e.uri,this.uri=e.uri,this.points=vt.singleBox(e.width,e.height,e.x,e.y),this.display={x:0,y:0,scale:n,width:e.width/n,height:e.height/n,points:vt.singleBox(e.width/n,e.height/n),rotation:e?.rotation}}}applyProps(e){let n=e.display?e.display.width:e.target.width,r=e.target.width/n;if(this.id=e.id||e.uri,this.uri=e.uri,this.points.set(vt.singleBox(e.target.width,e.target.height,e.target.x,e.target.y)),e.style&&typeof e.style.opacity<"u"&&(this.style.opacity=e.style.opacity),e.crop){this.cropData=e.crop;let s=vt.singleBox(e.crop.width,e.crop.height,e.crop.x,e.crop.y);ns(s,Tr(-e.crop.x,-e.crop.y)),this.crop?this.crop.set(s):this.crop=Ye(s)}e.display?(this.display.scale=r,this.display.width=e.display.width,this.display.height=e.display.height,this.display.rotation=e.display.rotation,this.display.points=vt.singleBox(e.display.width,e.display.height)):(this.display.scale=r,this.display.width=e.target.width/r,this.display.height=e.target.height/r,this.display.points=vt.singleBox(e.target.width/r,e.target.height/r))}getAllPointsAt(e,n,r){return[[this,this.crop||this.points,n]]}static fromSvg(e,n,r,s){return og.fromImage("data:image/svg+xml;base64,"+btoa(e),n,r,s)}static fromImage(e,n,r,s){let a=new og;return a.applyProps({uri:e,id:s,display:r,target:n}),a}getImageUrl(){return this.uri}},lg=class extends os{constructor(e){if(super(),N(this,"type","spacial-content"),N(this,"id"),N(this,"uri"),N(this,"display"),N(this,"points"),N(this,"getTexture"),this.getTexture=()=>({source:void 0,hash:-1}),!e)this.id="",this.uri="",this.display={x:0,y:0,scale:1,width:0,height:0,points:Ye(5)},this.points=Ye(5);else{let n=e.scale||1;this.id=e.id||e.uri,this.uri=e.uri,this.points=vt.singleBox(e.width,e.height),this.display={x:0,y:0,scale:n,width:e.width/n,height:e.height/n,points:n!==1?vt.singleBox(e.width/n,e.height/n):this.points}}}applyProps(e){let n=e.display?e.display.width:e.target.width,r=e.target.width/n;this.id=e.id,this.points.set(vt.singleBox(e.target.width,e.target.height)),this.display.scale=r,this.display.width=e.target.width/r,this.display.height=e.target.height/r,this.getTexture=e.getTexture,this.display.points=r!==1?vt.singleBox(e.target.width/r,e.target.height/r):this.points}getAllPointsAt(e,n,r){return[[this,this.points,n]]}};function eT(t,e,n=1){let r=e.length;if(r===0)throw new Error("No resources passed in.");let s=0,a=1/0;for(let c=0;c<r&&!(!e[c]||!e[c].display);c++){let d=ag(e[c].display.scale,t/(n||1));d<a&&(a=d,s=c)}return s}function ag(t,e){return Math.abs(t-e)}function Od(t,e){let n=ag(t.x,e.x),r=ag(t.y,e.y);return Math.sqrt(Math.pow(n,2)+Math.pow(r,2))}function tT(t){let e=t.length;return t.indexOf("/info.json")===e-10?t.slice(0,-10):t}function fd(t,e,n){return Math.min(Math.max(t,e),n)}var Nc=class Tx extends os{constructor(e){super(),N(this,"id"),N(this,"type","spacial-content"),N(this,"display"),N(this,"tileWidth"),N(this,"style",{opacity:1}),N(this,"points"),N(this,"service"),N(this,"format","jpg"),N(this,"crop2"),N(this,"version3"),N(this,"tileUrl"),this.tileUrl=tT(e.url),this.id=e.id||`${this.tileUrl}--${e.scaleFactor}`,this.points=e.displayPoints?e.displayPoints:Qs(e.points,tl(e.scaleFactor)),this.tileWidth=e.tileWidth,this.version3=e.version3,this.display={x:0,y:0,width:e.width/e.scaleFactor,height:e.height/e.scaleFactor,points:e.points,scale:e.scaleFactor},e.format&&(this.format=e.format)}applyProps(e){if(e.style&&typeof e.style.opacity<"u"&&(this.style.opacity=e.style.opacity),e.service!==this.service&&(this.service=e.service),e.format?this.format=e.format:this.format="jpg",typeof e.version3<"u"&&(this.version3=e.version3),e.crop){this.cropData=e.crop;let n=Ye([...this.points]),r=n.length/5,s=e.crop.x||0,a=e.crop.y||0,c=e.crop.x+e.crop.width,d=e.crop.y+e.crop.height;for(let m=0;m<r;m++){let y=m*5;n[y+1]<c&&n[y+3]>s&&n[y+2]<d&&n[y+4]>a?(n[y+1]=fd(n[y+1],s,c),n[y+3]=fd(n[y+3],s,c),n[y+2]=fd(n[y+2],a,d),n[y+4]=fd(n[y+4],a,d)):n[y]=0}ns(n,Tr(-e.crop.x,-e.crop.y)),this.crop?this.crop.set(n):this.crop=n}}static fromTile(e,n,r,s,a,c,d,m){r.height=r.height?r.height:r.width;let y=d?Math.floor(n.width/s):Math.ceil(n.width/s),h=d?Math.floor(n.height/s):Math.ceil(n.height/s),v=Math.ceil(y/r.width),E=Math.ceil(h/r.height),T=vt.grid(v,E),P=vt.grid(v,E),k=a?a["@context"]?Array.isArray(a["@context"])?a["@context"]:[a["@context"]]:[]:[],R=typeof m<"u"?m:k.indexOf("http://iiif.io/api/image/3/context.json")!==-1;for(let M=0;M<E;M++)for(let L=0;L<v;L++){let $=L*r.width,F=M*r.height;P.addPoints($*s,F*s,L===v-1?n.width:($+r.width)*s,M===E-1?n.height:(F+r.height)*s),T.addPoints($,F,L===v-1?y:$+r.width,M===E-1?h:F+r.height)}let _=new Tx({url:e,scaleFactor:s,points:T.build(),displayPoints:P.build(),width:n.width,height:n.height,tileWidth:r.width,format:c,version3:R});return _.applyProps({service:a}),_}getImageUrl(e){let n=this.points.slice(e*5,e*5+5),r=n[3]-n[1],s=n[4]-n[2],a=Math.ceil(r/this.display.scale),c=Math.ceil(s/this.display.scale),d=`${a>this.tileWidth?this.tileWidth:a},`;return this.version3&&(d+=`${c>this.tileWidth?this.tileWidth:c}`),`${this.tileUrl}/${n[1]},${n[2]},${r},${s}/${d}/0/default.${this.format||"jpg"}`}getAllPointsAt(e,n,r){let s=jc(this.crop||this.points,e);return[[this,s,n]]}transform(e){ns(this.points,e)}getScheduledUpdates(e,n){return[]}},nT=class extends os{constructor(){super(...arguments),N(this,"type","spacial-content")}getAllPointsAt(e,n,r){return[[this,this.points,n]]}},rT=class extends nT{constructor(e){super(),N(this,"id"),N(this,"display"),N(this,"points"),N(this,"images",[]),N(this,"allImages",[]),N(this,"scaleFactors",[]),N(this,"aggregateBuffer",Ye(9)),N(this,"lazyLoader"),N(this,"isFullyLoaded",!1),N(this,"maxScaleFactor",0),N(this,"renderOptions"),N(this,"_scheduleSortByScales",!1),N(this,"_sortByScales",()=>{this._scheduleSortByScales=!1,this.allImages.sort((r,s)=>s.display.width-r.display.width),this.images=[];let n=.1;for(let r of this.allImages)if(!(r.display.width<this.renderOptions.minSize&&r.display.height<this.renderOptions.minSize&&!r.priority||r instanceof nl&&(r.display.width>this.renderOptions.maxImageSize||r.display.height>this.renderOptions.maxImageSize)&&!r.priority)){if(Math.abs(r.display.scale-n)<.25||r.priority){let s=this.images.pop();s&&(s instanceof nl||s.priority)?(r.priority&&this.images.push(r),this.images.push(s)):r&&this.images.push(r)}else r&&this.images.push(r);n=r.display.scale}this.images.length===0&&(this.images=[...this.allImages]),this.scaleFactors=this.images.map(r=>r.display.scale),this.maxScaleFactor=Math.max(...this.scaleFactors)}),N(this,"loadFullResource",async()=>{if(!this.isFullyLoaded&&this.lazyLoader){this.isFullyLoaded=!0;let n=await this.lazyLoader();this.addImages(n)}}),N(this,"fallback",[this.loadFullResource]),this.id=e.id,this.points=vt.singleBox(e.width,e.height),this.lazyLoader=e.loadFullImages,e.loadFullImages||(this.isFullyLoaded=!0),this.display={x:0,y:0,points:vt.singleBox(e.width,e.height),height:e.height,width:e.width,scale:1},this.renderOptions={renderSmallestFallback:!0,renderLayers:3,minSize:255,maxImageSize:2048,quality:1.5,...e.renderOptions||{}},this.addImages(e.images)}applyProps(e){typeof e.renderSmallestFallback<"u"&&e.renderSmallestFallback!==this.renderOptions.renderSmallestFallback&&(this.renderOptions.renderSmallestFallback=e.renderSmallestFallback),typeof e.renderLayers<"u"&&e.renderLayers!==this.renderOptions.renderLayers&&(this.renderOptions.renderLayers=e.renderLayers),typeof e.minSize<"u"&&e.minSize!==this.renderOptions.minSize&&(this.renderOptions.minSize=e.minSize),typeof e.maxImageSize<"u"&&e.maxImageSize!==this.renderOptions.maxImageSize&&(this.renderOptions.maxImageSize=e.maxImageSize),typeof e.quality<"u"&&e.quality!==this.renderOptions.quality&&(this.renderOptions.quality=e.quality)}appendChild(e){this.addImages([e])}removeChild(e){this.images.indexOf(e)!==-1&&(this.images=this.images.filter(n=>n!==e),this.sortByScales())}insertBefore(e,n){this.addImages([e])}hideInstance(){}addImages(e){for(let n of e)n.__parent=this,n.__owner=this.__owner;this.allImages.push(...e.filter(Boolean)),this.sortByScales()}sortByScales(){this._scheduleSortByScales=!0}getScheduledUpdates(e,n){return this._scheduleSortByScales?[this._sortByScales]:this.isFullyLoaded?[]:n>1/this.maxScaleFactor?this.fallback:[]}getAllPointsAt(e,n,r){if(this.images.length===0)return[];let s=eT(1/(r||1)/(window.devicePixelRatio||1),this.images,this.renderOptions.quality),a=this.images.length,c=n?qs(n,Tr(this.x,this.y)):Tr(this.x,this.y);if(s!==this.images.length-1&&this.images[s+1]){let d=[];for(let h=a-1;h>=s;h--)d.push(h);let m=d[0];this.renderOptions.renderLayers&&(d=d.slice(-Math.min(d.length,this.renderOptions.renderLayers))),this.renderOptions.renderSmallestFallback&&d.indexOf(m)===-1&&d.unshift(m);let y=[];for(let h=0;h<d.length;h++)y.push(...this.images[d[h]].getAllPointsAt(e,c,r));return y}return this.images[s].getAllPointsAt(e,c,r)}};function dd(t,e,n,r,s){let a=Math.PI/180*s,c=Math.cos(a),d=Math.sin(a),m=c*(n-t)+d*(r-e)+t,y=c*(r-e)-d*(n-t)+e;return[m,y]}var Mg=class bx extends os{constructor(e,n){super(),N(this,"id"),N(this,"type","world-object"),N(this,"scale"),N(this,"layers"),N(this,"points"),N(this,"worldPoints"),N(this,"intersectionBuffer",Ye(5)),N(this,"aggregateBuffer",Ye(9)),N(this,"invertedBuffer",Ye(9)),N(this,"rotation",0),N(this,"filteredPointsBuffer"),N(this,"_updatedList",[]),N(this,"geometry");let{x:r=0,y:s=0}=n||{};e?(this.id=e.id||"",this.scale=1,this.layers=e.layers,this.points=Ye([1,r,s,r+e.width,s+e.height]),this.worldPoints=Ye([1,r,s,r+e.width,s+e.height]),this.filteredPointsBuffer=Ye(e.layers.length*5)):(this.id="",this.scale=1,this.layers=[],this.points=Ye(5),this.worldPoints=Ye(5),this.filteredPointsBuffer=Ye(5))}static createWithProps(e){let n=new bx;return n.applyProps(e),n}applyProps(e){let n=e.x||0,r=e.y||0;this.id=e.id;let s=typeof e.scale<"u"?e.scale:this.scale;this.points[0]=1,this.points[1]=n,this.points[2]=r,this.points[3]=n+e.width,this.points[4]=r+e.height,this.rotation=e.rotation||0,this.worldPoints[3]=this.worldPoints[1]+e.width,this.worldPoints[4]=this.worldPoints[2]+e.height,e.scale&&e.scale!==1&&this.atScale(s),this.scale=s}appendChild(e){e.points[0]===0&&e.points.set(this.points),e.__owner.value=this,this.addLayers([e])}removeChild(e){this.layers=this.layers.filter(n=>n!==e),this.filteredPointsBuffer=Ye(this.layers.length*5)}insertBefore(e,n){let r=this.layers.indexOf(n);if(r===-1||this.layers.indexOf(e)!==-1)return;let s=this.layers.slice(0,r),a=this.layers.slice(r);this.layers=[...s,e,...a]}hideInstance(){console.warn("hideInstance: not yet implemented")}getObjectsAt(e,n){if(this.rotation&&(e=this.applyRotation(e)),jc(this.points,e,this.filteredPointsBuffer)[0]===0)return[];let r=this.layers.length,s=[];for(let a=0;a<r;a++){let c=this.layers[a];if(n&&c.isShape){let d=Qs(c.points,Tr(this.x,this.y));if(!c.intersects([e[1]-d[1],e[2]-d[2]]))continue}if(jc(Qs(c.points,Tr(this.x,this.y)),e,this.filteredPointsBuffer)[0]!==0&&s.push(c),n){let d=c;s.push(...d.getObjectsAt(e,n))}}return s}applyRotation(e){if(this.rotation){let n={x:e[1],y:e[2]},r={x:e[1],y:e[4]},s={x:e[3],y:e[2]},a={x:e[3],y:e[4]},c=this.points[1]+(this.points[3]-this.points[1])/2,d=this.points[2]+(this.points[4]-this.points[2])/2,[m,y]=dd(c,d,n.x,n.y,this.rotation),[h,v]=dd(c,d,r.x,r.y,this.rotation),[E,T]=dd(c,d,s.x,s.y,this.rotation),[P,k]=dd(c,d,a.x,a.y,this.rotation),R=Math.min(m,h,E,P),_=Math.max(m,h,E,P),M=Math.min(y,v,T,k),L=Math.max(y,v,T,k);return Ye([e[0],R,M,_,L])}return e}getAllPointsAt(e,n,r){let s=qs(Tr(this.x,this.y),tl(this.scale),this.aggregateBuffer);this.rotation&&(e=this.applyRotation(e));let a=fk(e,this.points,this.intersectionBuffer),c=this.layers.length,d=[],m=Qs(a,qs(tl(1/this.scale),Tr(-this.x,-this.y),this.invertedBuffer)),y=n?qs(n,s,this.aggregateBuffer):s,h=r*this.scale;for(let v=0;v<c;v++)d.push(...this.layers[v].getAllPointsAt(m,y,h));return d}addLayers(e){let n=[];for(let r of e)this.layers.indexOf(r)===-1&&(n.push(r),r.points.length===5&&(r.points[1]<this.worldPoints[1]/this.scale||r.points[2]<this.worldPoints[2]/this.scale||r.points[3]>this.worldPoints[3]/this.scale||r.points[4]>this.worldPoints[4]/this.scale)&&(r.crop=r.crop||Ye([1,Math.max(this.worldPoints[1]/this.scale,r.points[1]),Math.max(this.worldPoints[2]/this.scale,r.points[2]),Math.min(this.worldPoints[3]/this.scale,r.points[3]),Math.min(this.worldPoints[4]/this.scale,r.points[4])])));this.layers=this.layers.concat(n),this.filteredPointsBuffer=Ye(this.layers.length*5)}getScheduledUpdates(e,n){let r=this.layers.length;this._updatedList=[];let s=n*this.scale;for(let a=0;a<r;a++){let c=this.layers[a].getScheduledUpdates(e,s);c&&this._updatedList.push(...c)}return this._updatedList}},th=class Rx extends os{constructor(e=0,n=0,r=100,s="left-to-right"){super(),N(this,"id","world"),N(this,"_width"),N(this,"_height"),N(this,"aspectRatio"),N(this,"viewingDirection"),N(this,"aggregateBuffer",Ye(9)),N(this,"isDirty",!1),N(this,"zones",[]),N(this,"filteredPointsBuffer"),N(this,"selectedZone"),N(this,"triggerQueue",[]),N(this,"activatedEvents",[]),N(this,"_updatedList",[]),N(this,"translationBuffer",Ye(9)),N(this,"needsRecalculate",!0),N(this,"emptyPaintables",[]),N(this,"renderOrder",[]),N(this,"points"),N(this,"objects",[]),N(this,"subscriptions",[]),N(this,"_propagateEventTargets",[]),N(this,"_alreadyFlushed",[]),this._width=e,this._height=n,this.aspectRatio=Number.isNaN(e/n)?1:e/n,this.viewingDirection=s,this.points=Ye(r*5),this.filteredPointsBuffer=Ye(r*5)}get x(){return 0}get y(){return 0}get width(){return this._width}get height(){return this._height}static withProps(e){let n=new Rx;return n.applyProps(e),n}applyProps(e){typeof e.width<"u"&&typeof e.height<"u"&&(e.width!==this._width||e.height!==this._height)&&this.resize(e.width,e.height),e.viewingDirection!==this.viewingDirection&&(this.viewingDirection=e.viewingDirection,this.triggerRepaint())}propagateTouchEvent(e,n,r){let s=[];for(let a of r)if(a.x&&a.y){let c=vt.singleBox(1,1,a.x,a.y);s.push(this.getObjectsAt(c,!0).reverse())}return s.map(a=>this.propagateEvent(e,n,a,{bubbles:!0,cancelable:!0}))}propagatePointerEvent(e,n,r,s,a={}){let c=vt.singleBox(1,1,r,s),d=this.getObjectsAt(c,!0).reverse();return this.propagateEvent(e,n,d,a)}propagateEvent(e,n,r,{bubbles:s=!1,cancelable:a=!1}={}){n.atlasTarget=this,this._propagateEventTargets.length=1,this._propagateEventTargets[0]=this;let c=!1;n.stopPropagation=()=>{c=!0};let d=r.length;for(let h=d-1;h>=0;h--){this._propagateEventTargets.unshift(r[h][0]);let v=r[h][1].length;if(v)for(let E=0;E<v;E++)this._propagateEventTargets.unshift(r[h][1][E])}let m=this._propagateEventTargets.length,y=!1;for(let h=0;h<m&&(n.atlasTarget=this._propagateEventTargets[h],n.atlasWorld=this,y=this._propagateEventTargets[h].dispatchEvent(e,n)||y,!c);h++);return y&&this.triggerRepaint(),this._propagateEventTargets}appendChild(e){let n=this.appendWorldObject(e);this.renderOrder.push(n/5)}removeChild(e){let n=this.objects.indexOf(e);if(n===-1){for(let r of this.objects)if(r&&r.id===e.id){this.removeChild(r);return}return}this.objects[n]=null,this.renderOrder=this.renderOrder.filter(r=>r!==n),this.points[n*5]=0,this.triggerRepaint(),this.needsRecalculate=!0}insertBefore(e,n){let r=this.objects.indexOf(n);if(r===-1)return;let s=this.appendWorldObject(e);this.renderOrder.splice(r-1,0,s/5)}hideInstance(){}asWorldObject(){return null}addZone(e){this.zones.push(e)}selectZone(e){if(typeof e=="string"){let n=this.zones.length;for(let r=0;r<n;r++)if(this.zones[r].id===e){this.selectedZone=r,this.trigger("zone-changed");return}}else this.zones[e]&&(this.selectedZone=e,this.trigger("zone-changed"))}deselectZone(){this.selectedZone=void 0}getActiveZone(){if(this.selectedZone)return this.zones[this.selectedZone]}hasActiveZone(){return typeof this.selectedZone<"u"}checkResizeInternalBuffer(){if(dk(this.points)===this.objects.length){let e=this.points,n=Ye(this.points.length*2);n.set(e,0),this.points=n}}appendWorldObject(e){this.checkResizeInternalBuffer();let n=this.objects.length*5,r=e.points;return e.points=this.points.subarray(this.objects.length*5,this.objects.length*5+5),e.points[1]=r[1],e.points[2]=r[2],e.points[3]=r[3],e.points[4]=r[4],this.objects.push(e),this.filteredPointsBuffer=Ye(this.objects.length*5),this.needsRecalculate=!0,this.triggerRepaint(),n}recalculateWorldSize(){let e=!1;if(this.needsRecalculate){let n=new Int32Array(this.objects.length),r=new Int32Array(this.objects.length),s=this.renderOrder.length;for(let d=0;d<s;d++){let m=this.renderOrder[d];this.objects[m]&&(n[d]=this.points[m*5+3],r[d]=this.points[m*5+4])}let a=Math.max(...n);a!==this._width&&(this._width=a,e=!0);let c=Math.max(...r);c!==this._height&&(this._height=c,e=!0),e&&this.trigger("recalculate-world-size",{width:a,height:c}),this.needsRecalculate=!1}return e}addObjectAt(e,n){n.width&&!n.height?n.height=n.width/e.width*e.height:n.height&&!n.width&&(n.width=n.height/e.height*e.width),(!n||!n.width||!n.height)&&(n.width=e.width,n.height=e.height);let{width:r,x:s,y:a}=n,c=r/e.width;this.checkResizeInternalBuffer(),this.points.set(vt.singleBox(e.width,e.height,0,0),this.objects.length*5);let d=new Mg(e);return d.points=this.points.subarray(this.objects.length*5,this.objects.length*5+5),this.objects.push(d),this.scaleWorldObject(this.objects.length-1,c),this.translateWorldObject(this.objects.length-1,s,a),this.filteredPointsBuffer=Ye(this.points.length*2),this.triggerRepaint(),this.needsRecalculate=!0,d}scaleWorldObject(e,n){ns(this.points.subarray(e*5,e*5+5),Lc(n,this.points[e*5+1],this.points[e*5+2]));let r=this.objects[e];r&&(r.atScale(n),this.triggerRepaint())}translateWorldObject(e,n,r){ns(this.points.subarray(e*5,e*5+5),Tr(n,r));let s=this.objects[e];s&&(s.translate(n,r),this.triggerRepaint())}resize(e,n){return this._width=e,this._height=n,this.aspectRatio=e/n,this.triggerRepaint(),this}getObjects(){return this.objects}getPoints(){return this.points}getPointsFromViewer(e,n){let r=vt.singleBox(e.width,e.height,e.x,e.y);return this.getPointsAt(r,n,e.scale)}addLayoutSubscriber(e){return this.subscriptions.push(e),()=>{this.subscriptions.splice(this.subscriptions.indexOf(e),1)}}getScheduledUpdates(e,n){let r=jc(this.points,e,this.filteredPointsBuffer),s=this.objects.length;this._updatedList=[];for(let a=0;a<s;a++)if(r[a*5]!==0){if(!this.objects[a])continue;this._updatedList.push(...this.objects[a].getScheduledUpdates(e,n))}return this._updatedList}getObjectsAt(e,n=!1){let r=this.getActiveZone(),s=jc(this.points,e,this.filteredPointsBuffer),a=this.renderOrder.length,c=[];for(let d=0;d<a;d++){let m=this.renderOrder[d];if(s[m*5]!==0){let y=this.objects[m];if(!y||r&&r.objects.indexOf(y)===-1)continue;if(y.type!=="world-object"){c.push([y,[y]]);continue}n?c.push([y,y.getObjectsAt(e,n)]):c.push([y,this.emptyPaintables])}}return c}getPointsAt(e,n,r=1){let s=this.getObjectsAt(e),a=qs(tl(r),Tr(-e[1],-e[2]),this.translationBuffer),c=n?qs(n,a,this.aggregateBuffer):a,d=s.length,m=[];for(let y=0;y<d;y++)s[y]&&m.push(...s[y][0].getAllPointsAt(e,c,r));return m}flushSubscriptions(){if(this.triggerQueue.length){this._alreadyFlushed=[];let e=this.triggerQueue.length;for(let n=0;n<e;n++){if(this._alreadyFlushed.indexOf(this.triggerQueue[n][0])!==-1)continue;typeof this.triggerQueue[n][1]>"u"&&this._alreadyFlushed.push(this.triggerQueue[n][0]);let r=this.subscriptions.length;for(let s=0;s<r;s++)this.subscriptions[s].apply(null,this.triggerQueue[n])}this.triggerQueue=[]}}trigger(e,n){this.triggerQueue.push([e,n])}triggerEventActivation(){this.trigger("event-activation")}triggerRepaint(){this.trigger("repaint")}gotoRegion(e){this.trigger("goto-region",e)}goHome(e=!1){this.trigger("go-home",{immediate:e})}zoomTo(e,n,r){this.trigger("zoom-to",{point:n,factor:e,stream:r})}zoomIn(e){this.trigger("zoom-to",{point:e,factor:.5})}zoomOut(e){this.trigger("zoom-to",{point:e,factor:2})}constraintBounds(e){this.trigger("constrain-bounds",{immediate:e})}},hd=/([0-9]+(px|em)\s+)+(solid)\s+(.*)/g,pd={},iT=["backgroundColor","opacity","boxShadow","borderColor","borderWidth","borderStyle","outlineColor","outlineWidth","outlineOffset","outlineStyle"],Rc=class extends os{constructor(){super(),N(this,"id"),N(this,"type","spacial-content"),N(this,"points"),N(this,"hoverEvents",!1),N(this,"activeEvents",!1),N(this,"display",{x:0,y:0,scale:1,width:-1,height:-1,points:Ye(5)}),N(this,"_parsed",{border:{id:null,match:[]},outline:{id:null,match:[]}}),N(this,"hovering"),N(this,"pressing"),N(this,"props",{}),N(this,"addHover",()=>{this.hovering=!0,this.__revision++}),N(this,"removeHover",()=>{this.hovering=!1,this.pressing=!1,this.__revision++}),N(this,"addPress",()=>{this.pressing=!0,this.__revision++}),N(this,"removePress",()=>{this.pressing=!1,this.__revision++}),this.id=eh(12),this.points=Ye(5)}getAllPointsAt(t,e){return[[this,this.points,e]]}applyProps(t={}){let e=!1;if(t.interactive!==this.props.interactive&&(e=!0,this.props.interactive=t.interactive),t.style){let n=t.border||t.style.border;if(n!==this._parsed.border.id)if(!n)this._parsed.border.id=null,this._parsed.border.match=[];else{let r=pd[n]||hd.exec(n)||hd.exec(n);r&&(this._parsed.border.id=n,this._parsed.border.match=pd[n]=r)}if(this._parsed.border.id&&(t.style.borderWidth=this._parsed.border.match[1],t.style.borderStyle="solid",t.style.borderColor=this._parsed.border.match[4]),t.style.outline!==this._parsed.outline.id)if(!t.style.outline)this._parsed.outline.id=null,this._parsed.outline.match=[];else{let r=pd[t.style.outline]||hd.exec(t.style.outline)||hd.exec(t.style.outline);r&&(this._parsed.outline.id=t.style.outline,this._parsed.outline.match=pd[t.style.outline]=r)}this._parsed.outline.id&&(t.style.outlineWidth=this._parsed.outline.match[1],t.style.outlineStyle="solid",t.style.outlineColor=this._parsed.outline.match[4]),this.props.style=t.style,t.backgroundColor&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=t.backgroundColor,e=!0),t.style.background&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=t.style.background,e=!0);for(let r of iT)if(this.props.style[r]!==t.style[r]){e=!0;break}t.style[":hover"]!==this.props.hoverStyles&&(this.props.hoverStyles=t.style[":hover"],this.hoverEvents||(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),e=!0),t.style[":active"]!==this.props.pressStyles&&(this.props.pressStyles=t.style[":active"],this.activeEvents||(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),e=!0)}t.href!==this.props.href&&(this.props.href=t.href,e=!0),t.hrefTarget!==this.props.hrefTarget&&(this.props.hrefTarget=t.hrefTarget,e=!0),t.title!==this.props.title&&(this.props.title=t.title,e=!0),t.className!==this.props.className&&(this.props.className=t.className,t.className&&!this.hoverEvents&&(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),t.className&&!this.activeEvents&&(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),e=!0),t.relativeSize!==this.props.relativeSize&&(this.props.relativeSize=t.relativeSize,e=!0),t.relativeStyle!==this.props.relativeStyle&&(this.props.relativeStyle=t.relativeStyle,e=!0),t.html!==this.props.html&&(this.props.html=t.html,e=!0),t.target&&(t.target.width!==this.display.width||t.target.height!==this.display.height||t.target.x!==this.points[1]||t.target.y!==this.points[2])&&(e=!0,this.points=vt.singleBox(t.target.width,t.target.height,t.target.x,t.target.y),this.display.points=vt.singleBox(t.target.width,t.target.height,t.target.x,t.target.y),this.display.width=t.target.width,this.display.height=t.target.height),e&&this.__revision++}},Td=class extends os{constructor(){super(),N(this,"type","spacial-content"),N(this,"id"),N(this,"points"),N(this,"color","#000"),N(this,"backgroundColor"),N(this,"hovering"),N(this,"pressing"),N(this,"text",""),N(this,"display",{x:0,y:0,scale:1,width:100,height:100,points:Ye(5)}),N(this,"className"),N(this,"html"),N(this,"interactive",!1),N(this,"props",{font:"18px Arial, sans-serif",lineHeight:1,textAlign:"left",verticalAlign:"top",paddingX:0,paddingY:0,fitParent:!1,lineBreak:"auto",strokeText:!1,sizeToFill:!1,maxFontSizeToFill:void 0,allowNewLine:!0,justifyLines:!1,renderHDPI:!1,textDecoration:"none",interactive:!1,relativeSize:!1}),this.id="",this.points=Ye(5)}getAllPointsAt(t,e){return[[this,this.points,e]]}applyProps({id:t,target:e,text:n,color:r,backgroundColor:s,fontSize:a=18,interactive:c,fontFamily:d="Arial, sans-serif",...m}){m.font=`${a}px ${d}`,this.interactive=c||!1,typeof n<"u"&&(this.text=n||""),r&&(this.color=r),s&&(this.backgroundColor=s),t&&(this.id=t),e&&(this.points=vt.singleBox(e.width,e.height,e.x,e.y),this.display.points=this.points,this.display.width=e.width,this.display.height=e.height),this.props={...this.props,...m},this.__revision++}},mc=Math.pow,sT=Math.cos,oT=Math.PI,Yo={easeInOutQuad:function(t){return t<.5?2*t*t:1-mc(-2*t+2,2)/2},easeOutQuart:function(t){return 1-mc(1-t,4)},easeInOutSine:function(t){return-(sT(oT*t)-1)/2},easeOutExpo:function(t){return t===1?1:1-mc(2,-10*t)},easeInOutExpo:function(t){return t===0?0:t===1?1:t<.5?mc(2,20*t-10)/2:(2-mc(2,-20*t+10))/2}},lT=class{constructor(t){N(this,"runtime"),N(this,"pendingTransition"),N(this,"lastZoomTo",null),N(this,"isConstraining",!1),N(this,"lastGoToRegion",null),this.runtime=t,this.pendingTransition={from:Ye(5),to:Ye(5),elapsed_time:0,done:!0,total_time:0,timingFunction:Yo.easeInOutQuad,constrain:!1}}hasPending(){return!this.pendingTransition.done}getPendingTransition(){return this.pendingTransition}getPendingFrom(){return this.pendingTransition.from}customTransition(t){t(this.pendingTransition)}stopTransition(){this.pendingTransition.from=Ye(this.runtime.target),this.pendingTransition.to=Ye(this.runtime.target),this.pendingTransition.done=!0,this.pendingTransition.elapsed_time=0,this.pendingTransition.total_time=0}runTransition(t,e){if(!this.pendingTransition.done){let n=this.pendingTransition,r=n.total_time===0?0:(n.elapsed_time+e)/n.total_time,s=n.total_time===0?1:r===0?0:n.timingFunction(r);t[1]=n.from[1]+(n.to[1]-n.from[1])*s,t[2]=n.from[2]+(n.to[2]-n.from[2])*s,t[3]=n.from[3]+(n.to[3]-n.from[3])*s,t[4]=n.from[4]+(n.to[4]-n.from[4])*s,this.pendingTransition.elapsed_time+=e,this.pendingTransition.elapsed_time>=this.pendingTransition.total_time&&(this.pendingTransition.done=!0,this.pendingTransition.callback?.(),this.pendingTransition.constrain&&this.constrainBounds({transition:{duration:this.pendingTransition.total_time===0?0:500,easing:Yo.easeOutExpo}}))}}resumeTransition(){this.lastZoomTo&&this.zoomTo(this.lastZoomTo.factor,this.lastZoomTo.options),this.isConstraining&&this.constrainBounds(),this.lastGoToRegion&&this.goToRegion(this.lastGoToRegion.target,this.lastGoToRegion.options)}zoomTo(t,e={}){let{origin:n,stream:r=!1,transition:s}=e;this.lastZoomTo={factor:t,options:e};let a=this.runtime.getZoomedPosition(t,{origin:n}),c=Math.abs(1-t);this.applyTransition(a,s,{duration:2e3*c,easing:Yo.easeOutExpo,constrain:!0,callback:()=>{this.lastZoomTo=null}},{stream:!1})}constrainBounds({transition:t,panPadding:e=0}={}){this.isConstraining=!0;let[n,r]=this.runtime.constrainBounds(this.runtime.target,{panPadding:e});n&&(this.applyTransition(r,t,{duration:500,easing:Yo.easeOutQuart,constrain:!1,callback:()=>{this.isConstraining=!1}}),this.runtime.updateNextFrame())}applyTransition(t,e,n,{stream:r}={}){this.pendingTransition.from=Ye(this.runtime.target),this.pendingTransition.to=t,r||(this.pendingTransition.elapsed_time=0),this.pendingTransition.done=!1,this.pendingTransition.total_time=typeof e?.duration<"u"?e.duration:typeof n?.duration<"u"?n.duration:1e3,this.pendingTransition.constrain=typeof e?.constrain<"u"?e.constrain:typeof n?.constrain<"u"?n.constrain:!1,this.pendingTransition.timingFunction=e?.easing||n?.easing||Yo.easeInOutSine}goToRegion(t,{transition:e}={}){this.lastGoToRegion={target:t,options:{transition:e}};let n=this.runtime.clampRegion(t);this.applyTransition(vt.singleBox(n.width,n.height,n.x,n.y),e,{duration:1e3,easing:Yo.easeOutExpo,constrain:!0,callback:()=>{this.lastGoToRegion=null}}),this.runtime.updateNextFrame()}},nh=class{constructor(e,n,r,s=[],a){N(this,"id",eh()),N(this,"ready",!1),N(this,"renderer"),N(this,"world"),N(this,"target"),N(this,"homePosition"),N(this,"manualHomePosition"),N(this,"manualFocalPosition"),N(this,"focalPosition"),N(this,"transitionManager"),N(this,"aggregate"),N(this,"transformBuffer",Ye(500)),N(this,"lastTarget",Ye(5)),N(this,"zoomBuffer",Ye(5)),N(this,"logNextRender",!1),N(this,"pendingUpdate",!0),N(this,"isCommitting",!1),N(this,"firstRender",!0),N(this,"lastTime"),N(this,"stopId"),N(this,"mode","explore"),N(this,"controllers",[]),N(this,"controllersRunning",!1),N(this,"controllerStopFunctions",[]),N(this,"maxScaleFactor",1),N(this,"_viewerToWorld",{x:0,y:0}),N(this,"_lastGoodScale",1),N(this,"hooks",{useFrame:[],useBeforeFrame:[],useAfterPaint:[],useAfterFrame:[]}),N(this,"fpsLimit"),N(this,"options"),N(this,"hookOptions",{filters:{grayscale:0,contrast:0,brightness:0,saturate:0,sepia:0,invert:0,hueRotate:0,blur:0}}),N(this,"_viewport",{x:0,y:0,width:0,height:0}),N(this,"setViewport",c=>{let d=Math.round(typeof c.x>"u"?this.target[1]:c.x),m=Math.round(typeof c.y>"u"?this.target[2]:c.y);c.width?this.target[3]=d+c.width:this.target[3]=this.target[3]-this.target[1]+d,c.height?this.target[4]=m+c.height:this.target[4]=this.target[4]-this.target[2]+m,Math.abs(this.target[1]-d)>.01&&(this.target[1]=d),Math.abs(this.target[2]-m)>.01&&(this.target[2]=m),this.pendingUpdate=!0}),N(this,"render",c=>{let d=c-this.lastTime;if(this.isCommitting||this.fpsLimit&&d<1e3/this.fpsLimit){this.stopId=window.requestAnimationFrame(this.render);return}this.lastTime=c,this.world.flushSubscriptions(),this.stopId=window.requestAnimationFrame(this.render),this.hook("useFrame",d);let m=this.pendingUpdate,y=this.renderer.pendingUpdate();if(this.transitionManager.hasPending()&&(this.transitionManager.runTransition(this.target,d),this.pendingUpdate=!0,this.updateControllerPosition()),!this.firstRender&&!m&&!y&&this.target[0]===this.lastTarget[0]&&this.target[1]===this.lastTarget[1]&&this.target[2]===this.lastTarget[2]&&this.target[3]===this.lastTarget[3]&&this.target[4]===this.lastTarget[4])return;this.hook("useBeforeFrame",d),this.renderer.beforeFrame(this.world,d,this.target,this.hookOptions);let h=this.getScaleFactor(),v=this.renderer.getPointsAt(this.world,this.target,this.aggregate,h),E=v.length;for(let k=0;k<E;k++){let R=v[k][0],_=v[k][1],M=v[k][2],L=M?Qs(_,M,this.transformBuffer):_;this.renderer.prepareLayer(R,R.__parent&&M?Qs(R.__parent.crop||R.__parent.points,M):L);let $=L.length/5;for(let F=0;F<$;F++){let H=F*5;L[H]!==0&&(this.renderer.paint(R,F,L[H+1],L[H+2],L[H+3]-L[H+1],L[H+4]-L[H+2]),this.hook("useAfterPaint",R))}this.renderer.finishLayer(R,_)}this.renderer.afterFrame(this.world,d,this.target,this.hookOptions),this.hook("useAfterFrame",d),this.lastTarget[0]=this.target[0],this.lastTarget[1]=this.target[1],this.lastTarget[2]=this.target[2],this.lastTarget[3]=this.target[3],this.lastTarget[4]=this.target[4],this.firstRender=!1,this.pendingUpdate=!1,this.logNextRender=!1,this.renderer.isReady()&&(this.ready=!0,this.world.trigger("ready")),this.world.flushSubscriptions();let T=this.world.getScheduledUpdates(this.target,h),P=T.length;if(P>0)for(let k=0;k<P;k++){let R=T[P-k-1]();R?R.then(()=>{this.pendingUpdate=!0}):this.pendingUpdate=!0}}),this.renderer=e,this.world=n,this.options={maxOverZoom:1,maxUnderZoom:1,visibilityRatio:1.5,...a||{}},this.target=vt.projection(r),this.manualHomePosition=!1,this.pendingUpdate=!0,this.homePosition=vt.projection(this.world),this.manualFocalPosition=!1,this.focalPosition=this.target,this.updateFocalPosition(),this.transitionManager=new lT(this),this.aggregate=tl(1),this.world.addLayoutSubscriber(c=>{c==="repaint"&&(this.pendingUpdate=!0),c==="recalculate-world-size"&&(this.manualHomePosition||(this.setHomePosition(),this.goHome()),this.updateFocalPosition())}),this.lastTime=performance.now(),this.controllers=s,this.render(this.lastTime),this.startControllers()}get x(){return this.target[1]}set x(e){this.target[1]=e}get y(){return this.target[2]}set y(e){this.target[2]=e}get x2(){return this.target[3]}set x2(e){this.target[3]=e}get y2(){return this.target[4]}set y2(e){this.target[4]=e}get width(){return this.target[3]-this.target[1]}set width(e){this.target[3]=this.target[1]+e}get height(){return this.target[4]-this.target[2]}set height(e){this.target[4]=this.target[2]=e}setHomePosition(e){this.homePosition.set(vt.projection(e||this.world)),this.pendingUpdate=!0}startControllers(){if(!this.controllersRunning){for(let e of this.controllers)this.controllerStopFunctions.push(e.start(this));this.controllersRunning=!0}}stopControllers(){if(this.controllersRunning){for(let e of this.controllerStopFunctions)e();this.controllersRunning=!1,this.controllerStopFunctions=[]}}updateControllerPosition(){for(let e of this.controllers)e.updatePosition(this.x,this.y,this.width,this.height)}triggerResize(){this.renderer.triggerResize&&this.renderer.triggerResize(),this.pendingUpdate=!0}addController(e){this.controllers.push(e),this.controllersRunning&&e.start(this),this.pendingUpdate=!0}cover(){return this.goHome({cover:!0})}getRendererScreenPosition(){return this.renderer.getRendererScreenPosition()}updateRendererScreenPosition(){this.pendingUpdate=!0,this.renderer.resize()}setOptions(e){this.options={...this.options,...e}}goHome(e={}){if(this.world.width<=0||this.world.height<=0)return;let n=this.getScaleFactor(),r=e.position?{x:e.position[1],y:e.position[2],width:e.position[3]-e.position[1],height:e.position[4]-e.position[2]}:{x:this.homePosition[1],y:this.homePosition[2],width:this.homePosition[3]-this.homePosition[1],height:this.homePosition[4]-this.homePosition[2]},s=this.width*n,a=this.height*n,c=r.width/s,d=r.height/a,m=s/a;if(e.cover?c>d:c<d){let y=m*r.height,h=(y-r.width)/2;this.target[1]=Math.round(-h+r.x),this.target[2]=Math.round(r.y),this.target[3]=Math.round(y-h+r.x),this.target[4]=Math.round(r.height+r.y)}else{let y=r.width/m,h=(y-r.height)/2;this.target[1]=Math.round(r.x),this.target[2]=Math.round(r.y-h),this.target[3]=Math.round(r.x+r.width),this.target[4]=Math.round(r.y+y-h)}this.constrainBounds(this.target),this.updateControllerPosition()}resize(e,n,r,s){this.transitionManager.hasPending()&&this.transitionManager.stopTransition(),this.updateFocalPosition(e-n,r-s);let a=n/e,c=s/r;this.target[3]=this.target[1]+(this.target[3]-this.target[1])*a,this.target[4]=this.target[2]+(this.target[4]-this.target[2])*c,this.goHome({position:this.focalPosition}),this.renderer.resize(n,s),this.pendingUpdate=!0,this.transitionManager.resumeTransition()}updateFocalPosition(e,n){if(!this.manualFocalPosition){let r=this.width,s=this.height,a=Math.min(r,s),c=0,d=0,m=this.x+c,y=this.y+d;if(r<s){let h=this.height-this.width;this.focalPosition=vt.projection({x:m,y:y+h/2,width:a-c*2,height:a-d*2}),this.pendingUpdate=!0}else{let h=this.width-this.height;this.focalPosition=vt.projection({x:m+h/2,y,width:a-c*2,height:a-d*2}),this.pendingUpdate=!0}}}getViewport(){return this._viewport.x=this.target[1],this._viewport.y=this.target[2],this._viewport.width=this.target[3]-this.target[1],this._viewport.height=this.target[4]-this.target[2],this._viewport}constrainBounds(e,{panPadding:n=0,ref:r=!1}={}){let{minX:s,maxX:a,minY:c,maxY:d}=this.getBounds({target:e,padding:n}),m=!1,y=r?e:Ye(e),h=Math.round(e[3]-e[1]),v=Math.round(e[4]-e[2]);return s>e[1]&&(m=!0,y[1]=s,y[3]=s+h),c>e[2]&&(m=!0,y[2]=c,y[4]=c+v),a<e[1]&&(m=!0,y[1]=a,y[3]=a+h),d<e[2]&&(m=!0,y[2]=d,y[4]=d+v),[m,y]}getBounds(e){let n=e.target||this.target,r=e.padding,s=this.options.visibilityRatio,a=Math.abs(1-s);if(this.world.hasActiveZone()){let M=this.world.getActiveZone();if(M){let L=n[3]-n[1]<M.points[3]-M.points[1],$=n[4]-n[2]<M.points[4]-M.points[2];return{minX:L?M.points[1]-r:M.points[1]+(M.points[3]-M.points[1])/2-(n[3]-n[1])/2,maxX:$?M.points[2]-r:M.points[2]+(M.points[4]-M.points[2])/2-(n[4]-n[2])/2,minY:L?M.points[3]+r:M.points[1]+(M.points[3]-M.points[1])/2-(n[3]-n[1])/2,maxY:$?M.points[4]+r:M.points[2]+(M.points[4]-M.points[2])/2-(n[4]-n[2])/2}}}let c=n[3]-n[1],d=this.world.width,m=-c*a,y=d-c-m,h=n[4]-n[2],v=this.world.height,E=-h*a,T=v-h-E,P=Math.round(Math.max(m,y)),k=Math.round(Math.min(m,y)),R=Math.round(Math.max(E,T)),_=Math.round(Math.min(E,T));return{minX:k,maxX:P,minY:_,maxY:R}}getScaleFactor(e=!1){let n=this.renderer.getScale(this.target[3]-this.target[1],this.target[4]-this.target[2],e);return n===0?this._lastGoodScale:(this._lastGoodScale=n,n)}getZoomedPosition(e,{origin:n,fromPos:r}){let s=r?{width:r[3]-r[1],height:r[4]-r[2]}:void 0,a=s?this.renderer.getScale(s.width,s.height):this.getScaleFactor(),c=s?s.width:this.width,d=s?s.height:this.height,m=this.getRendererScreenPosition()?.width,y=this.world.width,h=m?m/y:1,v=this.options.maxUnderZoom,E=Math.max(h||1,this.options.maxOverZoom),T=1/e,P=a*T;if(T<1){let R=c*a,_=d*a,M=this.world.width/R,L=this.world.height/_;if(M>L){let $=this.world.width*P,F=~~(c*a)*v;$<F&&(e=this.world.width*a/(c*a*v))}else{let $=this.world.height*P,F=~~(d*a)*v;$<F&&(e=this.world.height*a/(d*a*v))}}else P>E&&(e=a/E);let k=Qs(this.target,Lc(e,n?n.x:this.target[1]+(this.target[3]-this.target[1])/2,n?n.y:this.target[2]+(this.target[4]-this.target[2])/2),this.zoomBuffer);return this.constrainBounds(k,{ref:!0,panPadding:100}),k}clampRegion({x:e,y:n,width:r,height:s,padding:a=0}){let c=this.width,d=this.height,m=r/c<s/d,y=e-a,h=n-a,v=r+a*2,E=s+a*2;if(m){let P=E/d*c;return{x:y-(P-v)/2,y:h,width:P,height:E}}let T=v/c*d;return{x:y,y:h-(T-E)/2,width:v,height:T}}viewerToWorld(e,n){let r=this.getScaleFactor();return this._viewerToWorld.x=this.target[1]+e/r,this._viewerToWorld.y=this.target[2]+n/r,this._viewerToWorld}worldToViewer(e,n,r,s){let a=vt.singleBox(r,s,e,n);return ns(a,qs(tl(this.getScaleFactor()),Tr(-this.target[1],-this.target[2]))),{x:a[1],y:a[2],width:a[3]-a[1],height:a[4]-a[2],strand:a}}setScale(e,n){ns(this.target,Lc(e,n?n.x:this.target[1]+(this.target[3]-this.target[1])/2,n?n.y:this.target[2]+(this.target[4]-this.target[2])/2)),this.pendingUpdate=!0}syncTo(e){let n=this.target;return this.target=e.target,this.pendingUpdate=!0,()=>{this.target=n}}stop(){return typeof this.stopId<"u"&&(window.cancelAnimationFrame(this.stopId),this.stopId=void 0),()=>{this.render(performance.now())}}reset(){this.renderer.reset()}selectZone(e){this.world.selectZone(e),this.pendingUpdate=!0}deselectZone(){this.world.deselectZone(),this.pendingUpdate=!0}hook(e,n){let r=this.hooks[e].length;if(r!==0)for(let s=0;s<r;s++)this.hooks[e][s](n)}registerHook(e,n){return this.hooks[e].push(n),()=>{this.hooks[e]=this.hooks[e].filter(r=>r!==n)}}updateNextFrame(){this.pendingUpdate=!0}},gd=/([0-9]+(px|em)\s+)+(solid)\s+(.*)/g,md={},aT=["backgroundColor","opacity","boxShadow","borderColor","borderWidth","borderStyle","outlineColor","outlineWidth","outlineOffset","outlineStyle"],_x=class extends os{constructor(){super(),N(this,"id"),N(this,"type","spacial-content"),N(this,"isShape",!0),N(this,"points"),N(this,"hoverEvents",!1),N(this,"activeEvents",!1),N(this,"display",{x:0,y:0,scale:1,width:-1,height:-1,points:Ye(5)}),N(this,"boundingBox",null),N(this,"_parsed",{border:{id:null,match:[]},outline:{id:null,match:[]}}),N(this,"hovering"),N(this,"pressing"),N(this,"props",{}),N(this,"shape",{type:"none"}),N(this,"addHover",()=>{this.hovering=!0,this.__revision++}),N(this,"removeHover",()=>{this.hovering=!1,this.pressing=!1,this.__revision++}),N(this,"addPress",()=>{this.pressing=!0,this.__revision++}),N(this,"removePress",()=>{this.pressing=!1,this.__revision++}),this.id=eh(12),this.points=Ye(5),this.shape={type:"none"}}updateBoundingBox(){if(this.shape.type==="none")return;let t=this.shape.points;if(this.shape.points.length>2){let e=Math.min(...t.map(a=>a[0])),n=Math.min(...t.map(a=>a[1])),r=Math.max(0,...t.map(a=>a[0])),s=Math.max(0,...t.map(a=>a[1]));this.boundingBox={x:e,y:n,width:r-e,height:s-n};return}this.boundingBox=null}intersects(t){if(!t||this.shape.type==="none")return!1;let[e,n]=t,r=this.shape.points,s=this.boundingBox;if(s||(this.updateBoundingBox(),s=this.boundingBox),!s||e<s.x||e>s.x+s.width||n<s.y||n>s.height+s.y)return!1;let a=!1;for(let c=0,d=r.length-1;c<r.length;d=c++)r[c][1]>n!=r[d][1]>n&&e<(r[d][0]-r[c][0])*(n-r[c][1])/(r[d][1]-r[c][1])+r[c][0]&&(a=!a);return a}getAllPointsAt(t,e){return t[3]-t[1]===1&&t[4]-t[2]===1?this.intersects([t[1],t[2]])?[[this,this.points,e]]:[]:[[this,this.points,e]]}applyProps(t={}){let e=!1;if(t.points)if(this.shape.type!=="polygon"||this.shape.points.length!==t.points.length)this.shape={type:"polygon",points:t.points,open:t.open},this.updateBoundingBox();else{let n=!1,r=t.points.length;for(let s=0;s<r;s++)if(t.points[s][0]!==this.shape.points[s][0]||t.points[s][1]!==this.shape.points[s][1]){n=!0;break}n&&(this.shape={type:"polygon",points:t.points,open:t.open},this.updateBoundingBox())}if(t.interactive!==this.props.interactive&&(e=!0,this.props.interactive=t.interactive),(t.open||t.open===!1)&&(e=!0,this.shape.open=t.open),t.style){let n=t.border||t.style.border;if(n!==this._parsed.border.id)if(!n)this._parsed.border.id=null,this._parsed.border.match=[];else{let r=md[n]||gd.exec(n)||gd.exec(n);r&&(this._parsed.border.id=n,this._parsed.border.match=md[n]=r)}if(this._parsed.border.id&&(t.style.borderWidth=this._parsed.border.match[1],t.style.borderStyle="solid",t.style.borderColor=this._parsed.border.match[4]),t.style.outline!==this._parsed.outline.id)if(!t.style.outline)this._parsed.outline.id=null,this._parsed.outline.match=[];else{let r=md[t.style.outline]||gd.exec(t.style.outline)||gd.exec(t.style.outline);r&&(this._parsed.outline.id=t.style.outline,this._parsed.outline.match=md[t.style.outline]=r)}this._parsed.outline.id&&(t.style.outlineWidth=this._parsed.outline.match[1],t.style.outlineStyle="solid",t.style.outlineColor=this._parsed.outline.match[4]),this.props.style=t.style,t.backgroundColor&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=t.backgroundColor,e=!0),t.style.background&&!this.props.style.backgroundColor&&(this.props.style.backgroundColor=t.style.background,e=!0);for(let r of aT)if(this.props.style[r]!==t.style[r]){e=!0;break}t.style[":hover"]!==this.props.hoverStyles&&(this.props.hoverStyles=t.style[":hover"],this.hoverEvents||(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),e=!0),t.style[":active"]!==this.props.pressStyles&&(this.props.pressStyles=t.style[":active"],this.activeEvents||(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),e=!0)}t.href!==this.props.href&&(this.props.href=t.href,e=!0),t.hrefTarget!==this.props.hrefTarget&&(this.props.hrefTarget=t.hrefTarget,e=!0),t.title!==this.props.title&&(this.props.title=t.title,e=!0),t.className!==this.props.className&&(this.props.className=t.className,t.className&&!this.hoverEvents&&(this.hoverEvents=!0,this.addEventListener("pointerenter",this.addHover),this.addEventListener("pointerleave",this.removeHover)),t.className&&!this.activeEvents&&(this.activeEvents=!0,this.addEventListener("mousedown",this.addPress),this.addEventListener("mouseup",this.removePress)),e=!0),t.relativeSize!==this.props.relativeSize&&(this.props.relativeSize=t.relativeSize,e=!0),t.relativeStyle!==this.props.relativeStyle&&(this.props.relativeStyle=t.relativeStyle,e=!0),t.html!==this.props.html&&(this.props.html=t.html,e=!0),t.target&&(t.target.width!==this.display.width||t.target.height!==this.display.height||t.target.x!==this.points[1]||t.target.y!==this.points[2])&&(e=!0,this.points=vt.singleBox(t.target.width,t.target.height,t.target.x,t.target.y),this.display.points=vt.singleBox(t.target.width,t.target.height,t.target.x,t.target.y),this.display.width=t.target.width,this.display.height=t.target.height),e&&this.__revision++}},Ty=/(-?[0-9]+(px|em)\s+|0\s+)(-?[0-9]+(px|em)\s+|0\s+)(-?[0-9]+(px|em)\s+|0\s+)?(-?[0-9]+(px|em)\s+|0\s+)?(.*)/g,by={},uT=typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes("firefox"),yd={},cT=class{constructor(t,e){N(this,"canvas"),N(this,"ctx"),N(this,"options"),N(this,"imagesPending",0),N(this,"imagesLoaded",0),N(this,"imageIdsLoaded",[]),N(this,"frameIsRendering",!1),N(this,"pendingDrawCall",!1),N(this,"firstMeaningfulPaint",!1),N(this,"parallelTasks",8),N(this,"frameTasks",0),N(this,"loadingQueueOrdered",!0),N(this,"loadingQueue",[]),N(this,"currentTask",Promise.resolve()),N(this,"tasksRunning",0),N(this,"stats"),N(this,"averageJobTime",64),N(this,"lastKnownScale",1),N(this,"visible",[]),N(this,"previousVisible",[]),N(this,"rendererPosition"),N(this,"dpi"),N(this,"drawCalls",[]),N(this,"lastPaintedObject"),N(this,"hostCache"),N(this,"invalidated",[]),N(this,"_worker",()=>{if(this.loadingQueue.length){let n=this.loadingQueue.pop();n&&(this.tasksRunning++,this.frameTasks++,this.currentTask=n.task().then(()=>{this.tasksRunning--}).catch(()=>{this.tasksRunning--}))}}),N(this,"_scheduled",0),N(this,"_doWork",()=>{this.loadingQueue.length===0&&this.tasksRunning===0&&this._scheduled&&(clearInterval(this._scheduled),this._scheduled=0);let n=this.parallelTasks||1;!this.firstMeaningfulPaint&&this.loadingQueue.length&&(n=this.loadingQueue.length);for(let r=0;r<=n;r++)this._worker()}),this.canvas=t,this.rendererPosition=t.getBoundingClientRect(),this.ctx=t.getContext("2d",{alpha:!0}),this.ctx.imageSmoothingEnabled=!0,this.options=e||{},this.canvas.style.transition="opacity .3s",this.dpi=e?.dpi||1,this.hostCache=e?.lruCache?new Kl({maxSize:1024*512*512,dispose:(n,r,s)=>{this.invalidated.push(r),n.width=0,n.height=0},sizeCalculation:(n,r)=>n.width*n.height}):{store:{},get(n){return this.store[n]},set(n,r){this.store[n]=r}}}getCanvasDims(){return{width:this.canvas.width/this.dpi,height:this.canvas.height/this.dpi}}resize(){this.rendererPosition=this.canvas.getBoundingClientRect()}isReady(){return this.firstMeaningfulPaint}afterFrame(t){if(this.clearTransform(),this.lastPaintedObject=void 0,this.frameIsRendering=!1,this.imagesPending=Math.max(0,this.imagesPending-this.imagesLoaded),this.imagesLoaded=0,this.loadingQueueOrdered||(this.loadingQueue=this.loadingQueue.sort((e,n)=>e.network&&e.scale===n.scale?n.distance-e.distance:e.scale<n.scale?-1:1),this.loadingQueueOrdered=!0),this.previousVisible=this.visible,this.pendingDrawCall=!!this.drawCalls.length,this.pendingDrawCall)for(let e=0;e<this.drawCalls.length;e++){let n=this.drawCalls.shift();n&&n()}this.doOffscreenWork(),this.options.debug&&this.stats&&this.stats.end()}doOffscreenWork(){this.frameTasks=0,this.loadingQueue.length&&(this._worker(),this.loadingQueue.length&&(this._scheduled||(this._scheduled=setInterval(this._doWork,0))))}getScale(t,e,n){if(Number.isNaN(t)||Number.isNaN(e))return this.lastKnownScale;let r=this.getCanvasDims(),s=r.width/t,a=r.height/e,c=(s<a?a:s)*(n&&this.dpi||1);return Number.isNaN(c)||(this.lastKnownScale=c),this.lastKnownScale}beforeFrame(t,e,n,r){this.options.debug&&this.stats&&this.stats.begin(),this.frameIsRendering=!0,this.visible=[],this.options.beforeFrame&&this.options.beforeFrame(e);let s=this.getCanvasDims();if(this.ctx.globalAlpha=1,this.ctx.fillStyle=this.canvas.dataset.background??"rgb(0, 0, 0)",this.ctx.fillRect(0,0,s.width,s.height),r.enableFilters&&(r.filters.brightness||r.filters.contrast||r.filters.grayscale||r.filters.invert||r.filters.sepia||r.filters.saturate||r.filters.hueRotate||r.filters.blur)){let a="";r.filters.brightness&&(a+=`brightness(${~~(100+r.filters.brightness*100)}%) `),r.filters.contrast&&(a+=`contrast(${~~(100+r.filters.contrast*100)}%) `),r.filters.grayscale&&(a+=`grayscale(${~~(r.filters.grayscale*100)}%) `),r.filters.invert&&(a+=`invert(${~~(r.filters.invert*100)}%) `),r.filters.sepia&&(a+=`sepia(${~~(r.filters.sepia*100)}%) `),r.filters.saturate&&(a+=`saturate(${~~(100+r.filters.saturate*100)}%) `),r.filters.hueRotate&&(a+=`hue-rotate(${r.filters.hueRotate}deg) `),r.filters.blur&&(a+=`blur(${r.filters.blur}px) `),this.ctx.filter=a}else this.ctx.filter="none"}applyTransform(t,e,n,r,s){let a=t.__owner.value;if(a&&a.rotation){this.ctx.save();let c=e+r/2,d=n+s/2;this.ctx.translate(c,d),this.ctx.rotate(a.rotation*Math.PI/180),this.ctx.translate(-c,-d),this.lastPaintedObject=a}}clearTransform(){this.lastPaintedObject&&(this.lastPaintedObject.rotation&&this.ctx.restore(),this.lastPaintedObject=void 0)}paint(t,e,n,r,s,a){let c=this.ctx.globalAlpha;if(t instanceof nl||t instanceof Nc){if(t.display.rotation){this.ctx.save();let y=n+s/2,h=r+a/2;t.crop&&(y-=t.crop[e*5+1],h-=t.crop[e*5+2]),this.ctx.translate(y,h),this.ctx.rotate(t.display.rotation*Math.PI/180),this.ctx.translate(-y,-h)}if(this.visible.push(t),typeof t.style&&t.style.opacity!=="undefined"){if(!t.style.opacity)return;this.ctx.globalAlpha=t.style.opacity}try{let y=t.__host.canvas,h=this.getCanvasDims();if((y.indices.indexOf(e)===-1||this.invalidated.indexOf(y.canvases[e])!==-1)&&this.schedulePaintToCanvas(y,t,e,Od({x:n+s/2,y:r+s/2},{x:h.width/2,y:h.height/2})),!this.firstMeaningfulPaint)return;let v=this.hostCache.get(y.canvases[e]);if(v)if(t.crop&&t.cropData){if(t.crop[e*5]){let E=[t.crop[e*5+1]/t.display.scale-t.display.points[e*5+1],t.crop[e*5+2]/t.display.scale-t.display.points[e*5+2],1+(t.crop[e*5+3]-t.crop[e*5+1])/t.display.scale,1+(t.crop[e*5+4]-t.crop[e*5+2])/t.display.scale];E[0]+=t.cropData.x/t.display.scale,E[1]+=t.cropData.y/t.display.scale;let T=t.x*this.lastKnownScale,P=t.y*this.lastKnownScale,k=[n+T,r+P,s,a];k[0]+=T,k[1]+=P,this.ctx.drawImage(v,E[0],E[1],E[2],E[3],k[0],k[1],k[2]+1,k[3]+1)}}else uT?this.ctx.drawImage(v,0,0,t.display.points[e*5+3]-t.display.points[e*5+1],t.display.points[e*5+4]-t.display.points[e*5+2],n,r,s+1,a+1):this.ctx.drawImage(v,0,0,t.display.points[e*5+3]-t.display.points[e*5+1],t.display.points[e*5+4]-t.display.points[e*5+2],n,r,s+Number.MIN_VALUE+.5,a+Number.MIN_VALUE+.5)}catch{}t.display.rotation&&this.ctx.restore()}let d=t instanceof Rc&&this.options.box,m=t instanceof _x&&this.options.polygon;if((d||m)&&!t.props.className&&!t.props.html&&!t.props.href){if(this.visible.push(t),t.props.style){let y=Object.assign({},t.props.style||{},t.hovering?t.props.hoverStyles:{},t.pressing?t.props.pressStyles:{}),h=t.props.relativeStyle?1:s/t.width;typeof y.opacity<"u"&&(this.ctx.globalAlpha=y.opacity);let v=0;typeof y.borderWidth<"u"&&(v=parseInt(y.borderWidth,10)*h);let E=0;typeof y.outlineWidth<"u"&&(E=parseInt(y.outlineWidth,10)*h);let T=0;if(typeof y.outlineOffset<"u"&&(T=parseInt(y.outlineOffset,10)*h),y.borderColor&&(this.ctx.strokeStyle=y.borderColor),y.boxShadow){let P=y.boxShadow.split(/,(?![^(]*\))/);for(let k of P){let R=by[k]||Ty.exec(k)||Ty.exec(k);by[k]=R,R&&(this.ctx.save(),this.ctx.shadowOffsetX=parseInt(R[1])*this.dpi*h,this.ctx.shadowOffsetY=parseInt(R[3])*this.dpi*h,this.ctx.shadowBlur=parseInt(R[5])*this.dpi*h,this.ctx.shadowColor=R[9],this.ctx.fillStyle="rgba(0,0,0,1)",this.ctx.fillRect(n+v,r+v,s,a),this.ctx.restore())}}if(this.ctx.fillStyle=y.backgroundColor||"transparent",this.ctx.lineWidth=v,m){let P=t.shape,k=P.points||[],R=k.length;this.ctx.beginPath();for(let _=0;_<R;_++)this.ctx.lineTo(n+k[_][0]*this.lastKnownScale,r+k[_][1]*this.lastKnownScale);P.open||this.ctx.closePath(),v&&this.ctx.stroke(),P.open||this.ctx.fill()}else v&&this.ctx.strokeRect(n+v/2,r+v/2,s+v,a+v),this.ctx.fillRect(n+v,r+v,s,a);E&&(y.outlineColor&&(this.ctx.strokeStyle=y.outlineColor),this.ctx.lineWidth=E,this.ctx.strokeRect(n-E/2-T,r-E/2-T,s+v*2+E+T*2,a+v*2+E+T*2))}this.ctx.globalAlpha=c}}loadImage(t,e,n,r=!1){if(yd[t]&&yd[t].naturalWidth>0){e(yd[t]);return}try{let s=!1;r||setTimeout(()=>{s||this.loadImage(t,e,n,!0)},3e3);let a=document.createElement("img");a.decoding="auto",a.onload=function(){s=!0,e(a),yd[t]=a,a.onload=null},this.options.crossOrigin&&(a.crossOrigin="anonymous"),a.src=t,a.complete&&a.onload({}),a.width}catch(s){console.log("image error",s),n(s)}}schedulePaintToCanvas(t,e,n,r){this.imagesPending++,t.indices.push(n);let s=`${e.id}--${e.display.scale}-${n}`,a=this.invalidated.indexOf(s);a!==-1&&this.invalidated.splice(a,1),t.canvases[n]=s,e.__host.canvas.loading=!0,this.loadingQueueOrdered=!1,this.loadingQueue.push({id:s,scale:e.display.scale,network:!0,distance:r,task:()=>new Promise(c=>{if(this.visible.indexOf(e)===-1){this.imagesPending--,t.indices.splice(t.indices.indexOf(n),1),c();return}let d=e.getImageUrl(n);this.loadImage(d,m=>{this.loadingQueue.push({id:s,scale:e.display.scale,distance:r,task:()=>new Promise(y=>{this.imageIdsLoaded.includes(s)||(this.imagesLoaded++,this.imageIdsLoaded.push(s)),t.loaded.push(n),t.loaded.length===t.indices.length&&(t.loading=!1);let h=e.display.points.slice(n*5,n*5+5),v=document.createElement("canvas"),E=v.getContext("2d");v.width=h[3]-h[1],v.height=h[4]-h[2],this.hostCache.set(t.canvases[n],v),this.drawCalls.push(()=>{E.drawImage(m,0,0,h[3]-h[1],h[4]-h[2]),y()})})}),c()},m=>{this.imagesPending--,t.indices.splice(t.indices.indexOf(n),1),c()})})})}afterPaintLayer(t,e){}prepareLayer(t,e){t.__owner.value&&(t.cropData?(this.lastKnownScale*(1/t.display.scale),this.applyTransform(t,e[1],e[2],e[3]-e[1],e[4]-e[2])):this.applyTransform(t,e[1],e[2],e[3]-e[1],e[4]-e[2])),(!t.__host||!t.__host.canvas)&&(t instanceof nl||t instanceof Nc)&&this.createImageHost(t)}finishLayer(){this.lastPaintedObject&&this.clearTransform()}createImageHost(t){t.__host=t.__host?t.__host:{},t.__host.canvas={canvas:void 0,canvases:[],indices:[],loaded:[],loading:!1}}getPointsAt(t,e,n,r){return t.getPointsAt(e,n,r)}getViewportBounds(t,e,n){let r=t.getActiveZone();if(r){let s=e[3]-e[1]<r.points[3]-r.points[1],a=e[4]-e[2]<r.points[4]-r.points[2];return{x1:s?r.points[1]-n:r.points[1]+(r.points[3]-r.points[1])/2-(e[3]-e[1])/2,y1:a?r.points[2]-n:r.points[2]+(r.points[4]-r.points[2])/2-(e[4]-e[2])/2,x2:s?r.points[3]+n:r.points[1]+(r.points[3]-r.points[1])/2-(e[3]-e[1])/2,y2:a?r.points[4]+n:r.points[2]+(r.points[4]-r.points[2])/2-(e[4]-e[2])/2}}return null}pendingUpdate(){let t=!this.pendingDrawCall&&this.drawCalls.length===0&&this.imagesPending===0&&this.loadingQueue.length===0&&this.tasksRunning===0;return!t&&this.visible.length===0&&setTimeout(()=>{this.canvas.style.opacity="1",this.firstMeaningfulPaint=!0},500),!this.firstMeaningfulPaint&&t&&this.visible.length?(this.canvas.style.opacity="1",this.firstMeaningfulPaint=t,!0):this.options.debug?!0:!t}getRendererScreenPosition(){return this.rendererPosition}reset(){this.loadingQueue=[],this.drawCalls=[]}},Ix=class{constructor(t){N(this,"renderers",[]),N(this,"length");for(let e of t)e&&this.renderers.push(e);this.length=this.renderers.length}afterFrame(t,e,n,r){for(let s=0;s<this.length;s++)this.renderers[s].afterFrame(t,e,n,r)}afterPaintLayer(t,e){for(let n=0;n<this.length;n++)this.renderers[n].afterPaintLayer(t,e)}beforeFrame(t,e,n,r){for(let s=0;s<this.length;s++)this.renderers[s].beforeFrame(t,e,n,r)}triggerResize(){for(let t=0;t<this.length;t++){let e=this.renderers[t];e.triggerResize&&e.triggerResize()}}getPointsAt(t,e,n,r){return this.renderers[0].getPointsAt(t,e,n,r)}getScale(t,e){return this.renderers[0].getScale(t,e)}getViewportBounds(t,e,n){return this.renderers[0].getViewportBounds(t,e,n)}getRendererScreenPosition(){return this.renderers[0].getRendererScreenPosition()}isReady(){for(let t=0;t<this.length;t++)if(!this.renderers[t].isReady())return!1;return!0}paint(t,e,n,r,s,a){for(let c=0;c<this.length;c++)this.renderers[c].paint(t,e,n,r,s,a)}pendingUpdate(){for(let t=0;t<this.length;t++)if(this.renderers[t].pendingUpdate())return!0;return!1}prepareLayer(t,e){for(let n=0;n<this.length;n++)this.renderers[n].prepareLayer(t,e)}finishLayer(t,e){for(let n=0;n<this.length;n++)this.renderers[n].finishLayer(t,e)}resize(t,e){for(let n=0;n<this.length;n++)this.renderers[n].resize(t,e)}reset(){for(let t=0;t<this.length;t++)this.renderers[t].reset()}},fT=class{constructor(t){N(this,"canvas"),N(this,"context"),N(this,"heightRatio",1),N(this,"widthRatio",1),N(this,"target",new Float32Array(5)),N(this,"initialWidth"),N(this,"initialHeight"),N(this,"bounds"),N(this,"aggregate"),N(this,"delta",0),N(this,"renderNextFrame",!0),this.canvas=t,this.initialWidth=t.width,this.initialHeight=t.height,this.context=t.getContext("2d"),this.context.globalAlpha=.5,this.aggregate=tl(1)}isReady(){return!0}resize(){this.initialWidth=this.canvas.width,this.initialHeight=this.canvas.height,this.renderNextFrame=!0}afterFrame(t,e,n){if(this.renderNextFrame){this.context.clearRect(0,0,this.canvas.width,this.canvas.height);let r=this.initialWidth/t.width,s=this.initialHeight/t.height,a=this.widthRatio>this.heightRatio?r:s;if(this.target=n,this.bounds){let c=t.getPointsAt(this.bounds,this.aggregate,a);for(let[d,m]of c)if(d instanceof nl&&d.__host.canvas){let y=m.length/5;for(let h=0;h<y;h++)d.__host.canvas.canvases[h]&&(m[h+1]*a,m[h+2]*a,(m[h+3]-m[h+1])*a,(m[h+4]-m[h+2])*a)}}t.getPoints().forEach((c,d,m)=>{if(d%5===0&&c){let y={x1:m[d+1]*a,y1:m[d+2]*a,x2:m[d+3]*a,y2:m[d+4]*a,width:(m[d+3]-m[d+1])*a,height:(m[d+4]-m[d+2])*a};this.context.strokeStyle="red",this.context.strokeRect(y.x1,y.y1,y.width,y.height)}}),n&&(this.context.strokeStyle="red",this.context.lineWidth=window.devicePixelRatio||1,this.context.strokeRect(n[1]*a,n[2]*a,(n[3]-n[1])*a,(n[4]-n[2])*a))}}getActiveZone(t){return null}getPointsAt(t,e,n,r){return t.getPointsAt(e,n,r)}getScale(t,e){return 1}beforeFrame(t,e){this.bounds=vt.singleBox(t.width,t.height)}drawImage(){}afterPaintLayer(t,e){}paint(t,e,n,r,s,a){this.renderNextFrame=!0}prepareLayer(t){}pendingUpdate(){return!1}hasActiveZone(){return!1}getViewportBounds(t,e,n){return null}getRendererScreenPosition(){return this.canvas.getBoundingClientRect()}finishLayer(){}reset(){}};function dT(t){return{x:t[1],y:t[2],width:t[3]-t[1],height:t[4]-t[2]}}var Ry="pan",_y="scroll",hT="gesture",pT={zoomOutFactor:.8,zoomInFactor:1.25,maxZoomFactor:1,minZoomFactor:.05,zoomDuration:300,zoomWheelConstant:20,zoomClamp:.6,panBounceStiffness:120,panBounceDamping:15,panTimeConstant:240,panPower:.1,nudgeDistance:100,panPadding:0,devicePixelRatio:1,enableWheel:!0,enableClickToZoom:!0,ignoreSingleFingerTouch:!1,enablePanOnWait:!1,requireMetaKeyForWheelZoom:!1,panOnWaitDelay:40,onPanInSketchMode:()=>{},parentElement:null},Ox=(t={})=>({start:function(e){let{zoomWheelConstant:n,enableWheel:r,enableClickToZoom:s,ignoreSingleFingerTouch:a,enablePanOnWait:c,panOnWaitDelay:d,parentElement:m,requireMetaKeyForWheelZoom:y}={...pT,...t},h={pointerStart:{x:0,y:0},isPressing:!1,mousemoveBuffer:Ye(5)};e.world.activatedEvents.push("onMouseUp","onMouseDown","onMouseMove","onTouchStart","onTouchEnd","onTouchMove","onContextMenu");function v(){k=0,_="",L(),L(void 0,"notice"),R=0}function E(){e.world.constraintBounds(),v()}function T(K){if(K.which>1){h.isPressing=!1;return}e.mode==="explore"&&(K.preventDefault(),h.pointerStart.x=K.atlas.x,h.pointerStart.y=K.atlas.y,e.transitionManager.stopTransition(),h.isPressing=!0)}function P(){v(),h.isPressing&&(e.mode==="explore"&&e.world.constraintBounds(),h.isPressing=!1)}let k=0,R=0,_="";function M(K){if(e.mode==="explore"){if(K.atlasTouches.length===1&&(R=performance.now(),a==!1&&K.preventDefault(),h.pointerStart.x=K.atlasTouches[0].x,h.pointerStart.y=K.atlasTouches[0].y),K.atlasTouches.length===2){_=hT,K.preventDefault();let ge=K.atlasTouches[0].x,de=K.atlasTouches[1].x;h.pointerStart.x=(ge+de)/2;let we=K.atlasTouches[0].y,le=K.atlasTouches[1].y;h.pointerStart.y=(we+le)/2,k=Od({x:K.touches[0].clientX,y:K.touches[0].clientY},{x:K.touches[1].clientX,y:K.touches[1].clientY})}e.transitionManager.stopTransition(),h.isPressing=!0}}function L(K,ge="intent"){m&&(m.dataset[ge]=K)}function $(K){let ge=null,de=null,we=0;if(h.isPressing&&K.touches.length===2){let le=K.touches[0].clientX,Ie=K.touches[1].clientX;ge=(le+Ie)/2;let Se=K.touches[0].clientY,Te=K.touches[1].clientY;de=(Se+Te)/2,we=Od({x:K.touches[0].clientX,y:K.touches[0].clientY},{x:K.touches[1].clientX,y:K.touches[1].clientY})}if(L(_),h.isPressing&&K.touches.length===1){if(c&&(performance.now()-R<d&&_==""&&(_=_y),_==""&&(_=Ry)),L(_),_==""&&a==!0||_==_y){L("require-two-finger","notice");return}let le=K.touches[0];ge=le.clientX,de=le.clientY}if(ge!==null&&de!==null){let le=e.getRendererScreenPosition();if(le){let{x:Ie,y:Se}=e.viewerToWorld(ge-le.x,de-le.y),Te=we&&k?we/k:1;e.transitionManager.customTransition(D=>{D.from=Ye(e.target),D.to=Qs(D.from,qs(Tr(h.pointerStart.x-Ie,h.pointerStart.y-Se),Lc(1/Te,Ie,Se)),h.mousemoveBuffer),D.elapsed_time=0,D.total_time=0,D.timingFunction=Yo.easeInOutExpo,D.done=!1})}k=we}_==Ry&&K.preventDefault()}function F(K){if(h.isPressing){let ge=e.getRendererScreenPosition();if(ge){let{x:de,y:we}=e.viewerToWorld(K.clientX-ge.x,K.clientY-ge.y);e.transitionManager.customTransition(le=>{le.from=Ye(e.target),le.to=Qs(le.from,Tr(h.pointerStart.x-de,h.pointerStart.y-we),h.mousemoveBuffer),le.elapsed_time=0,le.total_time=0,le.timingFunction=Yo.easeInOutExpo,le.done=!1})}}}function H(K){e.mode==="explore"&&e.world.zoomIn(K.atlas)}function se(K){let ge=1+kk(K).spinY/n;e.world.zoomTo(ge,K.atlas,!0)}function oe(K){return y&&K.metaKey==!1?(L("meta-required","notice"),K.stopPropagation(),!1):!0}e.world.addEventListener("mouseup",E),e.world.addEventListener("touchend",E),e.world.addEventListener("touchstart",M),e.world.addEventListener("mousedown",T),window.addEventListener("touchend",P),window.addEventListener("mouseup",P),window.addEventListener("mousemove",F),m&&m.addEventListener("touchmove",$),s&&(e.world.activatedEvents.push("onClick"),e.world.addEventListener("click",H)),r&&(e.world.activatedEvents.push("onWheel"),y&&m?.addEventListener("wheel",oe,{passive:!0,capture:!0}),e.world.addEventListener("wheel",se));let me=e.world.addLayoutSubscriber((K,ge)=>{if(K==="zone-changed"&&e.transitionManager.constrainBounds({transition:{duration:0}}),K==="zoom-to"&&ge&&e.transitionManager.zoomTo(ge.factor,{origin:ge.point,stream:ge.stream}),K==="go-home"){let de=ge.immediate?{duration:0}:void 0;e.transitionManager.goToRegion(dT(e.homePosition),{transition:de})}if(K==="goto-region"&&ge){let de=ge.immediate?{duration:0}:{};e.transitionManager.goToRegion(ge,{transition:de})}K==="constrain-bounds"&&e.transitionManager.constrainBounds({transition:ge?.immediate?{duration:0}:void 0})});return()=>{e.world.removeEventListener("mouseup",E),e.world.removeEventListener("touchend",E),e.world.removeEventListener("touchstart",M),e.world.removeEventListener("mousedown",T),window.removeEventListener("touchend",P),window.removeEventListener("mouseup",P),e.world.removeEventListener("mousemove",F),m&&(m.removeEventListener("touchmove",F),m.removeEventListener("wheel",oe,{passive:!0,capture:!0})),s&&e.world.removeEventListener("click",H),r&&e.world.removeEventListener("wheel",se),me()}},updatePosition(){}}),Wc=Xt.createContext("explore");Wc.displayName="Mode";var gT=()=>O.useContext(Wc),Hc=Xt.createContext(null);Hc.displayName="Atlas";var rh=Xt.createContext(null);rh.displayName="Bounds";var Ad,mT=typeof performance=="object"&&typeof performance.now=="function";if(mT){let t=performance;Ad=()=>t.now()}else{let t=Date,e=t.now();Ad=()=>t.now()-e}var yT=16;function Iy(t,e){t&&t.appendChild&&e&&t.appendChild(e)}function Ax(t,e){t&&t.removeChild&&e&&t.removeChild(e)}function vT(t,e){return Ax(t.world,e)}function xT(t,e,n){return Mx(t.world,e,n)}function Mx(t,e,n){t&&t instanceof nh&&(t=t.world),t&&t.insertBefore&&t.insertBefore(e,n)}function jx(t,e,n){if(n&&(t.applyProps&&t.applyProps(n),t instanceof os))for(let r of Jd){let s=r.slice(2).toLowerCase();n[r]!==e[r]&&(e[r]&&t.removeEventListener(s,e[r]),t.addEventListener(s,n[r]))}}function Lx(t,e){let n=Object.keys(e),r=!1;for(let s of n)if(Jd.indexOf(s)!==-1){let a=hu[s];if(a){if(t.activatedEvents.indexOf(a)!==-1)continue;r=!0,t.activatedEvents.push(a)}}r&&t.triggerEventActivation()}var Md=new Map,Oy={};function wT(t,{args:e=[],...n},r,s,a){if(!(r instanceof nh)&&a){let m=y=>y.return?m(y.return):y.stateNode&&y.stateNode.containerInfo;r=m(a)}let c,d=r.world;switch(t){case"world":c=th.withProps({width:n.width,height:n.height,viewingDirection:"left-to-right"}),c.activatedEvents=d.activatedEvents,c.eventHandlers=d.eventHandlers,c.subscriptions=d.subscriptions,c.triggerEventActivation(),d=c;break;case"box":c=new Rc;break;case"shape":c=new _x;break;case"worldObject":case"world-object":c=new Mg;break;case"worldImage":case"world-image":c=new nl;break;case"texture":c=new lg;break;case"compositeImage":case"composite-image":c=new rT({id:n.id,width:n.width,height:n.height,images:[],renderOptions:n.renderOptions});break;case"tiledImage":case"tiled-image":c=Nc.fromTile(n.uri,n.display,n.tile,n.scaleFactor,void 0,n.format,n.useFloorCalc,n.version3);break;case"paragraph":c=new Td,c.text=n.children;break;default:return}return Lx(d,n),jx(c,{},n),c}function ST(t,e){if(e instanceof th)t.world=e;else if(e instanceof Mg)t.world.appendChild(e);else if(e)throw new Error("Invalid root")}var _c=jk({unstable_now:Ad,now:Ad,createInstance:wT,removeChild:Ax,appendChild:Iy,appendInitialChild:Iy,insertBefore:Mx,warnsIfNotActing:!0,supportsMutation:!0,isPrimaryRenderer:!1,scheduleTimeout:typeof setTimeout<"u"?setTimeout:void 0,cancelTimeout:typeof clearTimeout<"u"?clearTimeout:void 0,setTimeout:typeof setTimeout<"u"?setTimeout:void 0,clearTimeout:typeof clearTimeout<"u"?clearTimeout:void 0,noTimeout:-1,appendChildToContainer:ST,removeChildFromContainer:vT,createTextInstance(){},insertInContainerBefore:xT,prepareUpdate(t,e,n,r,s){return Lx(s.world,r),r},commitUpdate(t,e,n,r,s,a){t.applyProps&&e&&jx(t,r,e)},finalizeInitialChildren(t){return t?.__handlers},getChildHostContext(){return Oy},getRootHostContext(){return Oy},prepareForCommit(t){return t.isCommitting=!0,null},preparePortalMount(){},hideInstance(t){t&&t.points&&(t.points[0]=0)},unhideInstance(t,e){t&&t.points&&(t.points[0]=1)},getPublicInstance(t){return t},hideTextInstance(){throw new Error("Text is not allowed in the react-three-fibre tree. You may have extraneous whitespace between components.")},resetAfterCommit(t){t.isCommitting=!1,t.pendingUpdate=!0,t.world&&t.world.needsRecalculate&&(t.world.recalculateWorldSize(),t.world.triggerRepaint())},shouldSetTextContent(){return!1},clearContainer(){return!1},supportsHydration:!1,supportsPersistence:!1,detachDeletedInstance(t){},afterActiveInstanceBlur(){},beforeActiveInstanceBlur(){},getCurrentEventPriority(){return console.log("getCurrentEventPriority"),yT},getInstanceFromNode(t){throw console.log("getInstanceFromNode",t),new Error("Not implemented")},getInstanceFromScope(t){throw console.log("getInstanceFromScope",t),new Error("Not implemented")},prepareScopeUpdate(t,e){throw console.log("prepareScopeUpdate",t,e),new Error("Not implemented")},logRecoverableError(){},requestPostPaintCallback(){}});_c.injectIntoDevTools({bundleType:0,version:O.version,rendererPackageName:"@atlas-viewer/atlas"});function jg(t,e){let n=Md.get(t);n&&_c.updateContainer(null,n,null,()=>{Md.delete(t),e&&e(t)})}var Ay={render(t,e){let n=Md.get(e);if(n)_c.updateContainer(t,n,null);else{let r=_c.createContainer(e,0,null,!1,null,"",()=>{},null);_c.updateContainer(t,r,null),Md.set(e,r)}},unmountComponentAtNode(t,e){jg(t,e)}},Ic=typeof window<"u"&&(window.document?.createElement||window.navigator?.product==="ReactNative")?O.useLayoutEffect:O.useEffect,PT=Xt.memo(({children:t,setIsReady:e,onCreated:n,bounds:r,preset:s,mode:a="explore"})=>{let c=O.useCallback(function(d){let m=O.useRef(!1),y=()=>{e(!0)};return O.useEffect(()=>{if(s&&!m.current){s.runtime.goHome();let h=n&&n(s);return void(h&&h.then?h.then(y):y())}return()=>{}},[]),O.useEffect(()=>{m.current=!0},[]),d.children},[s]);return Ic(()=>{if(s){let d=s.runtime;a!==d.mode&&(d.mode=a),Ay.render(I.jsx(Xt.StrictMode,{children:I.jsx(c,{children:I.jsx(rh.Provider,{value:r,children:I.jsx(Wc.Provider,{value:a,children:I.jsx(Hc.Provider,{value:s,children:t})})})})}),d)}},[s,a,t]),Ic(()=>{if(s){let d=s.runtime;return()=>{Ay.unmountComponentAtNode(d)}}return()=>{}},[s]),null}),ET=class{constructor(t,e){N(this,"canvas"),N(this,"gl"),N(this,"program"),N(this,"fragmentShader"),N(this,"vertexShader"),N(this,"rectBuffer"),N(this,"fragmentShaderSource",`
    precision mediump float;

    uniform sampler2D u_image;
    varying vec2 v_texCoord;

    void main() {
        gl_FragColor = texture2D(u_image, v_texCoord);
    }
  `),N(this,"vertexShaderSource",`
    attribute vec2 a_position;
    uniform vec2 u_resolution;
    varying vec4 v_color;
    uniform sampler2D u_texture;

    attribute vec2 a_texCoord;
    varying vec2 v_texCoord;

    void main() {

        // convert the position from pixels to 0.0 to 1.0
        vec2 zeroToOne = a_position / u_resolution;

        // convert from 0->1 to 0->2
        vec2 zeroToTwo = zeroToOne * 2.0;

        // convert from 0->2 to -1->+1 (clip space)
        vec2 clipSpace = zeroToTwo - 1.0;

        gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);
        
        v_texCoord = a_texCoord;
    }
  `),N(this,"attributes"),N(this,"uniforms"),N(this,"buffers"),N(this,"rendererPosition"),N(this,"dpi"),N(this,"lastResize",0),N(this,"lastKnownScale",1),this.canvas=t,this.rendererPosition=t.getBoundingClientRect(),this.gl=t.getContext("webgl2"),this.fragmentShader=this.createShader(this.gl.FRAGMENT_SHADER,this.fragmentShaderSource),this.vertexShader=this.createShader(this.gl.VERTEX_SHADER,this.vertexShaderSource),this.program=this.createProgram(this.vertexShader,this.fragmentShader),this.dpi=e?.dpi||1,this.attributes={position:this.gl.getAttribLocation(this.program,"a_position"),texCoord:this.gl.getAttribLocation(this.program,"a_texCoord")},this.uniforms={resolution:this.gl.getUniformLocation(this.program,"u_resolution"),texture:this.gl.getUniformLocation(this.program,"u_texture")},this.buffers={position:this.createArrayBuffer(),texCoord:this.createArrayBuffer(new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]))},this.rectBuffer=new Float32Array(12),this.resize(),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.useProgram(this.program),this.gl.enableVertexAttribArray(this.attributes.position)}resize(){this.resizeCanvasToDisplaySize(),this.gl.viewport(0,0,this.gl.canvas.width,this.gl.canvas.height),this.rendererPosition=this.canvas.getBoundingClientRect()}isReady(){return!0}beforeFrame(t,e,n){this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.vertexAttribPointer(this.attributes.position,2,this.gl.FLOAT,!1,0,0),this.gl.uniform2f(this.uniforms.resolution,this.gl.canvas.width,this.gl.canvas.height),this.lastResize>1e3&&(this.lastResize=0,this.resizeCanvasToDisplaySize()),this.lastResize+=e}prepareLayer(t){(!t.__host||!t.__host.webgl)&&((t instanceof nl||t instanceof Nc)&&this.createImageHost(t),t instanceof lg&&this.createTextureHost(t))}createTextureHost(t){t.__host=t.__host?t.__host:{};let e=this.gl,n=this.gl.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1);let r;if(t instanceof lg){let s=t.getTexture();s.source&&e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,s.source),r=s}e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),t.__host.webgl={height:t.height,width:t.width,texture:n,lastImage:r}}createImageHost(t){let e=[...new Array(t.points.length/5)];t.__host=t.__host?t.__host:{},t.__host.webgl={height:t.height,width:t.width,textures:e,loading:[],loaded:[],lastLevelRendered:-1,onLoad:(n,r)=>{let s=this.gl,a=this.gl.createTexture();s.bindTexture(s.TEXTURE_2D,a),s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,!1),s.texImage2D(s.TEXTURE_2D,0,s.RGBA,s.RGBA,s.UNSIGNED_BYTE,r),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MAG_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_MIN_FILTER,s.LINEAR),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_T,s.CLAMP_TO_EDGE),s.texParameteri(s.TEXTURE_2D,s.TEXTURE_WRAP_S,s.CLAMP_TO_EDGE),s.bindTexture(s.TEXTURE_2D,null),t.__host.webgl.textures[n]=a,t.__host.webgl.loaded.push(n)}}}paint(t,e,n,r,s,a){if(t.type==="spacial-content"&&t.__host&&t.__host.webgl){if(t.getTexture){let d=t?.getTexture();if(d&&t.__host.webgl.lastImage!==d.hash&&d.source&&!t.__host.webgl.error)try{let m=this.gl.RGBA,y=this.gl.RGBA,h=this.gl.UNSIGNED_BYTE;this.gl.bindTexture(this.gl.TEXTURE_2D,t.__host.webgl.texture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,m,y,h,d.source),t.__host.webgl.lastImage=d.hash}catch(m){t.__host.webgl.error=m}}if(t.__host.webgl.loading&&t.__host.webgl.loading.indexOf(e)===-1&&t.getImageUrl){t.__host.webgl.loading.push(e);let d=document.createElement("img");d.decoding="async",d.crossOrigin="anonymous",d.src=t.getImageUrl(e),d.onload=()=>(d.onload=null,t.__host.webgl.onLoad(e,d))}let c=t.__host.webgl.texture?t.__host.webgl.texture:t.__host.webgl.textures[e];c&&(this.gl.enableVertexAttribArray(this.attributes.texCoord),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffers.texCoord),this.gl.enableVertexAttribArray(this.attributes.texCoord),this.gl.vertexAttribPointer(this.attributes.texCoord,2,this.gl.FLOAT,!1,0,0),this.gl.bindBuffer(this.gl.ARRAY_BUFFER,this.buffers.position),this.gl.enableVertexAttribArray(this.attributes.position),this.gl.vertexAttribPointer(this.attributes.position,2,this.gl.FLOAT,!1,0,0),this.gl.bindTexture(this.gl.TEXTURE_2D,c),this.gl.uniform1i(this.uniforms.texture,0),this.setRectangle(n,r,s,a),this.gl.drawArrays(this.gl.TRIANGLES,0,6))}}afterPaintLayer(t,e){}pendingUpdate(){return!0}getPointsAt(t,e,n,r){return t.getPointsAt(e,n,r)}afterFrame(){}getScale(t,e,n){if(Number.isNaN(t)||Number.isNaN(e))return this.lastKnownScale;let r=this.getCanvasDims(),s=r.width/t,a=r.height/e,c=(s<a?a:s)*(n&&this.dpi||1);return Number.isNaN(c)||(this.lastKnownScale=c),this.lastKnownScale}getCanvasDims(){return{width:this.canvas.width/this.dpi,height:this.canvas.height/this.dpi}}getViewportBounds(t,e,n){return null}createShader(t,e){let n=this.gl.createShader(t);if(n){if(this.gl.shaderSource(n,e),this.gl.compileShader(n),this.gl.getShaderParameter(n,this.gl.COMPILE_STATUS))return n;let r=this.gl.getShaderInfoLog(n);if(this.gl.deleteShader(n),r)throw new Error(r)}throw new Error("Invalid shader")}createProgram(t,e){let n=this.gl.createProgram();if(n){if(this.gl.attachShader(n,t),this.gl.attachShader(n,e),this.gl.linkProgram(n),this.gl.getProgramParameter(n,this.gl.LINK_STATUS))return n;let r=this.gl.getProgramInfoLog(n);if(this.gl.deleteProgram(n),r)throw new Error(r)}throw new Error("Invalid program")}resizeCanvasToDisplaySize(){let t=this.gl.canvas,e=t.clientWidth,n=t.clientHeight,r=t.width!==e||t.height!==n;return r&&(t.width=e,t.height=n),r}createArrayBuffer(t){let e=this.gl.createBuffer();if(this.gl.bindBuffer(this.gl.ARRAY_BUFFER,e),t&&this.gl.bufferData(this.gl.ARRAY_BUFFER,t,this.gl.STATIC_DRAW),!e)throw new Error("Cannot create buffer");return e}setRectangle(t,e,n,r){this.gl.bufferData(this.gl.ARRAY_BUFFER,this.getRectangle(t,e,n,r),this.gl.STATIC_DRAW)}getRectangle(t,e,n,r){let s=t,a=t+n,c=e,d=e+r;return this.rectBuffer.set([s,c,a,c,s,d,s,d,a,c,a,d]),this.rectBuffer}getRendererScreenPosition(){return this.rendererPosition}finishLayer(){}reset(){}};function ug(t,e){let n=e?t:JSON.stringify(t),r=5381,s=n.length;for(;s;)r=r*33^n.charCodeAt(--s);let a=(r>>>0).toString(16);return a.length%2?"0"+a:a}var Nx=class{constructor(t){N(this,"$element"),N(this,"stylesheetClasses"),N(this,"activeStylesheetClasses"),N(this,"sheetsDidUpdate"),N(this,"sheetPrefix"),N(this,"stylesheetEntries"),this.sheetPrefix=t?.sheetPrefix||"a-",this.$element=document.createElement("style"),this.stylesheetClasses=[],this.activeStylesheetClasses=[],this.sheetsDidUpdate=!1,this.stylesheetEntries={}}getElement(){return this.$element}addStylesheet(t){let e=t.replace(/\s\s+/g," ").replace(/: /g,":").replace(/; /g,";").trim(),n=this.sheetPrefix+ug(e,!0);return this.stylesheetClasses.indexOf(n)!==-1||(this.stylesheetClasses.push(n),this.activeStylesheetClasses.push(n),this.stylesheetEntries[n]=e,this.sheetsDidUpdate=!0),n}removeStylesheet(t){let e=this.sheetPrefix+ug(t,!0);this.stylesheetClasses.indexOf(e)&&(this.stylesheetClasses=this.stylesheetClasses.filter(n=>n!==e)),this.sheetsDidUpdate=!0}clearClasses(){this.activeStylesheetClasses=[]}didUpdateActive(){if(this.activeStylesheetClasses.length){for(let t of this.activeStylesheetClasses)if(this.stylesheetClasses.indexOf(t)===-1)return!0;for(let t of this.stylesheetClasses)if(this.activeStylesheetClasses.indexOf(t)===-1)return!0}return!1}updateSheet(){(this.sheetsDidUpdate||this.didUpdateActive())&&(this.$element.innerText=this.activeStylesheetClasses.map(t=>`.${t}{${this.stylesheetEntries[t]}}`).join(""),this.sheetsDidUpdate=!1,this.stylesheetClasses=[...this.activeStylesheetClasses])}},zx=class{constructor(e,n){N(this,"htmlContainer"),N(this,"visible",[]),N(this,"previousVisible",[]),N(this,"htmlIds",[]),N(this,"firstMeaningfulPaint",!1),N(this,"rendererPosition"),N(this,"stylesheet"),N(this,"options"),N(this,"paintTx",1),N(this,"zIndex",0),N(this,"classes"),this.htmlContainer=e,this.htmlContainer.innerHTML="",this.rendererPosition=this.htmlContainer.getBoundingClientRect(),this.options={triggerResize:()=>{},box:!1,text:!1,sheetPrefix:"",inlineStyles:!1,background:"",...n||{}},this.stylesheet=new Nx({sheetPrefix:this.options.sheetPrefix}),this.options.inlineStyles||this.htmlContainer.appendChild(this.stylesheet.getElement()),this.options.background&&this.htmlContainer.classList.add(this.stylesheet.addStylesheet(`
        background: ${this.options.background};
      `)),this.classes={hostClassName:this.stylesheet.addStylesheet(`
        position: absolute;
        transform-origin: 0px 0px;
      `),interactive:this.stylesheet.addStylesheet("pointer-events: all"),nonInteractive:this.stylesheet.addStylesheet("pointer-events: none")},this.stylesheet.updateSheet()}createHtmlHost(e){if(this.htmlContainer&&(this.options.box||e.props.className||e.props.html||e.props.href)){let n=document.createElement(e.props.href?"a":"div");if(e.props.href){n.style.display="block",n.href=e.props.href;let r=e.props.hrefTarget||"_blank";n.target=r,r!=="_self"&&(n.rel="noopener noreferrer")}n.title=e.props.title||"",this.options.inlineStyles?(n.style.display="block",n.style.position="absolute",n.style.overflow="hidden",n.style.transformOrigin="0px 0px"):n.classList.add(this.classes.hostClassName),e.__host={element:n,revision:null,relative:!1},this.updateHtmlHost(e,e.width,e.height),e.__onCreate&&e.__onCreate()}}triggerResize(){this.options.triggerResize()}updateHtmlHost(e,n,r){if(e.__revision!==e.__host.revision){let s=e.__host.element,a=[this.classes.hostClassName];if(e.props.interactive?this.options.inlineStyles?s.style.pointerEvents="all":a.push(this.classes.interactive):this.options.inlineStyles?s.style.pointerEvents="none":a.push(this.classes.nonInteractive),e.props.href){s.style.display="block",s.href=e.props.href;let d=e.props.hrefTarget||"_blank";s.target=d,d!=="_self"?s.rel="noopener noreferrer":s.rel=""}else s.href&&s.removeAttribute("href");if(e.props.title&&(s.title=e.props.title||""),e.props.className&&(a.push(e.props.className),e.hovering&&a.push(`${e.props.className}--hover`),e.pressing&&a.push(`${e.props.className}--active`)),e.props.relativeStyle?(s.style.width=`${n||e.width}px`,s.style.height=`${r||e.height}px`):(s.style.width=`${e.width}px`,s.style.height=`${e.height}px`),e.props.style){Object.assign(s.style,e.props.style||{},e.hovering?e.props.hoverStyles||{}:{},e.pressing?e.props.pressStyles||{}:{});return}if(this.options.text&&e instanceof Td){e.text&&(s.innerText=e.text),e.backgroundColor&&(s.style.backgroundColor=e.backgroundColor),e.color&&(s.style.color=e.color),e.props.font&&(s.style.font=e.props.font),e.props.textAlign&&(s.style.textAlign=e.props.textAlign),e.__host.revision=e.__revision;let d=a.join(" ");s.className=d,s.part=d}e instanceof Rc&&(this.options.box||e.props.className||e.props.html)&&(e.props.backgroundColor&&(s.style.backgroundColor=e.props.backgroundColor),e.props.border!==s.style.border&&(s.style.border=e.props.border));let c=a.join(" ");s.className=c,s.part=c}}afterFrame(e,n,r){this.stylesheet.updateSheet();for(let s of this.previousVisible)this.visible.indexOf(s)===-1&&this.htmlContainer&&s.__id&&this.htmlIds.indexOf(s.__id)!==-1&&this.htmlContainer.removeChild(s.__host.element);this.previousVisible=this.visible}afterPaintLayer(e,n){}beforeFrame(e,n,r){this.stylesheet.clearClasses(),this.paintTx++,this.zIndex=0,this.visible=[]}getPointsAt(e,n,r,s){return e.getPointsAt(n,r,s)}getScale(e,n){let r=this.rendererPosition.width/e,s=this.rendererPosition.height/n;return r<s?s:r}getViewportBounds(e,n,r){return null}isReady(){return!1}paint(e,n,r,s,a,c){if(this.zIndex++,(this.options.text&&e instanceof Td||e instanceof Rc&&(this.options.box||e.props.className||e.props.html))&&e.__host.tx!==this.paintTx&&(this.visible.push(e),e.__host.tx=this.paintTx,this.htmlContainer)){this.updateHtmlHost(e,a,c);let d=a/e.width,m=e.__host.element;m.style.zIndex=`${this.zIndex}`,e.props.relativeStyle?m.style.transform=`translate(${Math.round(r)}px, ${Math.round(s)}px)`:m.style.transform=`translate(${Math.round(r)}px, ${Math.round(s)}px) scale(${d})`,this.previousVisible.indexOf(e)===-1&&this.htmlContainer.appendChild(m),this.htmlIds.indexOf(e.__id)===-1&&this.htmlIds.push(e.__id)}}pendingUpdate(){return!1}prepareLayer(e){e.__host||(e instanceof Td||e instanceof Rc)&&this.createHtmlHost(e)}resize(e,n){typeof e<"u"&&typeof n<"u"&&(this.htmlContainer.style.width=`${e}px`,this.htmlContainer.style.height=`${n}px`),this.rendererPosition=this.htmlContainer.getBoundingClientRect()}getRendererScreenPosition(){return this.rendererPosition}finishLayer(){}reset(){}},Fx=class bd{constructor(e,n,r){N(this,"element"),N(this,"runtime"),N(this,"unsubscribe"),N(this,"activatedEvents",[]),N(this,"eventHandlers",[]),N(this,"bounds"),N(this,"listening"),N(this,"pointerMoveEvent"),N(this,"pointerEventState",{isClicking:!1,isDragging:!1,isPressed:!1,mousedOver:[],itemsBeingDragged:[],mouseDownStart:{x:0,y:0},lastTouches:[]}),N(this,"options"),N(this,"_realPointerMove",a=>{this.pointerMoveEvent=a}),N(this,"onWheelEvent",a=>{a.preventDefault(),this.onPointerEvent(a)}),N(this,"onContextMenu",a=>{a.preventDefault();let c="onContextMenu";if(this.runtime.world.activatedEvents.indexOf(c)!==-1){let{x:d,y:m}=this.runtime.viewerToWorld(a.clientX-this.bounds.left,a.clientY-this.bounds.top);this.assignToEvent(a,d,m),this.runtime.world.propagatePointerEvent(c,a,d,m)}}),N(this,"onTouchEvent",a=>{let c=hu[a.type],d=[],m=a.touches.length;for(let y=0;y<m;y++){let h=a.touches.item(y);if(!h)continue;let{x:v,y:E}=this.runtime.viewerToWorld(h.clientX-this.bounds.left,h.clientY-this.bounds.top),T={id:h.identifier,x:v,y:E};d.push(T)}d.length&&this.assignToEvent(a,d[0].x,d[0].y),c!=="onTouchEnd"?(this.pointerEventState.lastTouches=d,a.atlasTouches=d,this.runtime.world.propagateTouchEvent(c,a,d)):(a.atlasTouches=[],this.runtime.world.propagateTouchEvent(c,a,this.pointerEventState.lastTouches),this.pointerEventState.lastTouches=[])}),N(this,"onPointerEvent",a=>{if(a.button===2)return;let c=hu[a.type];if(c&&this.runtime.world.activatedEvents.indexOf(c)!==-1){let{x:d,y:m}=this.runtime.viewerToWorld(a.clientX-this.bounds.left,a.clientY-this.bounds.top);this.assignToEvent(a,d,m),this.runtime.world.propagatePointerEvent(c,a,d,m)}}),N(this,"onPointerDown",a=>{a.button!==2&&(this.pointerEventState.isPressed=!0,this.pointerEventState.isClicking=!0,this.pointerEventState.mouseDownStart.x=a.clientX,this.pointerEventState.mouseDownStart.y=a.clientY,setTimeout(()=>{this.runtime&&(this.pointerEventState.isClicking=!1)},250),setTimeout(()=>{if(this.runtime&&this.pointerEventState.isPressed&&!this.pointerEventState.isDragging){let c=this.runtime.viewerToWorld(this.pointerEventState.mouseDownStart.x-this.bounds.left,this.pointerEventState.mouseDownStart.y-this.bounds.top);this.pointerEventState.isDragging=!0,this.pointerEventState.itemsBeingDragged=this.runtime.world.propagatePointerEvent("onDragStart",a,c.x,c.y)}},800),this.onPointerEvent(a))}),N(this,"onPointerUp",a=>{if(a.button!==2){if(this.pointerEventState.isClicking){let{x:c,y:d}=this.runtime.viewerToWorld(a.clientX-this.bounds.left,a.clientY-this.bounds.top);this.assignToEvent(a,c,d),this.runtime.world.propagatePointerEvent("onClick",a,c,d)}if(this.pointerEventState.isDragging){for(let c of this.pointerEventState.itemsBeingDragged)c.dispatchEvent("onDragEnd",a);this.pointerEventState.isDragging=!1}this.pointerEventState.isClicking=!1,this.pointerEventState.isPressed=!1,this.pointerEventState.itemsBeingDragged=[],this.onPointerEvent(a)}}),N(this,"onPointerMove",a=>{this.pointerMoveEvent=void 0;let{x:c,y:d}=this.runtime.viewerToWorld(a.clientX-this.bounds.left,a.clientY-this.bounds.top);if(Number.isNaN(c)||Number.isNaN(d))return;this.assignToEvent(a,c,d),this.runtime.world.propagatePointerEvent("onPointerMove",a,c,d);let m=this.runtime.world.propagatePointerEvent("onMouseMove",a,c,d),y=[],h=[];for(let v of m)y.push(v.id),h.push(v),this.pointerEventState.mousedOver.indexOf(v)===-1&&(v.dispatchEvent("onMouseEnter",a),v.dispatchEvent("onPointerEnter",a),v.dispatchEvent("onMouseOver",a),v.dispatchEvent("onPointerOver",a));for(let v of this.pointerEventState.mousedOver)y.indexOf(v.id)===-1&&(v.dispatchEvent("onMouseLeave",a),v.dispatchEvent("onPointerLeave",a),v.dispatchEvent("onMouseOut",a),v.dispatchEvent("onPointerOut",a));if(this.pointerEventState.isDragging)for(let v of this.pointerEventState.itemsBeingDragged)v.dispatchEvent("onDrag",a);if(this.pointerEventState.isPressed&&!this.pointerEventState.isDragging&&Od(this.pointerEventState.mouseDownStart,{x:a.clientX,y:a.clientY})>50){let v=this.runtime.viewerToWorld(this.pointerEventState.mouseDownStart.x-this.bounds.left,this.pointerEventState.mouseDownStart.y-this.bounds.top);this.pointerEventState.isDragging=!0,this.pointerEventState.itemsBeingDragged=this.runtime.world.propagatePointerEvent("onDragStart",{...a,atlas:{x:v.x,y:v.y}},v.x,v.y)}this.pointerEventState.mousedOver=h}),this.element=e,this.runtime=n,this.unsubscribe=n.world.addLayoutSubscriber(this.layoutSubscriber.bind(this)),this.bounds=e.getBoundingClientRect(),this.listening=!1,this.options={simulationRate:0,...r||{}};let s=0;n.registerHook("useFrame",a=>{s+=a,s>this.options.simulationRate&&this.pointerMoveEvent&&(s=0,n.updateNextFrame())}),n.registerHook("useBeforeFrame",()=>{this.pointerMoveEvent&&this.onPointerMove(this.pointerMoveEvent)}),this.activateEvents()}updateBounds(){this.bounds=this.element.getBoundingClientRect(),this.runtime.updateRendererScreenPosition()}layoutSubscriber(e){e==="event-activation"&&this.listening==!1&&this.activateEvents()}assignToEvent(e,n,r){bd.eventPool.atlas.x=n,bd.eventPool.atlas.y=r,e.atlas=bd.eventPool.atlas}activateEvents(){this.listening=!0,this.element.addEventListener("pointermove",this._realPointerMove),this.element.addEventListener("pointerup",this.onPointerUp),this.element.addEventListener("pointerdown",this.onPointerDown),this.element.addEventListener("mousedown",this.onPointerEvent),this.element.addEventListener("mouseup",this.onPointerEvent),this.element.addEventListener("pointercancel",this.onPointerEvent),this.element.addEventListener("wheel",this.onWheelEvent),this.element.addEventListener("contextmenu",this.onContextMenu),this.element.addEventListener("touchstart",this.onTouchEvent),this.element.addEventListener("touchcancel",this.onTouchEvent),this.element.addEventListener("touchend",this.onTouchEvent),this.element.addEventListener("touchmove",this.onTouchEvent)}normalizeEventName(e){return e.startsWith("on")?e.slice(2).toLowerCase():e.toLowerCase()}stop(){this.listening=!1,this.element.removeEventListener("pointermove",this._realPointerMove),this.element.removeEventListener("pointerup",this.onPointerUp),this.element.removeEventListener("pointerdown",this.onPointerDown),this.element.removeEventListener("mousedown",this.onPointerEvent),this.element.removeEventListener("mouseup",this.onPointerEvent),this.element.removeEventListener("pointercancel",this.onPointerEvent),this.element.removeEventListener("wheel",this.onWheelEvent),this.element.removeEventListener("touchstart",this.onTouchEvent),this.element.removeEventListener("touchcancel",this.onTouchEvent),this.element.removeEventListener("touchend",this.onTouchEvent),this.element.removeEventListener("touchmove",this.onTouchEvent),this.unsubscribe();for(let[e,n]of this.eventHandlers)this.element.removeEventListener(this.normalizeEventName(e),n)}};N(Fx,"eventPool",{atlas:{x:0,y:0}});var Dx=Fx;function Bx({interactive:t=!0,viewport:e,forceRefresh:n,canvasElement:r,overlayElement:s,controllerConfig:a,unstable_webglRenderer:c,dpi:d,debug:m,canvasBox:y=!0,polygon:h=!0,navigatorElement:v,runtimeOptions:E}){if(!r)throw new Error("Invalid container");r.style.userSelect="none";let T=t?Ox({minZoomFactor:.5,maxZoomFactor:3,enableClickToZoom:!1,parentElement:r,...a||{}}):void 0,P=new Ix([c?new ET(r,{dpi:d}):new cT(r,{dpi:d,debug:m,box:y,polygon:h}),s?new zx(s,{box:c||!y,text:!0,triggerResize:n}):void 0,v?new fT(v):void 0]),k=new nh(P,new th(1024,1024),e,T?[T]:[],E),R=new Dx(r,k);return{name:"default-preset",em:R,runtime:k,renderer:P,controller:T,canvas:r,navigator:v,unmount(){jg(k),k.stopControllers(),k.stop(),k.reset(),R&&R.stop()}}}var qo=1+Number.MIN_VALUE,kT=class{constructor(t,e){N(this,"container"),N(this,"width"),N(this,"height"),N(this,"pending",!0),N(this,"options"),N(this,"stylesheet"),N(this,"zIndex",0),N(this,"lastKnownScale",1),N(this,"rendererPosition"),N(this,"currentlyVisible",[]),N(this,"previouslyVisible",[]),this.container=t,this.rendererPosition=t.getBoundingClientRect();let{width:n,height:r}=this.rendererPosition;this.width=n,this.height=r,this.options={addPart:!1,setDraggableFalse:!1,imageClass:"",widthStylesheet:!1,sheetPrefix:"position-",background:"#000",...e||{}},this.stylesheet=new Nx({sheetPrefix:this.options.sheetPrefix}),this.container.classList.add(this.stylesheet.addStylesheet(`
        background: ${this.options.background};
      `)),this.options.widthStylesheet&&this.container.appendChild(this.stylesheet.getElement())}isReady(){return!0}resize(){this.rendererPosition=this.container.getBoundingClientRect(),this.width=this.rendererPosition.width,this.height=this.rendererPosition.height}getRendererScreenPosition(){return this.rendererPosition}afterFrame(t,e,n){this.stylesheet.updateSheet();for(let r of this.previouslyVisible)this.currentlyVisible.indexOf(r)===-1&&this.container.removeChild(r);for(let r of this.currentlyVisible)this.previouslyVisible.indexOf(r)===-1&&this.container.appendChild(r);this.previouslyVisible=this.currentlyVisible,this.currentlyVisible=[]}afterPaintLayer(t,e){}beforeFrame(t,e,n){this.stylesheet.clearClasses(),this.zIndex=0}getPointsAt(t,e,n,r){return t.getPointsAt(e,n,r)}getScale(t,e){if(Number.isNaN(t)||Number.isNaN(e))return this.lastKnownScale;let n=this.width/t,r=this.height/e,s=n<r?r:n;return Number.isNaN(s)||(this.lastKnownScale=s),this.lastKnownScale}getViewportBounds(t,e,n){return null}createImage(){let t=document.createElement("img");return this.options.imageClass?(t.className=this.options.imageClass,this.options.addPart&&t.setAttribute("part",this.options.imageClass)):(t.style.position="absolute",t.style.pointerEvents="none",t.style.userSelect="none"),this.options.setDraggableFalse&&t.setAttribute("draggable","false"),t}paint(t,e,n,r,s,a){if(this.pending=!1,this.zIndex++,t instanceof nl){if(!t.__host){let d=this.createImage();d.src=t.uri,t.__host=d,this.container.appendChild(t.__host)}let c=t.__host;this.currentlyVisible.push(c),c.style.zIndex=`${this.zIndex}`,c.style.opacity=`${t.style.opacity}`,this.options.widthStylesheet?c.className=this.options.imageClass+" "+this.stylesheet.addStylesheet(`width:${(s+qo).toFixed(2)}px;height:${(a+qo).toFixed(2)}px;`):(c.style.width=`${s+qo}px`,c.style.height=`${a+qo}px`),c.style.transform=`translate(${n}px, ${r}px)`}if(t instanceof Nc){if(t.__host||(t.__host={images:[]}),!t.__host.images[e]){let d=t.getImageUrl(e),m=this.createImage();m.src=d,t.__host.images[e]=m,this.container.appendChild(m)}let c=t.__host.images[e];c.style.zIndex=`${this.zIndex}`,c.style.opacity=`${t.style.opacity}`,this.currentlyVisible.push(c),this.options.widthStylesheet?c.className=this.options.imageClass+" "+this.stylesheet.addStylesheet(`width:${(s+qo).toFixed(2)}px;height:${(a+qo).toFixed(2)}px;`):(c.style.width=`${s+qo}px`,c.style.height=`${a+qo}px`),c.style.transform=`translate(${n}px, ${r}px)`}}pendingUpdate(){return this.pending}prepareLayer(t){}finishLayer(t){}reset(){}};function CT({interactive:t,viewport:e,forceRefresh:n,containerElement:r,overlayElement:s,controllerConfig:a}){if(!r)throw new Error("Invalid container");r.style.userSelect="none";let c=t?Ox({minZoomFactor:.5,maxZoomFactor:3,enableClickToZoom:!1,parentElement:r,...a||{}}):void 0,d=new kT(r,{addPart:!1,setDraggableFalse:!1,imageClass:"atlas-static-image"}),m=s?new Ix([d,new zx(s,{box:!0,text:!0,triggerResize:n})]):d,y=new nh(m,new th(1024,1024),e,c?[c]:[]),h=new Dx(r,y);return{name:"static-preset",em:h,runtime:y,renderer:m,controller:c,container:r,overlay:s,unmount(){jg(y),y.stopControllers(),y.stop(),h&&h.stop()}}}var TT={"default-preset":Bx,"static-preset":CT},bT={};function RT(t,e){let n=O.useRef(),r=O.useRef(),s=O.useRef(),a=O.useRef(),c=O.useRef({width:e.width,height:e.height,didUpdate:!0}),[d="default-preset",m=bT]=Array.isArray(t)?t||[]:[t],[y,h]=O.useState(null);O.useLayoutEffect(()=>{let E=r.current,T=a.current,P=n.current,k=s.current,R=(TT[d]||Bx)({containerElement:T,canvasElement:E,overlayElement:P,navigatorElement:k,viewport:c.current,dpi:window.devicePixelRatio||1,forceRefresh:e.forceRefresh,unstable_webglRenderer:e.unstable_webglRenderer,...m||{}});return h(R),()=>{R&&(R.unmount(),E&&(E.height=0,E.width=0),P&&(P.innerHTML=""),k&&(k.height=0,k.width=0))}},[d,m]);let v=O.useMemo(()=>({canvas:r,overlay:n,container:a,navigator:s}),[]);return[d,y,c,v]}function _T(t){return O.useMemo(()=>ug(t),t)}var vc=Xt.forwardRef((t,e)=>I.jsx("div",{...t,ref:e,part:t.className})),My=["brightness","contrast","grayscale","hueRotate","invert","saturate","sepia","blur"],IT=({htmlChildren:t,renderPreset:e,onCreated:n,mode:r="explore",resetWorldOnChange:s=!0,unstable_webglRenderer:a=!1,unstable_noReconciler:c=!1,hideInlineStyle:d=!1,controllerConfig:m,children:y,overlayStyle:h,containerStyle:v,enableNavigator:E,className:T,containerProps:P={},homePosition:k,homeOnResize:R,homeCover:_,background:M,runtimeOptions:L,debug:$,filters:F,...H})=>{let[se,oe]=O.useState(r),[me,K]=O.useState(!1),ge=O.useRef(!1),de=O.useMemo(()=>(typeof e=="string"&&(e=[e,{}]),$?e?[e[0],{debug:$,...e[1]||{}}]:["default-preset",{debug:$}]:e||"default-preset"),[e,$]),[we,le,Ie]=G0({scroll:!0}),Se=O.useRef(),Te=ze=>{Se.current=ze,we(ze)},[D,U,Q,B]=RT(de,{width:H.width,height:H.height,forceRefresh:Ie,unstable_webglRenderer:a}),[re,Re]=O.useState("");O.useEffect(()=>{oe(r)},[r]),O.useEffect(()=>{U&&U.em&&U.em.updateBounds()},[U,le]),O.useEffect(()=>{U?.runtime.setOptions(L||{})},[L]),O.useEffect(()=>{U&&U.runtime&&(U.runtime.mode=se),me&&U&&(U.ready=!0)},[U,me,se]),O.useEffect(()=>{U&&(_||(U.runtime.manualHomePosition=!!k,U.runtime.setHomePosition(k)))},[U,_,k]),O.useEffect(()=>{if(U){let ze=U.runtime;ze.resize(Q.current.width,H.width,Q.current.height,H.height),Q.current.width=H.width,Q.current.height=H.height,ze.updateNextFrame(),Q.current.didUpdate=!0}},[U,H.width,H.height]),O.useEffect(()=>{if(F&&U){let ze=U.runtime,be=!1;ze.hookOptions.enableFilters=!0;for(let ct of My)F[ct]?F[ct]!==U.runtime.hookOptions.filters[ct]&&(ze.hookOptions.filters[ct]=F[ct],be=!0):ze.hookOptions.filters[ct]&&(ze.hookOptions.filters[ct]=0,be=!0);be&&ze.updateNextFrame()}else if(U){let ze=U.runtime;for(let be of My)ze.hookOptions.filters[be]=0;ze.hookOptions.enableFilters=!1,ze.updateNextFrame()}},[U,F]),Ic(()=>{if(U&&(U.overlay&&(U.overlay.style.width=`${le.width}px`,U.overlay.style.height=`${le.height}px`),U.container&&(U.container.style.width=`${le.width}px`,U.container.style.height=`${le.height}px`),_)){let ze=U.runtime.world.width,be=U.runtime.world.height,ct=ze/be,An=Q.current.width,fr=Q.current.height,Mn=An/fr;if(ct>Mn){Mn=fr/An,U.runtime.manualHomePosition=!0;let En=(ze-be/Mn)/2;_==="start"&&(En=0),_==="end"&&(En=ze-be/Mn),U.runtime.setHomePosition({x:En,y:0,width:be/Mn,height:be})}else{let En=(be-ze/Mn)/2;_==="start"&&(En=0),_==="end"&&(En=be-ze/Mn),U.runtime.manualHomePosition=!0,U.runtime.setHomePosition({x:0,y:En,width:ze,height:ze/Mn})}R&&U.runtime.goHome({})}},[U,le.height,le.width,_]),Ic(()=>{let ze=()=>{if(U){let be=U.runtime;Q.current.width!==H.width&&Q.current.height!==H.height&&(be.resize(Q.current.width,H.width,Q.current.height,H.height),Q.current.width=H.width,Q.current.height=H.height,be.updateNextFrame(),Q.current.didUpdate=!0)}};return window.addEventListener("resize",ze),()=>window.removeEventListener("resize",ze)},[U,H.height,H.width]);let je={width:120},Le=()=>{if(U&&U.navigator){let ze=U.runtime.world.height,be=U.runtime.world.width,ct=window.devicePixelRatio||1,An=je.width,fr=je.width/be*ze;U.navigator.width=An*ct,U.navigator.height=fr*ct,U.navigator.style.width=An+"px",U.navigator.style.height=fr+"px"}};Ic(()=>{if(U){Le();let ze=U.runtime;return ze.world.addLayoutSubscriber(be=>{be==="recalculate-world-size"&&(Le(),ze.resize(Q.current.width,H.width,Q.current.height,H.height))})}return()=>{}},[U,H.width,H.height]);let De=O.useCallback(function(ze){let be=()=>{K(!0)};return O.useEffect(()=>{if(U){U.runtime.goHome();let ct=n&&n(U);return void(ct&&ct.then?ct.then(be):be())}else throw new Error("Invalid configuration - no runtime found")},[]),ze.children},[U]);O.useEffect(()=>{if(U){let ze=U.runtime;if(s)return ze.world.addLayoutSubscriber(be=>{be==="recalculate-world-size"&&ze.goHome()})}return()=>{}},[U,s]),O.useEffect(()=>U?U.runtime.registerHook("useBeforeFrame",()=>{if(Q.current.didUpdate&&U.canvas){let ze=window.devicePixelRatio||1,be=Q.current.width,ct=Q.current.height;U.canvas.width=be*ze,U.canvas.height=ct*ze,U.canvas.style.width=be+"px",U.canvas.style.height=ct+"px",U.canvas.getContext("2d")?.scale(ze,ze),U&&U.em&&U.em.updateBounds(),Q.current.didUpdate=!1}}):()=>{},[U,s]),O.useEffect(()=>{let ze=()=>{U&&(oe("sketch"),Re("mode-sketch")),window.removeEventListener("keyup",ze)},be=ct=>{if(ct.code==="Space"&&U&&U.runtime.mode==="sketch"){let An=ct.target?.tagName?.toLowerCase();if(An==="input"||An==="textarea"||ct.target?.isContentEditable)return;ct.preventDefault(),oe("explore"),Re("mode-explore"),window.addEventListener("keyup",ze)}};return window.addEventListener("keydown",be),()=>{window.removeEventListener("keydown",be),window.removeEventListener("keyup",ze)}},[U]),ge.current=!0;let{height:Je,width:it,...ut}=H,mt=_T([H.width,H.height]),ot=!0;return de&&Array.isArray(de)&&de.length>1&&de[1].interactive===!1&&(ot=!1),M=M??"#000",Se.current&&(M=getComputedStyle(Se.current).getPropertyValue("--atlas-background")||M),I.jsxs(vc,{ref:Te,className:["atlas",d?"":`atlas-width-${mt}`,re,T,`atlas-${D}`].filter(Boolean).join(" ").trim(),style:{...v,...d?{}:{width:H.width,height:H.height}},children:[D==="static-preset"?I.jsx(vc,{className:"atlas-static-container",ref:B.container,tabIndex:0,...P}):I.jsx("canvas",{className:"atlas-canvas",part:"atlas-canvas",tabIndex:0,...ut,...P,ref:B.canvas,"data-background":M}),I.jsx(vc,{className:["atlas-overlay",ot?"atlas-overlay--interactive":""].filter(Boolean).join(" ").trim(),style:{...h||{}},ref:B.overlay,children:c?I.jsx(De,{children:I.jsx(rh.Provider,{value:le,children:I.jsx(Wc.Provider,{value:se,children:I.jsx(Hc.Provider,{value:U,children:y})})})}):I.jsx(PT,{bounds:le,preset:U,mode:se,setIsReady:K,onCreated:n,children:y})}),E?I.jsx(vc,{className:"atlas-navigator",children:I.jsx("canvas",{className:"atlas-navigator-canvas",part:"atlas-navigator-canvas",ref:B.navigator})}):null,d?I.jsx("style",{children:`.atlas-width-${mt} { width: ${H.width}px; height: ${H.height}px; }`}):I.jsx("style",{children:`
        .atlas { position: relative; display: flex; background: ${M}; z-index: var(--atlas-z-index, 10); -webkit-touch-callout: none; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; }
        .atlas-width-${mt} { width: ${H.width}px; height: ${H.height}px; }
        .atlas-canvas { flex: 1 1 0px; }
        .atlas-canvas:focus, .atlas-static-container:focus { outline: none }
        .atlas-canvas:focus-visible, .atlas-canvas-container:focus-visible { outline: var(--atlas-focus, 2px solid darkorange) }
        .atlas-static-preset { touch-action: inherit; }
        .atlas-static-container { position: relative; overflow: hidden; flex: 1 1 0px; }
        .atlas-overlay { position: absolute; top: 0; left: 0; none; overflow: hidden; }
        /** setting the pointer events to none means that Atlas will own the touch and mousewheel events **/
        .atlas-overlay--interactive { pointer-events: none; }
        .atlas-static-image { position: absolute; user-select: none; transform-origin: 0px 0px; }
        .atlas-navigator { position: absolute; top: var(--atlas-navigator-top, 10px); right: var(--atlas-navigator-bottom, 10px); left: var(--atlas-navigator-left); bottom: var(--atlas-navigator-bottom); opacity: .8 }
        .atlas-navigator-canvas { width: 100%; }
      `}),t]})};function OT(t){return Number(t)==t?`${t}px`:t}var AT=({resizeHash:t,aspectRatio:e,containerProps:n={},...r})=>{let[s,a,c]=G0(),{height:d,width:m,...y}=r;O.useEffect(()=>{c()},[m,d,t,c]);let h=O.useMemo(()=>e?{width:a.width,height:a.width*(1/e)}:a,[a,e]);return I.jsxs(vc,{ref:s,className:"atlas-container",...n,children:[h.width?I.jsx(IT,{width:h.width||100,height:h.height||100,...y,children:r.children}):null,r.hideInlineStyle?null:I.jsx("style",{children:`
          .atlas-container { 
            display: var(--atlas-container-display, block);
            flex: var(--atlas-container-flex, none);
            width: var(--atlas-container-width, ${m?`${m}px`:"100%"});
            height: var(--atlas-container-height, ${OT(d||(e?h.height:512))})  
          }
      `}),r.htmlChildren]})},Lg=()=>O.useContext(Hc),ih=()=>{let t=Lg();return t?t.runtime:void 0},$x=(t,e=[])=>{let n=ih();O.useEffect(()=>n?n.registerHook("useFrame",t):()=>{},e)},MT=()=>{let t=Lg();return t&&t.canvas?t.canvas:void 0};function jT(){return O.useContext(rh)}async function LT(t,e,n){if(O.version.startsWith("18.")){let r=await uy(()=>Promise.resolve().then(()=>I1),void 0),s=r.default?r.default.createRoot:r.createRoot;n.current||(n.current=s(t)),n.current.render(e)}else if(typeof ReactDOM<"u"){let{render:r,unmountComponentAtNode:s}=ReactDOM;r(e,t),n.current={unmount(){s(t)}}}else{let r=await uy(()=>Promise.resolve().then(()=>uR),void 0),s=r.default?r.default.render:r.render,a=r.default?r.default.unmountComponentAtNode:r.unmountComponentAtNode;s(e,t),n.current={unmount(){a(t)}}}}var Xs=Xt.forwardRef(({children:t,...e},n)=>{let r=O.useRef(),s=ih(),a=O.useRef(0),c=O.useRef(),d=O.useRef();return $x(()=>{if(e.relative){let m=r.current;if(m&&s){let y=s.getScaleFactor();a.current!==y&&(a.current=y,m.style.transformOrigin="0 0",m.style.transform=`scale(${1/a.current})`,m.style.width=`${a.current*100}%`,m.style.height=`${a.current*100}%`,r.current&&c.current?.__owner.value?.rotation&&(m.style.transform=`scale(${1/a.current}) translate(50%, 50%) rotate(${c.current?.__owner.value?.rotation||0}deg)  translate(-50%, -50%)`))}}},[e.relative]),O.useLayoutEffect(()=>{let m=c.current;n&&m&&(typeof n=="function"?n(m):n.current=m);async function y(){if(m&&m.__host){let h=e.relative?I.jsx("div",{ref:r,children:t}):t;await LT(m.__host.element,h,d)}}m&&m.__host?y():m&&(m.__onCreate=y)},[n,t,c,e.relative]),O.useLayoutEffect(()=>()=>{d.current&&setTimeout(()=>{d.current.unmount()},0)},[]),I.jsx("box",{html:!0,...e,ref:c})});Xs.displayName="HTMLPortal";var jy=(t,e,n=[])=>{let r=ih(),s=r?r.world:void 0;O.useEffect(()=>{if(r){let a=e,c=hu[t];r.world.activatedEvents.push(c);let d=c.slice(2).toLowerCase();return r.world.addEventListener(d,a),()=>{r.world.removeEventListener(d,a)}}return()=>{}},[s,t,...n])};function Ly(t,e){if(t===0)return[0,1];if(e===0)return[1,0];let n=Math.abs(t)/Math.abs(e);return[n,1-n]}function NT(){let t=O.useRef({ctrl:!1,shift:!1,alt:!1});return O.useLayoutEffect(()=>{function e(r){r.key==="Shift"&&(t.current.shift=!0),r.key==="Control"&&(t.current.ctrl=!0),r.key==="Alt"&&(t.current.alt=!0)}function n(r){r.key==="Shift"&&(t.current.shift=!1),r.key==="Control"&&(t.current.ctrl=!1),r.key==="Alt"&&(t.current.alt=!1)}return window.addEventListener("keydown",e),window.addEventListener("keyup",n),()=>{window.removeEventListener("keydown",e),window.removeEventListener("keyup",n)}},[]),t}var zT=(t,e)=>{let n=gT(),r=ih(),s=jT(),a=O.useRef(),c=O.useRef(null),d=O.useRef(),[m,y]=O.useState(!1),h=O.useRef(!1),v=O.useRef({north:0,south:0,east:0,west:0}),E=NT(),T=O.useCallback(M=>L=>{if(h.current=!0,y(!0),s&&r){let{top:$,left:F}=s,H=r.viewerToWorld(L.pageX-F,L.pageY-$);d.current={x:H.x,y:H.y},a.current=M}},[s,r]),P=O.useMemo(()=>t.width/t.height,[t.width,t.height]),k=O.useCallback(M=>{if(!Math.abs(M.north-M.south+(M.east-M.west)))return;let L=-M.west+M.east,$=-M.north+M.south,F=t.width+L,H=t.height+$;if(F/H>=P){let se=H*P,oe=F-se,[me,K]=Ly(M.east,M.west);M.west=M.west+oe*K,M.east=M.east-oe*me}else{let se=F/P,oe=H-se,[me,K]=Ly(M.north,M.south);M.north=M.north+oe*me,M.south=M.south-oe*K}},[t.width,t.height,P]);$x(()=>{d&&r&&r.updateNextFrame()}),O.useEffect(()=>{r&&r.updateNextFrame()},[r,m]);let R=O.useCallback(M=>{if(!r||!s||r.mode!=="sketch")return;let{top:L,left:$}=s,F=r.viewerToWorld(M.pageX-$,M.pageY-L),H=c.current,se=!t.maintainAspectRatio&&E.current.alt,oe=!se&&E.current.shift&&a.current?.indexOf("-")!==-1;if((a.current==="translate"||a.current==="east"||a.current==="north-east"||a.current==="south-east")&&(v.current.east=F.x-(d.current?d.current.x:0),se&&(v.current.west=-v.current.east)),(a.current==="translate"||a.current==="west"||a.current==="north-west"||a.current==="south-west")&&(v.current.west=F.x-(d.current?d.current.x:0),se&&(v.current.east=-v.current.west)),(a.current==="translate"||a.current==="north"||a.current==="north-east"||a.current==="north-west")&&(v.current.north=F.y-(d.current?d.current.y:0),se&&(v.current.south=-v.current.north)),(a.current==="translate"||a.current==="south"||a.current==="south-west"||a.current==="south-east")&&(v.current.south=F.y-(d.current?d.current.y:0),se&&(v.current.north=-v.current.south)),(t.maintainAspectRatio||oe)&&k(v.current),H){let me=v.current.west,K=v.current.north,ge=t.width+v.current.east,de=t.height+v.current.south;H.points[1]=Math.min(me,ge),H.points[2]=Math.min(K,de),H.points[3]=Math.max(me,ge),H.points[4]=Math.max(K,de),r.updateNextFrame()}},[r,t.width,t.height,t.maintainAspectRatio,s]);jy("mousemove",R,[t.width,t.height,s]),jy("pointermove",R,[t.width,t.height,s]);let _=O.useRef();return O.useEffect(()=>{_.current=()=>{if(h.current){let M=v.current.west,L=v.current.north,$=t.width+v.current.east,F=t.height+v.current.south,H=Math.min(M,$),se=Math.min(L,F),oe=Math.max(M,$),me=Math.max(L,F),K={x:(t.x||0)+H,y:(t.y||0)+se,width:oe-H||1,height:me-se||1};t.maintainAspectRatio,e(K),a.current=void 0,d.current=void 0,v.current.east=0,v.current.west=0,v.current.north=0,v.current.south=0,h.current=!1,y(!1)}}},[e,t.height,t.width,t.x,t.y]),O.useEffect(()=>{let M=()=>{_.current&&_.current()};return window.addEventListener("pointerup",M),window.addEventListener("touchend",M),()=>{window.removeEventListener("pointerup",M),window.removeEventListener("touchend",M)}},[]),{portalRef:c,mode:n,mouseEvent:T,onPointerMoveCallback:R,isEditing:m}};function FT({handleSize:t,resizable:e,onSave:n,children:r,maintainAspectRatio:s,disableCardinalControls:a,...c}){let d=typeof t>"u"?s?10:8:t,{portalRef:m,mode:y,mouseEvent:h,isEditing:v}=zT({x:c.x||0,y:c.y||0,width:c.width,height:c.height,maintainAspectRatio:s},n),E=O.useMemo(()=>h("translate"),[h]),T=O.useMemo(()=>h("east"),[h]),P=O.useMemo(()=>h("west"),[h]),k=O.useMemo(()=>h("south"),[h]),R=O.useMemo(()=>h("north"),[h]),_=O.useMemo(()=>h("south-east"),[h]),M=O.useMemo(()=>h("south-west"),[h]),L=O.useMemo(()=>h("north-east"),[h]),$=O.useMemo(()=>h("north-west"),[h]),F=y==="sketch",H={zIndex:999,boxShadow:"0px 2px 3px 0 rgba(0,0,0,0.2)",border:"1px solid rgba(155,155,155,.7)",borderRadius:s||a?"50%":2,position:"absolute",background:"#fff",pointerEvents:v?"none":F?"initial":"none"};return I.jsx(I.Fragment,{children:I.jsxs("world-object",{...c,children:[r,F&&e?I.jsx(Xs,{ref:m,target:{x:0,y:0,height:c.height,width:c.width},relative:!0,interactive:!1,children:F&&e?I.jsxs(I.Fragment,{children:[I.jsx("div",{onMouseDown:E,onTouchStart:E,style:{display:"block",width:"100%",height:"100%",position:"relative",border:"1px solid rgba(155,155,155, .7)",boxSizing:"border-box",pointerEvents:v?"none":F?"initial":"none"}}),s?null:I.jsxs(I.Fragment,{children:[I.jsx("div",{title:"east",onTouchStart:T,onMouseDown:T,style:{...H,cursor:"e-resize",height:d*2,width:d,right:0,top:"50%",opacity:a?0:1,transform:`translate(${d/2}px, -${d}px)`}}),I.jsx("div",{title:"west",onMouseDown:P,style:{...H,cursor:"w-resize",position:"absolute",height:d*2,width:d,left:0,top:"50%",opacity:a?0:1,transform:`translate(-${d/2}px, -${d}px)`}}),I.jsx("div",{title:"north",onMouseDown:R,style:{...H,cursor:"n-resize",position:"absolute",height:d,width:d*2,left:"50%",top:0,opacity:a?0:1,transform:`translate(-${d}px, -${d/2}px)`}}),I.jsx("div",{title:"south",onMouseDown:k,style:{...H,cursor:"s-resize",position:"absolute",height:d,width:d*2,left:"50%",bottom:0,opacity:a?0:1,transform:`translate(-${d}px, ${d/2}px)`}})]}),I.jsx("div",{title:"north-east",onMouseDown:L,style:{...H,cursor:"ne-resize",position:"absolute",height:d,width:d,right:0,top:0,transform:`translate(${d/2}px, -${d/2}px)`}}),I.jsx("div",{title:"south-east",onMouseDown:_,style:{...H,cursor:"se-resize",position:"absolute",height:d,width:d,bottom:0,right:0,transform:`translate(${d/2}px, ${d/2}px)`}}),I.jsx("div",{title:"south-west",onMouseDown:M,style:{...H,cursor:"sw-resize",position:"absolute",height:d,width:d,bottom:0,left:0,transform:`translate(-${d/2}px, ${d/2}px)`}}),I.jsx("div",{title:"north-west",onMouseDown:$,style:{...H,cursor:"nw-resize",position:"absolute",height:d,width:d,top:0,left:0,transform:`translate(-${d/2}px, -${d/2}px)`}})]}):null}):null]})})}function DT({interactive:t,region:e,onClick:n,onSave:r,maintainAspectRatio:s,disableCardinalControls:a,isEditing:c,rotation:d,style:m={backgroundColor:"rgba(0,0,0,.5)"}}){let y=O.useCallback(h=>{r({id:e.id,x:e.x,y:e.y,height:e.height,width:e.width,...h})},[r,e.id,e.x,e.y,e.height,e.width]);return I.jsx(FT,{x:e.x,y:e.y,rotation:d,width:e.width,height:e.height,resizable:c,onSave:y,maintainAspectRatio:s,disableCardinalControls:a,children:I.jsx("box",{interactive:t,onContextMenu:h=>{h.preventDefault(),console.log("menu!")},onClick:h=>{h.preventDefault(),h.stopPropagation(),n(e)},target:{x:0,y:0,width:e.width,height:e.height},style:m})})}function Ny(t,e){return t?e?{...t,...e||{},":hover":t[":hover"]?Object.assign(t[":hover"]||{},e[":hover"]||{}):e[":hover"],":active":t[":active"]?Object.assign(t[":active"]||{},e[":active"]||{}):e[":hover"]}:t:e}function Vc(t){return{all:t=t||new Map,on:function(e,n){var r=t.get(e);r?r.push(n):t.set(e,[n])},off:function(e,n){var r=t.get(e);r&&(n?r.splice(r.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var r=t.get(e);r&&r.slice().map(function(s){s(n)}),(r=t.get("*"))&&r.slice().map(function(s){s(e,n)})}}}const BT=Vc(),Ux=O.createContext(BT);function $T(){return O.useContext(Ux)}function UT(t,e,n=[]){const r=O.useContext(Ux);O.useEffect(()=>{const s=a=>{e(a)};return r.on(t,s),()=>{r.off(t,s)}},[r,t,...n])}function WT(t){return{all:t=t||new Map,on:function(e,n){var r=t.get(e);r?r.push(n):t.set(e,[n])},off:function(e,n){var r=t.get(e);r&&(n?r.splice(r.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var r=t.get(e);r&&r.slice().map(function(s){s(n)}),(r=t.get("*"))&&r.slice().map(function(s){s(e,n)})}}}function HT(t,e,n){let[r,s]=t,[a,c]=e,[d,m]=n,y=d-a,h=m-c,v=Math.sqrt(y*y+h*h);if(v===0)return{distance:Math.sqrt((r-a)**2+(s-c)**2),closestPoint:[a,c]};let E=Math.max(0,Math.min(1,((r-a)*y+(s-c)*h)/(v*v))),T=a+E*y,P=c+E*h,k=[T,P];return{distance:Math.sqrt((r-T)**2+(s-P)**2),closestPoint:k}}function VT(t,e,n,r){let[s,a]=t,[c,d]=e,[m,y]=n,[h,v]=r,E=(s-c)*(y-v)-(a-d)*(m-h);if(Math.abs(E)<1e-10)return null;let T=((s-m)*(y-v)-(a-y)*(m-h))/E,P=-((s-c)*(a-y)-(a-d)*(s-m))/E;if(T>=0&&T<=1&&P>=0&&P<=1){let k=s+T*(c-s),R=a+T*(d-a);return[k,R]}return null}function qT(t,e,n){let r=e.snapThreshold||15,s=[],[a,c]=t,d=e.polygon.points,m=e.slowState.transitionIntentType==="move-point";if(e.slowState.snapToPoints)for(let y=0;y<d.length;y++){if(m&&e.selectedPoints.includes(y))continue;let h=d[y];if(h[0]===a&&h[1]===c)continue;let v=h[0]-a,E=h[1]-c,T=Math.sqrt(v*v+E*E);T<=r&&s.push({type:"point",point:[h[0],h[1]],source:{pointIndex:y,polygon:e.polygon},distance:T})}if(e.slowState.snapToLines)for(let y=0;y<d.length;y++){if(m&&e.selectedPoints.includes(y))continue;let h=(y+1)%d.length;if(y===h)continue;let v=d[y],E=d[h],{distance:T,closestPoint:P}=HT(t,v,E);T<=r&&s.push({type:"line",point:P,source:{lineIndex:y,polygon:e.polygon},distance:T})}if(e.slowState.snapToIntersections&&d.length>=4)for(let y=0;y<d.length;y++){if(m&&e.selectedPoints.includes(y))continue;let h=(y+1)%d.length,v=d[y],E=d[h];for(let T=y+2;T<d.length;T++){if(m&&e.selectedPoints.includes(T))continue;let P=(T+1)%d.length;if(T===h||P===y)continue;let k=d[T],R=d[P],_=VT(v,E,k,R);if(_){let[M,L]=_,$=Math.sqrt((a-M)**2+(c-L)**2);$<=r&&s.push({type:"intersection",point:_,source:{lineIndex:y,polygon:e.polygon},distance:$})}}}if(e.slowState.snapToParallel)for(let y=0;y<d.length;y++){if(m&&e.selectedPoints.includes(y))continue;let h=d[y],[v,E]=h,T=Math.abs(c-E);T<=r&&s.push({type:"parallel",point:[a,E],source:{pointIndex:y,polygon:e.polygon},distance:T});let P=Math.abs(a-v);P<=r&&s.push({type:"parallel",point:[v,c],source:{pointIndex:y,polygon:e.polygon},distance:P})}return s.sort((y,h)=>y.distance-h.distance)}function QT(t){return t.sort((e,n)=>{let r=e.type==="point"?0:e.type==="intersection"?1:e.type==="parallel"?2:3,s=n.type==="point"?0:n.type==="intersection"?1:n.type==="parallel"?2:3;return r!==s?r-s:e.distance-n.distance})}function XT(t,e){let n=[];for(let r of t)switch(r.type){case"point":n.push({type:"point",points:[r.point],target:r});break;case"line":if(r.source?.lineIndex!==void 0){let s=e.polygon.points,a=r.source.lineIndex,c=(a+1)%s.length,d=s[a],m=s[c];n.push({type:"line",points:[d,m,r.point],target:r})}else n.push({type:"point",points:[r.point],target:r});break;case"intersection":n.push({type:"cross",points:[r.point],target:r});break;case"parallel":if(r.source?.pointIndex!==void 0){let s=e.polygon.points[r.source.pointIndex];n.push({type:"parallel-line",points:[s,r.point],target:r})}break}return n}function Jo(t,e,n=5,r){if(!e.slowState.snapEnabled)return e.snapTargets=[],e.activeSnapGuides=[],e.isSnapping=!1,e.snapPoint=null,null;let s=qT(t,e);if(s.length===0)return e.snapTargets=[],e.activeSnapGuides=[],e.isSnapping=!1,e.snapPoint=null,null;let a=QT(s);return e.snapTargets=a,e.activeSnapGuides=XT(a.slice(0,n),e),e.isSnapping=!0,e.snapPoint=a[0].point,e.snapPoint}function Wx(t){t.snapTargets=[],t.activeSnapGuides=[],t.isSnapping=!1,t.snapPoint=null}function YT(t){return t.isSnapping&&t.snapPoint!==null}function qc(t,e){return YT(e)&&e.snapPoint?e.snapPoint:t}var KT={type:"add-open-point",label:"Add point",tools:["pen","line","lineBox"],trigger:{type:"click"},isValid(t,e,n){if(!e.isOpen)return!1;if(e.polygon.points.length===0)return!0;if(e.selectedPoints.length!==1||e.polygon.points.length>=2&&(e.slowState.currentTool==="line"||e.slowState.currentTool==="lineBox"))return!1;if(e.slowState.bounds){let{x:s,y:a,width:c,height:d}=e.slowState.bounds,[m,y]=t[0];if(m<s||m>s+c||y<a||y>a+d)return!1}let r=e.selectedPoints[0];return r===0||r===e.polygon.points.length-1},commit(t,e,n){let r=e.line?e.line[1]:t[0];!n.Shift&&e.slowState.snapEnabled&&(Jo(r,e,3),r=qc(r,e));let s=e.polygon.points;if(s.length===0)return{selectedPoints:[0],points:[r]};n.Shift;let a=e.selectedPoints[0],c=e.slowState.currentTool==="line"||e.slowState.currentTool==="lineBox";if(a===0)return~~s[0][0]===~~r[0]&&~~s[0][1]===~~r[1]?{selectedPoints:[0],points:s}:{selectedPoints:c?[]:[0],points:[r,...s]};let d=s[s.length-1];return~~d[0]===~~r[0]&&~~d[1]===~~r[1]?{selectedPoints:[s.length-1],points:s}:(e.line=null,{selectedPoints:c?[]:[s.length],points:[...s,r]})}};function zy(t,e){return Math.abs(t-e)}function Qr(t,e){let n=zy(t[0],e[0]),r=zy(t[1],e[1]);return Math.sqrt(n**2+r**2)}function cg(t,e){return[t[0]-e[0],t[1]-e[1]]}function GT(t,e){return t[0]*e[0]+t[1]*e[1]}function Hx(t){return t[0]*t[0]+t[1]*t[1]}function vd(t,e){return Hx(cg(t,e))}function Vx(t,e,n,r){return r&&n&&(t<0?t=Math.max(t,-r.x-n.x):t>0&&(t=Math.min(t,r.x+r.width-n.x-n.width)),e<0?e=Math.max(e,-r.y-n.y):e>0&&(e=Math.min(e,r.y+r.height-n.y-n.height))),[t,e]}function qx(t,e){let n,r,s,a;var c=(P,k,R,_,M)=>{if(_<=R+1)return;let L=R,$=0,F=P*P;n=[k[R],k[_]],r=cg(n[1],n[0]);let H=Hx(r),se,oe,me,K,ge;for(let de=R+1;de<_;de++)se=cg(k[de],n[0]),K=GT(se,r),K<=0?ge=vd(k[de],n[0]):H<=K?ge=vd(k[de],n[1]):(me=K/H,oe=[n[0][0]+me*r[0],n[0][1]+me*r[1]],ge=vd(k[de],oe)),!(ge<=$)&&(L=de,$=ge);$>F&&(M[L]=1,c(P,k,R,L,M),c(P,k,L,_,M))};let d=t.length,m=[],y,h,v,E,T=e*e;for(s=[],a=[],s[0]=t[0],y=h=1,E=0;y<d;y++)vd(t[y],t[E])<T||(s[h++]=t[y],E=y);for(E<d-1&&(s[h++]=t[d-1]),a[0]=a[h-1]=1,c(e,s,0,h-1,a),y=v=0;y<h;y++)a[y]&&(m[v++]=s[y]);return m}function ZT(t){if(t.length!==4)return!1;let e=1e-10,n=Math.min(...t.map(d=>d[0])),r=Math.max(...t.map(d=>d[0])),s=Math.min(...t.map(d=>d[1])),a=Math.max(...t.map(d=>d[1]));for(let d of t){let m=Math.abs(d[0]-n)<e||Math.abs(d[0]-r)<e,y=Math.abs(d[1]-s)<e||Math.abs(d[1]-a)<e;if(!m||!y)return!1}let c=[[n,s],[n,a],[r,s],[r,a]];for(let d of c)if(!t.some(m=>Math.abs(m[0]-d[0])<e&&Math.abs(m[1]-d[1])<e))return!1;return!0}function Qx(t){let e=t.points.length,n=!1,r=[];if(e>1){t.iedges=[];let s=t.points[e-1];for(let a=0;a<e;a++){let c=s;if(s=t.points[a],s.length===6){let y=s[2],h=s[3],v=s[4],E=s[5];r.push([a,[s[0]+y,s[1]+h],[s[0]+v,s[1]+E]]),n=!0}let d=[s[0]-c[0],s[1]-c[1]],m=d[0]*d[0]+d[1]*d[1];m>0?t.iedges.push([d[0]/m,d[1]/m]):t.iedges.push([0,0])}}else e===1?t.iedges=[[0,0]]:t.iedges=null;t.isBezier=n,t.bezierLines=r}function JT(t,e){let n=1/0,r=null,s=-1,a=t.points.length;if(a<=1)return[null,n,s];let c=t.points[a-1];for(let d=0;d<a;d++){let m=c;c=t.points[d];let y=m[0]-e[0],h=m[1]-e[1],v=y*y+h*h;v<n&&(r=m,n=v,s=d===0?a-1:d-1)}return[r,n,s]}function jd(t){if(t.points.length>2){let e=Math.min(...t.points.map(a=>a[0])),n=Math.min(...t.points.map(a=>a[1])),r=Math.max(0,...t.points.map(a=>a[0])),s=Math.max(0,...t.points.map(a=>a[1]));t.boundingBox={x:e,y:n,width:r-e,height:s-n};return}t.boundingBox=null}function e2(t){return t[0]*t[0]+t[1]*t[1]}function Fy(t,e){let n=1/0,r=null,s=-1,a=[],c=t.points.length;if(c<=1)return[null,n,a,s];if(t.iedges===null&&(Qx(t),!t.iedges))return[null,n,a,s];let d=t.points[c-1];for(let m=0;m<c;m++){let y=d;d=t.points[m];let h=(e[0]-y[0])*t.iedges[m][0]+(e[1]-y[1])*t.iedges[m][1],v;h<=0?v=y:h<1?v=[(1-h)*y[0]+h*d[0],(1-h)*y[1]+h*d[1]]:v=d;let E=e2([v[0]-e[0],v[1]-e[1]]);E<n&&(r=v,n=E,a=[y,d],s=m===0?c-1:m-1)}return[r,n,a,s]}var xc={type:"bounding-box-corners",label:"Drag to resize",tools:["pointer","box"],modifiers:{Shift:"Maintain aspect ratio",Alt:"Scale from center",Meta:"Rotate"},isValid(t,e,n){if(e.transitionDirection=null,e.transitionRotate=!1,e.isOpen||!e.slowState.boxMode&&e.selectedPoints.length!==e.polygon.points.length||!e.polygon.boundingBox)return!1;let r=n.proximity*.5,s=n.proximity*5,a=t[0],c=e.polygon.boundingBox,d=c.x+r,m=c.x+c.width-r*2,y=c.y+r,h=c.y+c.height-r*2;if(a[0]>d&&a[0]<m&&a[1]>y&&a[1]<h)return!1;let v=[c.x+c.width,c.y+c.height],E=[c.x,c.y],T=[c.x+c.width,c.y],P=[c.x,c.y+c.height],k=["ne","nw","se","sw"],R={ne:T,nw:E,se:v,sw:P},_=[Qr(t[0],T),Qr(t[0],E),Qr(t[0],v),Qr(t[0],P)],M=Math.min(..._),L=_.indexOf(M),$=L===-1?null:k[L],F=$?R[$]:null;if(_[0]<s||_[1]<s||_[2]<s||_[3]<s){if($){let[H,se]=a;(n.Meta||H>=F[0]-n.proximity*4&&se>=F[1]-n.proximity*4&&H<=F[0]+n.proximity*4&&se<=F[1]+n.proximity*4&&!(H>=F[0]-n.proximity*2&&se>=F[1]-n.proximity*2&&H<=F[0]+n.proximity*2&&se<=F[1]+n.proximity*2))&&(e.slowState.boxMode||(e.transitionRotate=!0)),e.transitionDirection=$}return!0}return!1},start(t,e,n){t[0];let r=e.polygon.boundingBox,s=[r.x+r.width,r.y+r.height],a=[r.x,r.y],c=[r.x+r.width,r.y],d=[r.x,r.y+r.height],m=["ne","nw","se","sw"],y=[Qr(t[0],c),Qr(t[0],a),Qr(t[0],s),Qr(t[0],d)],h=Math.min(...y),v=y.indexOf(h);e.transitionDirection=v!==-1?m[v]:null},transition(t,e,n){let r=e.polygon.boundingBox,s=e.transitionOrigin||t[0],[a,c]=t[0];if((n.Meta||e.transitionRotate)&&!e.slowState.boxMode){let M=[r.x+r.width/2,r.y+r.height/2],L=Math.atan2(s[1]-M[1],s[0]-M[0]),$=Math.atan2(c-M[1],a-M[0]),F=n.Shift,H=Math.PI/(n.Alt?4:12),se=$-L;F&&(se=Math.round(se/H)*H);let oe=Math.cos(se),me=Math.sin(se),K=[];for(let ge of e.polygon.points){let de=ge[0]-M[0],we=ge[1]-M[1],le=de*oe-we*me,Ie=de*me+we*oe,Se=le+M[0],Te=Ie+M[1];K.push(ge.length===6?[Se,Te,ge[2],ge[3],ge[4],ge[5]]:[Se,Te])}e.transitionPoints=K,jd({points:K,boundingBox:null}),e.transitionBoundingBox=e.polygon.boundingBox?{...e.polygon.boundingBox,rotation:se}:null;return}let d=e.transitionDirection,m=d.includes("e")?1:-1,y=d.includes("s")?1:-1,h=!!n.Alt,v;if(h)v=[r.x+r.width/2,r.y+r.height/2];else switch(d){case"se":v=[r.x,r.y];break;case"sw":v=[r.x+r.width,r.y];break;case"ne":v=[r.x,r.y+r.height];break;case"nw":v=[r.x+r.width,r.y+r.height];break}let E=h?r.width/2:r.width,T=h?r.height/2:r.height,P,k;if(n.Shift||e.slowState.fixedAspectRatio){let M=m*E,L=y*T,$=a-v[0],F=c-v[1],H=M*M+L*L,se=H>0?($*M+F*L)/H:1;se=Math.max(se,.01),P=se,k=se}else{let M=0,L=0;switch(d){case"se":M=a-s[0],L=c-s[1];break;case"sw":M=s[0]-a,L=c-s[1];break;case"ne":M=a-s[0],L=s[1]-c;break;case"nw":M=s[0]-a,L=s[1]-c;break}h&&(M*=2,L*=2),P=(r.width+M)/r.width,k=(r.height+L)/r.height}let R=[];for(let M of e.polygon.points){let L=M[0]-v[0],$=M[1]-v[1],F=L*P,H=$*k,se=F+v[0],oe=H+v[1];R.push(M.length===6?[se,oe,M[2],M[3],M[4],M[5]]:[se,oe])}e.transitionPoints=R;let _={points:R,boundingBox:null};jd(_),e.transitionBoundingBox=_.boundingBox},commit(t,e,n){let r=e.transitionPoints;return e.transitionPoints=null,e.transitionBoundingBox=null,e.transitionRotate=!1,{points:r}}},t2={type:"close-line-box",label:"Close Line Box",tools:["lineBox"],trigger:{type:"click"},isValid(t,e,n){return e.polygon.points.length===2&&e.lineBox!==null&&e.slowState.boxMode===!1},commit(t,e,n){return e.lineBox?{isOpen:!1,points:e.lineBox,tool:"pen"}:{}}},Xx={type:"close-shape",label:"Close shape",tools:["pen","line"],trigger:{type:"click"},isValid(t,e,n){if(!e.isOpen||e.slowState.boxMode||e.selectedPoints.length!==1||e.polygon.points.length<2||n.Meta)return!1;let r=e.selectedPoints[0];if(r===0){let s=e.polygon.points[e.polygon.points.length-1];return Qr(t[0],s)<n.proximity}if(r===e.polygon.points.length-1){let s=e.polygon.points[0];return Qr(t[0],s)<n.proximity}return!1},commit(t,e,n){let r=e.selectedPoints[0];if(e.line=null,r===0)return{selectedPoints:[],points:e.polygon.points.slice(0).reverse(),isOpen:!1};if(r===e.polygon.points.length-1)return{selectedPoints:[],isOpen:!1}}},n2={type:"close-shape-line",label:"Close shape line",trigger:{type:"click"},tools:["pen"],isValid(t,e,n){return!e.isOpen||e.slowState.boxMode||e.polygon.points.length<3||!e.closestLinePoint||e.closestLineDistance>=n.proximity*2?!1:(e.closestLineIndex===0||(e.closestLineIndex,e.polygon.points.length-2),!0)},commit(t,e,n){return Xx.commit(t,e,n)}},Yx={type:"split-line",label:"Split line",tools:["pen"],isValid(t,e,n){let r=e.slowState.currentTool==="line";return n.Meta||r?!1:!!(e.closestLinePoint&&e.closestLineDistance<n.proximity)},transition(t,e,n){let r=t[0];!n.Shift&&e.slowState.snapEnabled&&(Jo(r,e,3,e.closestLineIndex),r=qc(r,e));let s=e.transitionOrigin||r,[a,c]=r,d=e.polygon.points,m=[],y=a-s[0],h=c-s[1];for(let v=0;v<d.length;v++)if(m.push(d[v]),e.closestLineIndex===v){let E=e.closestLinePoint;m.push([E[0]+y,E[1]+h])}e.transitionPoints=m},commit(t,e,n){let r=e.transitionPoints;return e.transitionPoints=null,e.transitionBoundingBox=null,{selectedPoints:[e.closestLineIndex+1],points:r}}},r2={type:"cut-line",label:"Add new point",tools:["pen"],trigger:{type:"click"},modifiers:{Shift:"Cut line"},isValid(t,e,n){return e.slowState.boxMode?!1:Yx.isValid(t,e,n)},commit(t,e,n){if(n.Shift&&!e.isOpen){let a=e.polygon.points,c=[],d=[],m=!1;for(let y=0;y<a.length;y++)m?d.push(a[y]):c.push(a[y]),e.closestLineIndex===y&&(m=!0);return{isOpen:!0,points:[...d,...c]}}let r=e.polygon.points,s=[];for(let a=0;a<r.length;a++)if(s.push(r[a]),e.closestLineIndex===a){let c=e.closestLinePoint;s.push(c)}return{points:s}}},i2={type:"delete-point",label:"Delete point",tools:["pointer","pen","lineBox","line"],trigger:{type:"key",key:"Backspace"},isValid(t,e,n){return e.selectedPoints.length>0&&e.slowState.canDelete},commit(t,e,n){let r=e.polygon.points.filter((s,a)=>!e.selectedPoints.includes(a));return{isOpen:r.length<3,selectedPoints:[],points:r,tool:e.slowState.boxMode?"box":void 0}}},s2={type:"deselect-bounding-box",label:"Deselect bounding box",tools:["pointer"],trigger:{type:"click"},isValid(t,e,n){return e.slowState.canDeselect&&!e.isOpen&&!e.slowState.boxMode&&e.selectedPoints.length>2&&e.selectedPoints.length===e.polygon.points.length},commit(t,e,n){return e.slowState.lastCreationTool==="pen"?{selectedPoints:[],tool:"pen"}:{selectedPoints:[]}}},o2={type:"deselect-draw",label:"Deselect draw",trigger:{type:"key",key:"Escape"},tools:["pointer","pen","box","lineBox","stamp","hand","pencil"],isValid(t,e,n){return e.slowState.canDeselect},commit(t,e,n){return{selectedPoints:[]}}},l2={type:"deselect-points",label:"Deselect points",trigger:{type:"click"},tools:["pointer","pen"],isValid(t,e,n){return e.selectedPoints.length>0&&e.slowState.canDeselect},commit(t,e,n){return{selectedPoints:[]}}},a2={type:"draw-shape",label:"Draw shape",tools:["pen","pencil"],modifiers:{Alt:"Freehand drawing"},isValid(t,e,n){let r=n.Alt||e.slowState.currentTool==="pencil";return!!(e.isOpen&&(e.line||e.polygon.points.length===0)&&r)},start(t,e,n){e.transitionDraw=[]},transition(t,e,n){let r=t[0];!n.Shift&&e.slowState.snapEnabled&&(Jo(r,e,3),r=qc(r,e)),e.transitionDraw.push(r)},commit(t,e,n){let r=e.slowState.currentTool==="pencil"?e.scale*1.5:e.scale*3,s=qx(e.transitionDraw,r);if(e.transitionDraw=[],s.length===0)return;let a=!0,c=3,d=e.selectedPoints[0],m=[...e.polygon.points,...s],y=m[0],h=m[m.length-1];d===0&&(y=m[m.length-1],h=m[0],m=[...s,...e.polygon.points.slice(0).reverse()]);let v=[m.length-1],E=Qr(y,h)/n.proximity<c,T="";return E&&(a=!1,T="pointer",v=m.map((P,k)=>k)),{isOpen:a,tool:T||void 0,points:m,selectedPoints:v}}},u2={type:"move-line",label:"Move line",tools:["line"],isValid(t,e,n){return e.slowState.currentTool!=="line"||e.slowState.boxMode?!1:!!(e.closestLinePoint&&e.closestLineDistance<n.proximity)},transition(t,e){let n=e.transitionOrigin,r=e.polygon.boundingBox,s=t[0],[a,c]=Vx(s[0]-n[0],s[1]-n[1],r,e.slowState.bounds);e.transitionPoints=e.polygon.points.map(d=>d.length===6?[d[0]+a,d[1]+c,d[2],d[3],d[4],d[5]]:[d[0]+a,d[1]+c])},commit(t,e,n){let r=e.transitionPoints;return e.transitionPoints=null,e.transitionBoundingBox=null,{points:r}}},c2={type:"move-point",label:"Move point",tools:["pointer","pen","line"],modifiers:{Shift:"Constrain to axis"},isValid(t,e,n){if(n.Alt)return!1;let r=n.proximity,[s,a]=t[0],c=e.polygon.points;e.selectedPoints;for(let d=0;d<c.length;d++){let m=c[d],y=m[0]-s,h=m[1]-a;if(y*y+h*h<r*r)return!0}return!1},start(t,e,n){if(e.slowState.boxMode)return xc.start?xc.start(t,e,n):void 0;if(e.selectedPoints.length<2){let[r,s,a]=JT(e.polygon,t[0]);return{selectedPoints:[a]}}if(e.slowState.closestPoint&&!e.selectedPoints.includes(e.slowState.closestPoint))return{selectedPoints:[e.slowState.closestPoint]}},transition(t,e,n){if(e.slowState.boxMode)return xc.transition(t,e,n);let r=e.transitionOrigin,s=t[0];!n.Shift&&e.slowState.snapEnabled&&(Jo(s,e,3),s=qc(s,e));let[a,c]=s,d=e.polygon.points,m=e.selectedPoints;if(e.slowState.closestPoint){let E=e.slowState.closestPoint;m.indexOf(E)===-1&&(m=[E])}let y=[],h=a-r[0],v=c-r[1];n.Shift&&!e.slowState.snapEnabled&&(Math.abs(h)>Math.abs(v)?v=0:h=0);for(let E=0;E<d.length;E++){let T=m.indexOf(E)!==-1,P=d[E];T?P.length===6?y.push([P[0]+h,P[1]+v,P[2],P[3],P[4],P[5]]):y.push([P[0]+h,P[1]+v]):y.push(P)}e.transitionPoints=y},commit(t,e,n){if(e.slowState.boxMode)return xc.commit(t,e,n);let r=e.transitionPoints;return e.transitionPoints=null,e.transitionBoundingBox=null,{points:r}}},Kx={type:"move-bounding-box",label:"Move bounding box",tools:["pointer"],isValid(t,e,n){let r=e.polygon.points.length,s=r===e.selectedPoints.length,a=e.polygon.boundingBox;if(r<1||!s||!a)return!1;let c=t[0],d=c[0],m=c[1];return d>=a.x&&d<=a.x+a.width&&m>=a.y&&m<=a.y+a.height},transition(t,e,n){let r=e.slowState.bounds,s=e.transitionOrigin,a=e.polygon.boundingBox,c=t[0],[d,m]=Vx(c[0]-s[0],c[1]-s[1],a,r);e.transitionPoints=e.polygon.points.map(y=>y.length===6?[y[0]+d,y[1]+m,y[2],y[3],y[4],y[5]]:[y[0]+d,y[1]+m]),a&&(e.transitionBoundingBox={x:a.x+d,y:a.y+m,width:a.width,height:a.height})},commit(t,e,n){let r=e.transitionPoints;return e.transitionPoints=null,e.transitionBoundingBox=null,{points:r}}},Gx={type:"move-shape",label:"Move shape",tools:["pointer","hand","box"],isValid(t,e,n){return n.Shift?!1:e.slowState.pointerInsideShape&&(!e.isOpen||e.line===null)},transition(t,e,n){Kx.transition(t,e,n)},commit(t,e,n){let r=e.transitionPoints;return e.transitionPoints=null,e.transitionBoundingBox=null,{points:r}}},f2={type:"nudge-right",label:"Nudge right",trigger:{type:"key",key:"ArrowRight"},tools:["pointer","pen"],modifiers:{Shift:"Nudge right more"},isValid(t,e,n){return e.selectedPoints.length>0},commit(t,e,n){let r=n.proximity*.3,s=e.polygon.points,a=e.selectedPoints;return{points:s.map((c,d)=>a.includes(d)?[c[0]+(n.Shift?4*r:1),c[1]]:c)}}},d2={type:"nudge-left",label:"Nudge left",trigger:{type:"key",key:"ArrowLeft"},tools:["pointer","pen"],modifiers:{Shift:"Nudge left more"},isValid(t,e,n){return e.selectedPoints.length>0},commit(t,e,n){let r=n.proximity*.3,s=e.polygon.points,a=e.selectedPoints;return{points:s.map((c,d)=>a.includes(d)?[Math.max(0,c[0]-(n.Shift?4*r:1)),c[1]]:c)}}},h2={type:"nudge-up",label:"Nudge up",trigger:{type:"key",key:"ArrowUp"},tools:["pointer","pen"],modifiers:{Shift:"Nudge up more"},isValid(t,e,n){return e.selectedPoints.length>0},commit(t,e,n){let r=n.proximity*.3,s=e.polygon.points,a=e.selectedPoints;return{points:s.map((c,d)=>{if(a.includes(d)){let m=c[0],y=Math.max(0,c[1]-(n.Shift?4*r:1));return c.length===6?[m,y,c[2],c[3],c[4],c[5]]:[m,y]}return c})}}},p2={type:"nudge-down",label:"Nudge down",trigger:{type:"key",key:"ArrowDown"},tools:["pointer","pen"],modifiers:{Shift:"Nudge down more"},isValid(t,e,n){return e.selectedPoints.length>0},commit(t,e,n){let r=n.proximity*.3,s=e.polygon.points,a=e.selectedPoints;return{points:s.map((c,d)=>{let m=c[0],y=Math.max(0,c[1]+(n.Shift?4*r:1));return a.includes(d)?c.length===6?[m,y,c[2],c[3],c[4],c[5]]:[m,y]:c})}}},g2={type:"select-multiple-points",label:"Drag to select multiple points",tools:["pointer","pen"],isValid(t,e,n){return e.slowState.currentTool==="line"&&e.polygon.points.length>=2?!0:!(e.slowState.boxMode||e.line)},transition(t,e,n){if(!e.transitionOrigin)return;let r=e.transitionOrigin[0],s=e.transitionOrigin[1],a=t[0][0],c=t[0][1],d=Math.min(r,a),m=Math.min(s,c),y=Math.abs(r-a),h=Math.abs(s-c);e.selectionBox={x:d,y:m,width:y,height:h}},commit(t,e,n){if(e.selectionBox){let r=[];n.Shift&&r.push(...e.selectedPoints);for(let s=0;s<e.polygon.points.length;s++){let a=e.polygon.points[s];a[0]>=e.selectionBox.x&&a[0]<=e.selectionBox.x+e.selectionBox.width&&a[1]>=e.selectionBox.y&&a[1]<=e.selectionBox.y+e.selectionBox.height&&r.push(s)}return{selectedPoints:r}}}},Dy=10,m2={type:"select-point",label:"Select point",trigger:{type:"click"},tools:["pointer","pen","line"],modifiers:{Shift:"Add to selection"},isValid(t,e,n){let r=-1;if(e.selectedPoints.length===1){let d=e.selectedPoints[0];d===0&&(r=e.polygon.points.length-1),d===e.polygon.points.length-1&&(r=0)}if(e.slowState.boxMode)return!1;let[s,a]=t[0],c=e.polygon.points;for(let d=0;d<c.length;d++){let m=c[d],y=m[0]-s,h=m[1]-a;if(y*y+h*h<Dy*Dy)return r!==d}return!1},commit(t,e,n){let r=n.Shift?[...e.selectedPoints]:[],[s,a]=t[0],c=e.polygon.points.map((d,m)=>{let y=d[0]-s,h=d[1]-a;return[y*y+h*h,m]}).sort((d,m)=>d[0]-m[0])[0];if(e.line=null,!r.includes(c[1]))r.push(c[1]);else if(n.Shift)return{selectedPoints:r.filter(d=>d!==c[1])};return{selectedPoints:r}}},y2={type:"select-shape",label:"Select shape",trigger:{type:"click"},tools:["pointer","pen"],isValid(t,e,n){return Gx.isValid(t,e,n)},commit(t,e,n){return{tool:"pointer",selectedPoints:e.polygon.points.map((r,s)=>s)}}},v2={type:"snap",label:"Smart snap",tools:["pointer","pen","line"],modifiers:{Shift:"Disable snapping"},isValid(t,e,n){return n.Shift||!e.slowState.snapEnabled||e.slowState.transitioning&&e.slowState.transitionIntentType!=="snap"||!e.slowState.snapToPoints&&!e.slowState.snapToLines&&!e.slowState.snapToIntersections?!1:Jo(t[0],e,0)!==null},start(t,e,n){Jo(t[0],e,5)},transition(t,e,n){let r=Jo(t[0],e,5);r&&(e.pointer=r)},commit(t,e,n){Wx(e)}},x2={type:"stamp-fixed-size-shape",label:"Stamp fixed size shape",trigger:{type:"click"},tools:["stamp"],isValid(t,e,n){return e.slowState.selectedStamp!==null},commit(t,e,n){let r=t[0],s=e.slowState.selectedStamp;if(!r||!s)return;let a=r[0],c=r[1],d=[],m=Math.min(...s.points.map(P=>P[0])),y=Math.min(...s.points.map(P=>P[1])),h=Math.max(...s.points.map(P=>P[0]))-m,v=Math.max(...s.points.map(P=>P[1]))-y,E=4*n.proximity,T=h/E;v/E>T&&(T=v/E),a-=h/T/2,c-=v/T/2;for(let P of s.points)d.push([a+(P[0]-m)/T,c+(P[1]-y)/T]);return{isOpen:!1,points:d}}},Zx={id:"square",open:!1,points:[[0,0],[0,100],[100,100],[100,0]]},w2={id:"triangle",open:!1,points:[[50,0],[0,100],[100,100]]},S2={id:"pentagon",open:!1,points:[[0,0],[0,100],[100,100],[100,0],[50,-50]]},P2={id:"hexagon",open:!1,points:[[50,0],[0,25],[0,75],[50,100],[100,75],[100,25]]},E2={id:"circle",open:!1,points:[[948.949,571.107],[954.545,500],[954.545,500],[948.949,428.893],[948.949,428.893],[932.298,359.538],[932.298,359.538],[905.003,293.641],[905.003,293.641],[867.735,232.825],[867.735,232.825],[821.412,178.588],[821.412,178.588],[767.175,132.265],[767.175,132.265],[706.359,94.997],[706.359,94.997],[640.462,67.702],[640.462,67.702],[571.107,51.051],[571.107,51.051],[500,45.455],[500,45.455],[428.893,51.051],[428.893,51.051],[359.538,67.702],[359.538,67.702],[293.641,94.997],[293.641,94.997],[232.825,132.265],[232.825,132.265],[178.588,178.588],[178.588,178.588],[132.265,232.825],[132.265,232.825],[94.997,293.641],[94.997,293.641],[67.702,359.538],[67.702,359.538],[51.051,428.893],[51.051,428.893],[45.455,500],[45.455,500],[51.051,571.107],[51.051,571.107],[67.702,640.462],[67.702,640.462],[94.997,706.359],[94.997,706.359],[132.265,767.175],[132.265,767.175],[178.588,821.412],[178.588,821.412],[232.825,867.735],[232.825,867.735],[293.641,905.003],[293.641,905.003],[359.538,932.298],[359.538,932.298],[428.893,948.949],[428.893,948.949],[500,954.545],[500,954.545],[571.107,948.949],[571.107,948.949],[640.462,932.298],[640.462,932.298],[706.359,905.003],[706.359,905.003],[767.175,867.735],[767.175,867.735],[821.412,821.412],[821.412,821.412],[867.735,767.175],[867.735,767.175],[905.003,706.359],[905.003,706.359],[932.298,640.462],[932.298,640.462],[948.949,571.107]]},k2={type:"stamp-shape",label:"Stamp shape",tools:["stamp","box"],modifiers:{Shift:"Maintain aspect ratio"},isValid(t,e,n){return!(e.polygon.points.length&&!e.slowState.canDelete)},start(t,e,n){let r=t[0],s=e.slowState.selectedStamp||Zx;if(r){let a=r[0],c=r[1],d=[],m=Math.min(...s.points.map(k=>k[0])),y=Math.min(...s.points.map(k=>k[1])),h=Math.max(...s.points.map(k=>k[0]))-m,v=Math.max(...s.points.map(k=>k[1]))-y,E=h/32;v/32>E&&(E=v/32);let T=[],P=0;for(let k of s.points)T.push(P),d.push([a+(k[0]-m)/E,c+(k[1]-y)/E]),P++;return e.transitionPoints=d,{isOpen:!1,selectedPoints:T,points:d}}},transition(t,e,n){if(!e.transitionOrigin)return;let r=e.polygon.boundingBox,s=[r.x,r.y];e.transitionOrigin||t[0];let[a,c]=t[0],d=e.transitionOrigin[0],m=e.transitionOrigin[1],y=t[0][0],h=t[0][1],v=y-d-32,E=h-m-32;if(n.Shift||e.slowState.fixedAspectRatio){let _=r.width/r.height;Math.abs(r.width/v)>Math.abs(r.height/E)?E=v/_:v=E*_}let T=(r.width+v)/r.width,P=(r.height+E)/r.height,k=[];for(let _ of e.polygon.points){let M=_[0]-s[0],L=_[1]-s[1],$=M*T,F=L*P,H=$+s[0],se=F+s[1];if(_.length===6){k.push([H,se,_[2],_[3],_[4],_[5]]);continue}k.push([H,se])}e.transitionPoints=k;let R={points:k,boundingBox:null};jd(R),e.transitionBoundingBox=R.boundingBox},commit(t,e,n){return{isOpen:!1,points:e.transitionPoints,tool:"pointer"}}},C2={type:"toggle-snap",label:"Toggle snapping",trigger:{type:"key",key:"`"},tools:["pointer","pen","line","lineBox","box","stamp"],modifiers:{},isValid(t,e,n){return!0},commit(t,e,n){let r=!e.slowState.snapEnabled;return e.slowState.snapEnabled=r,r||(e.snapTargets=[],e.activeSnapGuides=[],e.isSnapping=!1,e.snapPoint=null),{}}};function T2(t={}){let e=t.proximityThreshold||10,n=t.closestLinePointFill||{selected:"#fff",unselected:"rgba(255, 255, 255, .5)"},r=t.closestLinePointStroke||{selected:"#000",unselected:"rgba(0, 0, 0, .5)"};function s(P,k,R){P&&k.transitionBoundingBox&&R.transitioning&&(P.setAttribute("x",""+k.transitionBoundingBox.x),P.setAttribute("y",""+k.transitionBoundingBox.y),P.setAttribute("width",""+k.transitionBoundingBox.width),P.setAttribute("height",""+k.transitionBoundingBox.height))}function a(P,k,R){P&&k.polygon.boundingBox&&R.showBoundingBox&&(P.setAttribute("x",""+k.polygon.boundingBox.x),P.setAttribute("y",""+k.polygon.boundingBox.y),P.setAttribute("width",""+k.polygon.boundingBox.width),P.setAttribute("height",""+k.polygon.boundingBox.height))}function c(P,k,R){if(P&&k.polygon.boundingBox&&R.showBoundingBox){let _=k.transitionBoundingBox||k.polygon.boundingBox;_.rotation?(P.style.transformOrigin=`${_.x+_.width/2}px ${_.y+_.height/2}px`,P.style.transform=`rotate(${Math.round(100*_.rotation*(180/Math.PI))/100}deg)`):P.style.transform="",P.setAttribute("points",[[_.x,_.y],[_.x+_.width,_.y],[_.x+_.width,_.y+_.height],[_.x,_.y+_.height]].map(M=>M.join(",")).join(" "))}}function d(P,k,R){P&&k.transitionPoints&&R.transitioning&&P.setAttribute("points",k.transitionPoints.map(_=>_.join(",")).join(" "))}function m(P,k,R){P&&k.closestLinePoint&&R.hasClosestLine&&(P.setAttribute("cx",""+k.closestLinePoint[0]),P.setAttribute("cy",""+k.closestLinePoint[1]),P.setAttribute("fill",k.closestLineDistance<e?n.selected:n.unselected),P.setAttribute("stroke",k.closestLineDistance<e?r.selected:r.unselected))}function y(P,k,R){P&&k.closestLinePoint&&R.hasClosestLine&&P.setAttribute("transform",`translate(${k.closestLinePoint[0]}, ${k.closestLinePoint[1]})`)}function h(P,k,R){P&&k.selectionBox&&R.transitionIntentType==="select-multiple-points"&&(P.setAttribute("x",""+k.selectionBox.x),P.setAttribute("y",""+k.selectionBox.y),P.setAttribute("width",""+k.selectionBox.width),P.setAttribute("height",""+k.selectionBox.height))}function v(P,k,R){if(P&&k.pointer&&k.selectedPoints.length)if(R.actionIntentType==="close-shape"||R.actionIntentType==="close-shape-line"){let _=k.polygon.points[0],M=k.polygon.points[k.polygon.points.length-1];_&&M&&P.setAttribute("points",`${_.join(",")} ${M.join(",")}`)}else if(k.line)P.setAttribute("points",`${k.line[0].join(",")} ${k.line[1].join(",")}`);else{let _=k.polygon.points[k.selectedPoints[0]];_&&_.length&&P.setAttribute("points",`${k.pointer[0]},${k.pointer[1]} ${_.join(",")}`)}}function E(P,k,R,_=3){P&&k.transitionDraw.length&&P.setAttribute("points",qx(k.transitionDraw,_*k.scale).map(M=>M.join(",")).join(" "))}function T(P,k){P&&k.lineBox&&P.setAttribute("points",k.lineBox.map(R=>R.join(",")).join(" "))}return{updateTransitionBoundingBox:s,updateClosestLinePointTransform:y,updateBoundingBoxPolygon:c,updateBoundingBox:a,updateTransitionShape:d,updateClosestLinePoint:m,updateSelectBox:h,updatePointLine:v,updateDrawPreview:E,updateLineBox:T}}var b2=typeof window<"u"?window.requestAnimationFrame:t=>setTimeout(t,16),R2=typeof window<"u"?window.cancelAnimationFrame:t=>clearTimeout(t);function By(t){return!["hand","pointer"].includes(t)}var Oc=[xc,c2,u2,Yx,Gx,Kx,a2,g2,k2,v2],_2=Oc.length,wc=[t2,x2,Xx,m2,n2,r2,KT,y2,s2,l2],lu=[o2,f2,d2,h2,p2,i2,C2],zc={};Oc.forEach(t=>{zc[t.type]=t});wc.forEach(t=>{zc[t.type]=t});lu.forEach(t=>{zc[t.type]=t});var xd=10;function I2(t,e){let n=t?.fixedAspectRatio||!1,r=t?.tool||"pointer",s=t?.keyboardShortcutMapping||{},a=typeof t?.keyboardShortcutsEnabled=="boolean"?t.keyboardShortcutsEnabled:!0,c=t?.enabledTools||["pointer","pen","box","lineBox","stamp","hand","line","pencil"],d=t?.emitter||WT(),m={V:"pointer",P:"pen",B:"box",L:"lineBox",S:"stamp",H:"hand",N:"line",D:"pencil",...t?.toolMap||{}},y={shapeId:t?.id||null,noShape:t===null,transitioning:!1,actionIntentType:null,transitionIntentType:null,selectedPoints:[],hasClosestLine:!1,modifiers:{Alt:!1,Shift:!1,Meta:!1,proximity:xd},bounds:t?.bounds||null,showBoundingBox:!1,currentModifiers:{},validIntentKeys:{},pointerInsideShape:!1,closestPoint:null,selectedStamp:null,transitionModifiers:null,boxMode:!1,bezierLines:[],fixedAspectRatio:n,isToolSwitchingLocked:!1,canDeselect:!1,canDelete:!0,cursor:"default",enabledTools:c,currentTool:r,lastCreationTool:By(r)?r:null,snapEnabled:!1,snapToPoints:!0,snapToLines:!0,snapToIntersections:!0,snapToGrid:!1,snapToParallel:!0},h={isOpen:typeof t?.open=="boolean"?t.open:!1,polygon:{points:t?.points||[],iedges:null,boundingBox:null,isBezier:null,bezierLines:[]},scale:1,selectedPoints:[],pointer:null,line:null,lineBox:null,transitionPoints:null,transitionOrigin:null,transitionBoundingBox:null,closestLinePoint:null,closestLineDistance:0,closestLineIndex:-1,transitionRotate:!1,transitionDirection:null,transitionBezierLine:null,selectionBox:null,slowState:y,transitionDraw:[],isPanning:!1,panStart:null,snapTargets:[],activeSnapGuides:[],snapThreshold:15,isSnapping:!1,snapPoint:null},v={startTime:0,time:0,shouldUpdate:!1,nextSlowState:null,renderFunc:()=>{},setStateFunc:()=>{},animationFrame:0,actionIntent:null,transitionIntent:null,undoStack:[],undoStackPointer:-1},E={isPressed:!1,isClicking:!1,lastPress:null,pressTimeout:0,noTransition:!1};function T(Z){Qx(Z),Z.isBezier&&P({bezierLines:Z.bezierLines}),jd(Z),v.shouldUpdate=!0}T(h.polygon);function P(Z){let fe=Object.keys(Z);if(fe.length===0)return;let ke=v.nextSlowState||h.slowState,G=!1;if(fe.length===1&&fe[0]==="validIntentKeys"&&ke.validIntentKeys){let W=Object.keys(ke.validIntentKeys),ae=Object.keys(Z.validIntentKeys||{});if(W.length===ae.length){for(let he of W)ke.validIntentKeys[he]!==Z.validIntentKeys[he]&&(G=!0);if(!G)return}}if(Z.selectedPoints){let W=Array.from(ke.selectedPoints||[]),ae=Array.from(Z.selectedPoints||[]);if(W.length===ae.length){for(let he of W)if(!ae.includes(he)){G=!0;break}}else G=!0;G||delete Z.selectedPoints}if(!(fe.length===1&&fe.includes("hasClosestLine")&&Z.hasClosestLine===ke.hasClosestLine)){if(v.nextSlowState){v.nextSlowState={...v.nextSlowState,...Z};return}v.nextSlowState={...h.slowState,...Z}}}function k(Z,fe=!1){v.time+=Z,R(),_(),me(),oe(),se(),ge(),we(),de(),H(),v.renderFunc(h,h.slowState,Z),!fe&&(v.animationFrame=b2(k))}function R(){if(v.shouldUpdate&&(e({id:h.slowState.shapeId||void 0,open:h.isOpen,points:h.polygon.points}),v.shouldUpdate=!1),v.nextSlowState&&v.nextSlowState!==h.slowState){let Z=Object.keys(h.slowState),fe={},ke={},G=!1;for(let W of Z){let ae=h.slowState[W],he=v.nextSlowState[W];ae!==he?(G=!0,fe[W]=he,ke[W]=he):fe[W]=ae}G&&(h.slowState=fe,v.nextSlowState=null,v.setStateFunc(h.slowState),t?.customSetState?.(ke))}}function _(){let Z=!h.slowState.noShape&&h.polygon.points.length>2&&h.selectedPoints.length===h.polygon.points.length&&!h.isOpen&&(h.slowState.currentTool==="pointer"||h.slowState.currentTool==="box");h.slowState.showBoundingBox!==Z&&P({showBoundingBox:Z})}function M(Z){h.selectedPoints=Z.selectedPoints,P({selectedPoints:Z.selectedPoints}),h.polygon.points=Z.points,h.polygon.boundingBox=null,h.polygon.iedges=null,h.polygon.isBezier=null,T(h.polygon),P({closestPoint:null}),(Z.isOpen===!0||Z.isOpen===!1)&&(h.isOpen=Z.isOpen,v.shouldUpdate=!0)}function L(){if(v.undoStackPointer===-1)return;v.undoStackPointer--;let Z=v.undoStack[v.undoStackPointer];M(Z)}function $(){if(v.undoStackPointer===v.undoStack.length-1)return;v.undoStackPointer++;let Z=v.undoStack[v.undoStackPointer];M(Z)}function F(Z){v.undoStackPointer++,v.undoStack[v.undoStackPointer]=Z,v.undoStack.length>15&&(v.undoStack.shift(),v.undoStackPointer--)}function H(){P({boxMode:ZT(h.polygon.points||[])})}function se(){if(!h.pointer||h.slowState.noShape){P({pointerInsideShape:!1});return}let[Z,fe]=h.pointer,ke=h.polygon.points,G=h.polygon.boundingBox;if(!G){P({pointerInsideShape:!1});return}if(Z<G.x||Z>G.x+G.width||fe<G.y||fe>G.height+G.y){P({pointerInsideShape:!1});return}let W=!1;for(let ae=0,he=ke.length-1;ae<ke.length;he=ae++)ke[ae][1]>fe!=ke[he][1]>fe&&Z<(ke[he][0]-ke[ae][0])*(fe-ke[ae][1])/(ke[he][1]-ke[ae][1])+ke[ae][0]&&(W=!W);P({pointerInsideShape:W})}function oe(){if(h.slowState.noShape||!h.pointer||h.slowState.transitioning||!h.polygon.points||h.polygon.points.length===0)return;let[Z,fe]=h.pointer,ke=h.polygon.points.map((G,W)=>{let ae=G[0]-Z,he=G[1]-fe;return[ae*ae+he*he,W]}).sort((G,W)=>G[0]-W[0]);ke.length&&P({closestPoint:ke[0][1]})}function me(){if(!h.pointer||h.slowState.transitioning)return;if(h.slowState.noShape){h.closestLineIndex=-1,h.closestLinePoint=null,h.closestLineDistance=0;return}let[Z,fe,ke,G]=Fy(h.polygon,h.pointer),W=Re()*Re();fe<W&&(!h.isOpen||h.slowState.currentTool==="line"||h.polygon.points.length-1!==G)?(h.closestLinePoint=Z,h.closestLineDistance=Math.sqrt(fe),h.closestLineIndex=G,P({hasClosestLine:!0})):(h.closestLinePoint=null,h.closestLineDistance=0,h.closestLineIndex=-1,P({hasClosestLine:!1}))}function K(Z,fe=null){let ke={},G=fe||(h.pointer?[h.pointer[0],h.pointer[1]]:null);for(let W of[...Oc,...wc,...lu])W.tools.includes(Z)&&(G&&W.isValid([G],h,le())?ke[W.type]=W.label:G||(ke[W.type]=W.label));return ke}function ge(){if(h.slowState.transitioning||h.slowState.noShape||!h.pointer||!Array.isArray(h.pointer)||h.pointer.length<2||typeof h.pointer[0]!="number"||typeof h.pointer[1]!="number")return;let Z=h.slowState.currentTool;ct(Z);let fe=!1;for(let W=0;W<_2;W++){let ae=Oc[W];if(ae.tools.includes(Z)&&ae.isValid(E.isPressed?[E.lastPress]:[h.pointer],h,le())){if(v.transitionIntent===ae){fe=!0;break}P({transitionIntentType:ae.type}),v.transitionIntent=ae,fe=!0;break}}fe||v.transitionIntent&&(P({transitionIntentType:null}),v.transitionIntent=null);let ke=!1;for(let W=0;W<wc.length;W++){let ae=wc[W];if(ae.tools.includes(Z)&&Se(ae)){if(v.actionIntent===ae){ke=!0;break}P({actionIntentType:ae.type}),v.actionIntent=ae,ke=!0;break}}ke||v.actionIntent&&(v.actionIntent=null,P({actionIntentType:null}));let G={};for(let W=0;W<lu.length;W++){let ae=lu[W];ae.trigger.type==="key"&&Se(ae)&&(G[ae.trigger.key]=ae.label)}P({validIntentKeys:G})}function de(){let Z=h.pointer;if(h.lineBox=null,!Z||D()||h.polygon.points.length!==2)return;let[fe,ke]=Z,[G,W]=h.polygon.points[0],[ae,he]=h.polygon.points[1],[Xe,Ze,at,ue]=Fy(h.polygon,Z);if(!Xe)return;let pe=fe-Xe[0],Oe=ke-Xe[1],Ne=[G,W],Ae=[ae,he],tt=[Ae[0]+pe,Ae[1]+Oe],St=[Ne[0]+pe,Ne[1]+Oe];h.lineBox=[Ne,Ae,tt,St]}function we(){let Z=h.pointer;if(!Z||!D()||h.slowState.noShape)return;let fe=h.selectedPoints[0],ke=Z;if(h.slowState.snapEnabled&&!h.slowState.modifiers.Shift?(Jo(Z,h,5),ke=qc(Z,h)):Wx(h),h.line=[h.polygon.points[fe],ke],h.slowState.modifiers.Shift){let G=0;if(h.polygon.points.length>1){let Oe=h.selectedPoints[0];Oe===0?G=Math.atan2(h.polygon.points[1][1]-h.polygon.points[0][1],h.polygon.points[1][0]-h.polygon.points[0][0]):G=Math.atan2(h.polygon.points[Oe-1][1]-h.polygon.points[Oe][1],h.polygon.points[Oe-1][0]-h.polygon.points[Oe][0])}let W=Z[0]-h.polygon.points[fe][0],ae=Z[1]-h.polygon.points[fe][1],he=Math.atan2(ae,W),Xe=Math.PI/4,Ze=Math.round((he-G)/Xe)*Xe+G,at=Qr(h.polygon.points[fe],Z),ue=Math.cos(Ze)*at+h.polygon.points[fe][0],pe=Math.sin(Ze)*at+h.polygon.points[fe][1];h.line[1]=[ue,pe]}}function le(){return h.slowState.modifiers}function Ie(Z){let fe=Z.commit([E.lastPress],h,le());d.emit("polygons.end-transition",{transitionIntent:Z.type,response:fe}),fe&&(fe.tool&&be(fe.tool),fe.selectedPoints&&(h.selectedPoints=fe.selectedPoints,P({selectedPoints:fe.selectedPoints})),fe.points&&(h.polygon.points=fe.points,h.polygon.boundingBox=null,h.polygon.iedges=null,h.polygon.isBezier=null,h.transitionBoundingBox=null,T(h.polygon),P({closestPoint:null,selectedStamp:null})),(fe.isOpen===!0||fe.isOpen===!1)&&(h.isOpen=fe.isOpen,v.shouldUpdate=!0),F({isOpen:h.isOpen,points:h.polygon.points,selectedPoints:h.selectedPoints}),ct(h.slowState.currentTool)),P({transitionModifiers:null})}function Se(Z){if(!Z.tools.includes(h.slowState.currentTool))return!1;let fe=[];return h.pointer&&Array.isArray(h.pointer)&&h.pointer.length>=2&&typeof h.pointer[0]=="number"&&typeof h.pointer[1]=="number"&&(fe=[h.pointer]),Z.isValid(fe,h,le())}function Te(Z){Z==="Delete"&&(Z="Backspace");let fe=h.slowState.currentTool;for(let ke of lu)if(!(ke.trigger.type!=="key"||ke.trigger.key!==Z)&&ke.tools.includes(fe)&&Se(ke))return Ie(ke),!0;return!1}function D(){let Z=h.polygon.points,fe=h.pointer;if(!h.isOpen||!Z.length||h.selectedPoints.length!==1||!fe)return!1;let ke=h.selectedPoints[0],G=ke===0,W=ke===Z.length-1;return G||W}let U={reset(){P({modifiers:{Alt:!1,Shift:!1,Meta:!1,proximity:xd}})},getForType(Z){let fe={};if(!Z)return fe;let ke=zc[Z];return!ke||!ke.modifiers?fe:ke.modifiers},set(Z){Z!=="Shift"&&Z!=="Alt"&&Z!=="Meta"||P({modifiers:{...v.nextSlowState?.modifiers||h.slowState.modifiers,[Z]:!0}})},unset(Z){Z!=="Shift"&&Z!=="Alt"&&Z!=="Meta"||P({modifiers:{...v.nextSlowState?.modifiers||h.slowState.modifiers,[Z]:!1}})}},Q={set(Z){let fe=Z?Z.id==="square"||Z.id==="rectangle":!1;P({selectedStamp:Z,boxMode:fe})},clear(){Q.set(null)},square(){Q.set(Zx)},triangle(){Q.set(w2)},pentagon(){Q.set(S2)},hexagon(){Q.set(P2)},circle(){Q.set(E2)}},B={down(Z){let fe=s[Z]||Z;if(fe==="Shift"||fe==="Alt"||fe==="Meta")return U.set(fe),!0;if(fe==="Control")return U.set("Meta"),!0;if(fe==="z"&&h.slowState.modifiers.Meta)return h.slowState.modifiers.Shift?$():L(),!0;if(!h.slowState.modifiers.Meta&&!h.slowState.modifiers.Alt&&!h.slowState.transitioning){if(!a)return;let ke=fe.toUpperCase();if(m[ke]){let G=m[ke];return be(G),!0}}return Te(fe)},up(Z){let fe=s[Z]||Z;if(fe==="Control"){U.unset("Meta");return}fe!=="Shift"&&fe!=="Alt"&&fe!=="Meta"||U.unset(fe)}};function re(Z){h.scale=Z,P({modifiers:{...v.nextSlowState?.modifiers||h.slowState.modifiers,proximity:Z*xd}})}function Re(){return xd*h.scale}let je={set:Z=>{v.renderFunc=Z},start:(Z,fe)=>{v.startTime=performance.now(),v.time=0,Z&&(v.renderFunc=Z),fe&&(fe(h.slowState),v.setStateFunc=fe),k(0)},stop:()=>{v.animationFrame&&(R2(v.animationFrame),v.animationFrame=0)},step:(Z=16)=>{k(Z)}};function Le(Z){if(!Z||!Array.isArray(Z)||Z.length===0)return;let fe=Z[0];if(!(!fe||!fe[0]&&fe[0]!==0||!fe[1]&&fe[1]!==0)&&!(Number.isNaN(fe[0])||Number.isNaN(fe[1]))){if(h.pointer=fe,h.slowState.transitioning)v.transitionIntent&&(v.transitionIntent.transition(Z,h,le()),d.emit("polygons.transition",{transitionIntent:v.transitionIntent.type}));else if(E.isPressed&&!E.noTransition&&E.lastPress&&h.pointer&&(!E.isClicking||Qr(E.lastPress,h.pointer)>10))if(clearTimeout(E.pressTimeout),E.isClicking=!1,v.transitionIntent){if(h.transitionOrigin=E.lastPress,P({transitioning:!0}),v.transitionIntent.start){let ke=v.transitionIntent.start([E.lastPress],h,le());ke&&(ke.selectedPoints&&(h.selectedPoints=ke.selectedPoints,P({selectedPoints:ke.selectedPoints})),(ke.isOpen===!0||ke.isOpen===!1)&&(h.isOpen=ke.isOpen,v.shouldUpdate=!0),ke.points&&(h.polygon.points=ke.points,h.polygon.boundingBox=null,h.polygon.iedges=null,T(h.polygon),P({closestPoint:null})))}P({transitionModifiers:v.transitionIntent.modifiers||null}),d.emit("polygons.start-transition",{transitionIntent:v.transitionIntent.type}),v.transitionIntent.transition([E.lastPress],h,le()),d.emit("polygons.transition",{transitionIntent:v.transitionIntent.type})}else E.noTransition=!0}}function De(){h.pointer=null,h.slowState.transitioning||(E.isPressed=!1,E.isClicking=!1,E.lastPress=null,P({transitionIntentType:null,actionIntentType:null}),v.transitionIntent=null,v.actionIntent=null)}function Je(){E.isClicking=!0,E.isPressed=!0,E.lastPress=h.pointer,E.pressTimeout=setTimeout(()=>{E.isPressed&&(E.isClicking=!1)},250)}function it(){h.slowState.transitioning?(P({transitioning:!1}),v.transitionIntent&&Ie(v.transitionIntent),v.transitionIntent=null,P({transitionIntentType:null})):E.isClicking&&(v.actionIntent&&Ie(v.actionIntent),v.actionIntent=null,P({actionIntentType:null})),E.isPressed=!1,E.isClicking=!1,E.lastPress=null,E.noTransition=!1,clearTimeout(E.pressTimeout)}function ut(Z){h.polygon.points=Z?.points||[],h.polygon.boundingBox=null,h.polygon.iedges=null,h.isOpen=Z?.open||!1,T(h.polygon),v.nextSlowState=null,v.undoStack=[],v.undoStackPointer=-1,h.lineBox=null,h.line=null,E.pressTimeout&&clearTimeout(E.pressTimeout),P({noShape:Z===null,shapeId:Z?.id||null,transitioning:!1,actionIntentType:null,transitionIntentType:null,selectedPoints:[],hasClosestLine:!1,modifiers:{Alt:!1,Shift:!1,Meta:!1,proximity:h.slowState.modifiers.proximity},showBoundingBox:!1,currentModifiers:{},validIntentKeys:{},selectedStamp:null,closestPoint:null,pointerInsideShape:!1,boxMode:!1,fixedAspectRatio:n}),be(r),R()}function mt(Z){if(!Z)return"";let fe=zc[Z];return!fe||!fe.modifiers?fe.label||"":h.slowState.modifiers.Shift&&fe.modifiers.Shift?fe.modifiers.Shift:h.slowState.modifiers.Alt&&fe.modifiers.Alt?fe.modifiers.Alt:h.slowState.modifiers.Meta&&fe.modifiers.Meta?fe.modifiers.Meta:fe.label}function ot(){P({fixedAspectRatio:!0})}function ze(){P({fixedAspectRatio:!1})}function be(Z){if(h.slowState.isToolSwitchingLocked||h.slowState.currentTool===Z||!h.slowState.enabledTools.includes(Z))return;let fe=h.slowState.lastCreationTool;if(By(Z)){if(h.slowState.isToolSwitchingLocked)return;fe=Z}h.slowState.transitioning&&(h.transitionPoints=null,h.transitionBoundingBox=null,h.transitionDraw=[],h.line=null,h.lineBox=null,P({transitioning:!1}));let ke=K(Z),G=h.selectedPoints,W=h.isOpen,ae=h.slowState.selectedStamp;switch(Z){case"pointer":h.polygon.points.length>0&&!W&&G.length===0&&(G=h.polygon.points.map((he,Xe)=>Xe));break;case"pen":h.polygon.points.length===0?(G=[],W=!0):W&&G.length>1&&(G=[G[G.length-1]]);break;case"line":h.polygon.points.length===0?(G=[],W=!0):W?G.length>1&&(G=[G[G.length-1]]):(G=[h.polygon.points.length-1],W=!0);break;case"pencil":G=[],h.polygon.points.length===0&&(W=!0);break;case"box":G=h.polygon.points.map((he,Xe)=>Xe),W=!1,Q.square();break;case"lineBox":G=[],h.polygon.points.length===0&&(W=!0);break;case"stamp":G=[],W=!1,ae||Q.square();break;case"hand":G=[];break;default:G=[];break}P({validIntentKeys:ke}),P({currentTool:Z,selectedPoints:G,lastCreationTool:fe,boxMode:Z==="box"}),h.selectedPoints=G,h.isOpen=W,ct(Z),ge()}function ct(Z){let fe=Z==="box"||Z==="pointer"&&h.polygon.points.length>2&&h.selectedPoints.length===h.polygon.points.length&&!h.isOpen;P({showBoundingBox:fe})}function An(Z){h.slowState.currentTool===Z&&be("pointer")}function fr(Z){h.slowState.currentTool===Z?be("pointer"):be(Z)}let Mn={undo:L,redo:$,get canUndo(){return v.undoStackPointer>-1},get canRedo(){return v.undoStackPointer<v.undoStack.length-1}},En={setTool:be,unsetTool:An,toggleTool:fr,updateVisibility:ct,setCanDelete(Z){P({canDelete:Z})},setCanDeselect(Z){Vn(),P({canDeselect:Z})},lockToolSwitching(){P({isToolSwitchingLocked:!0})},unlockToolSwitching(){P({isToolSwitchingLocked:!1})},toggleToolSwitching(){P({isToolSwitchingLocked:!h.slowState.isToolSwitchingLocked})},shortcuts:Object.fromEntries(Object.entries(m).map(([Z,fe])=>[fe,Z])),getValidIntents(Z){let fe=Z||h.slowState.currentTool;return{actions:wc.filter(ke=>ke.tools.includes(fe)),transitions:Oc.filter(ke=>ke.tools.includes(fe)),keys:lu.filter(ke=>ke.tools.includes(fe)),all:K(fe),current:h.slowState.validIntentKeys}},getToolInfo(){return{name:h.slowState.currentTool,cursor:h.slowState.cursor,selectionCount:h.selectedPoints.length,pointCount:h.polygon.points.length,isOpen:h.isOpen}},smartSelect(){h.polygon.points.length!==0&&(h.isOpen?(h.selectedPoints=[h.polygon.points.length-1],P({selectedPoints:h.selectedPoints})):(h.selectedPoints=h.polygon.points.map((Z,fe)=>fe),P({selectedPoints:h.selectedPoints})))},clearSelection(){h.selectedPoints=[],P({selectedPoints:[]})},autoSelect(){h.selectedPoints.length===h.polygon.points.length&&!h.isOpen?be("pointer"):h.isOpen||h.selectedPoints.length>0?be(h.slowState.lastCreationTool||"pen"):be("pointer")}},as={enabled:()=>h.slowState.snapEnabled,enable:()=>P({snapEnabled:!0}),disable:()=>P({snapEnabled:!1}),toggle:()=>P({snapEnabled:!h.slowState.snapEnabled}),pointsEnabled:()=>h.slowState.snapToPoints,enablePoints:()=>P({snapToPoints:!0}),disablePoints:()=>P({snapToPoints:!1}),togglePoints:()=>P({snapToPoints:!h.slowState.snapToPoints}),linesEnabled:()=>h.slowState.snapToLines,enableLines:()=>P({snapToLines:!0}),disableLines:()=>P({snapToLines:!1}),toggleLines:()=>P({snapToLines:!h.slowState.snapToLines}),intersectionsEnabled:()=>h.slowState.snapToIntersections,enableIntersections:()=>P({snapToIntersections:!0}),disableIntersections:()=>P({snapToIntersections:!1}),toggleIntersections:()=>P({snapToIntersections:!h.slowState.snapToIntersections}),gridEnabled:()=>h.slowState.snapToGrid,enableGrid:()=>P({snapToGrid:!0}),disableGrid:()=>P({snapToGrid:!1}),toggleGrid:()=>P({snapToGrid:!h.slowState.snapToGrid}),parallelEnabled:()=>h.slowState.snapToParallel,enableParallel:()=>P({snapToParallel:!0}),disableParallel:()=>P({snapToParallel:!1}),toggleParallel:()=>P({snapToParallel:!h.slowState.snapToParallel}),getThreshold:()=>h.snapThreshold*h.slowState.modifiers.proximity,setThreshold:Z=>{h.snapThreshold=Math.max(5,Math.min(50,Z))},isActive:()=>h.isSnapping,getSnapPoint:()=>h.snapPoint,getActiveGuides:()=>h.activeSnapGuides,getTargets:()=>h.snapTargets};function Vn(){P({selectedPoints:h.polygon.points.map((Z,fe)=>fe)})}function br(Z){P({bounds:Z})}return be(r),{state:h,setState:P,emitter:d,modifiers:U,stamps:Q,history:Mn,key:B,setScale:re,clock:je,pointer:Le,blur:De,pointerDown:Je,pointerUp:it,setShape:ut,label:mt,tools:En,snap:as,selectAllPoints:Vn,setBounds:br,lockAspectRatio:ot,unlockAspectRatio:ze}}function Jx(t){const e=Math.max(...t.map(a=>a[0])),n=Math.min(...t.map(a=>a[0])),r=Math.max(...t.map(a=>a[1])),s=Math.min(...t.map(a=>a[1]));for(const a of t)if(a[0]!==n&&a[0]!==e&&a[1]!==s&&a[1]!==r||a[0]<n||a[0]>e||a[1]<s||a[1]>r)return!1;return!0}function Ld(t){if(!t)return null;if(t.points.length>2){const e=Math.min(...t.points.map(a=>a[0])),n=Math.min(...t.points.map(a=>a[1])),r=Math.max(0,...t.points.map(a=>a[0])),s=Math.max(0,...t.points.map(a=>a[1]));return{x:e,y:n,width:r-e,height:s-n}}return null}function O2(t){return t.type==="SvgSelector"}function $y(t,e){if(O2(t)){const c=t.svgShape==="polyline";if(!t.points||t.points.length===0)return null;if(e){const{width:d,height:m}=e;return{type:"SvgSelector",value:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${d} ${m}" width="${d}" height="${m}"><${c?"polygon":"polyline"} points="${t.points.map(h=>h.join(",")).join(" ")}" /></svg>`}}return{type:"SvgSelector",value:`<svg xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><g><path d='M${t.points.map(d=>d.join(",")).join(" ")}${c?" Z":""}' /></g></svg>`}}if(!t.spatial)return null;const{x:n,y:r,width:s,height:a}=t.spatial||{};return!s||!a?null:{type:"FragmentSelector",value:`xywh=${~~n},${~~r},${~~s},${~~a}`}}function fg(t,e){if(!t||!t.points.length)return null;if(Jx(t.points)){const n=t.points.map(m=>m[0]),r=t.points.map(m=>m[1]),s=Math.min(...n),a=Math.min(...r),c=Math.max(...n)-s,d=Math.max(...r)-a;return $y({type:"BoxSelector",spatial:{x:s,y:a,width:c,height:d}},e)}return $y({type:"SvgSelector",points:t.points,svgShape:t.open?"polygon":"polyline"},e)}function ew(t){if(t.type==="polygon"&&!t.noBox&&t.points&&Jx(t.points)){const n=Ld({points:t.points||[]});return ew({...t,type:"box",selector:n})}if(t.type==="polygon"||t.type==="draw")return{polygon:{points:t.points||[],open:t.open||!1},requestType:t.type,boundingBox:Ld({points:t.points||[]}),metadata:{},arguments:t.arguments||{},target:fg({points:t.points||[],open:!1},t.bounds)};const e=t.selector;if(e){const n=[[e.x,e.y],[e.x+e.width,e.y],[e.x+e.width,e.y+e.height],[e.x,e.y+e.height]];return{polygon:{points:n,open:!1},requestType:t.type,boundingBox:e,metadata:{},target:fg({points:n,open:!1},t.bounds),arguments:t.arguments||{}}}return{polygon:{points:[],open:!1},requestType:t.type,boundingBox:null,target:null,metadata:{},arguments:t.arguments||{}}}const A2={shapeId:null,noShape:!0,transitioning:!1,actionIntentType:null,transitionIntentType:null,selectedPoints:[],hasClosestLine:!1,lastCreationTool:null,modifiers:{Alt:!1,Shift:!1,Meta:!1,proximity:0},bounds:null,showBoundingBox:!1,currentModifiers:{},validIntentKeys:{},pointerInsideShape:!1,closestPoint:null,transitionModifiers:null,selectedStamp:null,bezierLines:[],boxMode:!1,fixedAspectRatio:!1,cursor:"",enabledTools:["pointer","pen","box","lineBox","stamp","hand","line","pencil"],canDelete:!0,canDeselect:!0,isToolSwitchingLocked:!1,currentTool:"box",snapEnabled:!1,snapToPoints:!1,snapToLines:!1,snapToIntersections:!1,snapToGrid:!1,snapToParallel:!1};function M2({events:t,enabledTools:e,keyboardShortcutMapping:n,keyboardShortcutsEnabled:r=!1,debug:s}){const a=ta((d,m)=>{let y=null;const v=I2({emitter:t,keyboardShortcutsEnabled:r,keyboardShortcutMapping:n,enabledTools:e,customSetState:E=>{s&&console.log("partial state",E),d(T=>({polygonState:{...T.polygonState,...E}}))}},E=>{d(T=>T.tool.requestId?{polygon:{...E,id:T.tool.requestId}}:{polygon:{id:void 0,points:[],open:!0}}),t.emit("atlas.polygon-update",E)});return{mode:"explore",tool:{enabled:!1,requestId:null,canvasId:null},requestType:null,requests:{},history:v.history,polygon:null,validRequestIds:[],metadata:{},stableViewport:null,canvasRelativePositions:{},canvasViewports:{},polygons:v,polygonState:A2,setMetadata:(E,T)=>{const P=T||m().tool.requestId;P&&d(k=>({metadata:{...k.metadata,[P]:{...k.metadata[P]||{},...E}}}))},setToolCanvasId:E=>{d(T=>({tool:{...T.tool,canvasId:E}}))},switchTool:{pointer(){d({mode:"sketch"}),c.tools.setTool("pointer")},hand(){d({mode:"explore"}),c.tools.setTool("hand")},draw(){d({mode:"sketch"}),c.tools.setTool("pencil")},pen(){d({mode:"sketch"}),c.tools.setTool("pen")},line(){d({mode:"sketch"}),c.tools.setTool("line")},lineBox(){d({mode:"sketch"}),c.tools.setTool("lineBox")},box(){d({mode:"sketch"}),c.tools.setTool("box")},triangle(){d({mode:"sketch"}),c.tools.setTool("stamp"),c.stamps.triangle()},hexagon(){d({mode:"sketch"}),c.tools.setTool("stamp"),c.stamps.hexagon()},circle(){d({mode:"sketch"}),c.tools.setTool("stamp"),c.stamps.circle()},remove(){const E=m();E.tool.requestId&&(v.setShape({points:[],open:!0}),E.cancelRequest(E.tool.requestId))}},reset:()=>{const E=m();E.tool.requestId&&E.cancelRequest(E.tool.requestId)},setPolygonState:E=>d({polygonState:typeof E=="function"?E(m().polygonState):E}),getRequestId:()=>{const E=Math.random().toString(36).slice(2);return d(T=>({validRequestIds:[...T.validRequestIds,E]})),{requestId:E,clear:()=>{m().tool.requestId,d(T=>({tool:T.tool.requestId===E?{enabled:!1,requestId:null,canvasId:null}:T.tool,validRequestIds:T.validRequestIds.filter(P=>P!==E)}))}}},cancelRequest:E=>{const T=E||m().tool.requestId;T&&(d(P=>({mode:"explore",tool:P.tool.requestId===T?{enabled:!1,requestId:null,canvasId:null}:P.tool,validRequestIds:P.validRequestIds.filter(k=>k!==T)})),t.emit("atlas.request-cancelled",{id:T}))},requestAnnotation:async(E,T)=>{const k={...m().requests,[T.requestId]:E},R=ew(E);s&&console.log("requestAnnotation",{response:R,request:E});try{const{points:_=[],open:M=!0}=R.polygon||{},{requestId:L,canvasId:$=null,toolId:F}=T;let H=F;const se=m(),oe=se.validRequestIds.includes(L),me=R.requestType;return s&&console.log("setting points",{requestType:me,points:_,open:M}),!oe||se.tool.enabled?null:(v.setShape({id:L,points:_,open:M}),me==="polygon"&&(H=H||"pen",v.tools.setTool("pen")),me==="draw"&&(H=H||"draw",v.tools.setTool("pencil")),me==="box"&&(H=H||"box",v.tools.setTool("box")),me==="target"?(H=H||"box",v.tools.setTool("box"),v.lockAspectRatio(),v.tools.lockToolSwitching(),v.tools.setCanDeselect(!1),v.tools.setCanDelete(!1)):(v.tools.unlockToolSwitching(),v.tools.setCanDeselect(!0),v.tools.setCanDelete(!0)),E.bounds&&v.setBounds(E.bounds),t.emit("atlas.annotation-request",{id:L}),d({polygon:{id:L,points:_,open:M},mode:"sketch",requestType:me,tool:{enabled:!0,requestId:L,canvasId:$},requests:k}),H?se.switchTool[H]?.():_.length===0&&se.switchTool.box(),(typeof E.selectByDefault>"u"&&_.length&&me==="box"||E.selectByDefault)&&se.switchTool.pointer(),new Promise(K=>{const ge=we=>{we.id===L&&(d(le=>({mode:"explore",tool:{requestId:null,enabled:!1,canvasId:null},requests:Object.fromEntries(Object.entries(le.requests).filter(([Ie])=>Ie!==L))})),t.off("atlas.request-cancelled",ge),t.off("atlas.annotation-completed",de),K(null))},de=we=>{we.id===L&&(d(le=>({mode:"explore",tool:{requestId:null,enabled:!1,canvasId:null},requests:Object.fromEntries(Object.entries(le.requests).filter(([Ie])=>Ie!==L))})),t.off("atlas.annotation-completed",de),t.off("atlas.request-cancelled",ge),K(we))};t.on("atlas.request-cancelled",ge),t.on("atlas.annotation-completed",de)}))}catch(_){return console.error(_),null}},completeRequest:E=>{const T=m().tool.requestId;if(typeof E=="string"&&E&&E!==T)return;const P=T?m().requests[T]?.arguments||{}:{},k=T?m().metadata[T]||{}:{},R=m().polygonState.bounds,_=m().polygon;_&&(t.emit("atlas.annotation-completed",{id:_.id,polygon:_,requestType:m().requestType,target:fg(_,R),canvasId:m().tool.canvasId,boundingBox:Ld(_),metadata:k,arguments:{...P}}),v.setShape(null))},setAtlasRuntime:E=>{y=E,t.emit("atlas.ready",{runtime:E}),c.setScale(1/y._lastGoodScale),y.world.addLayoutSubscriber((T,P)=>{(T==="event-activation"||T==="zoom-to"||T==="go-home")&&y?._lastGoodScale&&!Number.isNaN(y._lastGoodScale)&&c.setScale(1/y._lastGoodScale)})},clearAtlasRuntime:()=>{y=null,d({stableViewport:null})},setCanvasRelativePosition:(E,T)=>{d(P=>({canvasRelativePositions:{...P.canvasRelativePositions,[E]:T}}))},clearCanvasRelativePosition:E=>{d(T=>{const P={...T.canvasRelativePositions};return delete P[E],{canvasRelativePositions:P}})},changeMode:E=>{d({mode:E})},nudgeLeft:()=>{},nudgeRight:()=>{},nudgeUp:()=>{},nudgeDown:()=>{},zoomIn:()=>{y?.world?.zoomIn()},zoomOut:()=>{y?.world?.zoomOut()},goHome:()=>{y?.world?.goHome()}}}),c=a.getState().polygons;return t.on("atlas.annotation-request",()=>{c.clock.start((d,m,y)=>{t.emit("atlas.polygon-render",{state:d,slowState:m,dt:y})},d=>{typeof d=="object"?a.setState({polygonState:d}):a.setState(m=>({polygonState:d(m.polygonState)}))})}),t.on("atlas.annotation-completed",()=>{c.clock.stop()}),t.on("atlas.request-cancelled",()=>{c.clock.stop()}),a}const Fc=O.createContext(null);function sl(){return O.useContext(Fc)}const dg={};function j2(t="atlas"){return dg[t]?.getState()}function Ng({children:t,name:e="atlas",existing:n,atlasStoreConfig:r}){const s=$T(),a=O.useContext(Fc),c=O.useMemo(()=>n||a||M2({events:s,...r||{}}),[s,n,a]),d=Tt(c,m=>m.mode);return O.useEffect(()=>{const m=e;return m&&(dg[m]=c),()=>{m&&delete dg[m]}},[c,e]),I.jsx(Fc.Provider,{value:c,children:I.jsx(Wc.Provider,{value:d||"explore",children:t})})}function L2(){return{default:{backgroundColor:"rgba(0,0,0,0)",borderWidth:"2px",borderColor:"rgba(252,0,98, .5)"},highlighted:{backgroundColor:"rgba(78, 86, 228, 0.2)",borderWidth:"0px",borderColor:"rgba(78, 86, 228, 0.5)"},hidden:{borderWidth:"0px",borderColor:"rgba(0,0,0,0)",backgroundColor:"rgba(0,0,0,0)",hidden:!0}}}const tw=O.createContext(L2());tw.displayName="AnnotationStyle";function N2(){return O.useContext(tw)}function nw(t={},e=[]){const{id:n,selector:r}=t,s=pu(),a=cr(),c=n||s.annotation,d=zr(y=>c?y.iiif.entities.Annotation[c]:void 0,[c]),m=zr(y=>d&&d.body?d.body.map(h=>h?h.type==="SpecificResource"?{...h,source:a.get(h)}:h?y.iiif.entities[h.type][h.id]:null:null).filter(Boolean):[],[d]);return O.useMemo(()=>{if(!d)return;const y={...d,body:m,target:fi(d.target,{typeMap:a.getState().iiif.mapping})};return r?r(y):y},[d,r,m,...e])}function pn(t={},e=[]){const{id:n,selector:r}=t,s=pu(),a=n||s.canvas,c=zr(d=>a?d.iiif.entities.Canvas[a]:void 0,[a]);return O.useMemo(()=>{if(c)return r?r(c):c},[c,r,...e])}function z2(t=Uc){return{addEventListener(e,n,r,s){if(e)return t.setMetaValue([e.id,"eventManager",n],a=>{let c=a||[];for(let d of c)if(d.callback===r)return c;return[...c,{callback:r,scope:s}]}),r},removeEventListener(e,n,r){e&&t.setMetaValue([e.id,"eventManager",n],s=>(s||[]).filter(a=>a.callback!==r))},getListenersAsProps(e,n){let r=typeof e=="string"?{id:e}:e;if(!r||!r.id)return{};let s=t.getResourceMeta(r.id,"eventManager"),a={};if(s&&r)for(let c of Object.keys(s))a[c]=d=>{let m=t.get(r);for(let{callback:y,scope:h}of s[c]||[])(!h||n&&h.indexOf(n)!==-1)&&y(d,m)};return a}}}function rw(t,e){const n=cr(),r=O.useMemo(()=>z2(n),[n]),s=zr(()=>t&&t.id?n.getResourceMeta(t.id,"eventManager"):null,[t]);return O.useMemo(()=>t?r.getListenersAsProps(t,e):{},[s,t,n,e])}function iw(t=Uc){return{applyStyles(e,n,r){let s=typeof e=="string"?e:e.id;return t.setMetaValue([s,"styles",n],r)},getAppliedStyles(e){let n=typeof e=="string"?e:e.id;return t.getResourceMeta(n,"styles")}}}function Nd(t,e){const n=cr(),r=O.useMemo(()=>iw(n),[n]);return zr(()=>{if(!t)return null;const s=r.getAppliedStyles(t.id);return s?e?s[e]:s:void 0},[t,e])}const zg=({id:t,style:e,className:n,interactive:r,targetId:s,ignoreTargetId:a})=>{const c=nw({id:t}),d=Nd(c,"atlas"),m=Nd(c,"html"),y=rw(c,["atlas"]),h=pn(),v=N2(),E=O.useMemo(()=>Ny(Ny(e,d),c?.motivation?.includes("highlighting")?v.highlighted:v.default),[e,d,v,c?.motivation]),T=s||h?.id;return h&&c&&c.target&&c.target.selector&&(c.target.selector.type==="BoxSelector"||c.target.selector.type==="SvgSelector")&&c.target.source&&(a?!0:c.target.source.id===T||c.target.source===T)?I.jsx(DT,{id:c.id,isEditing:!0,region:c.target.selector.spatial,style:E,className:m?.className||n,interactive:!!(m?.href||r),href:m?.href||null,title:m?.title||null,hrefTarget:m?.target||null,onClick:()=>{},...y}):null};function F2(t={},e=[]){const{id:n,selector:r}=t,s=pu(),a=n||s.annotationPage,c=zr(d=>a?d.iiif.entities.AnnotationPage[a]:void 0,[a]);return O.useMemo(()=>{if(c)return r?r(c):c},[c,...e])}const Dc=({className:t,page:e,targetId:n,ignoreTargetId:r})=>{const s=F2({id:e.id})||e,a=Nd(s,"atlas"),c=Nd(s,"html");return zr(d=>s.id?d.iiif.entities.AnnotationPage[s.id]:null,[]),I.jsx(O.Fragment,{children:s.items?.map(d=>I.jsx(zg,{id:d.id,style:a,className:c?.className||t,targetId:n,ignoreTargetId:r},d.id))})},D2=O.createContext(null),B2=O.createContext(null),$2=O.createContext(null);function sw({actions:t,state:e,children:n,currentTime:r,progress:s,element:a}){return I.jsx($2.Provider,{value:{currentTime:r,progress:s,element:a},children:I.jsx(B2.Provider,{value:t,children:I.jsx(D2.Provider,{value:e,children:n})})})}function U2(t,e,n=[],r=!1,s=[]){if(s.length&&(e=e.filter(c=>s.indexOf(c)===-1)),!e||e.length===0)return;if(e.length===1)return e[0];if(!t)return e.indexOf("none")===-1?e[0]:"none";if(e.indexOf(t)!==-1)return t;let a=t.indexOf("-")===-1?null:t.slice(0,t.indexOf("-"));if(a&&e.indexOf(a)!==-1)return a;for(let c of n)if(e.indexOf(c)!==-1)return c;if(!r&&t){let c=e.map(m=>m.indexOf("-")===-1?null:m.slice(0,m.indexOf("-"))),d=c.indexOf(t);if(d!==-1)return e[d];for(let m of n){let y=m.indexOf("-")===-1?null:m.slice(0,m.indexOf("-")),h=y?e.indexOf(y):-1;if(h!==-1)return e[h]}}return e.indexOf("none")===-1?e.indexOf("@none")===-1?e[0]:"@none":"none"}function ow(t,e,n={}){let{strictFallback:r=!1,defaultText:s="",separator:a=`
`,fallbackLanguages:c=[],closest:d,skipLanguages:m}=n,y=Object.keys(t||{}),h=d?e:U2(e,y,c,r,m);if(!t)return s;if(typeof t=="string")return t;let v=h?t[h]:void 0;if(v&&h){if(typeof v=="string")return v;if(v.length===1&&v[0]===""){let E=n.skipLanguages||[];return ow(t,e,{...n,skipLanguages:[...E,h]})}return v.join(a)}return""}function W2(t,e={}){return ow(t,e.language||(typeof navigator<"u"?navigator.language:"en"),e)}function H2(t){return t.type==="SpecificResource"?[t.source,{selector:t.selector}]:[t,{selector:null}]}function V2(t=Uc){function e(s){let a=s?typeof s=="string"?t.get(s):s:null;if(!a)return[];let c=t.get(a.items,{parent:a}),d=[];for(let m of c)d.push(...t.get(m.items,{parent:m}));return d}function n(s,a=[]){let c=Array.isArray(s)?s:e(s),d=[],m={items:[],type:"complex-choice"},y=[];for(let h of c){if(h.type!=="Annotation")throw Error("getPaintables() accept either a canvas or list of annotations");let v=Array.from(Array.isArray(h.body)?h.body:[h.body]);for(let E of v){let[T,{selector:P}]=H2(E),k=t.get(T),R=(k.type||"unknown").toLowerCase();if(R==="choice"){let _=t.get(k.items,{parent:k.id}),M=a.length?a.map(L=>_.find($=>$.id===L)).filter(Boolean):[_[0]];M.length===0&&M.push(_[0]),m.items.push({type:"single-choice",items:_.map(L=>({id:L.id,label:L.label,selected:M.indexOf(L)!==-1})),label:T.label}),v.push(...M);continue}d.indexOf(R)===-1&&d.push(R),y.push({type:R,annotationId:h.id,annotation:h,resource:k,target:h.target,selector:P})}}return{types:d,items:y,choice:m.items.length<2?m.items[0]||null:m,allChoices:m.items.length?m:null}}function r(s){let{choice:a}=n(s);return a}return{getAllPaintingAnnotations:e,getPaintables:n,extractChoices:r}}function lw(){const t=ss(),e=pn();return O.useMemo(()=>{if(!t||!e||!t.start)return null;const n=fi(t.start);return!n||n.source.id!==e.id||!n||!n.selector||n.selector.type!=="TemporalSelector"?null:n.selector.temporal},[t,e])}function Uy(t){return{isMuted:!1,playRequested:!1,isPlaying:!1,isFinished:!1,volume:100,duration:t}}function q2(t,e){switch(e.type){case"RESET":return e.state;case"FINISHED":return{...t,isFinished:!0,isPlaying:!1,playRequested:!1};case"PLAY_PAUSE":return{...t,isFinished:!1,isPlaying:!t.isPlaying};case"PLAY_REQUESTED":return{...t,isFinished:!1,playRequested:!0};case"PAUSE":return{...t,isPlaying:!1};case"PLAY":return{...t,isFinished:!1,playRequested:!1,isPlaying:!0};case"MUTE":return{...t,isMuted:!0};case"SET_VOLUME":return{...t,volume:e.volume,isMuted:e.volume===0};case"TOGGLE_MUTE":return{...t,isMuted:!t.isMuted};case"UNMUTE":return{...t,isMuted:!1}}return t}function Fg(t){const e=Math.round(t);return`${Math.floor(e/60)}:${`${e%60}`.padStart(2,"0")}`}function Dg(t){const[e,n]=O.useReducer(q2,Uy(t.duration));O.useEffect(()=>{n({type:"RESET",state:Uy(t.duration)})},[t.duration]);const r=O.useRef(null),s=O.useRef(null),a=O.useRef(null),c=O.useRef(!1),d=O.useCallback(()=>{s.current&&r.current&&(s.current.innerHTML=Fg(r.current.currentTime),a.current&&(a.current.style.width=`${r.current.currentTime/t.duration*100}%`),c.current!==r.current.muted&&(c.current=r.current.muted,n(r.current.muted?{type:"MUTE"}:{type:"UNMUTE"})))},[t.duration]),m=O.useCallback(()=>{r.current&&(n({type:"PLAY_REQUESTED"}),r.current.play().then(()=>{n({type:"PLAY"})}),d())},[d]),y=O.useCallback(()=>{r.current&&(r.current.duration>0&&r.current.paused?m():h())},[d]),h=O.useCallback(()=>{r.current&&(r.current.pause(),n({type:"PAUSE"}),d())},[d]),v=O.useCallback(()=>{r.current&&(r.current.muted=!r.current.muted,n(r.current.muted?{type:"MUTE"}:{type:"UNMUTE"}))},[]),E=O.useCallback(()=>{r.current&&(r.current.muted=!0,n({type:"MUTE"}))},[]),T=O.useCallback(()=>{r.current&&(r.current.muted=!1,n({type:"UNMUTE"}))},[]),P=O.useCallback(_=>{r.current&&(r.current.muted=!1,r.current.volume=_/100,n({type:"SET_VOLUME",volume:_}))},[]),k=O.useCallback(_=>{r.current&&(r.current.currentTime=Math.max(0,Math.min(_*t.duration,t.duration)),d())},[]),R=O.useCallback(_=>{if(r.current){const M=typeof _=="function"?_(r.current.currentTime):_;r.current.currentTime=Math.max(0,Math.min(M,t.duration)),d()}},[]);return O.useEffect(()=>{const _=setInterval(()=>{d()},350);return()=>clearInterval(_)},[d,t.duration]),O.useEffect(()=>{const _=()=>{n({type:"FINISHED"})},M=r.current;return M?.addEventListener("ended",_),()=>M?.removeEventListener("ended",_)},[]),[{element:r,currentTime:s,progress:a},e,{play:m,pause:h,playPause:y,mute:E,unmute:T,toggleMute:v,setVolume:P,setDurationPercent:k,setTime:R}]}const aw=O.createContext(()=>{}),uw=O.createContext(()=>{});function rl(t,e,n,r,s=[]){const a=O.useContext(t==="portal"?uw:aw);O.useEffect(()=>(t!=="none"&&a(e,n,r),()=>{a(e,null)}),[e,t,a,...s])}function cw({media:t,startTime:e,children:n}){const[{element:r,currentTime:s,progress:a},c,d]=Dg({duration:t.duration}),m=e?`${t.url}#t=${e}`:t.url;return I.jsxs(sw,{state:c,actions:d,currentTime:s,progress:a,element:r,children:[I.jsx("audio",{ref:r,src:m}),n]},t.url)}function fw({media:t,mediaControlsDeps:e,audioCopmonent:n=cw,children:r}){const s=lw();return rl("portal","audio",n,{media:t,startTime:s?s.startTime:null,children:r},[t,s,...e||[]]),null}const Qc=O.createContext(null);Qc.displayName="Strategy";function Ai(){const t=O.useContext(Qc);if(!t)throw new Error("useStrategy must be used within a StrategyProvider");return t}function dw({model:t}){return I.jsxs(I.Fragment,{children:[I.jsx("style",{children:`
            .model-container {
              position: absolute;
              top: 0;
              bottom: 0;
              left: 0;
              right: 0;
              background: #000;
              z-index: 13;
              display: flex;
              justify-content: center;
              pointer-events: visible;
            }
          `}),I.jsx("div",{className:"model-container",children:I.jsx("model-viewer",{"interaction-prompt":"none",style:{width:"100%",height:"100%"},"camera-controls":"","ar-status":"not-presenting",src:t.id})})]})}function hw({model:t,name:e}){return rl("overlay",`model-${e}`,dw,{model:t},[t]),null}function Q2(){const{strategy:t}=Ai();return t.type!=="3d-model"?null:I.jsx(hw,{model:t.model})}const Bg=O.createContext(null);Bg.displayName="Controls";function na(){const t=O.useContext(Bg);if(!t)throw new Error("useStrategy must be used within a StrategyProvider");return t}function X2(){const{strategy:t}=Ai(),{renderViewerControls:e,viewControlsDeps:n}=na(),r=pn(),s=r?.accompanyingCanvas,a=r?.placeholderCanvas;return I.jsxs(I.Fragment,{children:[t.type==="media"&&t.media.type==="Sound"&&s?I.jsx(du,{canvas:s.id,children:I.jsx(Ud,{renderViewerControls:e,viewControlsDeps:n})}):null,t.type==="media"&&t.media.type==="Sound"&&a&&!s?I.jsx(du,{canvas:a.id,children:I.jsx(Ud,{renderViewerControls:e,viewControlsDeps:n})}):null]})}function Y2(){const e=cr().getStore();return O.useMemo(()=>n=>e.dispatch(n),[e])}function Wy(t){return typeof t!="string"&&t&&t.bindToVault}function K2(){const t=cr(),e=O.useRef([]),n=Y2(),r=O.useMemo(()=>`vault://annotation-page/${new Date().getTime()}/${Math.round(Math.random()*1e9).toString(16)}`,[]);O.useLayoutEffect(()=>{const d={id:r,type:"AnnotationPage",behavior:[],label:null,thumbnail:[],summary:null,requiredStatement:null,metadata:[],rights:null,provider:[],items:[],seeAlso:[],homepage:[],rendering:[],service:[]};n(Ed.importEntities({entities:{AnnotationPage:{[d.id]:d}}}))},[r]);const s=zr(d=>r&&d.iiif.entities.AnnotationPage[r]||null,[r]),a=O.useCallback((d,m)=>{if(r){if(Wy(d)){const v=d;v.__vault||v.bindToVault(t),d=typeof v.source=="string"?v.source:v.source.id,e.current[d]=v}else typeof d!="string"&&(d=d.id);const y=t.get({id:r,type:"AnnotationPage"}),h=t.get({id:d,type:"Annotation"});y&&h&&(y.items.find(v=>v.id===h.id)||n(Ed.addReference({id:r,type:"AnnotationPage",key:"items",reference:{id:d,type:"Annotation"},index:m})))}},[r]),c=O.useCallback(d=>{r&&(Wy(d)?d=typeof d.source=="string"?d.source:d.source.id:typeof d!="string"&&(d=d.id),e.current[d]&&e.current[d].beforeRemove(),t.get({id:r,type:"AnnotationPage"})&&n(Ed.removeReference({id:r,type:"AnnotationPage",key:"items",reference:{id:d,type:"Annotation"}})))},[r]);return[s,{addAnnotation:a,removeAnnotation:c}]}const pw=O.createContext(null);function G2(){const t=O.useContext(pw);return[t.fullPage,{addAnnotation:t.addAnnotation,removeAnnotation:t.removeAnnotation}]}function Z2({children:t}){const[e,{addAnnotation:n,removeAnnotation:r}]=K2();return I.jsx(pw.Provider,{value:O.useMemo(()=>({fullPage:e,addAnnotation:n,removeAnnotation:r}),[e]),children:t})}function J2({children:t}){const{strategy:e}=Ai(),[n]=G2();return e.type!=="images"?null:I.jsxs(I.Fragment,{children:[n?I.jsx(Dc,{page:n}):null,e.annotations&&e.annotations.pages?e.annotations.pages.map(r=>I.jsx(Dc,{page:r},r.id)):null,t]})}const eb=(t,e=[])=>{const n=cr();O.useEffect(()=>{t(n)},[n,...e])},tb=Xt.createContext(new Ag);function nb(){return O.useContext(tb)}function sh(t,e,{canvasId:n,manifestId:r}={}){const s=cr(),a=nb(),c=O.useMemo(()=>YC(s,{imageServiceLoader:a}),[s,a]),[d,m]=O.useState(),y=ss(r?{id:r}:void 0),h=pn(n?{id:n}:void 0),v=h||y,E=O.useRef(!1);if(O.useEffect(()=>(E.current=!1,()=>{E.current=!0}),[]),!v)throw new Error("Must be called under a manifest or canvas context.");return eb(T=>{c.getBestThumbnailAtSize(v,t,e).then(P=>{P.best&&!E.current&&m(P.best)})},[v]),d}function $g({x:t=0,y:e=0}){const n=pn(),r=sh({maxWidth:256,maxHeight:256});return!n||!r||r.type!=="fixed"?null:I.jsx("world-object",{height:n.height,width:n.width,x:t,y:e,children:I.jsx("world-image",{uri:r.id,target:{x:0,y:0,width:n.width,height:n.height},display:r.width&&r.height?{width:r.width,height:r.height}:void 0,crop:void 0})})}function rb({as:t}){const{strategy:e}=Ai(),{renderMediaControls:n,mediaControlsDeps:r}=na();return e.type!=="media"||e.media.type!=="Sound"?null:I.jsxs(fw,{media:e.media,mediaControlsDeps:r,audioCopmonent:t,children:[I.jsx($g,{}),n?n(e):null]},e.media.url)}const Ug=O.createContext(null);Ug.displayName="ComplexTimeline";function ib({children:t,store:e}){return I.jsx(Ug.Provider,{value:e,children:t})}function Ko(t){const e=O.useContext(Ug);if(!e)throw new Error("useComplexTimeline must be used within a ComplexTimelineProvider");return Tt(e,t)}function Hy({currentKeyFrameIndex:t,keyframes:e,targetTime:n,currentTime:r}){if(r<=n){const s=e.findIndex(d=>d.time>n);if(s===-1)return[t,[]];const a={},c=e.slice(t,s);for(const d of c)d.type==="enter"&&(a[d.id]=d),d.type==="exit"&&(a[d.id]?delete a[d.id]:a[d.id]=d);return[s,Object.values(a)]}return[t,[]]}function sb({complexTimeline:t,startTime:e=0}){const n=Vc(),r={},s={progress:null,currentTime:null};let a=0,c=null,d=0;function m(){const k=T.getState().visibleElements,R=r,_=[],M=Object.keys(R);for(const L of M){const $=R[L],F=k[L];$&&F&&_.push($)}return _}function y(){return Object.keys(r).map(k=>r[k])}function h(P){s.currentTime&&(s.currentTime.innerHTML=Fg(P),s.progress&&(s.progress.style.width=`${P/t.duration*100}%`))}const v=(P=0)=>{const k=P-a,R=T.getState();if(R.isPlaying){const _=R.currentPrime;if(_){const F=r[_.id];F&&(F.paused?d+=k:d=(_.time+F.currentTime)*1e3)}else d+=k;const M=d/1e3;if(M>R.duration){T.setState({isPlaying:!1}),T.getState().setTime(0),E(),h(0);return}h(M);const[L,$]=Hy({currentTime:M,currentKeyFrameIndex:R.nextKeyframeIndex,keyframes:R.complexTimeline.keyframes,targetTime:M});$.length&&R.applyKeyframes(L,$)}a=P,c=requestAnimationFrame(v)},E=()=>{c&&cancelAnimationFrame(c)},T=ta((P,k)=>({complexTimeline:t,elements:{},visibleElements:{},isBuffering:!1,bufferMap:{},isMuted:!1,playRequested:!1,isPlaying:!1,isFinished:!1,isReady:!1,volume:100,duration:t.duration,clockStartRequests:0,clockStartTime:0,primeTime:0,currentPrime:null,clockRunning:!1,nextKeyframeIndex:0,startClock:()=>{k().clockRunning||v(),P({clockRunning:!0,clockStartRequests:k().clockStartRequests+1})},applyKeyframes(R,_){const M=k(),L={...M.visibleElements};let $=M.currentPrime;for(const F of _)F.type==="enter"&&(L[F.id]=F,n.emit("complex-timeline.enter",{id:F.id})),F.type==="exit"&&(L[F.id]=null,n.emit("complex-timeline.exit",{id:F.id})),F.isPrime&&($=F);P({nextKeyframeIndex:R,visibleElements:L,currentPrime:$})},stopClock:()=>{const R=k().clockStartRequests;if(R!==0){if(R===1){E(),P({clockRunning:!1,clockStartRequests:0});return}P({clockStartRequests:R-1})}},setElement:(R,_)=>{r[R]=_;const M=Object.keys(r),L=k().complexTimeline;L.items.filter(F=>F.type!=="Image"&&F.type!=="Text").every(F=>M.includes(F.annotationId))&&!k().isReady&&(n.emit("complex-timeline.ready",{complexTimeline:L}),P({isReady:!0}))},removeElement:R=>{delete r[R]},mute(){for(const R of y())R.muted=!0;P({isMuted:!0})},unmute(){for(const R of y())R.muted=!1;P({isMuted:!1})},play(){if(!k().isPlaying){for(const _ of m())_.play();P({isPlaying:!0})}},pause(){if(k().isPlaying){for(const _ of m())_.pause();P({isPlaying:!1})}},playPause(){const R=k();R.isPlaying?R.pause():R.play()},setDurationPercent(R){const M=k().duration*R;k().setTime(M)},setTime(R){const _=k();let M=d/1e3;const L=typeof R=="function"?R(M):R;let $=_.nextKeyframeIndex;if(M>L){P({visibleElements:{},currentPrime:null});const ge=Object.keys(_.visibleElements);for(const de of ge)n.emit("complex-timeline.exit",{id:de});M=0,$=0}const[F,H]=Hy({currentTime:M,currentKeyFrameIndex:$,keyframes:_.complexTimeline.keyframes,targetTime:L});_.applyKeyframes(F,H),d=L*1e3;const oe=T.getState().visibleElements,me=r,K=Object.keys(oe);for(const ge of K){const de=oe[ge];if(de){const we=me[ge];we&&(we.currentTime=(d-de.time*1e3)/1e3)}}h(L)},setVolume(R){for(const _ of y())_.volume=Math.min(1,Math.max(0,R/100));P({volume:R})},toggleMute(){const R=k();R.isMuted?(R.unmute(),P({isMuted:!1})):(R.mute(),P({isMuted:!0}))},clearProgressElement(){s.progress=null},setProgressElement(R){s.progress=R},setCurrentTimeElement(R){s.currentTime=R},clearCurrentTimeElement(){s.currentTime=null}}));return n.on("complex-timeline.enter",P=>{const k=T.getState(),R=P.id,_=r[R];_&&k.isPlaying&&_.play()}),n.on("complex-timeline.exit",P=>{T.getState();const k=P.id,R=r[k];R&&(R.currentTime=0,R.pause())}),T.getState().setTime(e),{store:T,emitter:n}}const gw=Xt.createContext(QC.store);gw.displayName="ImageServicesHelper";function Wg(){return O.useContext(gw)}function ob(t){const e=Wg();return Tt(e,({loaded:n})=>n[t])}function mw(){const t=Wg();return Tt(t,({loadServiceSync:e})=>e)}function lb(){const t=Wg();return Tt(t,({loaded:e})=>e)}const ab=Xt.createContext("en"),ub=Xt.createContext({}),cb=Xt.createContext(null);function fb(){return Xt.useContext(cb)}function yw(){return Xt.useContext(ab)}function db(){return Xt.useContext(ub)}function Vy(t){return t.indexOf("-")!==-1?t.slice(0,t.indexOf("-")):t}function hb({as:t,language:e,children:n,viewingDirection:r,...s}){const a=yw();return O.useMemo(()=>Vy(a)===Vy(e),[a,e])?t?I.jsx(t,{...s,children:n}):I.jsx("span",{...s,children:n}):t?I.jsx(t,{...s,lang:e,dir:r,children:n}):I.jsx("span",{...s,lang:e,dir:r,children:n})}function pb(t,e,n){if(e.length===0)return;if(e.length===1)return e[0];if(e.indexOf(t)!==-1)return t;const r=t.indexOf("-")!==-1?t.slice(0,t.indexOf("-")):null;if(r&&e.indexOf(r)!==-1)return r;for(const s of n)if(e.indexOf(s)!==-1)return s;return e.indexOf("none")!==-1?"none":e.indexOf("@none")!==-1?"@none":e[0]}const gb=(t,e=[])=>{const n=yw();return O.useMemo(()=>{const r=t();return pb(n,r,[])},[n,...e])};function Mp(t,e,n,r){return e?n?n(t[e]||e,r||"none"):t[e]||e:""}function mb(t,e,n=`
`,r={}){const s=fb(),a=gb(()=>Object.keys(t||{}),[t]);return[O.useMemo(()=>{if(!t)return Mp(r,e,s)||"";if(typeof t=="string")return Mp(r,t,s);const c=a?t[a]:void 0;return c?typeof c=="string"?c:c.map(d=>Mp(r,d,s,a)).join(n):""},[a,e,t]),a]}function Hs({as:t,defaultText:e,enableDangerouslySetInnerHTML:n,children:r,separator:s,...a}){const c=db(),[d,m]=mb(r,e,s,c);return m?I.jsx(hb,{...a,as:t,language:m,title:n?void 0:d,dangerouslySetInnerHTML:n?{__html:d}:void 0,children:n?void 0:d}):t?I.jsx(t,{...a,children:d}):I.jsx("span",{...a,title:n?void 0:d,dangerouslySetInnerHTML:n?{__html:d}:void 0,children:n?void 0:d})}const qy=t=>{const e=t.format||"jpg",n=t.width/(t.crop?.width||t.tiles.width),r=t.tiles.imageService.sizes||[],s=t.enableThumbnail,a=t.enableSizes,c=O.useMemo(()=>{const y=t.tiles.imageService.id||t.tiles.imageService["@id"];return y?.endsWith("/info.json")?y.slice(0,-10):y},[t.tiles.imageService.id,t.tiles.imageService["@id"]]),d=O.useMemo(()=>{const y=t.tiles.imageService.tiles||[];if(!y.length){const h=t.width,v=[1];let E=1;for(;2**E<h;)E=E*2,v.push(E);return(t.tiles.imageService.maxArea||t.tiles.imageService.maxWidth||t.tiles.imageService.maxHeight)&&bc(2,t.tiles.imageService)?[{width:256,height:256,scaleFactors:v}]:bc(2,t.tiles.imageService)?[{width:256,height:256,scaleFactors:v}]:[]}return y},[t.tiles.imageService,t.width]),m=O.useMemo(()=>{const y=t.tiles.imageService;return(y?y["@context"]?Array.isArray(y["@context"])?y["@context"]:[y["@context"]]:[]:[]).indexOf("http://iiif.io/api/image/3/context.json")!==-1},[t.tiles.imageService.id,t.tiles.imageService]);return I.jsx("world-object",{rotation:t.rotation,scale:n,height:t.crop?.height||t.tiles.height,width:t.crop?.width||t.tiles.width,x:t.x,y:t.y,onClick:t.onClick,children:I.jsxs("composite-image",{id:t.tiles.imageService.id,width:t.crop?.width||t.tiles.width,height:t.crop?.height||t.tiles.height,crop:t.crop,renderOptions:t.renderOptions,children:[s&&t.tiles.thumbnail?I.jsx("world-image",{priority:!0,uri:t.tiles.thumbnail.id,target:{width:t.tiles.width,height:t.tiles.height},display:{width:t.tiles.thumbnail.width,height:t.tiles.thumbnail.height},crop:t.crop}):null,a&&r.map((y,h)=>I.jsx("world-image",{uri:`${c}/full/${y.width},${m?y.height:""}/0/default.${e}`,target:{width:t.tiles.width,height:t.tiles.height},display:{width:y.width,height:y.height},crop:t.crop},h)),d.map(y=>(y.scaleFactors||[]).map(h=>I.jsx("tiled-image",{uri:t.tiles.imageService.id,display:{width:t.tiles.width,height:t.tiles.height},format:e,tile:y,scaleFactor:h,crop:t.crop,version3:m},`${t.tiles.imageService.id}-tile-${h}`)))]},t.tiles.imageService.id)},t.tiles.imageService.id)};function yb({resource:t,heading:e,note:n,extra:r}){return r?I.jsx(Xs,{target:{x:-1,y:-1,width:r.target?.spatial.width,height:r.target?.spatial.height},backgroundColor:"#333",relative:!0,children:I.jsx("div",{style:{display:"flex",alignContent:"center",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",background:"#444",color:"#BBB"},children:I.jsxs("div",{children:[I.jsx(Hs,{children:e||"Not authorised"}),n&&I.jsx("p",{children:I.jsx(Hs,{children:n})}),I.jsx("p",{children:t.id||t["@id"]||"unknown"})]})})}):null}function vb({image:t,thumbnail:e,crop:n,enableSizes:r,enableThumbnail:s,renderOptions:a,rotation:c}){const d=YE(),m=Vt(t.service),y=ob(m),h=mw(),v=y?.service;h(t.service,t);const E=v&&y?.status==="done",T=(v?.preferredFormats||[])[0],P=e&&e.type==="fixed"&&e.id&&!e.id.includes("/full/full/")&&!e.id.includes("/max/")?e:void 0;if(E===!1)return null;if(!d){const k=t.service,R=k.width||t.width||0,_=k.height||t.height||0;let M=0,L=0,$=t.target?.spatial.width||R,F=t.target?.spatial.height||_;return(c===90||c===270)&&([$,F]=[F,$],F>$?L=-(F-$)/2:M=-($-F)/2),I.jsx(qy,{enableThumbnail:s,renderOptions:a,rotation:c,tiles:{id:k.id||k["@id"]||"unknown",height:_,width:R,imageService:k,thumbnail:P},enableSizes:r,x:M,y:L,format:T,width:$,height:F,crop:n})}return I.jsx(ek,{resource:t.service,errorComponent:yb,extra:t,children:k=>{const R=k.width||t.width||0,_=k.height||t.height||0;let M=0,L=0,$=t.target?.spatial.width||R,F=t.target?.spatial.height||_;return(c===90||c===270)&&([$,F]=[F,$],F<$?(L=-(F-$)/2,M=($-F)/2):(L=(F-$)/2,M=-($-F)/2)),I.jsx(qy,{enableThumbnail:s,renderOptions:a,tiles:{id:k.id||k["@id"]||"unknown",height:_,width:R,imageService:k,thumbnail:P},rotation:c,format:T,enableSizes:r,x:M,y:L,width:$,height:F,crop:n})}},t.id)}function Hg({id:t,image:e,thumbnail:n,isStatic:r,x:s=0,y:a=0,children:c,selector:d,onClick:m,enableSizes:y,enableAnnotations:h}){const v=O.useMemo(()=>{if(!(!d||d.spatial.x===0&&d.spatial.y===0))return d.spatial},[d]),E=O.useMemo(()=>{const L=Array.isArray(e.annotation.body)?e.annotation.body?.[0]:e.annotation.body;if(L&&L.selector?.type==="ImageApiSelector")return Number(L.selector.rotation)},[e]),T=s+e.target.spatial.x,P=a+e.target.spatial.y;let k=e.target.spatial.width,R=e.target.spatial.height,_=e.target.spatial.width,M=e.target.spatial.height;return(E===90||E===270)&&([k,R]=[R,k],[_,M]=[M,_]),I.jsxs("world-object",{x:T,y:P,width:k,height:R,onClick:m,rotation:E,children:[e.service?I.jsxs(O.Fragment,{children:[I.jsx(vb,{image:e,thumbnail:n,crop:v,enableSizes:y,rotation:E}),c]},"service"):I.jsxs(O.Fragment,{children:[I.jsx("world-image",{onClick:m,uri:e.id,target:{x:-1,y:-1,width:_,height:M},display:_&&M?{width:_,height:M}:void 0,crop:v}),c]},"no-service"),h&&e.annotationPages?e.annotationPages.map(L=>I.jsx(Dc,{page:L,className:"image-service-annotation",ignoreTargetId:!0},L.id)):null]},t+(e.service?"server":"no-service"))}function xb(t){if(!t)return null;try{const e=new URL(t),n=e.hostname.replace(/^www\./,"");if(n==="youtu.be")return e.pathname.slice(1);if(n.endsWith("youtube.com")){if(e.pathname.startsWith("/embed/"))return e.pathname.split("/embed/")[1];if(e.searchParams.has("v"))return e.searchParams.get("v")}}catch{}return null}function vw({element:t,media:e,onPlay:n,onPause:r,onEnded:s}){const a=O.useRef(null),c=t,d=O.useMemo(()=>e.youTubeId??xb(e.url),[e.youTubeId,e.url]);if(!d)return null;const m=typeof window<"u"?`&origin=${encodeURIComponent(window.location.origin)}`:"",y=`https://www.youtube.com/embed/${d}?enablejsapi=1&controls=0&disablekb=1&modestbranding=1&rel=0&iv_load_policy=3&fs=0&playsinline=1&rel=0${m}`,h=O.useMemo(()=>e.annotationId??`yt-${d}`,[d,e.annotationId]);return O.useEffect(()=>{const v=c.current;if(!v)return;const E=k=>{if(k.source!==v.contentWindow||!(typeof k.origin=="string"&&(k.origin.indexOf("youtube.com")!==-1||k.origin.indexOf("youtube-nocookie.com")!==-1)))return;let _;try{_=typeof k.data=="string"?JSON.parse(k.data):k.data}catch{return}if(console.log("YouTube message received:",_),_?.event==="onStateChange"){const M=_.info;M===1?n?.():M===2?r?.():M===0&&s?.()}};window.addEventListener("message",E);const T=()=>{v.contentWindow?.postMessage(JSON.stringify({event:"listening",id:h}),"*")},P=setTimeout(T,100);return T(),()=>{clearTimeout(P),window.removeEventListener("message",E)}},[h,c,n,r,s]),I.jsxs("div",{className:"video-container",part:"video-container",children:[I.jsx("style",{children:`
          .video-container {
            position: absolute;
            inset: 0;
            background: #000;
            z-index: 13;
            display: flex;
            justify-content: center;
            pointer-events: auto; /* 'visible' n'est pas valide */
          }
          .video-yt {
            border: none;
            width: 100%;
            height: 100%;
            object-fit: contain;
          }
        `}),I.jsx("iframe",{id:h,className:"video-yt",ref:v=>{a.current=v,t&&(t.current=v)},title:"YouTube video player",src:y,allow:"autoplay; encrypted-media; picture-in-picture",loading:"lazy"})]})}function wb({media:t,mediaControlsDeps:e,children:n}){const[{element:r,currentTime:s,progress:a},c,d]=Dg({duration:t.duration});return rl("overlay","video-element",vw,{element:r,media:t,playPause:d.playPause}),null}function xw({strategy:t,onClickPaintingAnnotation:e}){return I.jsx(I.Fragment,{children:t.items.map((n,r)=>I.jsx(I.Fragment,{children:I.jsx(Xs,{onClick:e?s=>{s.stopPropagation(),e(n.annotationId,n,s)}:void 0,target:n.target?.spatial||void 0,children:I.jsx("div",{"data-textual-content":!0,children:I.jsx(Hs,{enableDangerouslySetInnerHTML:!0,children:n.text})})},r)}))})}function Sb(t){let e=!0,n=0,r=100,s=!1,a=0;const c=(m,y=[])=>{t.contentWindow?.postMessage(JSON.stringify({event:"command",func:m,args:y}),"*")},d=()=>{if(!e){const m=performance.now();n+=(m-a)/1e3,a=m,requestAnimationFrame(d)}};return{play(){e=!1,a=performance.now(),c("playVideo"),requestAnimationFrame(d)},pause(){e=!0,c("pauseVideo")},get paused(){return e},get currentTime(){return n},set currentTime(m){n=Math.max(0,m),c("seekTo",[n,!0])},get muted(){return s},set muted(m){s=m,c(m?"mute":"unMute")},get volume(){return r},set volume(m){r=Math.max(0,Math.min(100,m)),c("setVolume",[r])}}}const Pb=O.memo(function({item:e,visible:n,store:r}){const s=O.useRef(null);return O.useEffect(()=>{if(!s.current)return;const a=Sb(s.current);r.getState().setElement(e.annotationId,a)},[e.annotationId,r]),I.jsxs("div",{style:{position:"absolute",inset:0,opacity:n?1:0,pointerEvents:n?"auto":"none",width:"100%",height:"100%"},children:[I.jsx(vw,{element:s,media:e,playPause:()=>{}}),I.jsx("button",{type:"button","aria-label":"Play/Pause",onClick:a=>{a.stopPropagation(),r.getState().playPause()},style:{position:"absolute",inset:0,background:"transparent",border:0,padding:0,margin:0,cursor:"pointer",zIndex:20}})]})},(t,e)=>t.visible===e.visible&&t.item?.annotationId===e.item?.annotationId),Eb=Pb;function kb({strategy:t,children:e}){const n=O.useRef(null),r=O.useRef(null),s=O.useMemo(()=>JSON.stringify({dur:t.duration,k:t.keyframes?.length??0,items:t.items?.length??0}),[t]);if(!n.current)n.current=sb({complexTimeline:t}),r.current=s;else if(r.current!==s){const k=n.current.store;k.setState({complexTimeline:t,duration:t.duration,visibleElements:{},currentPrime:null,nextKeyframeIndex:0}),k.getState().setTime(0),r.current=s}const a=n.current.store,c=Tt(a,k=>k.isReady),d=Tt(a,k=>k.visibleElements),y=O.useContext(Hc)?.runtime||null,h=O.useCallback(k=>{if(!y)return;const R=y.getScaleFactor(),_=k/R;y.setViewport({x:y.x+_,y:y.y})},[y]),[v,E]=O.useState(!1);O.useEffect(()=>{if(typeof window>"u")return;const k=window.matchMedia("(min-width: 1024px) and (hover: hover) and (pointer: fine)"),R=L=>{E(("matches"in L,L.matches))};R(k);const _=k.addEventListener?"addEventListener":"addListener",M=k.removeEventListener?"removeEventListener":"removeListener";return k[_]("change",R),()=>k[M]("change",R)},[]);const T=O.useMemo(()=>t.items.some(k=>k.type==="Video"&&!!d[k.annotationId]),[t.items,d]);O.useEffect(()=>{if(!v||!y||!T)return;const k=setInterval(()=>{clearInterval(k),h(260)},200);return()=>clearInterval(k)},[v,y,h]);function P(k){return R=>{R&&a.getState().setElement(k,R)}}return O.useEffect(()=>{if(typeof document>"u")return;const k=document.getElementById("root");if(k){const R="has-video";return T?k.classList.add(R):k.classList.remove(R),()=>k.classList.remove(R)}},[T]),O.useLayoutEffect(()=>{if(c){const{startClock:k,stopClock:R}=a.getState();return k(),()=>{R()}}},[t,c]),rl("portal","custom-controls",ib,{store:a,children:e},[c]),I.jsxs(I.Fragment,{children:[t.items.map(k=>k.type!=="Image"||!d[k.annotationId]?null:I.jsx(Hg,{image:k,id:k.annotationId},k.id)),t.items.map((k,R)=>k.type!=="Text"||!d[k.annotationId]?null:I.jsx(xw,{strategy:{type:"textual-content",items:[k]}},R)),t.items.map((k,R)=>{if(k.type!=="Video")return null;const _=k.url||k.annotation?.body?.[0]?.id||"";if(/youtube\.com|youtu\.be/.test(_)){const L=!!d[k.annotationId];return I.jsx(Xs,{className:"video-contenaire",target:k.target.spatial,children:I.jsx(Eb,{store:a,item:k,visible:L})},R)}else return I.jsx(Xs,{className:"video-contenaire",target:k.target.spatial,children:I.jsx("video",{className:"video",ref:P(k.annotationId),src:k.url,style:{height:"100%",width:"100%",opacity:d[k.annotationId]?1:0}})},R)}),t.items.map((k,R)=>k.type!=="Sound"?null:I.jsx(Xs,{children:I.jsx("audio",{ref:P(k.annotationId),src:k.url})},R)),t.highlights.map(({annotation:k})=>d[k.id]?I.jsx(zg,{id:k.id,ignoreTargetId:!0,style:{outline:"50px solid rgba(78, 86, 228, 0.4)"},className:"image-service-annotation"},k.id):null)]})}function Cb(){const{strategy:t}=Ai(),{renderComplexTimelineControls:e}=na();return t.type!=="complex-timeline"?null:I.jsx(kb,{strategy:t,children:e?e(t):null})}function ww({style:t}){const e=pn();return!e||!e.height||!e.width?null:I.jsx("box",{interactive:!1,target:{x:0,y:0,width:Number(e.width),height:Number(e.height)},style:t})}function Tb({backgroundStyle:t,alwaysShowBackground:e}){const{strategy:n}=Ai();return n.type!=="empty"&&!e?null:I.jsx(ww,{style:t})}const oh=O.createContext(null);function Sw(){return O.useContext(oh)}function bb({isStatic:t=!1,enableSizes:e=!1,enableAnnotations:n=!0,onClickPaintingAnnotation:r,children:s}){const{strategy:a}=Ai(),{renderViewerControls:c,viewControlsDeps:d}=na(),m=pn(),y=Sw(),h=sh({maxWidth:256,maxHeight:256});return rl(y&&a.type==="images"&&c?"overlay":"none",`canvas-portal-controls-${m?.id}`,oh.Provider,c?{value:y||null,children:c(a)}:{},[m,y,a,...d||[]]),a.type!=="images"?null:I.jsxs(I.Fragment,{children:[a.images.map((v,E)=>I.jsx(Hg,{isStatic:t,image:v,id:v.id,thumbnail:E===0?h:void 0,selector:v.selector,enableSizes:e,enableAnnotations:n,onClick:r?T=>{r(v.annotationId,v,T)}:void 0},v.id+E)),s]})}function Rb({onClickPaintingAnnotation:t,children:e}){const{strategy:n}=Ai(),{renderViewerControls:r,viewControlsDeps:s}=na(),a=Sw(),c=pn();return rl(a&&n.type==="textual-content"&&r?"overlay":"none",`canvas-portal-controls-${c?.id}`,oh.Provider,r?{value:a||null,children:r(n)}:{},[c,a,n,...s||[]]),n.type!=="textual-content"?null:I.jsxs(I.Fragment,{children:[I.jsx(xw,{strategy:n,onClickPaintingAnnotation:t}),e]})}function Pw({element:t,media:e,startTime:n,playPause:r,poster:s}){const c=n?`${e.url}#t=${n}`:e.url;return I.jsxs("div",{className:"video-container",part:"video-container",onClick:r,children:[I.jsx("style",{children:`
            .video-container {
              position: absolute;
              top: 0;
              bottom: 0;
              left: 0;
              right: 0;
              background: #000;
              z-index: 13;
              display: flex;
              justify-content: center;
              pointer-events: visible;
            }
          `}),I.jsx("video",{poster:s,ref:t,src:c,style:{width:"100%",objectFit:"contain"}})]})}function Ew({media:t,mediaControlsDeps:e,children:n,videoComponent:r=Pw,captions:s}){const a=pn(),c=lw(),d=a&&a.placeholderCanvas&&a.placeholderCanvas.id||void 0,m=sh({},!1,{canvasId:d}),[{element:y,currentTime:h,progress:v},E,T]=Dg({duration:t.duration});return rl("overlay","video-element",r,{element:y,media:t,playPause:T.playPause,poster:m?.id,canvas:a,startTime:c?c.startTime:null,captions:s},[m]),rl("portal","custom-controls",sw,{state:E,actions:T,currentTime:h,progress:v,element:y,children:n},[h,E,t,...e||[]]),null}function _b({as:t}){const{strategy:e}=Ai(),{renderMediaControls:n,mediaControlsDeps:r}=na();return e.type!=="media"||e.media.type!=="Video"?null:I.jsxs(Ew,{captions:e.captions,media:e.media,mediaControlsDeps:r,videoComponent:t,children:[I.jsx($g,{}),n?n(e):null]},e.media.url)}function Ib(){const{strategy:t}=Ai(),{renderMediaControls:e,mediaControlsDeps:n}=na();return t.type!=="media"||t.media.type!=="VideoYouTube"?null:I.jsxs(wb,{media:t.media,mediaControlsDeps:n,children:[I.jsx($g,{}),e?e(t):null]})}function Ob(t){const e=sl(),n=Tt(e,a=>a.polygons),r=Tt(e,a=>a.polygonState),s=Tt(e,a=>a.polygon);return UT("atlas.polygon-render",({state:a,slowState:c,dt:d})=>{t(a,c,d)}),{currentShape:s,state:r,helper:n}}const Us=T2(),Ab={shapeFill:"#ffffff33",shapeStroke:"#000",lineStroke:"#000",ghostLineStroke:"#0F0",activeLineStroke:"#4D7EEA",boundingBoxDottedStroke:"#0007",boundingBoxStroke:"#fffA",controlFill:"#fff"};function Mb(t){const e={...Ab,...t.theme||{}},n=O.useRef(),r=O.useRef(),s=O.useRef(),a=O.useRef(),c=O.useRef(),d=O.useRef(),m=O.useRef(),y=O.useRef(),h=O.useRef(),v=O.useRef(),[E,T]=O.useState(null),[P,k]=O.useState(!1),{helper:R,state:_,currentShape:M}=Ob((K,ge)=>{if(K.closestLineIndex,Us.updateTransitionBoundingBox(s.current,K,ge),Us.updateBoundingBoxPolygon(n.current,K,ge),Us.updateBoundingBoxPolygon(r.current,K,ge),Us.updateTransitionShape(m.current,K,ge),Us.updateClosestLinePointTransform(c.current,K,ge),Us.updateSelectBox(a.current,K,ge),Us.updatePointLine(y.current,K,ge),Us.updateDrawPreview(d.current,K,ge,3),Us.updateLineBox(h.current,K),T(K.transitionDirection),k(K.transitionRotate),K.closestLineIndex!==-1&&v.current){const de=K.polygon,we=de.points[K.closestLineIndex],le=de.points[(K.closestLineIndex+1)%de.points.length];we&&le&&v.current.setAttribute("points",`${we[0]},${we[1]} ${le[0]},${le[1]}`)}});O.useEffect(()=>{const K=()=>{R.modifiers.reset()};return document.addEventListener("mouseleave",K),()=>{document.removeEventListener("mouseleave",K)}},[]);const L=I.jsxs(I.Fragment,{children:[I.jsxs("marker",{id:"dot",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"5",markerHeight:"5",children:[I.jsx("circle",{cx:"5",cy:"5",r:"5",fill:e.lineStroke,className:"marker"}),I.jsx("circle",{cx:"5",cy:"5",r:"3",fill:e.controlFill})]}),I.jsx("marker",{id:"newdot",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"5",markerHeight:"5",children:I.jsx("circle",{cx:"5",cy:"5",r:"5",fill:e.activeLineStroke,className:"marker"})}),I.jsxs("marker",{id:"selected",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"5",markerHeight:"5",children:[I.jsx("circle",{cx:"5",cy:"5",r:"5",fill:e.lineStroke}),I.jsx("circle",{cx:"5",cy:"5",r:"3",fill:e.activeLineStroke})]}),I.jsxs("marker",{id:"resizer",viewBox:"0 0 10 10",refX:"5",refY:"5",markerWidth:"6",markerHeight:"6",children:[I.jsx("rect",{width:"10",height:"10",fill:e.lineStroke}),I.jsx("rect",{x:"1",y:"1",width:"8",height:"8",fill:e.controlFill})]})]}),$=M?M.open?"polyline":"polygon":null,F=!_.showBoundingBox&&_.closestPoint!==null&&_.actionIntentType==="select-point",H=_.actionIntentType==="add-open-point",se=_.transitionIntentType==="split-line",oe=_.transitioning&&_.selectedStamp&&_.transitionIntentType==="stamp-shape",me=M&&$?I.jsxs(I.Fragment,{children:[I.jsx($,{fill:(!_.transitioning||_.transitionIntentType==="select-multiple-points")&&!M.open?e.shapeFill:"none",strokeWidth:oe||_.showBoundingBox&&_.boxMode||_.transitioning&&_.transitionIntentType==="split-line"||_.transitioning&&_.transitionIntentType==="move-point"?0:2,stroke:e.shapeStroke,points:M.points.map(K=>K.join(",")).join(" "),vectorEffect:"non-scaling-stroke",markerStart:_.showBoundingBox?void 0:_.boxMode?"url(#resizer)":"url(#dot)",markerMid:_.showBoundingBox?void 0:_.boxMode?"url(#resizer)":"url(#dot)",markerEnd:_.showBoundingBox?void 0:_.boxMode?"url(#resizer)":"url(#dot)",style:{pointerEvents:"none"},opacity:_.transitioning&&_.transitionIntentType==="move-shape"?0:1}),_.currentTool==="lineBox"&&_.actionIntentType==="close-line-box"?I.jsx("polygon",{fill:e.shapeFill,ref:h,stroke:e.lineStroke,strokeWidth:2,vectorEffect:"non-scaling-stroke"}):null,_.transitionIntentType==="draw-shape"&&_.transitioning?I.jsx("polyline",{ref:d,fill:"none",stroke:e.activeLineStroke,strokeWidth:2,vectorEffect:"non-scaling-stroke"}):null,!(_.transitioning&&_.transitionIntentType==="move-point")&&!(_.transitioning&&_.transitionIntentType==="stamp-shape")&&!_.showBoundingBox&&_.selectedPoints&&_.selectedPoints.length?I.jsx("polyline",{strokeWidth:2,vectorEffect:"non-scaling-stroke",stroke:"transparent",markerStart:"url(#selected)",markerMid:"url(#selected)",markerEnd:"url(#selected)",fill:"transparent",points:M.points.filter((K,ge)=>_.selectedPoints?.includes(ge)).map(K=>K.join(",")).join(" "),opacity:_.transitioning&&_.transitionIntentType==="move-shape"?0:1}):null,F&&!_.transitioning&&_.closestPoint!==null&&M.points[_.closestPoint]?I.jsx("polyline",{strokeWidth:2,vectorEffect:"non-scaling-stroke",stroke:"transparent",markerStart:"url(#selected)",markerMid:"url(#selected)",markerEnd:"url(#selected)",fill:e.activeLineStroke,points:`${M.points[_.closestPoint][0]},${M.points[_.closestPoint][1]}`,opacity:_.transitioning&&_.transitionIntentType==="move-shape"?0:1}):null,!_.transitioning&&(_.actionIntentType==="add-open-point"||_.actionIntentType==="close-shape"||_.actionIntentType==="close-shape-line")?I.jsx("polyline",{stroke:e.activeLineStroke,ref:y,strokeWidth:_.actionIntentType==="add-open-point"?1:2,vectorEffect:"non-scaling-stroke"}):null,_.hasClosestLine&&!_.showBoundingBox&&!_.transitioning&&_.currentTool!=="box"&&_.transitionIntentType==="split-line"?I.jsx("g",{children:I.jsx("polyline",{ref:v,vectorEffect:"non-scaling-stroke",fill:"transparent",stroke:e.activeLineStroke,strokeWidth:3})}):null,_.hasClosestLine&&!_.showBoundingBox&&!_.transitioning&&_.currentTool!=="box"&&_.transitionIntentType==="split-line"?I.jsx("g",{ref:c,children:I.jsx("polyline",{markerStart:"url(#newdot)",points:"0,0 1,1",vectorEffect:"non-scaling-stroke",stroke:"transparent",fill:"transparent",strokeWidth:2})}):null,_.transitioning?I.jsx($,{ref:m,fill:M.open?"none":e.shapeFill,stroke:_.transitionIntentType==="stamp-shape"?e.activeLineStroke:e.shapeStroke,vectorEffect:"non-scaling-stroke",strokeWidth:(M.open,2)}):null,_.transitioning&&_.transitionIntentType==="select-multiple-points"?I.jsx("rect",{ref:a,fill:"rgba(255, 255, 255, .3)",strokeWidth:1,stroke:"rgba(0,0,0,.2)",vectorEffect:"non-scaling-stroke"}):null,_.showBoundingBox&&!oe?I.jsxs(I.Fragment,{children:[I.jsx("polygon",{ref:n,strokeWidth:2,stroke:e.boundingBoxStroke,fill:"none",markerStart:"url(#resizer)",markerMid:"url(#resizer)",markerEnd:"url(#resizer)",vectorEffect:"non-scaling-stroke"}),I.jsx("polygon",{ref:r,strokeWidth:2,stroke:e.boundingBoxDottedStroke,fill:"none",strokeDasharray:"4 4",markerStart:"url(#resizer)",markerMid:"url(#resizer)",markerEnd:"url(#resizer)",vectorEffect:"non-scaling-stroke"})]}):null]}):null;return{currentTool:R.state.slowState.currentTool,setCurrentTool:R.tools.setTool,helper:R,currentShape:M,state:_,isAddingPoint:H,isSplitting:se,isStamping:oe,isHoveringPoint:F,transitionDirection:E,transitionRotate:P,defs:L,editor:me}}function jb(t){const e=Lg(),{image:n}=t,{helper:r,defs:s,editor:a,state:c,transitionDirection:d,isSplitting:m,transitionRotate:y,isHoveringPoint:h,isAddingPoint:v}=Mb({image:t.image,theme:t.theme}),E=O.useCallback(k=>{k.button!==2&&r.pointer([[~~k.atlas.x,~~k.atlas.y]])},[r]),T=O.useCallback(k=>{k.button!==2&&r.pointerDown()},[r]),P=O.useCallback(k=>{k.button!==2&&r.pointerUp()},[r]);return O.useEffect(()=>{const k=R=>{r.key.up(R.key)};return document.addEventListener("keyup",k),()=>{document.removeEventListener("keyup",k)}},[r]),O.useEffect(()=>{const k=R=>{R.target&&["INPUT","TEXTAREA"].includes(R.target.tagName)||R.target?.isContentEditable||document.activeElement&&(document.activeElement instanceof HTMLInputElement||document.activeElement instanceof HTMLTextAreaElement||document.activeElement.isContentEditable)||r.key.down(R.key)};return document.addEventListener("keydown",k),()=>{document.removeEventListener("keydown",k)}},[r]),O.useEffect(()=>{const k=[];return d&&k.push(`atlas-cursor-${d}`),c.actionIntentType==="cut-line"&&c.modifiers?.Shift&&k.push("atlas-cursor-cut"),(h||c.transitionIntentType==="move-shape"||c.transitionIntentType==="move-point")&&k.push("atlas-cursor-move"),v&&k.push("atlas-cursor-crosshair"),m&&k.push("atlas-cursor-copy"),y&&k.push("atlas-cursor-rotate"),c.transitionIntentType==="draw-shape"&&k.push("atlas-cursor-draw"),e?.canvas&&e.canvas.classList.add(...k),()=>{e?.canvas&&e.canvas.classList.remove(...k)}},[e?.canvas,v,h,m,c.modifiers?.Shift,c.actionIntentType,c.transitionIntentType,d,y]),I.jsx("world-object",{height:n.height,width:n.width,onMouseMove:E,onMouseDown:T,onMouseUp:P,onMouseLeave:r.blur,children:I.jsx(Xs,{relative:!0,interactive:!1,children:I.jsx("div",{className:"absolute top-0 right-0 left-0 bottom-0",children:I.jsxs("svg",{width:"100%",height:"100%",viewBox:`0 0 ${n.width} ${n.height}`,tabIndex:-1,children:[I.jsx("title",{children:"Annotation Editor"}),I.jsx("defs",{children:s}),a]})})})})}function lh(){return typeof window<"u"}function gu(t){return kw(t)?(t.nodeName||"").toLowerCase():"#document"}function Xr(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function ls(t){var e;return(e=(kw(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function kw(t){return lh()?t instanceof Node||t instanceof Xr(t).Node:!1}function hn(t){return lh()?t instanceof Element||t instanceof Xr(t).Element:!1}function Oi(t){return lh()?t instanceof HTMLElement||t instanceof Xr(t).HTMLElement:!1}function hg(t){return!lh()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Xr(t).ShadowRoot}const Lb=new Set(["inline","contents"]);function Xc(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=di(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!Lb.has(s)}const Nb=new Set(["table","td","th"]);function zb(t){return Nb.has(gu(t))}const Fb=[":popover-open",":modal"];function ah(t){return Fb.some(e=>{try{return t.matches(e)}catch{return!1}})}const Db=["transform","translate","scale","rotate","perspective"],Bb=["transform","translate","scale","rotate","perspective","filter"],$b=["paint","layout","strict","content"];function Vg(t){const e=uh(),n=hn(t)?di(t):t;return Db.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||Bb.some(r=>(n.willChange||"").includes(r))||$b.some(r=>(n.contain||"").includes(r))}function Ub(t){let e=Gs(t);for(;Oi(e)&&!Ys(e);){if(Vg(e))return e;if(ah(e))return null;e=Gs(e)}return null}function uh(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const Wb=new Set(["html","body","#document"]);function Ys(t){return Wb.has(gu(t))}function di(t){return Xr(t).getComputedStyle(t)}function ch(t){return hn(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Gs(t){if(gu(t)==="html")return t;const e=t.assignedSlot||t.parentNode||hg(t)&&t.host||ls(t);return hg(e)?e.host:e}function Cw(t){const e=Gs(t);return Ys(e)?t.ownerDocument?t.ownerDocument.body:t.body:Oi(e)&&Xc(e)?e:Cw(e)}function el(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=Cw(t),a=s===((r=t.ownerDocument)==null?void 0:r.body),c=Xr(s);if(a){const d=pg(c);return e.concat(c,c.visualViewport||[],Xc(s)?s:[],d&&n?el(d):[])}return e.concat(s,el(s,[],n))}function pg(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}const zd=Math.min,Yl=Math.max,Fd=Math.round,wd=Math.floor,rs=t=>({x:t,y:t}),Hb={left:"right",right:"left",bottom:"top",top:"bottom"},Vb={start:"end",end:"start"};function Qy(t,e,n){return Yl(t,zd(e,n))}function fh(t,e){return typeof t=="function"?t(e):t}function Gl(t){return t.split("-")[0]}function dh(t){return t.split("-")[1]}function Tw(t){return t==="x"?"y":"x"}function bw(t){return t==="y"?"height":"width"}const qb=new Set(["top","bottom"]);function Go(t){return qb.has(Gl(t))?"y":"x"}function Rw(t){return Tw(Go(t))}function Qb(t,e,n){n===void 0&&(n=!1);const r=dh(t),s=Rw(t),a=bw(s);let c=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[a]>e.floating[a]&&(c=Dd(c)),[c,Dd(c)]}function Xb(t){const e=Dd(t);return[gg(t),e,gg(e)]}function gg(t){return t.replace(/start|end/g,e=>Vb[e])}const Xy=["left","right"],Yy=["right","left"],Yb=["top","bottom"],Kb=["bottom","top"];function Gb(t,e,n){switch(t){case"top":case"bottom":return n?e?Yy:Xy:e?Xy:Yy;case"left":case"right":return e?Yb:Kb;default:return[]}}function Zb(t,e,n,r){const s=dh(t);let a=Gb(Gl(t),n==="start",r);return s&&(a=a.map(c=>c+"-"+s),e&&(a=a.concat(a.map(gg)))),a}function Dd(t){return t.replace(/left|right|bottom|top/g,e=>Hb[e])}function Jb(t){return{top:0,right:0,bottom:0,left:0,...t}}function eR(t){return typeof t!="number"?Jb(t):{top:t,right:t,bottom:t,left:t}}function Bd(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function Ky(t,e){if(!t||!e)return!1;const n=e.getRootNode==null?void 0:e.getRootNode();if(t.contains(e))return!0;if(n&&hg(n)){let r=e;for(;r;){if(t===r)return!0;r=r.parentNode||r.host}}return!1}function yc(t){return"composedPath"in t?t.composedPath()[0]:t.target}function jp(t,e){if(e==null)return!1;if("composedPath"in t)return t.composedPath().includes(e);const n=t;return n.target!=null&&e.contains(n.target)}function tR(t){return t.matches("html,body")}function Gy(t){return t?.ownerDocument||document}function Rd(t,e,n){return n===void 0&&(n=!0),t.filter(s=>{var a;return s.parentId===e&&(!n||((a=s.context)==null?void 0:a.open))}).flatMap(s=>[s,...Rd(t,s.id,n)])}function nR(t){return"nativeEvent"in t}var rR=typeof document<"u",iR=function(){},mg=rR?O.useLayoutEffect:iR;const sR={...uv},oR=sR.useInsertionEffect,lR=oR||(t=>t());function au(t){const e=O.useRef(()=>{});return lR(()=>{e.current=t}),O.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return e.current==null?void 0:e.current(...r)},[])}var hh=cv();const aR=Jl(hh),uR=Wd({__proto__:null,default:aR},[hh]);function Zy(t,e,n){let{reference:r,floating:s}=t;const a=Go(e),c=Rw(e),d=bw(c),m=Gl(e),y=a==="y",h=r.x+r.width/2-s.width/2,v=r.y+r.height/2-s.height/2,E=r[d]/2-s[d]/2;let T;switch(m){case"top":T={x:h,y:r.y-s.height};break;case"bottom":T={x:h,y:r.y+r.height};break;case"right":T={x:r.x+r.width,y:v};break;case"left":T={x:r.x-s.width,y:v};break;default:T={x:r.x,y:r.y}}switch(dh(e)){case"start":T[c]-=E*(n&&y?-1:1);break;case"end":T[c]+=E*(n&&y?-1:1);break}return T}const cR=async(t,e,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:a=[],platform:c}=n,d=a.filter(Boolean),m=await(c.isRTL==null?void 0:c.isRTL(e));let y=await c.getElementRects({reference:t,floating:e,strategy:s}),{x:h,y:v}=Zy(y,r,m),E=r,T={},P=0;for(let k=0;k<d.length;k++){const{name:R,fn:_}=d[k],{x:M,y:L,data:$,reset:F}=await _({x:h,y:v,initialPlacement:r,placement:E,strategy:s,middlewareData:T,rects:y,platform:c,elements:{reference:t,floating:e}});h=M??h,v=L??v,T={...T,[R]:{...T[R],...$}},F&&P<=50&&(P++,typeof F=="object"&&(F.placement&&(E=F.placement),F.rects&&(y=F.rects===!0?await c.getElementRects({reference:t,floating:e,strategy:s}):F.rects),{x:h,y:v}=Zy(y,E,m)),k=-1)}return{x:h,y:v,placement:E,strategy:s,middlewareData:T}};async function _w(t,e){var n;e===void 0&&(e={});const{x:r,y:s,platform:a,rects:c,elements:d,strategy:m}=t,{boundary:y="clippingAncestors",rootBoundary:h="viewport",elementContext:v="floating",altBoundary:E=!1,padding:T=0}=fh(e,t),P=eR(T),R=d[E?v==="floating"?"reference":"floating":v],_=Bd(await a.getClippingRect({element:(n=await(a.isElement==null?void 0:a.isElement(R)))==null||n?R:R.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(d.floating)),boundary:y,rootBoundary:h,strategy:m})),M=v==="floating"?{x:r,y:s,width:c.floating.width,height:c.floating.height}:c.reference,L=await(a.getOffsetParent==null?void 0:a.getOffsetParent(d.floating)),$=await(a.isElement==null?void 0:a.isElement(L))?await(a.getScale==null?void 0:a.getScale(L))||{x:1,y:1}:{x:1,y:1},F=Bd(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:d,rect:M,offsetParent:L,strategy:m}):M);return{top:(_.top-F.top+P.top)/$.y,bottom:(F.bottom-_.bottom+P.bottom)/$.y,left:(_.left-F.left+P.left)/$.x,right:(F.right-_.right+P.right)/$.x}}const fR=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:s,middlewareData:a,rects:c,initialPlacement:d,platform:m,elements:y}=e,{mainAxis:h=!0,crossAxis:v=!0,fallbackPlacements:E,fallbackStrategy:T="bestFit",fallbackAxisSideDirection:P="none",flipAlignment:k=!0,...R}=fh(t,e);if((n=a.arrow)!=null&&n.alignmentOffset)return{};const _=Gl(s),M=Go(d),L=Gl(d)===d,$=await(m.isRTL==null?void 0:m.isRTL(y.floating)),F=E||(L||!k?[Dd(d)]:Xb(d)),H=P!=="none";!E&&H&&F.push(...Zb(d,k,P,$));const se=[d,...F],oe=await _w(e,R),me=[];let K=((r=a.flip)==null?void 0:r.overflows)||[];if(h&&me.push(oe[_]),v){const le=Qb(s,c,$);me.push(oe[le[0]],oe[le[1]])}if(K=[...K,{placement:s,overflows:me}],!me.every(le=>le<=0)){var ge,de;const le=(((ge=a.flip)==null?void 0:ge.index)||0)+1,Ie=se[le];if(Ie&&(!(v==="alignment"?M!==Go(Ie):!1)||K.every(D=>Go(D.placement)===M?D.overflows[0]>0:!0)))return{data:{index:le,overflows:K},reset:{placement:Ie}};let Se=(de=K.filter(Te=>Te.overflows[0]<=0).sort((Te,D)=>Te.overflows[1]-D.overflows[1])[0])==null?void 0:de.placement;if(!Se)switch(T){case"bestFit":{var we;const Te=(we=K.filter(D=>{if(H){const U=Go(D.placement);return U===M||U==="y"}return!0}).map(D=>[D.placement,D.overflows.filter(U=>U>0).reduce((U,Q)=>U+Q,0)]).sort((D,U)=>D[1]-U[1])[0])==null?void 0:we[0];Te&&(Se=Te);break}case"initialPlacement":Se=d;break}if(s!==Se)return{reset:{placement:Se}}}return{}}}},dR=new Set(["left","top"]);async function hR(t,e){const{placement:n,platform:r,elements:s}=t,a=await(r.isRTL==null?void 0:r.isRTL(s.floating)),c=Gl(n),d=dh(n),m=Go(n)==="y",y=dR.has(c)?-1:1,h=a&&m?-1:1,v=fh(e,t);let{mainAxis:E,crossAxis:T,alignmentAxis:P}=typeof v=="number"?{mainAxis:v,crossAxis:0,alignmentAxis:null}:{mainAxis:v.mainAxis||0,crossAxis:v.crossAxis||0,alignmentAxis:v.alignmentAxis};return d&&typeof P=="number"&&(T=d==="end"?P*-1:P),m?{x:T*h,y:E*y}:{x:E*y,y:T*h}}const pR=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:s,y:a,placement:c,middlewareData:d}=e,m=await hR(e,t);return c===((n=d.offset)==null?void 0:n.placement)&&(r=d.arrow)!=null&&r.alignmentOffset?{}:{x:s+m.x,y:a+m.y,data:{...m,placement:c}}}}},gR=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:s}=e,{mainAxis:a=!0,crossAxis:c=!1,limiter:d={fn:R=>{let{x:_,y:M}=R;return{x:_,y:M}}},...m}=fh(t,e),y={x:n,y:r},h=await _w(e,m),v=Go(Gl(s)),E=Tw(v);let T=y[E],P=y[v];if(a){const R=E==="y"?"top":"left",_=E==="y"?"bottom":"right",M=T+h[R],L=T-h[_];T=Qy(M,T,L)}if(c){const R=v==="y"?"top":"left",_=v==="y"?"bottom":"right",M=P+h[R],L=P-h[_];P=Qy(M,P,L)}const k=d.fn({...e,[E]:T,[v]:P});return{...k,data:{x:k.x-n,y:k.y-r,enabled:{[E]:a,[v]:c}}}}}};function Iw(t){const e=di(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=Oi(t),a=s?t.offsetWidth:n,c=s?t.offsetHeight:r,d=Fd(n)!==a||Fd(r)!==c;return d&&(n=a,r=c),{width:n,height:r,$:d}}function qg(t){return hn(t)?t:t.contextElement}function fu(t){const e=qg(t);if(!Oi(e))return rs(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:a}=Iw(e);let c=(a?Fd(n.width):n.width)/r,d=(a?Fd(n.height):n.height)/s;return(!c||!Number.isFinite(c))&&(c=1),(!d||!Number.isFinite(d))&&(d=1),{x:c,y:d}}const mR=rs(0);function Ow(t){const e=Xr(t);return!uh()||!e.visualViewport?mR:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function yR(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Xr(t)?!1:e}function Zl(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),a=qg(t);let c=rs(1);e&&(r?hn(r)&&(c=fu(r)):c=fu(t));const d=yR(a,n,r)?Ow(a):rs(0);let m=(s.left+d.x)/c.x,y=(s.top+d.y)/c.y,h=s.width/c.x,v=s.height/c.y;if(a){const E=Xr(a),T=r&&hn(r)?Xr(r):r;let P=E,k=pg(P);for(;k&&r&&T!==P;){const R=fu(k),_=k.getBoundingClientRect(),M=di(k),L=_.left+(k.clientLeft+parseFloat(M.paddingLeft))*R.x,$=_.top+(k.clientTop+parseFloat(M.paddingTop))*R.y;m*=R.x,y*=R.y,h*=R.x,v*=R.y,m+=L,y+=$,P=Xr(k),k=pg(P)}}return Bd({width:h,height:v,x:m,y})}function ph(t,e){const n=ch(t).scrollLeft;return e?e.left+n:Zl(ls(t)).left+n}function Aw(t,e){const n=t.getBoundingClientRect(),r=n.left+e.scrollLeft-ph(t,n),s=n.top+e.scrollTop;return{x:r,y:s}}function vR(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const a=s==="fixed",c=ls(r),d=e?ah(e.floating):!1;if(r===c||d&&a)return n;let m={scrollLeft:0,scrollTop:0},y=rs(1);const h=rs(0),v=Oi(r);if((v||!v&&!a)&&((gu(r)!=="body"||Xc(c))&&(m=ch(r)),Oi(r))){const T=Zl(r);y=fu(r),h.x=T.x+r.clientLeft,h.y=T.y+r.clientTop}const E=c&&!v&&!a?Aw(c,m):rs(0);return{width:n.width*y.x,height:n.height*y.y,x:n.x*y.x-m.scrollLeft*y.x+h.x+E.x,y:n.y*y.y-m.scrollTop*y.y+h.y+E.y}}function xR(t){return Array.from(t.getClientRects())}function wR(t){const e=ls(t),n=ch(t),r=t.ownerDocument.body,s=Yl(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),a=Yl(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let c=-n.scrollLeft+ph(t);const d=-n.scrollTop;return di(r).direction==="rtl"&&(c+=Yl(e.clientWidth,r.clientWidth)-s),{width:s,height:a,x:c,y:d}}const Jy=25;function SR(t,e){const n=Xr(t),r=ls(t),s=n.visualViewport;let a=r.clientWidth,c=r.clientHeight,d=0,m=0;if(s){a=s.width,c=s.height;const h=uh();(!h||h&&e==="fixed")&&(d=s.offsetLeft,m=s.offsetTop)}const y=ph(r);if(y<=0){const h=r.ownerDocument,v=h.body,E=getComputedStyle(v),T=h.compatMode==="CSS1Compat"&&parseFloat(E.marginLeft)+parseFloat(E.marginRight)||0,P=Math.abs(r.clientWidth-v.clientWidth-T);P<=Jy&&(a-=P)}else y<=Jy&&(a+=y);return{width:a,height:c,x:d,y:m}}const PR=new Set(["absolute","fixed"]);function ER(t,e){const n=Zl(t,!0,e==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,a=Oi(t)?fu(t):rs(1),c=t.clientWidth*a.x,d=t.clientHeight*a.y,m=s*a.x,y=r*a.y;return{width:c,height:d,x:m,y}}function ev(t,e,n){let r;if(e==="viewport")r=SR(t,n);else if(e==="document")r=wR(ls(t));else if(hn(e))r=ER(e,n);else{const s=Ow(t);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return Bd(r)}function Mw(t,e){const n=Gs(t);return n===e||!hn(n)||Ys(n)?!1:di(n).position==="fixed"||Mw(n,e)}function kR(t,e){const n=e.get(t);if(n)return n;let r=el(t,[],!1).filter(d=>hn(d)&&gu(d)!=="body"),s=null;const a=di(t).position==="fixed";let c=a?Gs(t):t;for(;hn(c)&&!Ys(c);){const d=di(c),m=Vg(c);!m&&d.position==="fixed"&&(s=null),(a?!m&&!s:!m&&d.position==="static"&&!!s&&PR.has(s.position)||Xc(c)&&!m&&Mw(t,c))?r=r.filter(h=>h!==c):s=d,c=Gs(c)}return e.set(t,r),r}function CR(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const c=[...n==="clippingAncestors"?ah(e)?[]:kR(e,this._c):[].concat(n),r],d=c[0],m=c.reduce((y,h)=>{const v=ev(e,h,s);return y.top=Yl(v.top,y.top),y.right=zd(v.right,y.right),y.bottom=zd(v.bottom,y.bottom),y.left=Yl(v.left,y.left),y},ev(e,d,s));return{width:m.right-m.left,height:m.bottom-m.top,x:m.left,y:m.top}}function TR(t){const{width:e,height:n}=Iw(t);return{width:e,height:n}}function bR(t,e,n){const r=Oi(e),s=ls(e),a=n==="fixed",c=Zl(t,!0,a,e);let d={scrollLeft:0,scrollTop:0};const m=rs(0);function y(){m.x=ph(s)}if(r||!r&&!a)if((gu(e)!=="body"||Xc(s))&&(d=ch(e)),r){const T=Zl(e,!0,a,e);m.x=T.x+e.clientLeft,m.y=T.y+e.clientTop}else s&&y();a&&!r&&s&&y();const h=s&&!r&&!a?Aw(s,d):rs(0),v=c.left+d.scrollLeft-m.x-h.x,E=c.top+d.scrollTop-m.y-h.y;return{x:v,y:E,width:c.width,height:c.height}}function Lp(t){return di(t).position==="static"}function tv(t,e){if(!Oi(t)||di(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return ls(t)===n&&(n=n.ownerDocument.body),n}function jw(t,e){const n=Xr(t);if(ah(t))return n;if(!Oi(t)){let s=Gs(t);for(;s&&!Ys(s);){if(hn(s)&&!Lp(s))return s;s=Gs(s)}return n}let r=tv(t,e);for(;r&&zb(r)&&Lp(r);)r=tv(r,e);return r&&Ys(r)&&Lp(r)&&!Vg(r)?n:r||Ub(t)||n}const RR=async function(t){const e=this.getOffsetParent||jw,n=this.getDimensions,r=await n(t.floating);return{reference:bR(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function _R(t){return di(t).direction==="rtl"}const IR={convertOffsetParentRelativeRectToViewportRelativeRect:vR,getDocumentElement:ls,getClippingRect:CR,getOffsetParent:jw,getElementRects:RR,getClientRects:xR,getDimensions:TR,getScale:fu,isElement:hn,isRTL:_R};function Lw(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function OR(t,e){let n=null,r;const s=ls(t);function a(){var d;clearTimeout(r),(d=n)==null||d.disconnect(),n=null}function c(d,m){d===void 0&&(d=!1),m===void 0&&(m=1),a();const y=t.getBoundingClientRect(),{left:h,top:v,width:E,height:T}=y;if(d||e(),!E||!T)return;const P=wd(v),k=wd(s.clientWidth-(h+E)),R=wd(s.clientHeight-(v+T)),_=wd(h),L={rootMargin:-P+"px "+-k+"px "+-R+"px "+-_+"px",threshold:Yl(0,zd(1,m))||1};let $=!0;function F(H){const se=H[0].intersectionRatio;if(se!==m){if(!$)return c();se?c(!1,se):r=setTimeout(()=>{c(!1,1e-7)},1e3)}se===1&&!Lw(y,t.getBoundingClientRect())&&c(),$=!1}try{n=new IntersectionObserver(F,{...L,root:s.ownerDocument})}catch{n=new IntersectionObserver(F,L)}n.observe(t)}return c(!0),a}function AR(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:a=!0,elementResize:c=typeof ResizeObserver=="function",layoutShift:d=typeof IntersectionObserver=="function",animationFrame:m=!1}=r,y=qg(t),h=s||a?[...y?el(y):[],...el(e)]:[];h.forEach(_=>{s&&_.addEventListener("scroll",n,{passive:!0}),a&&_.addEventListener("resize",n)});const v=y&&d?OR(y,n):null;let E=-1,T=null;c&&(T=new ResizeObserver(_=>{let[M]=_;M&&M.target===y&&T&&(T.unobserve(e),cancelAnimationFrame(E),E=requestAnimationFrame(()=>{var L;(L=T)==null||L.observe(e)})),n()}),y&&!m&&T.observe(y),T.observe(e));let P,k=m?Zl(t):null;m&&R();function R(){const _=Zl(t);k&&!Lw(k,_)&&n(),k=_,P=requestAnimationFrame(R)}return n(),()=>{var _;h.forEach(M=>{s&&M.removeEventListener("scroll",n),a&&M.removeEventListener("resize",n)}),v?.(),(_=T)==null||_.disconnect(),T=null,m&&cancelAnimationFrame(P)}}const MR=pR,jR=gR,LR=fR,NR=(t,e,n)=>{const r=new Map,s={platform:IR,...n},a={...s.platform,_c:r};return cR(t,e,{...s,platform:a})};var zR=typeof document<"u",FR=function(){},_d=zR?O.useLayoutEffect:FR;function $d(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!$d(t[r],e[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const a=s[r];if(!(a==="_owner"&&t.$$typeof)&&!$d(t[a],e[a]))return!1}return!0}return t!==t&&e!==e}function Nw(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function nv(t,e){const n=Nw(t);return Math.round(e*n)/n}function Np(t){const e=O.useRef(t);return _d(()=>{e.current=t}),e}function DR(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:a,floating:c}={},transform:d=!0,whileElementsMounted:m,open:y}=t,[h,v]=O.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[E,T]=O.useState(r);$d(E,r)||T(r);const[P,k]=O.useState(null),[R,_]=O.useState(null),M=O.useCallback(D=>{D!==H.current&&(H.current=D,k(D))},[]),L=O.useCallback(D=>{D!==se.current&&(se.current=D,_(D))},[]),$=a||P,F=c||R,H=O.useRef(null),se=O.useRef(null),oe=O.useRef(h),me=m!=null,K=Np(m),ge=Np(s),de=Np(y),we=O.useCallback(()=>{if(!H.current||!se.current)return;const D={placement:e,strategy:n,middleware:E};ge.current&&(D.platform=ge.current),NR(H.current,se.current,D).then(U=>{const Q={...U,isPositioned:de.current!==!1};le.current&&!$d(oe.current,Q)&&(oe.current=Q,hh.flushSync(()=>{v(Q)}))})},[E,e,n,ge,de]);_d(()=>{y===!1&&oe.current.isPositioned&&(oe.current.isPositioned=!1,v(D=>({...D,isPositioned:!1})))},[y]);const le=O.useRef(!1);_d(()=>(le.current=!0,()=>{le.current=!1}),[]),_d(()=>{if($&&(H.current=$),F&&(se.current=F),$&&F){if(K.current)return K.current($,F,we);we()}},[$,F,we,K,me]);const Ie=O.useMemo(()=>({reference:H,floating:se,setReference:M,setFloating:L}),[M,L]),Se=O.useMemo(()=>({reference:$,floating:F}),[$,F]),Te=O.useMemo(()=>{const D={position:n,left:0,top:0};if(!Se.floating)return D;const U=nv(Se.floating,h.x),Q=nv(Se.floating,h.y);return d?{...D,transform:"translate("+U+"px, "+Q+"px)",...Nw(Se.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:U,top:Q}},[n,d,Se.floating,h.x,h.y]);return O.useMemo(()=>({...h,update:we,refs:Ie,elements:Se,floatingStyles:Te}),[h,we,Ie,Se,Te])}const BR=(t,e)=>({...MR(t),options:[t,e]}),$R=(t,e)=>({...jR(t),options:[t,e]}),UR=(t,e)=>({...LR(t),options:[t,e]}),WR="data-floating-ui-focusable",rv="active",iv="selected",HR={...uv};let sv=!1,VR=0;const ov=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+VR++;function qR(){const[t,e]=O.useState(()=>sv?ov():void 0);return mg(()=>{t==null&&e(ov())},[]),O.useEffect(()=>{sv=!0},[]),t}const QR=HR.useId,XR=QR||qR;function YR(){const t=new Map;return{emit(e,n){var r;(r=t.get(e))==null||r.forEach(s=>s(n))},on(e,n){t.has(e)||t.set(e,new Set),t.get(e).add(n)},off(e,n){var r;(r=t.get(e))==null||r.delete(n)}}}const KR=O.createContext(null),GR=O.createContext(null),ZR=()=>{var t;return((t=O.useContext(KR))==null?void 0:t.id)||null},zw=()=>O.useContext(GR);function JR(t){return"data-floating-ui-"+t}const e_={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},t_={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},lv=t=>{var e,n;return{escapeKey:typeof t=="boolean"?t:(e=t?.escapeKey)!=null?e:!1,outsidePress:typeof t=="boolean"?t:(n=t?.outsidePress)!=null?n:!0}};function n_(t,e){e===void 0&&(e={});const{open:n,onOpenChange:r,elements:s,dataRef:a}=t,{enabled:c=!0,escapeKey:d=!0,outsidePress:m=!0,outsidePressEvent:y="pointerdown",referencePress:h=!1,referencePressEvent:v="pointerdown",ancestorScroll:E=!1,bubbles:T,capture:P}=e,k=zw(),R=au(typeof m=="function"?m:()=>!1),_=typeof m=="function"?R:m,M=O.useRef(!1),{escapeKey:L,outsidePress:$}=lv(T),{escapeKey:F,outsidePress:H}=lv(P),se=O.useRef(!1),oe=au(le=>{var Ie;if(!n||!c||!d||le.key!=="Escape"||se.current)return;const Se=(Ie=a.current.floatingContext)==null?void 0:Ie.nodeId,Te=k?Rd(k.nodesRef.current,Se):[];if(!L&&(le.stopPropagation(),Te.length>0)){let D=!0;if(Te.forEach(U=>{var Q;if((Q=U.context)!=null&&Q.open&&!U.context.dataRef.current.__escapeKeyBubbles){D=!1;return}}),!D)return}r(!1,nR(le)?le.nativeEvent:le,"escape-key")}),me=au(le=>{var Ie;const Se=()=>{var Te;oe(le),(Te=yc(le))==null||Te.removeEventListener("keydown",Se)};(Ie=yc(le))==null||Ie.addEventListener("keydown",Se)}),K=au(le=>{var Ie;const Se=a.current.insideReactTree;a.current.insideReactTree=!1;const Te=M.current;if(M.current=!1,y==="click"&&Te||Se||typeof _=="function"&&!_(le))return;const D=yc(le),U="["+JR("inert")+"]",Q=Gy(s.floating).querySelectorAll(U);let B=hn(D)?D:null;for(;B&&!Ys(B);){const Le=Gs(B);if(Ys(Le)||!hn(Le))break;B=Le}if(Q.length&&hn(D)&&!tR(D)&&!Ky(D,s.floating)&&Array.from(Q).every(Le=>!Ky(B,Le)))return;if(Oi(D)&&we){const Le=Ys(D),De=di(D),Je=/auto|scroll/,it=Le||Je.test(De.overflowX),ut=Le||Je.test(De.overflowY),mt=it&&D.clientWidth>0&&D.scrollWidth>D.clientWidth,ot=ut&&D.clientHeight>0&&D.scrollHeight>D.clientHeight,ze=De.direction==="rtl",be=ot&&(ze?le.offsetX<=D.offsetWidth-D.clientWidth:le.offsetX>D.clientWidth),ct=mt&&le.offsetY>D.clientHeight;if(be||ct)return}const re=(Ie=a.current.floatingContext)==null?void 0:Ie.nodeId,Re=k&&Rd(k.nodesRef.current,re).some(Le=>{var De;return jp(le,(De=Le.context)==null?void 0:De.elements.floating)});if(jp(le,s.floating)||jp(le,s.domReference)||Re)return;const je=k?Rd(k.nodesRef.current,re):[];if(je.length>0){let Le=!0;if(je.forEach(De=>{var Je;if((Je=De.context)!=null&&Je.open&&!De.context.dataRef.current.__outsidePressBubbles){Le=!1;return}}),!Le)return}r(!1,le,"outside-press")}),ge=au(le=>{var Ie;const Se=()=>{var Te;K(le),(Te=yc(le))==null||Te.removeEventListener(y,Se)};(Ie=yc(le))==null||Ie.addEventListener(y,Se)});O.useEffect(()=>{if(!n||!c)return;a.current.__escapeKeyBubbles=L,a.current.__outsidePressBubbles=$;let le=-1;function Ie(Q){r(!1,Q,"ancestor-scroll")}function Se(){window.clearTimeout(le),se.current=!0}function Te(){le=window.setTimeout(()=>{se.current=!1},uh()?5:0)}const D=Gy(s.floating);d&&(D.addEventListener("keydown",F?me:oe,F),D.addEventListener("compositionstart",Se),D.addEventListener("compositionend",Te)),_&&D.addEventListener(y,H?ge:K,H);let U=[];return E&&(hn(s.domReference)&&(U=el(s.domReference)),hn(s.floating)&&(U=U.concat(el(s.floating))),!hn(s.reference)&&s.reference&&s.reference.contextElement&&(U=U.concat(el(s.reference.contextElement)))),U=U.filter(Q=>{var B;return Q!==((B=D.defaultView)==null?void 0:B.visualViewport)}),U.forEach(Q=>{Q.addEventListener("scroll",Ie,{passive:!0})}),()=>{d&&(D.removeEventListener("keydown",F?me:oe,F),D.removeEventListener("compositionstart",Se),D.removeEventListener("compositionend",Te)),_&&D.removeEventListener(y,H?ge:K,H),U.forEach(Q=>{Q.removeEventListener("scroll",Ie)}),window.clearTimeout(le)}},[a,s,d,_,y,n,r,E,c,L,$,oe,F,me,K,H,ge]),O.useEffect(()=>{a.current.insideReactTree=!1},[a,_,y]);const de=O.useMemo(()=>({onKeyDown:oe,...h&&{[e_[v]]:le=>{r(!1,le.nativeEvent,"reference-press")},...v!=="click"&&{onClick(le){r(!1,le.nativeEvent,"reference-press")}}}}),[oe,r,h,v]),we=O.useMemo(()=>({onKeyDown:oe,onMouseDown(){M.current=!0},onMouseUp(){M.current=!0},[t_[y]]:()=>{a.current.insideReactTree=!0}}),[oe,y,a]);return O.useMemo(()=>c?{reference:de,floating:we}:{},[c,de,we])}function r_(t){const{open:e=!1,onOpenChange:n,elements:r}=t,s=XR(),a=O.useRef({}),[c]=O.useState(()=>YR()),d=ZR()!=null,[m,y]=O.useState(r.reference),h=au((T,P,k)=>{a.current.openEvent=T?P:void 0,c.emit("openchange",{open:T,event:P,reason:k,nested:d}),n?.(T,P,k)}),v=O.useMemo(()=>({setPositionReference:y}),[]),E=O.useMemo(()=>({reference:m||r.reference||null,floating:r.floating||null,domReference:r.reference}),[m,r.reference,r.floating]);return O.useMemo(()=>({dataRef:a,open:e,onOpenChange:h,elements:E,events:c,floatingId:s,refs:v}),[e,h,E,c,s,v])}function i_(t){t===void 0&&(t={});const{nodeId:e}=t,n=r_({...t,elements:{reference:null,floating:null,...t.elements}}),r=t.rootContext||n,s=r.elements,[a,c]=O.useState(null),[d,m]=O.useState(null),h=s?.domReference||a,v=O.useRef(null),E=zw();mg(()=>{h&&(v.current=h)},[h]);const T=DR({...t,elements:{...s,...d&&{reference:d}}}),P=O.useCallback(L=>{const $=hn(L)?{getBoundingClientRect:()=>L.getBoundingClientRect(),getClientRects:()=>L.getClientRects(),contextElement:L}:L;m($),T.refs.setReference($)},[T.refs]),k=O.useCallback(L=>{(hn(L)||L===null)&&(v.current=L,c(L)),(hn(T.refs.reference.current)||T.refs.reference.current===null||L!==null&&!hn(L))&&T.refs.setReference(L)},[T.refs]),R=O.useMemo(()=>({...T.refs,setReference:k,setPositionReference:P,domReference:v}),[T.refs,k,P]),_=O.useMemo(()=>({...T.elements,domReference:h}),[T.elements,h]),M=O.useMemo(()=>({...T,...r,refs:R,elements:_,nodeId:e}),[T,R,_,e,r]);return mg(()=>{r.dataRef.current.floatingContext=M;const L=E?.nodesRef.current.find($=>$.id===e);L&&(L.context=M)}),O.useMemo(()=>({...T,context:M,refs:R,elements:_}),[T,R,_,M])}function zp(t,e,n){const r=new Map,s=n==="item";let a=t;if(s&&t){const{[rv]:c,[iv]:d,...m}=t;a=m}return{...n==="floating"&&{tabIndex:-1,[WR]:""},...a,...e.map(c=>{const d=c?c[n]:null;return typeof d=="function"?t?d(t):null:d}).concat(t).reduce((c,d)=>(d&&Object.entries(d).forEach(m=>{let[y,h]=m;if(!(s&&[rv,iv].includes(y)))if(y.indexOf("on")===0){if(r.has(y)||r.set(y,[]),typeof h=="function"){var v;(v=r.get(y))==null||v.push(h),c[y]=function(){for(var E,T=arguments.length,P=new Array(T),k=0;k<T;k++)P[k]=arguments[k];return(E=r.get(y))==null?void 0:E.map(R=>R(...P)).find(R=>R!==void 0)}}}else c[y]=h}),c),{})}}function s_(t){t===void 0&&(t=[]);const e=t.map(d=>d?.reference),n=t.map(d=>d?.floating),r=t.map(d=>d?.item),s=O.useCallback(d=>zp(d,t,"reference"),e),a=O.useCallback(d=>zp(d,t,"floating"),n),c=O.useCallback(d=>zp(d,t,"item"),r);return O.useMemo(()=>({getReferenceProps:s,getFloatingProps:a,getItemProps:c}),[s,a,c])}const o_=Vc(),gh=O.createContext({emitter:o_});gh.displayName="Events";function l_(){return Xt.useContext(gh).emitter}const Qg=Xt.createContext({});function Fw(){const t=O.useContext(Qg),e=Object.keys(t),n={};for(const r of e)t[r].Provider&&(n[r]={value:O.useContext(t[r]),Provider:t[r].Provider});return n}function a_(t){const e=Object.keys(t);let n=t.children;for(const r of e){if(r==="children")continue;const{value:s,Provider:a}=t[r];n=I.jsx(a,{value:s,children:n})}return n}function Dw(){return{VaultContext:O.useContext(Qd),ResourceContext:O.useContext(wg),SimpleViewerReactContext:O.useContext(Yd),VisibleCanvasReactContext:O.useContext(Xd),AuthRContext:O.useContext(Bc),SearchReactContext:O.useContext($c),ReactEventContext:O.useContext(gh),ContextBridgeReactContext:O.useContext(Qg),StrategyReactContext:O.useContext(Qc),AtlasStoreReactContext:O.useContext(Fc)}}function Bw(t){return I.jsx(Cg,{vault:t.bridge.VaultContext.vault||void 0,resources:t.bridge.ResourceContext,children:I.jsx(Xd.Provider,{value:t.bridge.VisibleCanvasReactContext,children:I.jsx(Yd.Provider,{value:t.bridge.SimpleViewerReactContext,children:I.jsx(gh.Provider,{value:t.bridge.ReactEventContext,children:I.jsx(Fc.Provider,{value:t.bridge.AtlasStoreReactContext,children:I.jsx(Bc.Provider,{value:t.bridge.AuthRContext,children:I.jsx($c.Provider,{value:t.bridge.SearchReactContext,children:I.jsx(Qg.Provider,{value:t.bridge.ContextBridgeReactContext,children:I.jsx(Qc.Provider,{value:t.bridge.StrategyReactContext,children:t.custom?I.jsx(a_,{...t.custom,children:t.children}):t.children})})})})})})})})})}function $w({annotation:t,target:e,children:n,dismissable:r,isOpen:s,onOpenChange:a,placement:c}){const d=Dw(),m=Fw(),{refs:y,floatingStyles:h,context:v}=i_({open:s,onOpenChange:a,nodeId:t.id,placement:c||"bottom",middleware:[BR(10),$R(),UR({mainAxis:!0})],whileElementsMounted:AR}),E=n_(v),{getReferenceProps:T,getFloatingProps:P}=s_([r?E:null].filter(k=>k!==null));return I.jsxs(Xs,{relative:!0,target:e,interactive:!1,children:[I.jsx("div",{ref:y.setReference,...T(),style:{position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none"}}),hh.createPortal(I.jsx(Bw,{bridge:d,custom:m,children:I.jsx("div",{ref:y.setFloating,style:h,...P(),children:n})}),document.getElementById("atlas-floating-ui"))]})}const u_=$E()(t=>({isMenuOpen:!1,menuPosition:{x:0,y:0},setMenuPosition(e){t({menuPosition:e})},toggle(e){t(n=>({isMenuOpen:!n.isMenuOpen,menuPosition:e}))},open(e){t({isMenuOpen:!0,menuPosition:e})},setIsMenuOpen(e){t(typeof e=="function"?n=>({isMenuOpen:e(n.isMenuOpen)}):{isMenuOpen:e})},close(){t({isMenuOpen:!1})}}));function Uw(t,e,n){const{isMenuOpen:r,setIsMenuOpen:s,close:a,open:c,menuPosition:d,setMenuPosition:m,toggle:y}=u_(),h=O.useCallback(T=>{n&&(T.preventDefault(),T.stopPropagation(),y(T.atlas))},[y,n]);return[I.jsx(I.Fragment,{children:n&&r&&I.jsx($w,{dismissable:!0,placement:"bottom-start",isOpen:r,onOpenChange:s,annotation:{id:t},target:{x:d.x,y:d.y,height:1,width:1},children:r&&n({canvasId:e,position:d,close:()=>s(!1)})})}),{onContextMenu:h},{open:c,close:a,toggle:y,isMenuOpen:r,setIsMenuOpen:s,menuPosition:d,setMenuPosition:m}]}function c_(){const t=sl();return Tt(t,e=>e.tool.requestId&&e.requests[e.tool.requestId]||null)}function f_({theme:t,renderContextMenu:e,children:n}){const r=sl(),s=pn(),a=Tt(r,F=>F.polygon),c=Tt(r,F=>F.polygonState.currentTool),d=Tt(r,F=>F.mode),m=Tt(r,F=>F.changeMode),y=Tt(r,F=>F.polygonState.transitioning),{enabled:h,requestId:v}=Tt(r,F=>F.tool),E=O.useMemo(()=>Ld(a),[a]),T=c_(),[P,k]=Uw("editing-annotation",s?.id,e),R=T?.annotationPopup||n||I.jsx(d_,{}),_=T?.svgTheme||t,M=()=>{m("sketch")};if(!h||!s||!v||!a)return null;const L=E&&a.id&&!y&&(c==="pointer"||c==="hand"||!a.open)?I.jsx($w,{annotation:a,target:E,children:R}):null,$="shape";return d==="explore"?I.jsxs(I.Fragment,{children:[I.jsx($,{id:`shape-${a.id}`,points:a.points,open:a.open,onClick:M,relativeStyle:!0,target:{x:0,y:0,width:s.width,height:s.height},style:{":hover":{backgroundColor:"rgba(0,0,0,0.2)"},backgroundColor:"rgba(0,0,0,0)",borderWidth:"4px",borderColor:"rgba(255, 255, 255, .4)"},...k}),I.jsx($,{id:`shape-${a.id}`,points:a.points,open:a.open,onClick:M,relativeStyle:!0,target:{x:0,y:0,width:s.width,height:s.height},style:{backgroundColor:"rgba(0,0,0,0)",borderWidth:"2px",borderColor:"rgba(0, 0, 0, .4)"}}),L]}):I.jsxs(I.Fragment,{children:[e?I.jsx($,{id:`shape-${a.id}`,points:a.points,open:a.open,target:{x:0,y:0,width:s.width,height:s.height},...k}):null,I.jsx(jb,{image:s,theme:_}),L,P]})}function d_(){const t=sl(),e=Tt(t,c=>c.changeMode),n=Tt(t,c=>c.mode),r=Tt(t,c=>c.completeRequest),s=Tt(t,c=>c.tool),a=()=>{O.startTransition(()=>{r()})};return s.enabled?I.jsxs("div",{className:"svg-tools-container animate-fadeIn",children:[n!=="sketch"&&I.jsx("button",{className:"svg-tools-button",onClick:()=>{e("sketch")},children:"Edit"}),I.jsx("button",{className:"svg-tools-button",onClick:a,children:"Save"})]}):null}function Ww(t,e){const{selector:n,source:r}=fi(e);if(r.id!==t.id)return[null,r];const s={spatial:{x:0,y:0,width:Number(t.width),height:Number(t.height)}};return[n?n.type==="TemporalSelector"?{type:"TemporalBoxSelector",temporal:n.temporal,spatial:s.spatial}:n:null,r]}const h_={makeChoice:()=>{}},Fp={type:"unknown"},Wn=t=>({type:"unknown",reason:t,annotations:{pages:[]}}),p_=(t,e)=>({type:"empty",width:t,height:e,annotations:{pages:[]},image:null,images:[]});function g_(t,e){const n=t?.iiif?.meta[e];return n?n.annotationPageManager:null}function m_(t,e){return zr(n=>{const r=[];if(!t)return r;const s=Object.keys(n.iiif.entities.AnnotationPage);for(const a of s)if(!e||e.indexOf(a)!==-1){const c=g_(n,a);c&&c.views&&c.views[t]&&r.push(a)}return r},[t,e])}function y_({canvas:t,manifest:e,all:n,canvases:r}){const s=[];if(e)for(const a of e.annotations)s.indexOf(a.id)===-1&&s.push(a.id);if(n){if(r&&r.length)for(const a of r)for(const c of a.annotations)s.indexOf(c.id)===-1&&s.push(c.id)}else if(t)for(const a of t.annotations)s.indexOf(a.id)===-1&&s.push(a.id);return s}function v_(t,e){const n=t?.iiif?.meta[e];return n?n.annotationPageManager:null}function Xg(t,e={}){const n=cr(),r=ss(),s=pn(),a=W0(),c=O.useMemo(()=>y_({all:e.all,manifest:r,canvas:s,canvases:a}),[e.all,s,a,r]),d=m_(t,e.all?void 0:c),m=O.useCallback(h=>{t&&n.setMetaValue([h,"annotationPageManager","views"],v=>v&&!v[t]?v:{...v||{},[t]:!1})},[t,n]),y=O.useCallback((h,v={})=>{if(!t)return;const E=n.getState(),T=[];if(v?.deselectOthers){const P=Object.keys(E.iiif.entities.AnnotationPage);for(const k of P){const R=v_(E,k);R&&R.views&&R.views[t]&&T.push(k)}}for(const P of T)m(P);n.setMetaValue([h,"annotationPageManager","views"],P=>P&&P[t]?P:{...P||{},[t]:!0})},[t,m,n]);return{availablePageIds:c,enabledPageIds:d,setPageEnabled:y,setPageDisabled:m}}function x_(t,e){return zr((n,r)=>r.get(t.map(s=>({id:s,type:e}))),[t,e])}const w_=ta((t,e)=>({loaded:{},setLoaded:(n,r="done")=>{t(s=>({loaded:{...s.loaded,[n]:r}}))}})),S_=Vc();S_.on("loaded",t=>{w_.getState().setLoaded(t.imageServiceId)});function P_(){const t=mw(),e=lb();return[O.useCallback((r,{height:s,width:a})=>r&&t(r,{height:s,width:a},!0),[t]),e]}function E_(t={}){const e=nw(),n=pn(t.canvasId?{id:t.canvasId}:void 0);return zr((r,s)=>{if(!n)return[];if(e&&t.enableSingleAnnotation)return[e];const a=s.get(n.items),c=[];for(const d of a)c.push(...s.get(d.items));return c},[n])}function k_(t,e=[]){const n=cr(),r=O.useMemo(()=>V2(n),[]),s=E_({enableSingleAnnotation:t?.enableSingleAnnotation}),[a,c]=O.useState(t?.defaultChoices||[]),d=O.useMemo(()=>r.getPaintables(s,a),[n,s,a,...e]),y={makeChoice:O.useCallback((h,{deselectOthers:v=!0,deselect:E=!1}={})=>{d.choice&&c(T=>{if(E){const k=T.filter(R=>R!==h);if(k.length===0){const R=d.items[0].resource.id;return R?[R]:[]}return k}if(v)return[h];const P=[...T];if(P.length===0&&d.items.length){const k=d.items[0].resource.id;k&&P.push(k)}return T.indexOf(h)!==-1?T:[...T,h]})},[d.choice])};return[d,y]}const C_=["model/gltf-binary"];function T_(t,e){const n=e.items[0],r=n.resource;return r.format?C_.indexOf(r.format)===-1?Wn(`3D format: ${r.format} is unsupported`):{type:"3d-model",model:r,annotationId:n.annotationId,annotation:n.annotation}:Wn("Unknown format")}function Hw(t,e){const n=e.items,r=n[0];if(n.length===0||!r)return Wn("No audio");if(!t.duration)return Wn("No duration on canvas");if(n.length>1)return Wn("Only one audio source supported");const s=r.resource;return s?("format"in s||(s.format="audio/mpeg"),{type:"media",media:{annotationId:r.annotationId,annotation:r.annotation,duration:t.duration,url:s.id,type:"Sound",target:{type:"TemporalSelector",temporal:{startTime:0,endTime:t.duration}},format:s.format,selector:{type:"TemporalSelector",temporal:{startTime:0,endTime:t.duration}}},annotations:{pages:[]}}):Wn("Unknown audio")}function Vw(t,e,n){const r=[];for(const s of e.items){const a=s.resource&&s.resource.type==="SpecificResource"?s.resource.source:s.resource;if(!a.id)return Wn("No resource Identifier");let c;if(a.service){const P=Og(a);P[0]&&(c=n(P[0],t))}const d={type:"BoxSelector",spatial:{x:0,y:0,width:Number(t.width),height:Number(t.height)}},[m,y]=Ww(t,s.target),h=t.id?.split("?")[0]||"";if(!(y.id===t.id||decodeURIComponent(y.id||"")===(t.id||"")||y.id===h||decodeURIComponent(y.id||"")===h))continue;s.resource.width&&s.resource.height&&(s.resource.width,s.resource.height);let v=s.resource.type==="SpecificResource"?fi(s.resource):null;if(s.selector){const P=fi({type:"SpecificResource",source:s.resource,selector:s.selector});P&&(v=P)}const E=v&&v.selector&&(v.selector.type==="BoxSelector"||v.selector.type==="TemporalBoxSelector")?{type:"BoxSelector",spatial:{x:v.selector.spatial.x,y:v.selector.spatial.y,width:v.selector.spatial.width,height:v.selector.spatial.height}}:void 0;c&&!c.id&&(c.id=c["@id"]);const T={id:a.id,type:"Image",annotationId:s.annotationId,annotation:s.annotation,width:Number(m||E?a.width:t.width),height:Number(m||E?a.height:t.height),service:c,sizes:c&&c.sizes?c.sizes:a.width&&a.height?[{width:a.width,height:a.height}]:[],target:m&&m.type!=="PointSelector"?m:d,selector:E||{type:"BoxSelector",spatial:{x:0,y:0,width:Number(t.width),height:Number(t.height)}},annotationPages:s.resource.annotations||[]};r.push(T)}return{type:"images",image:r[0],images:r,choice:e.choice}}function qw(t,e={},n){const r=t.language||n||"none";switch(t.type){case"TextualBody":{typeof t.value<"u"&&(e[r]=[t.value]);break}case"List":case"Composite":case"Choice":t.items&&t.items.forEach(s=>qw(s,e,r))}return e}function Qw(t,e){const n=[];return e.items.forEach(r=>{if(r.resource){const[s]=Ww(t,r.target);n.push({type:"Text",annotationId:r.annotationId,annotation:r.annotation,text:qw(r.resource),target:s})}}),{type:"textual-content",items:n}}const b_=/^.*(?:(?:youtu\.be\/|v\/|vi\/|u\/\w\/|embed\/|shorts\/)|(?:(?:watch)?\?vi?=|&vi?=))([^#&?]*).*/;function Xw(t,e,n){const r=e.items.filter(T=>T.type==="video"),s=r[0];let a=!1;if(t.duration||(a=!0),r.length>1||!s)return Wn("Only one video source supported");const c=r[0]?.resource,d=!!(c.service||[]).find(T=>(T.profile||"").includes("youtube.com"));if(!d&&a)return Wn("Video does not have duration");if(!c)return Wn("Unknown video");if((!c.format||c.format==="text/html")&&!d)return Wn("Video does not have format");let m=[];const y=n.get(t.annotations||[]);for(const T of y){const P=n.get(T.items||[]);for(const k of P)if((k.motivation?Array.isArray(k.motivation||"")?k.motivation:[k.motivation]:[]).includes("supplementing")){const _=n.get(k.body||[]);for(const M of _){const L=M;if(L.type==="Choice")for(const $ of L.items){const F=n.get($);F.format==="text/vtt"&&m.push({id:F.id,type:"Text",format:"text/vtt",label:F.label,language:F.language})}else L.format==="text/vtt"&&m.push({id:L.id,type:"Text",format:"text/vtt",label:L.label,language:L.language})}}}const h={annotationId:s.annotationId,annotation:s.annotation,duration:t.duration,url:c.id,type:"Video",target:{type:"TemporalSelector",temporal:{startTime:0,endTime:t.duration}},format:c.format,selector:{type:"TemporalSelector",temporal:{startTime:0,endTime:t.duration}}},v=fi(s.target);v.selector&&v.selector.type==="TemporalBoxSelector"&&(h.target=v.selector);const{selector:E}=Ec(s.selector);if(E===null){const T=h.target.temporal.startTime,k=(h.target.temporal.endTime||t.duration)-T;h.selector={type:"TemporalSelector",temporal:{startTime:0,endTime:k}}}else E.type==="TemporalSelector"&&(h.selector=E);if(d){h.type="VideoYouTube";const T=c.id.match(b_);if(!T[1])return Wn("Video is not known youtube video");h.youTubeId=T[1]}return{type:"media",media:h,annotations:{pages:[]},captions:m}}function R_(t,e,n,r){const s={type:"complex-timeline",items:[],keyframes:[],highlights:[],duration:t.duration||0},a={type:"complex-choice",items:[]},c=r.get(t.annotations);function d(h){h.choice&&(h.choice.type==="complex-choice"?a.items.push(...h.choice.items):a.items.push(h.choice))}for(const h of e.items){if(h.type==="image"){const v=Vw(t,{choice:null,items:[h]},n);if(v.type==="images"){d(v),s.items.push(v.image);const E={id:v.image.annotationId,type:"enter",resourceType:"image",time:v.image.target?.temporal?.startTime||0};s.keyframes.push(E);const T={id:v.image.annotationId,type:"exit",resourceType:"image",time:v.image.target?.temporal?.endTime||t.duration||0};s.keyframes.push(T)}}if(h.type==="textualbody"){const v=Qw(t,{items:[h]});if(v.type==="textual-content"){d(v);const E=v.items[0];s.items.push(E);const T=E.target,P={id:E.annotationId,type:"enter",resourceType:"text",time:T.temporal?.startTime||0};s.keyframes.push(P);const k={id:E.annotationId,type:"exit",resourceType:"text",time:T.temporal?.endTime||t.duration||0};s.keyframes.push(k)}}if(h.type==="video"){const v=Xw(t,{items:[h]},r);if(v.type==="media"){d(v);const E=v.media;s.items.push(E);const T={id:E.annotationId,type:"enter",resourceType:"video",time:E.target?.temporal?.startTime||0};s.keyframes.push(T);const P={id:E.annotationId,type:"exit",resourceType:"video",time:E.target?.temporal?.endTime||t.duration||0};s.keyframes.push(P)}}if(h.type==="audio"||h.type==="sound"){const v=Hw(t,{items:[h]});if(v.type==="media"){d(v);const E=v.media;s.items.push(E);const T={id:E.annotationId,type:"enter",resourceType:"audio",time:E.target?.temporal?.startTime||0};s.keyframes.push(T);const P={id:E.annotationId,type:"exit",resourceType:"audio",time:E.target?.temporal?.endTime||t.duration||0};s.keyframes.push(P)}}}for(const h of c)for(const v of h.items){const E=r.get(v),T=fi(E.target,{typeMap:r.getState?.().iiif.mapping});if(T.selector?.temporal){const P={id:E.id,type:"enter",resourceType:"highlight",time:T.selector.temporal.startTime||0};s.keyframes.push(P);const k={id:E.id,type:"exit",resourceType:"highlight",time:T.selector.temporal.endTime||t.duration||0};s.keyframes.push(k)}s.highlights.push({annotation:E,target:T})}s.keyframes.sort((h,v)=>h.time-v.time);let m=[];const y=[];for(const h of s.keyframes){if(h.resourceType==="image"||h.resourceType==="text"||h.resourceType==="highlight"){y.push(h);continue}if(h.type==="enter"){m.length===0&&(h.isPrime=!0),m.push(h),y.push(h);continue}if(h.type==="exit"&&(y.push(h),m=m.filter(v=>v.id!==h.id),m.length!==0)){const v=m[0],E={id:v.id,type:"change",isPrime:!0,resourceType:v.resourceType,time:h.time};y.push(E)}}return s.keyframes=y,a.items.length&&(s.choice=a),s}const Sd={},Yw={get(t){return t},setMetaValue([t,e,n],r){const s=Yw.getResourceMeta(t,e),a=s?s[n]:void 0,c=typeof r=="function"?r(a):r;Sd[t]={...Sd[t]||{},[e]:{...(Sd[t]||{})[e]||{},[n]:c}}},getResourceMeta:((t,e)=>{const n=Sd[t];if(n)return e?n[e]:n}),async load(t){const e=typeof t=="string"?t:t.id;return fetch(e).then(n=>n.json())},requestStatus(t){}};function __({canvas:t,paintables:e,supports:n,loadImageService:r,vault:s=Yw}){if(!t)return Fp;if(e.types.length===0)return n.indexOf("empty")!==-1?p_(t.width,t.height):Fp;if(e.types.length!==1)if(e.types.length===2&&e.types.indexOf("text")!==-1)e.types=e.types.filter(c=>c!=="text");else return n.indexOf("complex-timeline")===-1?Wn("Complex timeline not supported"):R_(t,e,r,s);const a=e.types[0];return a==="image"?n.indexOf("images")===-1?Wn("Image not supported"):Vw(t,e,r):a==="Model"||a==="model"?n.indexOf("3d-model")===-1?Wn("3D not supported"):T_(t,e):a==="textualbody"?n.indexOf("textual-content")===-1?Wn("Textual content not supported"):Qw(t,e):a==="sound"||a==="audio"?n.indexOf("media")===-1?Wn("Media not supported"):Hw(t,e):a==="video"?n.indexOf("media")===-1?Wn("Media not supported"):Xw(t,e,s):Fp}function I_(t){const e=ss(),n=pn(),r=cr(),s=l_(),a=t?.emitter||s,[c,d]=P_(),{enabledPageIds:m}=Xg(t?.annotationPageManagerId||e?.id||n?.id,{all:!1}),y=x_(m,"AnnotationPage"),h=t?.strategies||["empty","images","media","textual-content","complex-timeline"],[v,E]=k_(t,[d]);O.useEffect(()=>{const P=k=>{E.makeChoice(k.choiceId,{deselectOthers:k.deselectOthers,deselect:k.deselect})};return a.on("make-choice",P),()=>{a.off("make-choice",P)}},[]);const T=O.useMemo(()=>__({canvas:n,paintables:v,supports:h,loadImageService:c,vault:r}),[n,v,r,E.makeChoice]);return O.useEffect(()=>{const P=v.allChoices,k={canvasId:n?.id,manifestId:e?.id};P&&a.emit("choice-change",{choice:P,partOf:k})},[n?.id,v.allChoices]),O.useMemo(()=>T.type==="unknown"?[T,h_]:[{...T,annotations:{pages:y}},E],[T,y])}function O_({strategies:t,registerActions:e,defaultChoices:n,onChoiceChange:r,mediaControlsDeps:s,renderMediaControls:a,renderViewerControls:c,viewControlsDeps:d,renderComplexTimelineControls:m,complexTimelineControlsDeps:y,throwOnUnknown:h,children:v}){const E=pn(),T=cr(),P=O.useMemo(()=>iw(T),[T]),[k,R]=I_({strategies:t||["images"],defaultChoices:n?.map(({id:$})=>$)}),_="choice"in k?k.choice:void 0;if(O.useEffect(()=>{e&&e(R)},[k.annotations]),O.useEffect(()=>{r&&r(_)},[_]),O.useEffect(()=>{if(n)for(const $ of n)typeof $.opacity<"u"&&P.applyStyles({id:$.id},"atlas",{opacity:$.opacity})},[n]),k.type==="unknown"&&h)throw new Error(k.reason||"Unknown strategy");const M=O.useMemo(()=>({renderMediaControls:a,mediaControlsDeps:s||[],renderViewerControls:c,viewControlsDeps:d||[],renderComplexTimelineControls:m,complexTimelineControlsDeps:y||[]}),[s,a,c,d,m,y]),L=O.useMemo(()=>({strategy:k,actions:R,choices:"choice"in k?k.choice:[]}),[k,E]);return I.jsx(Bg.Provider,{value:M,children:I.jsx(Qc.Provider,{value:L,children:v})})}const Kw=O.createContext(()=>{});function A_(t){const e=pn(),n=O.useContext(Kw);O.useEffect(()=>e&&e.id?(n(e.id,t),()=>n(e.id,-1)):()=>{},[e,t])}function M_({x:t=0,y:e=0,keepCanvasScale:n=!0,renderContextMenu:r,children:s}){const{strategy:a}=Ai(),c=pn(),d=sl(),m=rw(c,["deep-zoom"]),y=Tt(d,k=>k.setCanvasRelativePosition),h=Tt(d,k=>k.clearCanvasRelativePosition),[v,E]=Uw(`context-menu/${c?.id}`,c?.id,r),T=O.useMemo(()=>n?1:Math.max(1,...a.type==="images"?a.images.map(k=>(k.width||0)/k.target?.spatial.width):[]),[n,a]);O.useEffect(()=>{if(c)return y(c.id,{x:t,y:e,width:c.width,height:c.height}),()=>{h(c.id)}},[t,e,c,h,y]),O.useEffect(()=>{c&&d.getState().reset()},[d,c]),A_(T);const P=a.type==="images"?a.images.length:0;return c?I.jsxs("world-object",{height:c.height,width:c.width,scale:T,x:t,y:e,...E,...m,children:[v,s]},`${c.id}/${a.type}/${P}`):null}function Ud({x:t,y:e,onChoiceChange:n,registerActions:r,defaultChoices:s,isStatic:a,renderViewerControls:c,renderMediaControls:d,renderComplexTimelineControls:m,complexTimelineControlsDeps:y,viewControlsDeps:h,mediaControlsDeps:v,strategies:E,throwOnUnknown:T,backgroundStyle:P,alwaysShowBackground:k,keepCanvasScale:R=!1,enableSizes:_=!1,enableYouTube:M=!0,onClickPaintingAnnotation:L,components:$={},children:F,annotationPopup:H,svgTheme:se,renderContextMenu:oe,renderAnnotationContextMenu:me}){return I.jsxs(O_,{throwOnUnknown:T,onChoiceChange:n,registerActions:r,strategies:E,defaultChoices:s,mediaControlsDeps:v,renderMediaControls:d,renderViewerControls:c,renderComplexTimelineControls:m,complexTimelineControlsDeps:y,viewControlsDeps:h,children:[I.jsxs(M_,{keepCanvasScale:R,x:t,y:e,renderContextMenu:oe,children:[I.jsx(Tb,{alwaysShowBackground:k,backgroundStyle:P}),I.jsx(Cb,{}),I.jsx(Rb,{}),I.jsx(bb,{isStatic:a,enableSizes:_,onClickPaintingAnnotation:L}),I.jsx(J2,{}),I.jsx(Q2,{}),I.jsx(rb,{as:$.Audio}),I.jsx(_b,{as:$.Video}),M?I.jsx(Ib,{}):null,I.jsx(f_,{theme:se,renderContextMenu:me,children:H}),F]}),I.jsx(X2,{})]})}function j_(t){const e=pn();return!e||!e.placeholderCanvas?null:I.jsx(du,{canvas:e.placeholderCanvas.id,children:I.jsx(Ud,{renderViewerControls:t.renderViewerControls})})}const L_=O.createContext(null),Dp={didCatch:!1,error:null};class N_ extends O.Component{constructor(e){super(e),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=Dp}static getDerivedStateFromError(e){return{didCatch:!0,error:e}}resetErrorBoundary(){const{error:e}=this.state;if(e!==null){for(var n,r,s=arguments.length,a=new Array(s),c=0;c<s;c++)a[c]=arguments[c];(n=(r=this.props).onReset)===null||n===void 0||n.call(r,{args:a,reason:"imperative-api"}),this.setState(Dp)}}componentDidCatch(e,n){var r,s;(r=(s=this.props).onError)===null||r===void 0||r.call(s,e,n)}componentDidUpdate(e,n){const{didCatch:r}=this.state,{resetKeys:s}=this.props;if(r&&n.error!==null&&z_(e.resetKeys,s)){var a,c;(a=(c=this.props).onReset)===null||a===void 0||a.call(c,{next:s,prev:e.resetKeys,reason:"keys"}),this.setState(Dp)}}render(){const{children:e,fallbackRender:n,FallbackComponent:r,fallback:s}=this.props,{didCatch:a,error:c}=this.state;let d=e;if(a){const m={error:c,resetErrorBoundary:this.resetErrorBoundary};if(typeof n=="function")d=n(m);else if(r)d=O.createElement(r,m);else if(s!==void 0)d=s;else throw c}return O.createElement(L_.Provider,{value:{didCatch:a,error:c,resetErrorBoundary:this.resetErrorBoundary}},d)}}function z_(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t.length!==e.length||t.some((n,r)=>!Object.is(n,e[r]))}function F_(t,e=2e3){const{currentSequenceIndex:n,sequence:r,items:s}=Rg(),a=pn(),c=O.useMemo(()=>{const m=r[n]||[];return m.length===0&&a?[{id:a.id,type:"Canvas"}]:m.map(y=>s[y])},[r,n,a,s]),d=sl();O.useEffect(()=>{const y=setInterval(()=>{if(t&&e!==-1){const h={x:t.x,y:t.y,width:t.width,height:t.height},v=d.getState().canvasRelativePositions,E={};for(const T of c){const P=v[T.id];if(P){const k=P.x,R=P.y,_=P.width,M=P.height,L={x:Math.max(k,h.x),y:Math.max(R,h.y),width:Math.min(k+_,h.x+h.width)-Math.max(k,h.x),height:Math.min(R+M,h.y+h.height)-Math.max(R,h.y)};L.width<=0||L.height<=0||(E[T.id]={x:L.x-P.x,y:L.y-P.y,width:L.width,height:L.height}),d.setState({canvasViewports:E})}}}},e);return()=>{clearTimeout(y)}},[c,t,d,e])}function D_({width:t,style:e,height:n,error:r,resetErrorBoundary:s}){return I.jsxs("div",{style:{width:t,height:n,minHeight:500,...e||{},background:"#f9f9f9"},children:[I.jsx("h3",{children:"Error occurred"}),I.jsx("p",{children:r.message}),I.jsx("button",{type:"button",onClick:s,children:"Reset"})]})}function B_(t){const e=sl();return I.jsx(Ng,{name:t.name,existing:e,children:I.jsx($_,{...t})})}function $_({name:t,children:e,errorFallback:n,outerContainerProps:r={},worldScale:s,updateViewportTimeout:a,...c}){const d=sl(),m=Tt(d,de=>de.mode),y=Tt(d,de=>de.setAtlasRuntime),[h,v]=O.useState(),E=Fw(),T=Dw(),P=n||D_,[k,R]=O.useState({}),_=Object.entries(k),[M,L]=O.useState({}),$=Object.entries(M),[F,H]=O.useState({}),se=O.useMemo(()=>s||Math.max(...Object.values(F)),[F]),oe=O.useMemo(()=>({maxOverZoom:se||1,...c.runtimeOptions||{}}),[se,c.runtimeOptions]);F_(h?.runtime,a);const me=O.useCallback((de,we)=>{H(le=>{if(we===-1){const{[de]:Ie,...Se}=le;return Se}return{...le,[de]:we}})},[]),K=O.useCallback((de,we,le)=>{R(({[de]:Ie,...Se})=>we?{...Se,[de]:{element:we,props:le}}:Se)},[]),ge=O.useCallback((de,we,le)=>{L(({[de]:Ie,...Se})=>we?{...Se,[de]:{element:we,props:le}}:Se)},[]);return I.jsxs(N_,{resetKeys:[],fallbackRender:de=>I.jsx(P,{...c,...de}),children:[I.jsx(AT,{...c,mode:m,containerProps:{style:{position:"relative"},...c.containerProps||{}},htmlChildren:I.jsx(I.Fragment,{children:_.map(([de,{element:we,props:le}])=>I.jsx(Xt.Fragment,{children:I.jsx(we,{...le||{}})},de))}),onCreated:de=>{v(de),y(de.runtime),c.onCreated&&c.onCreated(de)},runtimeOptions:oe,children:I.jsx(Ng,{name:t,existing:d,children:I.jsx(oh.Provider,{value:h,children:I.jsx(Kw.Provider,{value:me,children:I.jsx(aw.Provider,{value:K,children:I.jsx(uw.Provider,{value:ge,children:I.jsx(Bw,{bridge:T,custom:E,children:I.jsx(Z2,{children:e})})})})})})})}),I.jsx("div",{children:$.map(([de,{element:we,props:le}])=>I.jsx(Xt.Fragment,{children:I.jsx(we,{...le||{}})},de))}),I.jsx("div",{id:"atlas-floating-ui",style:{position:"relative",zIndex:999999}})]})}const U_=O.forwardRef(function(e,n){const r=ss(),s=W0(),a=Rg(),{ViewerControls:c,MediaControls:d,ComplexTimelineControls:m}=e.components||{};if(O.useImperativeHandle(n,()=>a,[a]),!r)return I.jsx("div",{});let y=0;const h=r.viewingDirection==="top-to-bottom",v=r.viewingDirection==="bottom-to-top";r.viewingDirection;const E=r.viewingDirection==="right-to-left",P=r.behavior.includes("continuous")?0:e.spacing||0,k=v||E,R=O.useMemo(()=>k?[...s].reverse():s,[s,k]);return I.jsxs(I.Fragment,{children:[e.header,I.jsx(Hn.Viewer,{height:e.height,mode:e.mode,renderPreset:e.renderPreset,runtimeOptions:e.runtimeOptions,updateViewportTimeout:e.updateViewportTimeout,children:R.map((_,M)=>{let L=0,$=0;return h?(L=y,y+=_.width+P):($=y,y+=_.height+P),I.jsx(du,{canvas:_.id,children:I.jsx(Hn.RenderCanvas,{strategies:["3d-model","media","images","empty","textual-content","complex-timeline"],renderViewerControls:M===0&&c?()=>I.jsx(c,{}):void 0,renderMediaControls:M===0&&d?()=>I.jsx(d,{}):void 0,annotationPopup:e.annotationPopup,renderContextMenu:e.renderContextMenu,keepCanvasScale:e.keepCanvasScale,renderComplexTimelineControls:M===0&&m?()=>I.jsx(m,{}):void 0,renderAnnotationContextMenu:e.renderAnnotationContextMenu,x:L,y:$,svgTheme:e.svgTheme,...e.canvasProps||{},children:e.annotations},_.id)},_.id)})},e.reuseAtlas?"":a.currentSequenceIndex),e.children]})}),Hn=O.forwardRef(function({children:e,height:n,annotations:r,canvasProps:s,spacing:a,header:c,components:d,mode:m,reuseAtlas:y,renderPreset:h,runtimeOptions:v,annotationPopup:E,name:T,svgTheme:P,updateViewportTimeout:k,renderContextMenu:R,keepCanvasScale:_,renderAnnotationContextMenu:M,...L},$){const F=Tg();return I.jsx(Ng,{name:T,children:I.jsx(Cg,{vault:F,children:I.jsx(ak,{...L,children:I.jsx(U_,{ref:$,height:n,components:d,spacing:a,canvasProps:s,annotations:r,header:c,mode:m,reuseAtlas:y,renderPreset:h,runtimeOptions:v,annotationPopup:E,svgTheme:P,updateViewportTimeout:k,renderContextMenu:R,keepCanvasScale:_,renderAnnotationContextMenu:M,children:e})})})})});Hn.RenderImage=Hg;Hn.RenderCanvas=Ud;Hn.RenderAnnotationPage=Dc;Hn.RenderAnnotation=zg;Hn.Viewer=B_;Hn.CanvasBackground=ww;Hn.Audio=fw;Hn.Video=Ew;Hn.Model=hw;Hn.AudioHTML=cw;Hn.VideoHTML=Pw;Hn.ModelHTML=dw;Hn.PlaceholderCanvas=j_;Hn.getAtlasStoreByName=j2;const W_=O.createContext(Vc());W_.displayName="SelectorHelper";O.forwardRef(function({canvasId:e},n){const r=MT(),s=Xg(e||r?.id),a=cr();return O.useImperativeHandle(n,()=>s,[e,r]),!r||s.enabledPageIds.length===0?null:I.jsx(I.Fragment,{children:s.enabledPageIds.map(c=>I.jsx(Hn.RenderAnnotationPage,{page:a.get(c)},c))})});function H_({metadata:t=[],config:e,labelWidth:n=16,showEmptyMessage:r=!0,allowHtml:s,emptyFallback:a,classes:c={},emptyMessage:d="No metadata available",emptyValueFallback:m="No value",emptyLabelFallback:y="",separator:h,tableFooter:v,tableHeader:E}){const T=O.useMemo(()=>{const k=(e||[]).reduce((_,M)=>[..._,...M.keys],[]),R={};for(const _ of t){const M=_&&_.label?Object.values(_.label):[];for(const L of M)if(L&&L.length&&(k.indexOf(`metadata.${L[0]}`)!==-1||k.length===0)&&_){const $=`metadata.${L[0]}`;R[$]=R[$]?R[$]:[],R[$].push(_);break}}return R},[e,t]);return Object.keys(T).length===0&&r?I.jsx(I.Fragment,{children:a})||I.jsx("div",{className:c.empty,children:d}):e&&e.length?I.jsxs("table",{className:`metadata ${c.container}`,children:[E,I.jsx("tbody",{children:e.map((k,R)=>{const _=[];for(const M of k.keys)for(const L of T[M]||[])_.push(I.jsx(Hs,{enableDangerouslySetInnerHTML:s,defaultText:m,separator:h,children:L.value},R+"__"+M));return _.length===0?null:I.jsxs("tr",{className:c.row,children:[I.jsx("td",{className:c.label,style:n?{minWidth:n}:{},children:I.jsx(Hs,{enableDangerouslySetInnerHTML:s,separator:h,defaultText:y,children:k.label})}),I.jsx("td",{className:c.value,children:_})]},R)})}),v]}):I.jsxs("table",{className:`metadata ${c.container}`,children:[E,I.jsx("tbody",{children:t&&t.length?t.map((k,R)=>k?I.jsxs("tr",{className:c.row,children:[I.jsx("td",{className:c.label,style:n?{minWidth:n}:{},children:I.jsx(Hs,{enableDangerouslySetInnerHTML:s,defaultText:m,separator:h,children:k.label})}),I.jsx("td",{className:c.value,children:I.jsx(Hs,{enableDangerouslySetInnerHTML:s,defaultText:m,separator:h,children:k.value})})]},R):null):null}),v]})}function V_(t){const e=ss(),n=pn(),r=V0(),s=O.useMemo(()=>{const a=e?.metadata||[],c=n?.metadata||[],d=r?.metadata||[];return[...a,...c,...d]},[e,n,r]);return I.jsx(H_,{metadata:s,...t})}var Bp={exports:{}},av;function q_(){return av||(av=1,(()=>{var t={296:(s,a,c)=>{var d=/^\s+|\s+$/g,m=/^[-+]0x[0-9a-f]+$/i,y=/^0b[01]+$/i,h=/^0o[0-7]+$/i,v=parseInt,E=typeof c.g=="object"&&c.g&&c.g.Object===Object&&c.g,T=typeof self=="object"&&self&&self.Object===Object&&self,P=E||T||Function("return this")(),k=Object.prototype.toString,R=Math.max,_=Math.min,M=function(){return P.Date.now()};function L(F){var H=typeof F;return!!F&&(H=="object"||H=="function")}function $(F){if(typeof F=="number")return F;if((function(oe){return typeof oe=="symbol"||(function(me){return!!me&&typeof me=="object"})(oe)&&k.call(oe)=="[object Symbol]"})(F))return NaN;if(L(F)){var H=typeof F.valueOf=="function"?F.valueOf():F;F=L(H)?H+"":H}if(typeof F!="string")return F===0?F:+F;F=F.replace(d,"");var se=y.test(F);return se||h.test(F)?v(F.slice(2),se?2:8):m.test(F)?NaN:+F}s.exports=function(F,H,se){var oe,me,K,ge,de,we,le=0,Ie=!1,Se=!1,Te=!0;if(typeof F!="function")throw new TypeError("Expected a function");function D(Re){var je=oe,Le=me;return oe=me=void 0,le=Re,ge=F.apply(Le,je)}function U(Re){var je=Re-we;return we===void 0||je>=H||je<0||Se&&Re-le>=K}function Q(){var Re=M();if(U(Re))return B(Re);de=setTimeout(Q,(function(je){var Le=H-(je-we);return Se?_(Le,K-(je-le)):Le})(Re))}function B(Re){return de=void 0,Te&&oe?D(Re):(oe=me=void 0,ge)}function re(){var Re=M(),je=U(Re);if(oe=arguments,me=this,we=Re,je){if(de===void 0)return(function(Le){return le=Le,de=setTimeout(Q,H),Ie?D(Le):ge})(we);if(Se)return de=setTimeout(Q,H),D(we)}return de===void 0&&(de=setTimeout(Q,H)),ge}return H=$(H)||0,L(se)&&(Ie=!!se.leading,K=(Se="maxWait"in se)?R($(se.maxWait)||0,H):K,Te="trailing"in se?!!se.trailing:Te),re.cancel=function(){de!==void 0&&clearTimeout(de),le=0,oe=we=me=de=void 0},re.flush=function(){return de===void 0?ge:B(M())},re}},96:(s,a,c)=>{var d="Expected a function",m=NaN,y="[object Symbol]",h=/^\s+|\s+$/g,v=/^[-+]0x[0-9a-f]+$/i,E=/^0b[01]+$/i,T=/^0o[0-7]+$/i,P=parseInt,k=typeof c.g=="object"&&c.g&&c.g.Object===Object&&c.g,R=typeof self=="object"&&self&&self.Object===Object&&self,_=k||R||Function("return this")(),M=Object.prototype.toString,L=Math.max,$=Math.min,F=function(){return _.Date.now()};function H(oe){var me=typeof oe;return!!oe&&(me=="object"||me=="function")}function se(oe){if(typeof oe=="number")return oe;if((function(ge){return typeof ge=="symbol"||(function(de){return!!de&&typeof de=="object"})(ge)&&M.call(ge)==y})(oe))return m;if(H(oe)){var me=typeof oe.valueOf=="function"?oe.valueOf():oe;oe=H(me)?me+"":me}if(typeof oe!="string")return oe===0?oe:+oe;oe=oe.replace(h,"");var K=E.test(oe);return K||T.test(oe)?P(oe.slice(2),K?2:8):v.test(oe)?m:+oe}s.exports=function(oe,me,K){var ge=!0,de=!0;if(typeof oe!="function")throw new TypeError(d);return H(K)&&(ge="leading"in K?!!K.leading:ge,de="trailing"in K?!!K.trailing:de),(function(we,le,Ie){var Se,Te,D,U,Q,B,re=0,Re=!1,je=!1,Le=!0;if(typeof we!="function")throw new TypeError(d);function De(ot){var ze=Se,be=Te;return Se=Te=void 0,re=ot,U=we.apply(be,ze)}function Je(ot){var ze=ot-B;return B===void 0||ze>=le||ze<0||je&&ot-re>=D}function it(){var ot=F();if(Je(ot))return ut(ot);Q=setTimeout(it,(function(ze){var be=le-(ze-B);return je?$(be,D-(ze-re)):be})(ot))}function ut(ot){return Q=void 0,Le&&Se?De(ot):(Se=Te=void 0,U)}function mt(){var ot=F(),ze=Je(ot);if(Se=arguments,Te=this,B=ot,ze){if(Q===void 0)return(function(be){return re=be,Q=setTimeout(it,le),Re?De(be):U})(B);if(je)return Q=setTimeout(it,le),De(B)}return Q===void 0&&(Q=setTimeout(it,le)),U}return le=se(le)||0,H(Ie)&&(Re=!!Ie.leading,D=(je="maxWait"in Ie)?L(se(Ie.maxWait)||0,le):D,Le="trailing"in Ie?!!Ie.trailing:Le),mt.cancel=function(){Q!==void 0&&clearTimeout(Q),re=0,Se=B=Te=Q=void 0},mt.flush=function(){return Q===void 0?U:ut(F())},mt})(oe,me,{leading:ge,maxWait:me,trailing:de})}},703:(s,a,c)=>{var d=c(414);function m(){}function y(){}y.resetWarningCache=m,s.exports=function(){function h(T,P,k,R,_,M){if(M!==d){var L=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw L.name="Invariant Violation",L}}function v(){return h}h.isRequired=h;var E={array:h,bigint:h,bool:h,func:h,number:h,object:h,string:h,symbol:h,any:h,arrayOf:v,element:h,elementType:h,instanceOf:v,node:h,objectOf:v,oneOf:v,oneOfType:v,shape:v,exact:v,checkPropTypes:y,resetWarningCache:m};return E.PropTypes=E,E}},697:(s,a,c)=>{s.exports=c(703)()},414:s=>{s.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}},e={};function n(s){var a=e[s];if(a!==void 0)return a.exports;var c=e[s]={exports:{}};return t[s](c,c.exports,n),c.exports}n.n=s=>{var a=s&&s.__esModule?()=>s.default:()=>s;return n.d(a,{a}),a},n.d=(s,a)=>{for(var c in a)n.o(a,c)&&!n.o(s,c)&&Object.defineProperty(s,c,{enumerable:!0,get:a[c]})},n.g=(function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}})(),n.o=(s,a)=>Object.prototype.hasOwnProperty.call(s,a),n.r=s=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})};var r={};(()=>{n.r(r),n.d(r,{LazyLoadComponent:()=>ze,LazyLoadImage:()=>ke,trackWindowScroll:()=>U});const s=ea();var a=n.n(s),c=n(697);function d(){return typeof window<"u"&&"IntersectionObserver"in window&&"isIntersecting"in window.IntersectionObserverEntry.prototype}function m(G){return m=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},m(G)}function y(G,W){var ae=Object.keys(G);if(Object.getOwnPropertySymbols){var he=Object.getOwnPropertySymbols(G);W&&(he=he.filter((function(Xe){return Object.getOwnPropertyDescriptor(G,Xe).enumerable}))),ae.push.apply(ae,he)}return ae}function h(G,W,ae){return(W=E(W))in G?Object.defineProperty(G,W,{value:ae,enumerable:!0,configurable:!0,writable:!0}):G[W]=ae,G}function v(G,W){for(var ae=0;ae<W.length;ae++){var he=W[ae];he.enumerable=he.enumerable||!1,he.configurable=!0,"value"in he&&(he.writable=!0),Object.defineProperty(G,E(he.key),he)}}function E(G){var W=(function(ae,he){if(m(ae)!=="object"||ae===null)return ae;var Xe=ae[Symbol.toPrimitive];if(Xe!==void 0){var Ze=Xe.call(ae,"string");if(m(Ze)!=="object")return Ze;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(ae)})(G);return m(W)==="symbol"?W:String(W)}function T(G,W){return T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ae,he){return ae.__proto__=he,ae},T(G,W)}function P(G){return P=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(W){return W.__proto__||Object.getPrototypeOf(W)},P(G)}var k=function(G){G.forEach((function(W){W.isIntersecting&&W.target.onVisible()}))},R={},_=(function(G){(function(ue,pe){if(typeof pe!="function"&&pe!==null)throw new TypeError("Super expression must either be null or a function");ue.prototype=Object.create(pe&&pe.prototype,{constructor:{value:ue,writable:!0,configurable:!0}}),Object.defineProperty(ue,"prototype",{writable:!1}),pe&&T(ue,pe)})(at,G);var W,ae,he,Xe,Ze=(he=at,Xe=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var ue,pe=P(he);if(Xe){var Oe=P(this).constructor;ue=Reflect.construct(pe,arguments,Oe)}else ue=pe.apply(this,arguments);return(function(Ne,Ae){if(Ae&&(m(Ae)==="object"||typeof Ae=="function"))return Ae;if(Ae!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return(function(tt){if(tt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return tt})(Ne)})(this,ue)});function at(ue){var pe;if((function(Ne,Ae){if(!(Ne instanceof Ae))throw new TypeError("Cannot call a class as a function")})(this,at),(pe=Ze.call(this,ue)).supportsObserver=!ue.scrollPosition&&ue.useIntersectionObserver&&d(),pe.supportsObserver){var Oe=ue.threshold;pe.observer=(function(Ne){return R[Ne]=R[Ne]||new IntersectionObserver(k,{rootMargin:Ne+"px"}),R[Ne]})(Oe)}return pe}return W=at,ae=[{key:"componentDidMount",value:function(){this.placeholder&&this.observer&&(this.placeholder.onVisible=this.props.onVisible,this.observer.observe(this.placeholder)),this.supportsObserver||this.updateVisibility()}},{key:"componentWillUnmount",value:function(){this.observer&&this.placeholder&&this.observer.unobserve(this.placeholder)}},{key:"componentDidUpdate",value:function(){this.supportsObserver||this.updateVisibility()}},{key:"getPlaceholderBoundingBox",value:function(){var ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.scrollPosition,pe=this.placeholder.getBoundingClientRect(),Oe=this.placeholder.style,Ne=parseInt(Oe.getPropertyValue("margin-left"),10)||0,Ae=parseInt(Oe.getPropertyValue("margin-top"),10)||0;return{bottom:ue.y+pe.bottom+Ae,left:ue.x+pe.left+Ne,right:ue.x+pe.right+Ne,top:ue.y+pe.top+Ae}}},{key:"isPlaceholderInViewport",value:function(){if(typeof window>"u"||!this.placeholder)return!1;var ue=this.props,pe=ue.scrollPosition,Oe=ue.threshold,Ne=this.getPlaceholderBoundingBox(pe),Ae=pe.y+window.innerHeight,tt=pe.x,St=pe.x+window.innerWidth,bt=pe.y;return bt-Oe<=Ne.bottom&&Ae+Oe>=Ne.top&&tt-Oe<=Ne.right&&St+Oe>=Ne.left}},{key:"updateVisibility",value:function(){this.isPlaceholderInViewport()&&this.props.onVisible()}},{key:"render",value:function(){var ue=this,pe=this.props,Oe=pe.className,Ne=pe.height,Ae=pe.placeholder,tt=pe.style,St=pe.width;if(Ae&&typeof Ae.type!="function")return a().cloneElement(Ae,{ref:function(Pt){return ue.placeholder=Pt}});var bt=(function(Pt){for(var Dt=1;Dt<arguments.length;Dt++){var Rt=arguments[Dt]!=null?arguments[Dt]:{};Dt%2?y(Object(Rt),!0).forEach((function(sn){h(Pt,sn,Rt[sn])})):Object.getOwnPropertyDescriptors?Object.defineProperties(Pt,Object.getOwnPropertyDescriptors(Rt)):y(Object(Rt)).forEach((function(sn){Object.defineProperty(Pt,sn,Object.getOwnPropertyDescriptor(Rt,sn))}))}return Pt})({display:"inline-block"},tt);return St!==void 0&&(bt.width=St),Ne!==void 0&&(bt.height=Ne),a().createElement("span",{className:Oe,ref:function(Pt){return ue.placeholder=Pt},style:bt},Ae)}}],ae&&v(W.prototype,ae),Object.defineProperty(W,"prototype",{writable:!1}),at})(a().Component);_.propTypes={onVisible:c.PropTypes.func.isRequired,className:c.PropTypes.string,height:c.PropTypes.oneOfType([c.PropTypes.number,c.PropTypes.string]),placeholder:c.PropTypes.element,threshold:c.PropTypes.number,useIntersectionObserver:c.PropTypes.bool,scrollPosition:c.PropTypes.shape({x:c.PropTypes.number.isRequired,y:c.PropTypes.number.isRequired}),width:c.PropTypes.oneOfType([c.PropTypes.number,c.PropTypes.string])},_.defaultProps={className:"",placeholder:null,threshold:100,useIntersectionObserver:!0};const M=_;var L=n(296),$=n.n(L),F=n(96),H=n.n(F),se=function(G){var W=getComputedStyle(G,null);return W.getPropertyValue("overflow")+W.getPropertyValue("overflow-y")+W.getPropertyValue("overflow-x")};const oe=function(G){if(!(G instanceof HTMLElement))return window;for(var W=G;W&&W instanceof HTMLElement;){if(/(scroll|auto)/.test(se(W)))return W;W=W.parentNode}return window};function me(G){return me=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},me(G)}var K=["delayMethod","delayTime"];function ge(){return ge=Object.assign?Object.assign.bind():function(G){for(var W=1;W<arguments.length;W++){var ae=arguments[W];for(var he in ae)Object.prototype.hasOwnProperty.call(ae,he)&&(G[he]=ae[he])}return G},ge.apply(this,arguments)}function de(G,W){for(var ae=0;ae<W.length;ae++){var he=W[ae];he.enumerable=he.enumerable||!1,he.configurable=!0,"value"in he&&(he.writable=!0),Object.defineProperty(G,(Xe=(function(Ze,at){if(me(Ze)!=="object"||Ze===null)return Ze;var ue=Ze[Symbol.toPrimitive];if(ue!==void 0){var pe=ue.call(Ze,"string");if(me(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Ze)})(he.key),me(Xe)==="symbol"?Xe:String(Xe)),he)}var Xe}function we(G,W){return we=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ae,he){return ae.__proto__=he,ae},we(G,W)}function le(G,W){if(W&&(me(W)==="object"||typeof W=="function"))return W;if(W!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Ie(G)}function Ie(G){if(G===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return G}function Se(G){return Se=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(W){return W.__proto__||Object.getPrototypeOf(W)},Se(G)}var Te=function(){return typeof window>"u"?0:window.scrollX||window.pageXOffset},D=function(){return typeof window>"u"?0:window.scrollY||window.pageYOffset};const U=function(G){var W=(function(ae){(function(Oe,Ne){if(typeof Ne!="function"&&Ne!==null)throw new TypeError("Super expression must either be null or a function");Oe.prototype=Object.create(Ne&&Ne.prototype,{constructor:{value:Oe,writable:!0,configurable:!0}}),Object.defineProperty(Oe,"prototype",{writable:!1}),Ne&&we(Oe,Ne)})(pe,ae);var he,Xe,Ze,at,ue=(Ze=pe,at=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var Oe,Ne=Se(Ze);if(at){var Ae=Se(this).constructor;Oe=Reflect.construct(Ne,arguments,Ae)}else Oe=Ne.apply(this,arguments);return le(this,Oe)});function pe(Oe){var Ne;if((function(tt,St){if(!(tt instanceof St))throw new TypeError("Cannot call a class as a function")})(this,pe),(Ne=ue.call(this,Oe)).useIntersectionObserver=Oe.useIntersectionObserver&&d(),Ne.useIntersectionObserver)return le(Ne);var Ae=Ne.onChangeScroll.bind(Ie(Ne));return Oe.delayMethod==="debounce"?Ne.delayedScroll=$()(Ae,Oe.delayTime):Oe.delayMethod==="throttle"&&(Ne.delayedScroll=H()(Ae,Oe.delayTime)),Ne.state={scrollPosition:{x:Te(),y:D()}},Ne.baseComponentRef=a().createRef(),Ne}return he=pe,(Xe=[{key:"componentDidMount",value:function(){this.addListeners()}},{key:"componentWillUnmount",value:function(){this.removeListeners()}},{key:"componentDidUpdate",value:function(){typeof window>"u"||this.useIntersectionObserver||oe(this.baseComponentRef.current)!==this.scrollElement&&(this.removeListeners(),this.addListeners())}},{key:"addListeners",value:function(){typeof window>"u"||this.useIntersectionObserver||(this.scrollElement=oe(this.baseComponentRef.current),this.scrollElement.addEventListener("scroll",this.delayedScroll,{passive:!0}),window.addEventListener("resize",this.delayedScroll,{passive:!0}),this.scrollElement!==window&&window.addEventListener("scroll",this.delayedScroll,{passive:!0}))}},{key:"removeListeners",value:function(){typeof window>"u"||this.useIntersectionObserver||(this.scrollElement.removeEventListener("scroll",this.delayedScroll),window.removeEventListener("resize",this.delayedScroll),this.scrollElement!==window&&window.removeEventListener("scroll",this.delayedScroll))}},{key:"onChangeScroll",value:function(){this.useIntersectionObserver||this.setState({scrollPosition:{x:Te(),y:D()}})}},{key:"render",value:function(){var Oe=this.props,Ne=(Oe.delayMethod,Oe.delayTime,(function(tt,St){if(tt==null)return{};var bt,Pt,Dt=(function(sn,Yr){if(sn==null)return{};var Fr,us,cs={},fs=Object.keys(sn);for(us=0;us<fs.length;us++)Fr=fs[us],Yr.indexOf(Fr)>=0||(cs[Fr]=sn[Fr]);return cs})(tt,St);if(Object.getOwnPropertySymbols){var Rt=Object.getOwnPropertySymbols(tt);for(Pt=0;Pt<Rt.length;Pt++)bt=Rt[Pt],St.indexOf(bt)>=0||Object.prototype.propertyIsEnumerable.call(tt,bt)&&(Dt[bt]=tt[bt])}return Dt})(Oe,K)),Ae=this.useIntersectionObserver?null:this.state.scrollPosition;return a().createElement(G,ge({forwardRef:this.baseComponentRef,scrollPosition:Ae},Ne))}}])&&de(he.prototype,Xe),Object.defineProperty(he,"prototype",{writable:!1}),pe})(a().Component);return W.propTypes={delayMethod:c.PropTypes.oneOf(["debounce","throttle"]),delayTime:c.PropTypes.number,useIntersectionObserver:c.PropTypes.bool},W.defaultProps={delayMethod:"throttle",delayTime:300,useIntersectionObserver:!0},W};function Q(G){return Q=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},Q(G)}function B(G,W){for(var ae=0;ae<W.length;ae++){var he=W[ae];he.enumerable=he.enumerable||!1,he.configurable=!0,"value"in he&&(he.writable=!0),Object.defineProperty(G,(Xe=(function(Ze,at){if(Q(Ze)!=="object"||Ze===null)return Ze;var ue=Ze[Symbol.toPrimitive];if(ue!==void 0){var pe=ue.call(Ze,"string");if(Q(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Ze)})(he.key),Q(Xe)==="symbol"?Xe:String(Xe)),he)}var Xe}function re(G,W){return re=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ae,he){return ae.__proto__=he,ae},re(G,W)}function Re(G){return Re=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(W){return W.__proto__||Object.getPrototypeOf(W)},Re(G)}var je=(function(G){(function(ue,pe){if(typeof pe!="function"&&pe!==null)throw new TypeError("Super expression must either be null or a function");ue.prototype=Object.create(pe&&pe.prototype,{constructor:{value:ue,writable:!0,configurable:!0}}),Object.defineProperty(ue,"prototype",{writable:!1}),pe&&re(ue,pe)})(at,G);var W,ae,he,Xe,Ze=(he=at,Xe=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var ue,pe=Re(he);if(Xe){var Oe=Re(this).constructor;ue=Reflect.construct(pe,arguments,Oe)}else ue=pe.apply(this,arguments);return(function(Ne,Ae){if(Ae&&(Q(Ae)==="object"||typeof Ae=="function"))return Ae;if(Ae!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return(function(tt){if(tt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return tt})(Ne)})(this,ue)});function at(ue){return(function(pe,Oe){if(!(pe instanceof Oe))throw new TypeError("Cannot call a class as a function")})(this,at),Ze.call(this,ue)}return W=at,(ae=[{key:"render",value:function(){return a().createElement(M,this.props)}}])&&B(W.prototype,ae),Object.defineProperty(W,"prototype",{writable:!1}),at})(a().Component);const Le=U(je);function De(G){return De=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},De(G)}function Je(G,W){for(var ae=0;ae<W.length;ae++){var he=W[ae];he.enumerable=he.enumerable||!1,he.configurable=!0,"value"in he&&(he.writable=!0),Object.defineProperty(G,(Xe=(function(Ze,at){if(De(Ze)!=="object"||Ze===null)return Ze;var ue=Ze[Symbol.toPrimitive];if(ue!==void 0){var pe=ue.call(Ze,"string");if(De(pe)!=="object")return pe;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(Ze)})(he.key),De(Xe)==="symbol"?Xe:String(Xe)),he)}var Xe}function it(G,W){return it=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ae,he){return ae.__proto__=he,ae},it(G,W)}function ut(G){if(G===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return G}function mt(G){return mt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(W){return W.__proto__||Object.getPrototypeOf(W)},mt(G)}var ot=(function(G){(function(ue,pe){if(typeof pe!="function"&&pe!==null)throw new TypeError("Super expression must either be null or a function");ue.prototype=Object.create(pe&&pe.prototype,{constructor:{value:ue,writable:!0,configurable:!0}}),Object.defineProperty(ue,"prototype",{writable:!1}),pe&&it(ue,pe)})(at,G);var W,ae,he,Xe,Ze=(he=at,Xe=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var ue,pe=mt(he);if(Xe){var Oe=mt(this).constructor;ue=Reflect.construct(pe,arguments,Oe)}else ue=pe.apply(this,arguments);return(function(Ne,Ae){if(Ae&&(De(Ae)==="object"||typeof Ae=="function"))return Ae;if(Ae!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ut(Ne)})(this,ue)});function at(ue){var pe;(function(St,bt){if(!(St instanceof bt))throw new TypeError("Cannot call a class as a function")})(this,at),pe=Ze.call(this,ue);var Oe=ue.afterLoad,Ne=ue.beforeLoad,Ae=ue.scrollPosition,tt=ue.visibleByDefault;return pe.state={visible:tt},tt&&(Ne(),Oe()),pe.onVisible=pe.onVisible.bind(ut(pe)),pe.isScrollTracked=!!(Ae&&Number.isFinite(Ae.x)&&Ae.x>=0&&Number.isFinite(Ae.y)&&Ae.y>=0),pe}return W=at,(ae=[{key:"componentDidUpdate",value:function(ue,pe){pe.visible!==this.state.visible&&this.props.afterLoad()}},{key:"onVisible",value:function(){this.props.beforeLoad(),this.setState({visible:!0})}},{key:"render",value:function(){if(this.state.visible)return this.props.children;var ue=this.props,pe=ue.className,Oe=ue.delayMethod,Ne=ue.delayTime,Ae=ue.height,tt=ue.placeholder,St=ue.scrollPosition,bt=ue.style,Pt=ue.threshold,Dt=ue.useIntersectionObserver,Rt=ue.width;return this.isScrollTracked||Dt&&d()?a().createElement(M,{className:pe,height:Ae,onVisible:this.onVisible,placeholder:tt,scrollPosition:St,style:bt,threshold:Pt,useIntersectionObserver:Dt,width:Rt}):a().createElement(Le,{className:pe,delayMethod:Oe,delayTime:Ne,height:Ae,onVisible:this.onVisible,placeholder:tt,style:bt,threshold:Pt,width:Rt})}}])&&Je(W.prototype,ae),Object.defineProperty(W,"prototype",{writable:!1}),at})(a().Component);ot.propTypes={afterLoad:c.PropTypes.func,beforeLoad:c.PropTypes.func,useIntersectionObserver:c.PropTypes.bool,visibleByDefault:c.PropTypes.bool},ot.defaultProps={afterLoad:function(){return{}},beforeLoad:function(){return{}},useIntersectionObserver:!0,visibleByDefault:!1};const ze=ot;function be(G){return be=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(W){return typeof W}:function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},be(G)}var ct=["afterLoad","beforeLoad","delayMethod","delayTime","effect","placeholder","placeholderSrc","scrollPosition","threshold","useIntersectionObserver","visibleByDefault","wrapperClassName","wrapperProps"];function An(G,W){var ae=Object.keys(G);if(Object.getOwnPropertySymbols){var he=Object.getOwnPropertySymbols(G);W&&(he=he.filter((function(Xe){return Object.getOwnPropertyDescriptor(G,Xe).enumerable}))),ae.push.apply(ae,he)}return ae}function fr(G){for(var W=1;W<arguments.length;W++){var ae=arguments[W]!=null?arguments[W]:{};W%2?An(Object(ae),!0).forEach((function(he){Mn(G,he,ae[he])})):Object.getOwnPropertyDescriptors?Object.defineProperties(G,Object.getOwnPropertyDescriptors(ae)):An(Object(ae)).forEach((function(he){Object.defineProperty(G,he,Object.getOwnPropertyDescriptor(ae,he))}))}return G}function Mn(G,W,ae){return(W=Vn(W))in G?Object.defineProperty(G,W,{value:ae,enumerable:!0,configurable:!0,writable:!0}):G[W]=ae,G}function En(){return En=Object.assign?Object.assign.bind():function(G){for(var W=1;W<arguments.length;W++){var ae=arguments[W];for(var he in ae)Object.prototype.hasOwnProperty.call(ae,he)&&(G[he]=ae[he])}return G},En.apply(this,arguments)}function as(G,W){for(var ae=0;ae<W.length;ae++){var he=W[ae];he.enumerable=he.enumerable||!1,he.configurable=!0,"value"in he&&(he.writable=!0),Object.defineProperty(G,Vn(he.key),he)}}function Vn(G){var W=(function(ae,he){if(be(ae)!=="object"||ae===null)return ae;var Xe=ae[Symbol.toPrimitive];if(Xe!==void 0){var Ze=Xe.call(ae,"string");if(be(Ze)!=="object")return Ze;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(ae)})(G);return be(W)==="symbol"?W:String(W)}function br(G,W){return br=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ae,he){return ae.__proto__=he,ae},br(G,W)}function Z(G){return Z=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(W){return W.__proto__||Object.getPrototypeOf(W)},Z(G)}var fe=(function(G){(function(ue,pe){if(typeof pe!="function"&&pe!==null)throw new TypeError("Super expression must either be null or a function");ue.prototype=Object.create(pe&&pe.prototype,{constructor:{value:ue,writable:!0,configurable:!0}}),Object.defineProperty(ue,"prototype",{writable:!1}),pe&&br(ue,pe)})(at,G);var W,ae,he,Xe,Ze=(he=at,Xe=(function(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch{return!1}})(),function(){var ue,pe=Z(he);if(Xe){var Oe=Z(this).constructor;ue=Reflect.construct(pe,arguments,Oe)}else ue=pe.apply(this,arguments);return(function(Ne,Ae){if(Ae&&(be(Ae)==="object"||typeof Ae=="function"))return Ae;if(Ae!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return(function(tt){if(tt===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return tt})(Ne)})(this,ue)});function at(ue){var pe;return(function(Oe,Ne){if(!(Oe instanceof Ne))throw new TypeError("Cannot call a class as a function")})(this,at),(pe=Ze.call(this,ue)).state={loaded:!1},pe}return W=at,(ae=[{key:"onImageLoad",value:function(){var ue=this;return this.state.loaded?null:function(pe){ue.props.onLoad(pe),ue.props.afterLoad(),ue.setState({loaded:!0})}}},{key:"getImg",value:function(){var ue=this.props,pe=(ue.afterLoad,ue.beforeLoad,ue.delayMethod,ue.delayTime,ue.effect,ue.placeholder,ue.placeholderSrc,ue.scrollPosition,ue.threshold,ue.useIntersectionObserver,ue.visibleByDefault,ue.wrapperClassName,ue.wrapperProps,(function(Oe,Ne){if(Oe==null)return{};var Ae,tt,St=(function(Pt,Dt){if(Pt==null)return{};var Rt,sn,Yr={},Fr=Object.keys(Pt);for(sn=0;sn<Fr.length;sn++)Rt=Fr[sn],Dt.indexOf(Rt)>=0||(Yr[Rt]=Pt[Rt]);return Yr})(Oe,Ne);if(Object.getOwnPropertySymbols){var bt=Object.getOwnPropertySymbols(Oe);for(tt=0;tt<bt.length;tt++)Ae=bt[tt],Ne.indexOf(Ae)>=0||Object.prototype.propertyIsEnumerable.call(Oe,Ae)&&(St[Ae]=Oe[Ae])}return St})(ue,ct));return a().createElement("img",En({},pe,{onLoad:this.onImageLoad()}))}},{key:"getLazyLoadImage",value:function(){var ue=this.props,pe=ue.beforeLoad,Oe=ue.className,Ne=ue.delayMethod,Ae=ue.delayTime,tt=ue.height,St=ue.placeholder,bt=ue.scrollPosition,Pt=ue.style,Dt=ue.threshold,Rt=ue.useIntersectionObserver,sn=ue.visibleByDefault,Yr=ue.width;return a().createElement(ze,{beforeLoad:pe,className:Oe,delayMethod:Ne,delayTime:Ae,height:tt,placeholder:St,scrollPosition:bt,style:Pt,threshold:Dt,useIntersectionObserver:Rt,visibleByDefault:sn,width:Yr},this.getImg())}},{key:"getWrappedLazyLoadImage",value:function(ue){var pe=this.props,Oe=pe.effect,Ne=pe.height,Ae=pe.placeholderSrc,tt=pe.width,St=pe.wrapperClassName,bt=pe.wrapperProps,Pt=this.state.loaded,Dt=Pt?" lazy-load-image-loaded":"",Rt=Pt||!Ae?{}:{backgroundImage:"url(".concat(Ae,")"),backgroundSize:"100% 100%"};return a().createElement("span",En({className:St+" lazy-load-image-background "+Oe+Dt,style:fr(fr({},Rt),{},{color:"transparent",display:"inline-block",height:Ne,width:tt})},bt),ue)}},{key:"render",value:function(){var ue=this.props,pe=ue.effect,Oe=ue.placeholderSrc,Ne=ue.visibleByDefault,Ae=ue.wrapperClassName,tt=ue.wrapperProps,St=this.getLazyLoadImage();return(pe||Oe)&&!Ne||Ae||tt?this.getWrappedLazyLoadImage(St):St}}])&&as(W.prototype,ae),Object.defineProperty(W,"prototype",{writable:!1}),at})(a().Component);fe.propTypes={onLoad:c.PropTypes.func,afterLoad:c.PropTypes.func,beforeLoad:c.PropTypes.func,delayMethod:c.PropTypes.string,delayTime:c.PropTypes.number,effect:c.PropTypes.string,placeholderSrc:c.PropTypes.string,threshold:c.PropTypes.number,useIntersectionObserver:c.PropTypes.bool,visibleByDefault:c.PropTypes.bool,wrapperClassName:c.PropTypes.string,wrapperProps:c.PropTypes.object},fe.defaultProps={onLoad:function(){},afterLoad:function(){return{}},beforeLoad:function(){return{}},delayMethod:"throttle",delayTime:300,effect:"",placeholderSrc:null,threshold:100,useIntersectionObserver:!0,visibleByDefault:!1,wrapperClassName:""};const ke=fe})(),Bp.exports=r})()),Bp.exports}var Gw=q_();const Zw=Jl(Gw),Q_=Wd({__proto__:null,default:Zw},[Gw]),{LazyLoadComponent:X_}=Q_||Zw;function Y_(t){const{size:e,visible:n,classes:r,canvasId:s,figure:a}=t,c=e?.width||128,d=e?.height||e?.width||128,m=I.jsx(K_,{...t}),y=I.jsx(X_,{threshold:300,style:{height:d,width:c},visibleByDefault:n,children:s?I.jsx(du,{canvas:s,children:m}):m});return a?I.jsx("figure",{className:r?.figure,children:y}):y}function K_({fallback:t,size:e,classes:n,showLabel:r,alt:s,dereference:a=!1}){const c=pn(),d=e?.width||128,m=e?.height||e?.width||128,y=s||W2(c?.label)||"",h=sh({width:d,height:m,allowUnsafe:!0},a);return!h||h.type!=="fixed"?I.jsx(I.Fragment,{children:t}):I.jsxs(I.Fragment,{children:[I.jsx("div",{className:n?.imageWrapper,children:I.jsx("img",{className:n?.img,src:h.id,alt:y})}),r?I.jsx(Hs,{as:"figcaption",className:n?.label,children:c?.label}):null]})}function G_({scrollBehaviour:t,dereference:e,flat:n,size:r,classes:s={},showLabel:a,figure:c,fallback:d}){const m=O.useRef(null),{items:y,sequence:h,currentSequenceIndex:v,setSequenceIndex:E}=Rg(),T={row:s.selected?.row||s.row,item:s.selected?.item||s.item,figure:s.selected?.figure||s.figure,img:s.selected?.img||s.img,label:s.selected?.label||s.label,imageWrapper:s.selected?.imageWrapper||s.imageWrapper};O.useLayoutEffect(()=>{if(!m.current)return;const k=m.current.querySelector("[data-selected=true]");k&&k.scrollIntoView({behavior:t||"instant",block:"nearest",inline:"center"})},[v]);const P=[];for(const k of h){const R=[],_=h[v]===k;for(const M of k){const L=y[M];R.push(I.jsx("div",{className:_?T.item:s.item,children:I.jsx(Y_,{classes:_?T:s,canvasId:L.id,size:r,dereference:e,showLabel:a,figure:c,placeholder:I.jsx("div",{style:{height:128,width:128}}),fallback:d})},M))}if(n){P.push(R);continue}P.push(I.jsx("div",{onClick:M=>{E(h.indexOf(k))},"data-selected":_,className:_?T.row:s.row,children:R},k.join("-")))}return I.jsx("div",{ref:m,className:s.container,children:P})}function Z_(){const{play:t,pause:e,setVolume:n,toggleMute:r,setDurationPercent:s,duration:a,isMuted:c,volume:d,isPlaying:m,isReady:y,playRequested:h,setProgressElement:v,setCurrentTimeElement:E,clearProgressElement:T,clearCurrentTimeElement:P}=Ko(_=>_),k=O.useRef(null),R=O.useRef(null);return O.useLayoutEffect(()=>(k.current&&v(k.current),R.current&&E(R.current),()=>{T(),P()}),[y]),I.jsxs("div",{className:"controls",style:{display:"flex",alignItems:"center",opacity:y?1:.5},children:[I.jsx("button",{disabled:h,onClick:()=>{m?e():t()},children:m?"pause":"play"}),I.jsx("div",{ref:R,style:{padding:"0 20px"},children:"0:00"}),I.jsxs("div",{style:{flex:" 1 1 0px",height:"6px",display:"flex",position:"relative",padding:"15px 0"},onClick:_=>{const{left:M,width:L}=_.currentTarget.getBoundingClientRect(),$=(_.pageX-M)/L;s($)},children:[I.jsx("div",{style:{height:"6px",pointerEvents:"none",position:"absolute",top:"13px",left:"0",right:0,borderRadius:"3px",transition:"width 200ms",background:"#f9f9f9"}}),a?I.jsx("div",{style:{position:"absolute",top:"13px",left:"0",height:"6px",borderRadius:"3px",background:"cornflowerblue",width:"100%",pointerEvents:"none"},ref:k}):null]}),I.jsx("div",{style:{padding:"0 20px"},children:Fg(a)}),I.jsxs("div",{style:{display:"flex"},children:[I.jsx("input",{type:"range",id:"audio-slider",role:"slider",disabled:c,min:"0",max:"100",value:d,onChange:_=>n(Number(_.currentTarget.value))}),I.jsx("button",{onClick:()=>r(),children:c?"Unmute":"Mute"})]})]})}function J_({onReady:t,onPlay:e,onPause:n,onStop:r,onBuffering:s,onPrimeChange:a,onEnter:c,onExit:d}){const[m,y]=O.useState(!1),[h,v]=O.useState(Date.now());Ko(P=>P.isReady);const E=Ko(P=>P.isPlaying);Ko(P=>P.isBuffering),Ko(P=>P.visibleElements),Ko(P=>P.currentPrime),Ko(P=>P.nextKeyframeIndex);const T=O.useRef(E);return O.useEffect(()=>{console.log("TimelineEvents.useEffect",T,E,Date.now()-h),E&&T.current!==E?(y(!0),v(Date.now()),e()):(T.current!==E||m===!0&&Date.now()-h>500)&&(y(!1),n())},[E]),null}function eI({onReady:t}){const e=Ko(r=>({play:r.play,pause:r.pause,playPause:r.playPause,setTime:r.setTime,setDurationPercent:r.setDurationPercent,isReady:r.isReady,isPlaying:r.isPlaying,isMuted:r.isMuted,duration:r.duration})),n=O.useMemo(()=>({play:e.play,pause:e.pause,playPause:e.playPause,setTime:e.setTime,setDurationPercent:e.setDurationPercent,getState:()=>({isReady:e.isReady,isPlaying:e.isPlaying,isMuted:e.isMuted,duration:e.duration})}),[e.play,e.pause,e.playPause,e.setTime,e.setDurationPercent,e.isReady,e.isPlaying,e.isMuted,e.duration]);return O.useEffect(()=>{t?.(n)},[t,n]),null}const tI={maxOverZoom:5};function nI(){const t=pn(),e=Xg(t?.id),n=cr();return!t||e.enabledPageIds.length===0?null:I.jsx(I.Fragment,{children:e.enabledPageIds.map(r=>I.jsx(Dc,{page:n.get(r)},r))})}function rI(){const t=ss();return t?I.jsx(Hs,{as:"h2",className:"text-2xl my-3",children:t.label}):I.jsx("div",{children:"Loading.."})}function iI({manifest:t,onControlsReady:e,onPlay:n,onPause:r,startCanvas:s,pagingEnabledDefault:a=!0}){const c=O.useRef(null),[d,m]=O.useState(a),y=O.useCallback(()=>n?.(),[n]),h=O.useCallback(()=>r?.(),[r]),v=O.useMemo(()=>({ComplexTimelineControls:()=>I.jsxs(I.Fragment,{children:[I.jsx(Z_,{}),I.jsx(eI,{onReady:e}),I.jsx(J_,{onReady:()=>console.log("READY"),onPlay:()=>{y()},onPause:()=>{h()},onStop:()=>console.log("STOP"),onBuffering:T=>console.log("BUFFERING:",T),onPrimeChange:T=>console.log("PRIME:",T),onEnter:(T,P)=>console.log("ENTER:",T,P),onExit:T=>console.log("EXIT:",T)})]})}),[e,n,r]);return I.jsxs(I.Fragment,{children:[I.jsx("style",{children:`
        [data-textual-content="true"] {
          background: #fff;
          font-size: 1.2em;
          font-family: system-ui, sans-serif;
          padding: 1em;
          margin-top: 1em;
        }
        * { box-sizing: border-box; }
        .atlas-container { background: #000; }
        body { padding: 0.5em }
      `}),I.jsxs(Hn,{ref:c,spacing:20,height:800,header:I.jsx(rI,{}),reuseAtlas:!0,mode:"explore",pagingEnabled:d,runtimeOptions:tI,manifest:t,startCanvas:s,components:v,annotations:I.jsx(I.Fragment,{children:I.jsx(nI,{})}),renderAnnotationContextMenu:()=>I.jsx("div",{children:"This is indeed an annotation"}),children:[I.jsxs("div",{className:"actions hide flex gap-2 my-4",children:[I.jsx("button",{className:"p-2 bg-blue-500 text-white hover:bg-blue-400",onClick:()=>m(E=>!E),children:"toggle paging"}),I.jsx("button",{className:"p-2 bg-blue-500 text-white hover:bg-blue-400",onClick:()=>c.current?.previousCanvas(),children:"prev"}),I.jsx("button",{className:"p-2 bg-blue-500 text-white hover:bg-blue-400",onClick:()=>c.current?.nextCanvas(),children:"next"})]}),I.jsx(G_,{classes:{container:"actions hide flex gap-1 overflow-x-auto",row:"flex gap-2 border border-gray-200 flex-none p-2 m-2",img:"max-h-[128px] max-w-[128px] object-contain h-full w-full",selected:{row:"flex gap-2 border border-blue-400 flex-none p-2 m-2 bg-blue-100"}},fallback:I.jsx("div",{className:"flex items-center justify-center w-32 h-32 bg-gray-200 text-gray-400 select-none",children:"No thumb"})}),I.jsx(V_,{allowHtml:!0,classes:{container:"m-4",row:"border-b border-gray-200",label:"font-bold p-2 text-slate-600",value:"text-sm p-2 text-slate-800",empty:"text-gray-400"}})]})]})}function Jw({manifest:t,items:e,onSelect:n}){const[r,s]=O.useState({}),[a,c]=O.useState("info-box"),d=m=>y=>{if(y.preventDefault(),window.location.hash=`manifest=${m}`,n)return n(m);const v={...Wp.parse(window.location.hash.slice(1)),manifest:m};window.location.hash=Wp.stringify(v)};return!e||!e.length?I.jsx("div",{className:"gallerie empty",children:"Aucun lment"}):I.jsxs("div",{className:"gallerie-container",children:[I.jsx("ul",{className:"gallerie",children:e.map(m=>{const y=`#manifest=${m.manifest}`;return I.jsxs("li",{className:`item${t!==m.manifest?"":" active"}`,children:[t!==m.manifest?I.jsxs("a",{href:y,onClick:d(m.manifest),children:[m.image&&I.jsx("img",{className:"img",src:m.image,alt:m.label,loading:"lazy"}),I.jsx("span",{className:"label",children:m.label})]}):I.jsxs("div",{children:[m.image&&I.jsx("img",{className:"img",src:m.image,alt:m.label,loading:"lazy"}),I.jsx("span",{className:"label",children:m.label})]}),I.jsx("button",{className:"info",onClick:()=>{c("info-box open"),s(m.info)},children:"i"})]},m.id)})}),a==="info-box open"&&I.jsxs("div",{className:a,children:[I.jsx("button",{className:"close",onClick:()=>{c("info-box")},children:""}),I.jsx("div",{className:"card-container",onClick:()=>{c("info-box")},children:I.jsxs("div",{class:"card",onClick:m=>{m.stopPropagation()},children:[r.image&&I.jsx("img",{src:r.image,alt:r.title}),I.jsxs("div",{class:"content",children:[I.jsx("div",{class:"meta"}),r.title&&I.jsx("h1",{children:r.title}),r.creator&&I.jsx("h2",{children:r.creator}),I.jsx("p",{children:r.summary}),r.copyright&&I.jsx("p",{class:"copyright",children:r.copyright})]})]})})]})]})}function sI({collection:t,onSelect:e}){return I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"card-container home",children:I.jsxs("div",{className:"card",children:[t.index.image&&I.jsx("img",{src:t.index.image,alt:t.index.title}),I.jsxs("div",{className:"content",children:[I.jsx("div",{className:"meta"}),t.index.title&&I.jsx("h1",{children:t.index.title}),t.index.summary&&I.jsx("p",{children:t.index.summary}),I.jsx("button",{className:"commencer",onClick:()=>e(t.galleries[0].manifest,!0),children:"Commencer"}),t.index.copyright&&I.jsx("div",{className:"copyright",children:t.index.copyright})]})]})}),I.jsx(Jw,{items:t.galleries,onSelect:e})]})}const oI=async t=>{const e={};try{const n=await fetch(t,{headers:{Accept:"application/json"}});if(!n.ok)throw new Error(`HTTP ${n.status}`);const r=await n.json();if(r.metadata)for(const s of r.metadata)s.label&&s.value&&(e[s.label.fr[0].toLowerCase()]=s.value.fr[0]);if(r.summary&&(e.summary=r.summary.fr[0]),r.requiredStatement)for(const s in r.requiredStatement)s.toLowerCase()==="value"&&(e.copyright=r.requiredStatement[s].fr[0]);r.thumbnail&&(e.image=r.thumbnail[0].id)}catch(n){console.error("Erreur lors du chargement des mtadonnes :",n)}return e},lI=async t=>{const e=await fetch(t,{headers:{Accept:"application/json"}});if(!e.ok)throw new Error(`HTTP ${e.status}`);const n=await e.json(),r=[],s={};if(n.summary&&(s.summary=n.summary.fr[0]),n.metadata)for(const c of n.metadata)c.label&&c.value&&(s[c.label.fr[0].toLowerCase()]=c.value.fr[0]);if(n.requiredStatement)for(const c in n.requiredStatement)c.toLowerCase()==="value"&&(s.copyright=n.requiredStatement[c].fr[0]);n.thumbnail&&(s.image=n.thumbnail[0].id);const a={};if(n.provider)for(const c of n.provider)c.type.toLowerCase()==="agent"&&(c.label&&c.label.fr&&(a.nom=c.label.fr[0]),c.homepage&&(c.homepage=c.homepage[0],a.url=c.homepage.id),c.logo&&(c.logo=c.logo[0],a.logo=c.logo.id));if(n.items)for(const c of n.items){const d=await oI(c.id.replace("http://","https://")),m={manifest:c.id.replace("http://","https://"),image:c.thumbnail?c.thumbnail[0].id:null,label:c.label?c.label.fr[0]:null,info:d};r.push(m)}return{index:s,provider:a,galleries:r,raw:n}},aI=async()=>{let{manifest:t,collection:e}=Wp.parse(window.location.hash.slice(1));return e||(e=document.getElementById("root").dataset.collection),t||(e=document.getElementById("root").dataset.collection),e=await lI(e),{manifest:t,collection:e}};function uI(){const[t,e]=O.useState(null),[n,r]=O.useState(null),[s,a]=O.useState(!0);O.useEffect(()=>{(async()=>{a(!0);const M=await aI();e(M.collection),r(M.manifest||null),a(!1)})()},[]);const[c,d]=O.useState("bt-play"),[m,y]=O.useState("player-contenaire"),h=O.useRef(null),v=n||"https://gist.githubusercontent.com/stephenwf/57cc5024144c53d48cc3c07cc522eb94/raw/a87a5d9a8f949bfb11cebd4f011a204abe8a932b/manifest.json",E=O.useCallback(_=>{h.current=_},[]),T=O.useCallback(()=>{console.log("play"),d("bt-play hide"),y("player-contenaire playing")},[]),P=O.useCallback(()=>{console.log("pause",h),d("bt-play"),y("player-contenaire")},[]);if(O.useCallback(()=>{console.log("isPlaying")},[]),s)return I.jsx("div",{children:"Chargement"});const k={};t.provider.logo&&(k.backgroundImage=`url(${t.provider.logo})`);const R=(_,M=!1)=>{r(_),M?setTimeout(()=>{h.current?.play()},1e3):_===void 0&&(document.location.hash="")};return I.jsxs(I.Fragment,{children:[I.jsx("div",{className:"signature",style:k}),n?I.jsxs("div",{className:m,children:[I.jsx("div",{className:c,children:I.jsx("button",{onClick:()=>{h.current?.play(),setTimeout(()=>{h.current?.play()},200)},children:"Play"})}),I.jsxs("div",{className:"appWrap",children:[I.jsx("div",{class:"home-button",onClick:()=>R(void 0),children:"Accueil"}),t?I.jsx(Jw,{manifest:v,items:t.galleries,onSelect:R}):null,I.jsx("div",{className:"player",children:I.jsx(iI,{manifest:v,onControlsReady:E,onPlay:T,onPause:P})})]})]}):I.jsx("div",{className:m,children:I.jsx(sI,{collection:t,onSelect:R})})]})}yg.createRoot(document.getElementById("root")).render(I.jsx(O.StrictMode,{children:I.jsx(uI,{})}));
